!function($){$._button||($._button=$.button),$.fn.inputToObject=function(a){var e={};return $(this).attr("name")&&("radio"!=$(this).attr("type")||$(this).prop("checked"))&&function a(e,t,o){1==t.length?e[t[0]]=o:(null==e[t[0]]&&(e[t[0]]={}),a(e[t[0]],t.slice(1),o))}(e,$(this).attr("name").replace(/]/g,"").split("["),a),e},MapSVG.isMac=function(){return 0<=navigator.platform.toUpperCase().indexOf("MAC")},MapSVG.isValidURL=function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)};var WP=!0,msvg,editingMark,_data={},_this={};_data.optionsDelta={},_data.optionsMode={preview:{responsive:!0,disableLinks:!0},editRegions:{responsive:!0,disableLinks:!0,zoom:{on:!0,limit:[-1e3,1e3]},scroll:{on:!0},onClick:null,mouseOver:null,mouseOut:null,tooltips:{on:!0},templates:{tooltipRegion:"<b>{{id}}</b>{{#if title}}: {{title}} {{/if}}"},popovers:{on:!1},actions:{region:{click:{showDetails:!1,filterDirectory:!1,loadObjects:!1,showPopover:!1,goToLink:!1}},marker:{click:{showDetails:!1,showPopover:!1,goToLink:!1}}}},draw:{responsive:!0,disableLinks:!0,zoom:{on:!0,limit:[-10,10]},scroll:{on:!0,spacebar:!0},mouseOver:null,mouseOut:null,colorsIgnore:!0,tooltips:{on:!1},popovers:{on:!1},actions:{region:{click:{showDetails:!1,filterDirectory:!1,loadObjects:!1,showPopover:!1,goToLink:!1}},marker:{click:{showDetails:!1,showPopover:!1,goToLink:!1}}}},editData:{responsive:!0,disableLinks:!0,zoom:{on:!0,limit:[-1e3,1e3]},scroll:{on:!0},actions:{region:{click:{showDetails:!1,filterDirectory:!0,loadObjects:!1,showPopover:!1,goToLink:!1}},marker:{click:{showDetails:!1,showPopover:!1,goToLink:!1}}},tooltips:{on:!0},templates:{tooltipRegion:"Click to show linked DB Objects",tooltipMarker:"DB Object id: <b>{{id}}</b> (Click to edit)"},popovers:{on:!1}},editMarkers:{responsive:!0,disableLinks:!0,zoom:{on:!0,limit:[-1e3,1e3]},scroll:{on:!0},onClick:null,mouseOver:null,mouseOut:null,tooltips:{on:!0},templates:{tooltipMarker:"DB Object id: <b>{{id}}</b> (Click to edit)"},popovers:{on:!1},actions:{region:{click:{showDetails:!1,filterDirectory:!0,loadObjects:!1,showPopover:!1,goToLink:!1}},marker:{click:{showDetails:!1,showPopover:!1,goToLink:!1}}}}},_data.mode="preview",methods={getData:function(){return _data},getMapId:function(){return _data.options.map_id},selectCheckbox:function(){c=!!$(this).attr("checked"),$(".region_select").removeAttr("checked"),c&&$(this).attr("checked","true")},disableAll:function(){c=!!$(this).attr("checked"),c?$(".region_disable").attr("checked","true"):$(".region_disable").removeAttr("checked")},save:function(o){$(this);$("#mapsvg-save")._button("loading");var s=msvg.getOptions(!1,null,_data.optionsDelta),a={mapsvg_data:MapSVG.convertToText(s),title:s.title,map_id:_data.options.map_id,region_prefix:s.regionPrefix,source:s.source};return a.mapsvg_data=a.mapsvg_data.replace(/select/g,"!mapsvg-encoded-slct"),a.mapsvg_data=a.mapsvg_data.replace(/table/g,"!mapsvg-encoded-tbl"),a.mapsvg_data=a.mapsvg_data.replace(/database/g,"!mapsvg-encoded-db"),a.mapsvg_data=a.mapsvg_data.replace(/varchar/g,"!mapsvg-encoded-vc"),_this.mapsvgCssChanged&&(a.css=_this.mapsvgCss),void 0!==s.manualRegions&&(a.manualRegions=MapSVG.parseBoolean(_this.manualRegions)),$.post(ajaxurl,{action:"mapsvg_save",_wpnonce:_data.options._wpnonce,data:a},function(a){if($.isNumeric(a)){var e=_data.options._wpnonce.split("-");e[1]=a,_data.options._wpnonce=e.join("-");var t="Settings saved";$("#map-page-title").html(s.title),"new"==_data.options.map_id&&($("#mapsvg-shortcode").html('[mapsvg id="'+a+'"]'),t+='. Shortcode: [mapsvg id="'+a+'"]',_data.options.map_id=a,msvg.id=a)}else t="Error!";!o&&$.growl.notice({title:"",message:t,duration:700})}).always(function(){$("#mapsvg-save")._button("reset")}).fail(function(){$.growl.error({message:"Server error: settings were not saved"})})},mapDelete:function(a){a.preventDefault();var e=$(this).data("nonce"),t=$(this).closest("tr"),o=t.attr("data-id");t.fadeOut(),$.post(ajaxurl,{action:"mapsvg_delete",_wpnonce:e,id:o},function(){})},mapCopy:function(a){a.preventDefault();var e=$(this).data("nonce"),o=$(this).closest("tr"),t=o.attr("data-id"),s=o.attr("data-title");if(!(new_name=prompt("Enter new map title",s+" - copy")))return!1;$.post(ajaxurl,{action:"mapsvg_copy",_wpnonce:e,id:t,new_name:new_name},function(a){var e=o.clone(),t="?page=mapsvg-config&map_id="+a;e.attr("data-id",a).attr("data-title",new_name),e.find(".mapsvg-map-title a").attr("href",t).html(new_name),e.find(".mapsvg-action-buttons a.mapsvg-button-edit").attr("href",t),e.find(".mapsvg-shortcode").html('[mapsvg id="'+a+'"]'),e.prependTo(o.closest("tbody"))})},mapUpdate:function(e){e.preventDefault();var btn=$(this),table_row=$(this).closest("tr"),map_id=table_row.length?table_row.attr("data-id"):msvg.id,update_to=$(this).data("update-to");jQuery.get(ajaxurl,{action:"mapsvg_get",id:map_id},function(data){var disabledRegions=[];if(eval("var options = "+data),options.regions)for(var id in options.regions)options.regions[id].disabled&&disabledRegions.push(id);$.post(ajaxurl,{action:"mapsvg_update",id:map_id,update_to:update_to,disabledRegions:disabledRegions,disabledColor:options.colors&&void 0!==options.colors.disabled?options.colors.disabled:""},function(){btn.fadeOut(),table_row.length||window.location.reload()}).fail(function(){$.growl.error({title:"Server Error",message:"Can't update the map"})})})},markerEditHandler:function(a){if(editingMark=this.getOptions(),hbData.isGeo&&a&&editingMark.object){var e=msvg.database.getLoadedObject(editingMark.dataId);msvg.database.update(e)}},regionEditHandler:function(){$("#mapsvg-region-"+this.id_no_spaces);$('#mapsvg-tabs-menu a[href="#tab_regions"]').tab("show"),_data.controllers.regions.controllers.list.editRegion(this,!0)},dataEditHandler:function(){var a=this;$('#mapsvg-tabs-menu a[href="#tab_database"]').tab("show");var e={};a instanceof Region?e.region_id=a.id:a instanceof Marker&&(e.id=a.object.id),_data.controllers.database.controllers.list.setFilters(e)},resizeDashboard:function(){var a=$("#wpbody-content").width(),e=$("#wpadminbar").height(),t=$(window).width()-a,o=$(window).height()-e;$("#mapsvg-admin").css({width:a,height:o,left:t,top:e}),($("#mapsvg-sizer").outerWidth()>$("#mapsvg-container").outerWidth()||$("#mapsvg-sizer").outerHeight()>$("#mapsvg-container").outerHeight()||$("#mapsvg-sizer").outerHeight()<$("#mapsvg-container").outerHeight()&&$("#mapsvg-sizer").outerWidth()<$("#mapsvg-container").outerWidth())&&_this.resizeSVGCanvas()},resizeSVGCanvas:function(){if(msvg){var a=$("#mapsvg-container").width(),e=$("#mapsvg-container").height(),t=msvg&&msvg.getData().viewBox,o=Math.floor(msvg.getData().$leftSidebar.outerWidth()),s=Math.floor(msvg.getData().$rightSidebar.outerWidth()),i=a-(o+s),n=e-(msvg.getData().$header.is(":hidden")?0:Math.floor(msvg.getData().$header.outerHeight(!0))),r=t[2]/t[3];if(r<i/n){var d=r*n,l=(Math.round(100*d/i),d+o+s);$("#mapsvg-sizer").css({width:l+"px"})}else $("#mapsvg-sizer").css({width:"auto"})}},setPreviousMode:function(){_data.previousMode&&_this.setMode(_data.previousMode)},setMode:function(a,e){if(_data.mode!=a){if("draw"==_data.mode){if(_data.controllers.draw.changed&&!confirm("Changes in SVG file will be lost. Continue?"))return jQuery("#mapsvg-map-mode-2 label").toggleClass("active",!1),jQuery("#mapsvg-map-mode-2 input").prop("checked",!1),jQuery('#mapsvg-map-mode-2 [data-mode="draw"]').toggleClass("active",!0),void jQuery('#mapsvg-map-mode-2 [data-mode="draw"] input').prop("checked",!0);_data.controllers.draw.revert(),_this.unloadController(_data.controllers.draw)}_data.previousMode=_data.mode,_data.mode=a,msvg.update(_data.optionsDelta);var t=msvg.getOptions();_data.optionsDelta={},$.each(_data.optionsMode[_data.mode],function(a,e){_data.optionsDelta[a]=void 0!==t[a]?t[a]:null}),msvg.update(_data.optionsMode[a]);var o=a;$("#mapsvg-map-mode").find("label").removeClass("active").find("input").prop("checked",!1),$("#mapsvg-map-mode").find('label[data-mode="'+o+'"]').addClass("active"),$("body").off("click.switchTab"),msvg.off("zoom"),"editRegions"==a?(msvg.setMarkersEditMode(!1),msvg.setRegionsEditMode(!0),msvg.setDataEditMode(!1),_this.setDrawMode(!1),msvg.getData().$map.addClass("mapsvg-edit-regions"),$("body").on("click.switchTab",".mapsvg-region",function(){$('#mapsvg-tabs-menu a[href="#tab_regions"]').tab("show")}),msvg.getData().$map.removeClass("mapsvg-edit-objects")):"draw"==a?(msvg.setMarkersEditMode(!1),msvg.setRegionsEditMode(!1),msvg.setDataEditMode(!1),msvg.getData().$map.removeClass("mapsvg-edit-regions"),msvg.getData().$map.removeClass("mapsvg-edit-objects"),_this.setDrawMode(!0)):"editMarkers"==a?(msvg.setMarkersEditMode(!0),msvg.setRegionsEditMode(!1),msvg.setDataEditMode(!1),_this.setDrawMode(!1),msvg.getData().$map.removeClass("mapsvg-edit-regions"),msvg.getData().$map.removeClass("mapsvg-edit-objects")):"editData"==a?(msvg.setMarkersEditMode(!1),msvg.setRegionsEditMode(!1),msvg.setDataEditMode(!0),_this.setDrawMode(!1),msvg.getData().$map.removeClass("mapsvg-edit-regions"),msvg.getData().$map.addClass("mapsvg-edit-objects"),$("body").on("click.switchTab",".mapsvg-region",function(){$('#mapsvg-tabs-menu a[href="#tab_database"]').tab("show")}),$("body").on("click.switchTab",".mapsvg-marker",function(){$('#mapsvg-tabs-menu a[href="#tab_database"]').tab("show");var a=msvg.getMarker($(this).prop("id"));_data.controllers.database.controllers.list.editDataObject(a.object.id,!0)})):(msvg.setMarkersEditMode(!1),msvg.setRegionsEditMode(!1),msvg.setDataEditMode(!1),_this.setDrawMode(!1),_this.resizeSVGCanvas(),msvg.getData().$map.removeClass("mapsvg-edit-regions"),msvg.getData().$map.removeClass("mapsvg-edit-objects")),$("#mapsvg-admin").attr("data-mode",a),"draw"==_data.previousMode&&_this.loadController("tab_settings","settings")}},setDrawMode:function(a){if(a)this.toggleContainers(!1),msvg.hideMarkersExceptOne(),_data.controllers.draw?_data.controllers.draw.show():_data.controllers.draw=new MapSVGAdminDrawController("mapsvg-container",this,msvg),_data.controllers.draw.viewDidAppear();else{if("draw"!==_data.previousMode)return;this.toggleContainers(),msvg.showMarkers(),_data.controllers.draw&&_data.controllers.draw.close()}},enableMarkersMode:function(a){var e=$("#mapsvg-map-mode").find('[data-mode="editMarkers"]');a?($("#mapsvg-map-mode").find("label").addClass("disabled"),e.removeClass("disabled").find("input")):($("#mapsvg-map-mode").find("label").removeClass("disabled"),e.addClass("disabled").find("input"))},addHandlebarsMethods:function(){},getPostTypes:function(){return _data.options.post_types},togglePanel:function(a,e){e?$("#mapsvg-panels").removeClass("hide-"+a):$("#mapsvg-panels").addClass("hide-"+a);var t=$("#mapsvg-panels-view-"+a);t.hasClass("active")!=e&&(e?t.addClass("active"):t.removeClass("active"),t.prop("checked",e))},rememberPanelsState:function(){_data.panelsState={},_data.panelsState.left=!$("#mapsvg-panels").hasClass("hide-left"),_data.panelsState.right=!$("#mapsvg-panels").hasClass("hide-right")},restorePanelsState:function(){for(var a in _data.panelsState)_this.togglePanel(a,_data.panelsState[a]);_data.panelsState={}},toggleContainers:function(a){a=void 0===a?!_this.containersVisible:a,$(".mapsvg-top-container").toggleClass("mapsvg-hidden",!a),_this.containersVisible=a},setEventHandlers:function(){$("#mapsvg-admin").on("mousewheel",".jspContainer",function(a){a.preventDefault()}),$(".mapsvg-copy-shortcode").on("click",function(){var a=$(this).data("shortcode"),e=document.createElement("textarea");e.value=a,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),$.growl.notice({title:"",message:"Shortcode copied to clipboard",duration:700})}),$(window).on("keydown.save.mapsvg",function(a){(a.metaKey||a.ctrlKey)&&83==a.keyCode&&(a.preventDefault(),"draw"!=_data.mode?_this.save():_data.controllers.draw.saveSvg())}),_data.view.on("click","#mapsvg-save",function(){_this.save()}).on("change","#mapsvg-map-mode :radio",function(){var a=$("#mapsvg-map-mode :radio:checked").val();_this.setMode(a)}).on("change","#mapsvg-preview-containers-toggle :checkbox",function(){_this.toggleContainers($(this).is(":checked"))}).on("click","button",function(a){a.preventDefault()}),_data.view.on("change","#mapsvg-map-mode-2 :radio",function(){var a=$("#mapsvg-map-mode-2 :radio:checked").val();_this.setMode(a)}),$("#mapsvg-view-buttons").on("change",'[type="checkbox"]',function(){var a=$(this).prop("checked"),e=$(this).attr("name");_this.togglePanel(e,a)}),$("#mapsvg-tabs-menu").on("click","a",function(a){a.preventDefault(),$(this).tab("show")}),$("#mapsvg-tabs-menu").on("shown.bs.tab","a",function(a){$("#mapsvg-tabs-menu .menu-name").html($(this).text());var e=$(this).attr("href");_this.resizeDashboard();var t=$(e),o=e.replace("#",""),s=t.attr("data-controller");_this.loadController(o,s)})},addController:function(a,e,t){if(!$("#"+e).length){var o=$("#mapsvg-tabs-menu .dropdown-menu").find('a[href="#'+t+'"]').parent();$('<li><a href="#'+e+'">'+a+"</a></li>").insertAfter(o),$("#mapsvg-tabs").append('<div class="tab-pane" id="'+e+'" data-controller="'+e+'"></div>')}},loadController:function(a,e){if(!_data.currentController||_data.currentController!=_data.controllers[e]){if(!_data.controllers[e]){var t=e.charAt(0).toUpperCase()+e.slice(1);_data.controllers[e]=new window["MapSVGAdmin"+t+"Controller"](a,_this,msvg)}return _data.currentController&&_data.currentController.viewDidDisappear(),_data.currentController=_data.controllers[e],_data.currentController.viewDidAppear(),$("#"+a).attr("data-controller")||$("#"+a).attr("data-controller",e),$("#"+a).hasClass("active")||$('#mapsvg-tabs-menu a[href="#'+a+'"]').tab("show"),_data.currentController}},unloadController:function(a){"string"!=typeof a&&(a=a.nameCamel()),_data.controllers[a].destroy(),_data.controllers[a]=null,_data.currentController=null,"draw"==a&&(_data.controllers.drawRegion=null)},init:function(a){MapSVG.isMac()?$("body").addClass("mapsvg-os-mac"):$("body").addClass("mapsvg-os-other"),_data.options=a,_data.controllers={},_data.view=$("#mapsvg-admin");var t=!!_data.options.mapsvg_options.source;return $(document).ready(function(){if(WP&&t&&(new MapSVG.ResizeSensor($("#adminmenuwrap")[0],function(){_this.resizeDashboard()}),new MapSVG.ResizeSensor($("#wpwrap")[0],function(){_this.resizeDashboard()}),new MapSVG.ResizeSensor($("#mapsvg")[0],function(){_this.resizeDashboard()}),_this.resizeDashboard()),_data.view.tooltip({selector:".toggle-tooltip",trigger:"hover"}),$("body").on("click",".mapsvg-update",methods.mapUpdate),t){_this.addHandlebarsMethods();var e=_data.options.mapsvg_options.afterLoad;return _data.options.mapsvg_options.backend=!0,_data.options.mapsvg_options.manualRegions&&$('label[data-mode="addRegions"]').show(),_data.options.mapsvg_options.afterLoad=function(){var a;(window.m||(window.m=msvg),new MapSVG.ResizeSensor($(".mapsvg-header")[0],function(){setTimeout(function(){_this.resizeSVGCanvas()},1)}),msvg.setMarkerEditHandler(methods.markerEditHandler),msvg.setRegionEditHandler(methods.regionEditHandler),msvg.setAfterLoad(e),hbData=msvg.getOptions(!0),_this.hbData=hbData,msvg.getData().presentAutoID&&$("#mapsvg-auto-id-warning").show(),_this.setMode("preview"),hbData.isGeo=msvg.getData().mapIsGeo,hbData.isGeo&&$("#mapsvg-admin").addClass("mapsvg-is-geo"),MapSVG.markerImages=_data.options.markerImages||[],_data.options.mapsvg_options.defaultMarkerImage||msvg.setDefaultMarkerImage(_data.options.markerImages[0].url),hbData.isSafari=navigator.vendor&&-1<navigator.vendor.indexOf("Apple")&&navigator.userAgent&&!navigator.userAgent.match("CriOS"),hbData.title=_data.options.map_title,hbData.title||(hbData.title=hbData.svgFilename.split("."),hbData.title.pop(),hbData.title=hbData.title.join("."),hbData.title=hbData.title.charAt(0).toUpperCase()+hbData.title.substr(1)),msvg.update({title:hbData.title}),_data.options.mapsvg_options.extension&&$().mapSvg.extensions&&$().mapSvg.extensions[_data.options.mapsvg_options.extension])&&((a=$().mapSvg.extensions[_data.options.mapsvg_options.extension])&&a.backend(msvg,_this));_data.controllers.settings=new MapSVGAdminSettingsController("tab_settings",_this,msvg),_data.controllers.database=new MapSVGAdminDatabaseController("tab_database",_this,msvg),_data.controllers.regions=new MapSVGAdminRegionsController("tab_regions",_this,msvg),$(document).on("focus",".select2-selection--single",function(a){select2_open=$(this).parent().parent().prev("select"),select2_open.mselect2("open")}),hbData.isSafari&&_data.view.find('input[type="text"]').closest(".form-group").wrap("<form />"),_this.setEventHandlers(),_this.resizeDashboard();try{e(msvg)}catch(a){}_data.options.mapsvg_options.extension&&$().mapSvg.extensions&&$().mapSvg.extensions[_data.options.mapsvg_options.extension]&&((a=$().mapSvg.extensions[_data.options.mapsvg_options.extension])&&a.backendAfterLoad(msvg))},_data.options.mapsvg_options.db_map_id=_this.getMapId(),_data.options.mapsvg_options.editMode=!0,_data.options.mapsvg_options.googleMaps||(_data.options.mapsvg_options.googleMaps={}),!_data.options.mapsvg_options.googleMaps.apiKey&&_data.options.mapsvg_google_api_key&&(_data.options.mapsvg_options.googleMaps={apiKey:_data.options.mapsvg_google_api_key}),_data.options.mapsvg_options.googleMaps.apiKey=_data.options.mapsvg_google_api_key,msvg=$("#mapsvg").mapSvg(_data.options.mapsvg_options),_this}$(".mapsvg-copy-shortcode").on("click",function(){var a=$(this).data("shortcode"),e=document.createElement("textarea");e.value=a,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),$.growl.notice({title:"",message:"Shortcode copied to clipboard",duration:700})}),$(".select-map-list").mselect2().on("select2:select",function(){var a=$(this).find("option:selected").data("link");a&&(window.location=a+"&noheader=true")});var s=[];$("#svg_file_uploader").on("change",function(a){$.each(a.target.files,function(a,t){if(-1==t.type.indexOf("svg"))return alert("You can upload only SVG files"),!1;var e=new FileReader;e.onload=function(a){object={},object.filename=t.name,object.data=a.target.result;var e=$("<div>"+object.data+"</div>");e.find("#mapsvg-google-map-background").length&&(confirm("Remove Google Maps background image from SVG file?")&&e.find("#mapsvg-google-map-background").remove());object.data=e.html(),object.data.replace("\x3c!--?xml","<?xml"),object.data.replace('"no"?--\x3e','"no"?>'),object.data.replace("mapsvg:geoviewbox","mapsvg:geoViewBox"),s.push(object),$("#svg_file_uploader_form").submit()},e.readAsText(t)})}),$("#svg_file_uploader_form").on("submit",function(a){var o=$(this).find(".btn");o._button("loading"),console.log(file.data.length/1024/1024),$.each(s,function(a,e){var t=e.filename.replace(/\s/g,"_");$.ajax({url:ajaxurl,type:"POST",data:{action:"mapsvg_upload",filename:t,data:e.data}}).done(function(a,e,t){$.growl.notice({title:"",message:"File uploaded:<br>user-uploads/"+a}),$("#mapsvg-svg-file-select").find('[data-link="?page=mapsvg-config&map_id=new&package=uploads&path='+a+'"]').length||$("#mapsvg-svg-file-select").append('<option data-link="?page=mapsvg-config&map_id=new&package=uploads&path='+a+'">user-uploads/'+a+"</option>")}).always(function(){$("#svg_file_uploader").val(""),o._button("reset")})}),s=[],a.preventDefault()});var i=[];$("#image_file_uploader").on("change",function(a){$.each(a.target.files,function(a,o){if(-1==["image/png","image/jpeg"].indexOf(o.type))return alert("Supported file types: png / jpeg"),!1;var e=new FileReader;e.onload=function(a){var e=a.target.result,t=new Image;t.onload=function(){object={};var a=(new Date).valueOf();object.filename=o.name+"_"+a+".svg",object.data='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns:mapsvg="http://mapsvg.com" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+this.width+'" height="'+this.height+'"> <image id="mapsvg-image-background" class="mapsvg-image-background" xlink:href="'+e+'"  x="0" y="0" height="'+this.height+'" width="'+this.width+'"></image></svg>',i.push(object),$("#image_file_uploader_form").submit()},t.src=e},e.readAsDataURL(o)})}),$("#image_file_uploader_form").on("submit",function(a){var t=$(this).find(".btn");t._button("loading"),$.each(i,function(a,e){var o=e.filename.replace(/\s/g,"_");$.ajax({url:ajaxurl,type:"POST",data:{action:"mapsvg_upload",filename:o,data:e.data}}).done(function(a,e,t){window.location.href="?page=mapsvg-config&map_id=new&package=uploads&path="+o+"&noheader=true"}).always(function(){t._button("reset")})}),i=[],a.preventDefault()}),$("#new-google-map").on("click",function(a){if(!_data.options.mapsvg_google_api_key)return $("#myModal").modal().show(),!1}),$("#download_gmap").on("click",function(){_data.options.mapsvg_google_api_key?_this.showGoogleMapDownloader():$("#myModal").modal().show()}),$("#save-api-key").on("click",function(){var e=$("#mapsvg-google-api-key").val(),a=$("#mapsvg-google-geocoding-api-key").val();e&&e.length&&$.post(ajaxurl,{action:"mapsvg_save_google_api_key",maps_api_key:e,geocoding_api_key:a}).done(function(a){(a=JSON.parse(a)).ok?($("#myModal").modal("hide"),_data.options.mapsvg_google_api_key=e):alert("Error")})}),$("#mapsvg-table-maps").on("click","a.mapsvg-delete",methods.mapDelete).on("click","a.mapsvg-copy",methods.mapCopy)}),_this},showGoogleMapDownloader:function(){if(_this.googleMapsFullscreenWrapper||(_this.googleMapsFullscreenWrapper=$("#mapsvg-google-map-fullscreen-wrap"),_this.googleMapsFullscreenWrapper.on("click","#mapsvg-gm-download",function(a){a.preventDefault();$(this),window;html2canvas($("#mapsvg-google-map-fullscreen > div > div.gm-style > div:nth-child(1)")[0],{useCORS:!0,onrendered:function(a){var e=a.toDataURL("image/png"),t=_this.gm.getBounds().toJSON();t=[t.west,t.north,t.east,t.south],$.post(ajaxurl,{action:"mapsvg_download_svg",png:e,bounds:t,width:a.width,height:a.height}).done(function(a){location.href=a})}})}).on("click","#mapsvg-gm-close",function(){_this.googleMapsFullscreenWrapper.hide(),$("body").css("overflow","auto")})),_this.googleMapsFullscreenWrapper.show(),$("body").css("overflow","hidden"),_this.gmloaded)_this.loadgm();else{var a=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("formatted_address"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:ajaxurl+"?action=mapsvg_geocoding&address=%QUERY%",wildcard:"%QUERY%",transform:function(a){return a.error_message&&alert(a.error_message),a.results},rateLimitWait:500}}),e=_this.googleMapsFullscreenWrapper.find("#mapsvg-gm-address-search");e.typeahead(null,{name:"mapsvg-addresses",display:"formatted_address",source:a,minLength:2});e.on("typeahead:select",function(a,e){var t=e.geometry.bounds?e.geometry.bounds:e.geometry.viewport,o=new google.maps.LatLngBounds(t.southwest,t.northeast);_this.gm.fitBounds(o)}),_this.gmapikey=_data.options.mapsvg_google_api_key,window.gm_authFailure=function(){MapSVG.GoogleMapBadApiKey?MapSVG.GoogleMapBadApiKey():alert("Google Maps API key is incorrect.")},_data.googleMapsScript=document.createElement("script"),_data.googleMapsScript.onload=function(){_this.loadgm()},_data.googleMapsScript.src="https://maps.googleapis.com/maps/api/js?key="+_this.gmapikey+"&language=en",document.head.appendChild(_data.googleMapsScript),_this.gmloaded=!0}},loadgm:function(){_this.gm=new google.maps.Map($("#mapsvg-google-map-fullscreen")[0],{zoom:2,center:new google.maps.LatLng(-34.397,150.644),mapTypeId:"roadmap",fullscreenControl:!1,mapTypeControl:!0,scaleControl:!0,scrollwheel:!0,streetViewControl:!1,zoomControl:!0})}},_this=methods,$.fn.mapsvgadmin=function(a){return methods[a]?methods[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"==typeof a?methods.init.apply(this,arguments):a?void $.error("Method "+method+" does not exist on mapSvg plugin"):methods}}(jQuery);
!function($,window){var MapSVGAdminController=function(t,e,a,i){this.name=this.name||"controller",this.container="object"==typeof t?t:$("#"+t),this.admin=e,this.mapsvg=a,this.templates={},this.templatesURL=this.templatesURL||MapSVG.urls.templates,this.scrollable=void 0===this.scrollable||this.scrollable,this.controllers={},this.activeController=null,this.events=i||{},this._init()};MapSVGAdminController.prototype.nameCamel=function(){return this.name.split("-").map(function(t,e){return 0===e?t:t.charAt(0).toUpperCase()+t.slice(1)}).join("")},MapSVGAdminController.prototype.viewLoaded=function(){this.activeController&&this.activeController.viewDidAppear(),this.events.onload&&this.events.onload.call(this)},MapSVGAdminController.prototype.viewUnloaded=function(){this.events.unload&&this.events.unload.call(this)},MapSVGAdminController.prototype._viewLoaded=function(){this.loaded=!0,this.view.find(".mapsvg-select2").mselect2({minimumResultsForSearch:20}),this.scrollable&&this.updateScroll(),this.view.find(".mapsvg-onoff").bootstrapToggle({onstyle:"default",offstyle:"default"})},MapSVGAdminController.prototype.viewDidAppear=function(){var t=this;t.controllers&&t.activeController&&t.activeController.viewDidAppear(),this.scrollable&&t.updateScroll()},MapSVGAdminController.prototype.viewDidDisappear=function(){if(this.controllers)for(var t in this.controllers)this.controllers&&this.controllers[t]&&this.controllers[t].viewDidDisappear()},MapSVGAdminController.prototype.updateScroll=function(){if(this.contentWrap&&this.scrollable){var t=this.disableHorizontalScroll?{contentWidth:"0px"}:{};this.contentWrap.data("jsp")||this.contentWrap.jScrollPane(t);var e=this.contentWrap.data("jsp");e.reinitialise(),setTimeout(function(){e.reinitialise()},500)}},MapSVGAdminController.prototype._init=function(){var i=this;i.templatesLoaded?i.render():$.get(i.templatesURL+this.name+".hbs?"+Math.random(),function(t){$(t).each(function(t,e){var a=$(e).data("name");a&&(i.templates[a]=Handlebars.compile($(e).html()),$(e).data("partial")&&Handlebars.registerPartial(i.nameCamel()+MapSVG.ucfirst(a)+"Partial",$(e).html()))}),i.templatesLoaded=!0,i.render()}).fail(function(t){404==t.status&&alert('Can\'t load "*.hbs" template files. If you have IIS server you need to add .hbs extension to server config file. More info: \nhttps://stackoverflow.com/questions/21545302/asp-net-mvc5-how-to-load-hbs-file')})},MapSVGAdminController.prototype.render=function(){this.view&&this.view.empty().remove(),this.view=$("<div />").attr("id","mapsvg-admin-controller-"+this.name).addClass("mapsvg-view"),this.contentWrap=$("<div />").attr("id","mapsvg-admin-content-"+this.name).addClass("mapsvg-view-wrap"),this.contentView=$("<div />").addClass("mapsvg-view-content"),this.scrollable&&(this.contentWrap.addClass("nano"),this.contentView.addClass("nano-content")),this.contentWrap.append(this.contentView),this.templates.toolbar&&(this.toolbarView=$("<div />").attr("id","mapsvg-admin-toolbar-"+this.name).addClass("mapsvg-view-toolbar"),this.view.append(this.toolbarView)),this.view.append(this.contentWrap),this.container.append(this.view),this.container.data("controller",this),this.redraw(),this.setEventHandlersCommon(),this.setEventHandlers(),this._viewLoaded(),this.viewLoaded()},MapSVGAdminController.prototype.redraw=function(){this.templateData=this.getTemplateData(),this.contentView.html(this.templates.main(this.templateData)),this.templates.toolbar&&this.toolbarView.html(this.templates.toolbar(this.templateData)),this.scrollable&&this.updateScroll()},MapSVGAdminController.prototype.setMainTemplate=function(t){t="image"==t?"image":"path",this.templates.main=this.templates[t]},MapSVGAdminController.prototype.getTemplateData=function(){return this.mapsvg.getOptions(!0,null,this.admin.getData().optionsDelta)},MapSVGAdminController.prototype.setEventHandlersCommon=function(){var i=this;new MapSVG.ResizeSensor(this.view[0],function(){i.scrollable&&i.updateScroll()}),i.view.on("click","a.mapsvg-toggle-visibility",function(){var t=$(this).data("toggle-visibility");$(t).toggle(),$(t).is(":visible")?$(this).text("Hide"):$(this).text("Read more")}),i.view.on("change paste",'[data-live="change"]',function(t){i.formToObjectUpdate(t)}).on("keyup paste",'[data-live="keyup"]',function(t){i.formToObjectUpdate(t)}).on("select",'[data-live="select"]',function(t){i.formToObjectUpdate(t)}).on("click",'[data-live="click"]',function(t){i.formToObjectUpdate(t)}).on("keypress","form.safarifix input",function(t){13!=t.which&&13!=t.keyCode||t.preventDefault()}).on("click","input.input-switch",function(){$(this).is(":checked")&&($(this).closest(".controls").find(".radio").next().attr("disabled","disabled"),$(this).parent().next().removeAttr("disabled"))}).on("change",".mapsvg-toggle-visibility",function(){$(this).closest(".btn-group");var t=!$(this).is(":checkbox")||MapSVG.parseBoolean($(this).prop("checked")),e=$(this).data("toggle-visibility"),a=$(this).data("toggle-visibility-reverse");e&&(t?$(e).show():$(e).hide()),a&&(t?$(a).hide():$(a).show()),i.scrollable&&i.updateScroll()}).on("click","button.mapsvg-toggle-visibility",function(t){t.preventDefault();var e=$(this).data("toggle-visibility");$(e).toggle(),i.scrollable&&i.updateScroll()}).on("click",".disabled",function(t){return t.preventDefault(),!1}).on("click",".btn-group-checkbox a",function(){var t=$(this),e=t.attr("data-toggle");setTimeout(function(){t.hasClass("active")?t.closest(".btn-group-checkbox").find("input.input-toggle-"+e).val("true"):t.closest(".btn-group-checkbox").find("input.input-toggle-"+e).val("")},200)}).on("click",".mapsvg-template-link",function(){var t=$(this).data("template");i.admin.getData().controllers.templates?($('#mapsvg-tabs-menu a[href="#tab_templates"]').tab("show"),$("#tab_templates").find("select").val(t).trigger("change")):($('#mapsvg-tabs-menu a[href="#tab_templates"]').tab("show"),setTimeout(function(){$("#tab_templates").find("select").val(t).trigger("change")},500))}).on("click",".mapsvg-tab-link",function(t){t.preventDefault(),$('#mapsvg-tabs-menu a[href="'+$(this).attr("href")+'"]').tab("show")})},MapSVGAdminController.prototype.setEventHandlers=function(){},MapSVGAdminController.prototype.show=function(){this.view.show()},MapSVGAdminController.prototype.hide=function(){this.view.hide()},MapSVGAdminController.prototype.destroy=function(){if(this.viewUnloaded(),this.view.empty().remove(),this.controllers)for(var t in this.controllers)this.controllers[t]&&this.controllers[t].view&&this.controllers[t].destroy()},MapSVGAdminController.prototype.objectUpdater=function(t){return this.admin.mapSvgUpdate(t)},MapSVGAdminController.prototype.formToObjectUpdate=function(t){var e=$(t.target);e.is(":radio")&&(e=e.closest(".form-group").find(":radio:checked"));parseInt($(e).data("delay"));e.closest(".form-group").removeClass("has-error");var a=this.validateInput(e);if(!(a instanceof TypeError))return this.formToObjectUpdater(a);e.closest(".form-group").addClass("has-error")},MapSVGAdminController.prototype.formToObjectUpdater=function(t){var e=this;for(var a in t)var i=a;e.admin.getData().optionsMode[e.admin.getData().mode].hasOwnProperty(i)?$.extend(!0,e.admin.getData().optionsDelta,t):e.mapsvg.update(t)},MapSVGAdminController.prototype.mapSvgUpdateFinal=function(t){var e=this,a=e.validateInput(t);if(a instanceof TypeError)t.closest(".form-group").addClass("has-error");else{for(var i in a)var o=i;e.admin.getData().optionsMode[e.admin.getData().mode].hasOwnProperty(o)?$.extend(!0,e.admin.getData().optionsDelta,a):e.mapsvg.update(a)}},MapSVGAdminController.prototype.validateInput=function(jQueryElem){var val;val=jQueryElem.is(":checkbox")?!!jQueryElem.is(":checked")&&(!jQueryElem.attr("value")||"on"==jQueryElem.attr("value")||jQueryElem.attr("value")):jQueryElem.val();var validate=jQueryElem.data("validate");if(validate&&""!=val)if("function"==validate){if(val=""!=val?msvg.functionFromString(val):null,val instanceof TypeError||val instanceof SyntaxError)return val}else if("link"==validate){if(!MapSVG.isValidURL(val))return new TypeError('MapSVG error: wrong URL format. URL must start with "http://"')}else if("number"==validate){if(!$.isNumeric(val))return new TypeError("MapSVG error: value must be a number")}else if("object"==validate&&("["==data.substr(0,1)||"{"==data.substr(0,1)))try{var tmp;eval("tmp = "+val);var val=tmp}catch(t){return new TypeError("MapSVG error: wrong object format for "+jQueryElem.attr("name"))}return jQueryElem.inputToObject(val)},window.MapSVGAdminController=MapSVGAdminController}(jQuery,window);
!function(e,t){var a=function(e,t,a){this.name="actions",MapSVGAdminController.call(this,e,t,a)};t.MapSVGAdminActionsController=a,MapSVG.extend(a,t.MapSVGAdminController),a.prototype.viewLoaded=function(){this.updateDirSource()},a.prototype.setEventHandlers=function(){var e=this;this.mapsvg.regionsDatabase.on("schemaChange",function(){e.render()}),this.mapsvg.database.on("schemaChange",function(){e.render()})},a.prototype.updateDirSource=function(e){e=e||this.mapsvg.getData().options.menu.source,this.view.find("#mapsvg-dir-object").html("database"==e?"Database object":"Region object"),this.view.find("#mapsvg-dir-source").html("database"==e?"Database":"Regions"),"database"==e?this.view.find("#mapsvg-dir-link").attr("href","#").data("template","detailsView").html("DB Object details view template"):this.view.find("#mapsvg-dir-link").attr("href","#").data("template","detailsViewRegion").html("Region details view template")},a.prototype.getTemplateData=function(){var e=MapSVGAdminController.prototype.getTemplateData.call(this);e.databaseFields=this.mapsvg.database.getSchema().map(function(e){if("text"==e.type||"textarea"==e.type||"post"==e.type)return"post"==e.type?"Object.post.url":"Object."+e.name}),e.regionFields=this.mapsvg.regionsDatabase.getSchema().map(function(e){if("text"==e.type||"textarea"==e.type||"post"==e.type)return"Region."+e.name}),e.zoomLevels=[];for(var t=1;t<21;)e.zoomLevels.push(t++);return console.log(e.zoomLevels),e}}(jQuery,window);
!function(r,e){var o=function(e,o,s){this.name="colors",MapSVGAdminController.call(this,e,o,s)};e.MapSVGAdminColorsController=o,MapSVG.extend(o,e.MapSVGAdminController),o.prototype.setEventHandlers=function(){var s=this,e=s.mapsvg.getData().options.colors.selected,o=s.mapsvg.getData().options.colors.hover;r("#mapsvg-controls-hover-brightness").ionRangeSlider({type:"single",grid:!0,min:-100,max:100,from:r.isNumeric(o)?o:0}),r("#mapsvg-controls-selected-brightness").ionRangeSlider({type:"single",grid:!0,min:-100,max:100,from:r.isNumeric(e)?e:0}),r(".mapsvg-color-brightness").on("change",":radio",function(){var e=r(this).closest(".mapsvg-color-brightness :radio:checked").val(),o=r(this).closest(".form-group");"color"==e?(o.find(".cpicker").show(),o.find(".irs").hide()):(o.find(".cpicker").hide(),o.find(".irs").show())}),r.isNumeric(e)?(r("#mapsvg-colors-selected :radio").eq(0).prop("checked",!1).parent().removeClass("active"),r("#mapsvg-colors-selected :radio").eq(1).prop("checked",!0).parent().addClass("active"),r("#mapsvg-colors-selected .cpicker").hide(),r("#mapsvg-colors-selected .irs").show()):(r("#mapsvg-colors-selected :radio").eq(0).prop("checked",!0).parent().addClass("active"),r("#mapsvg-colors-selected :radio").eq(1).prop("checked",!1).parent().removeClass("active"),r("#mapsvg-colors-selected .cpicker").show().find("input").val(e),r("#mapsvg-colors-selected .irs").hide()),r.isNumeric(o)?(r("#mapsvg-colors-hover :radio").eq(0).prop("checked",!1).parent().removeClass("active"),r("#mapsvg-colors-hover :radio").eq(1).prop("checked",!0).parent().addClass("active"),r("#mapsvg-colors-hover .cpicker").hide(),r("#mapsvg-colors-hover .irs").show()):(r("#mapsvg-colors-hover :radio").eq(0).prop("checked",!0).parent().addClass("active"),r("#mapsvg-colors-hover :radio").eq(1).prop("checked",!1).parent().removeClass("active"),r("#mapsvg-colors-hover .cpicker").show().find("input").val(o),r("#mapsvg-colors-hover .irs").hide()),r("#mapsvg-controls-gauge").on("change",":radio",function(){var e=MapSVG.parseBoolean(r("#mapsvg-controls-gauge :radio:checked").val());r("#table-regions").removeClass("mapsvg-gauge-on"),e&&r("#table-regions").addClass("mapsvg-gauge-on"),e?r("#mapsvg-gauge-options").show():r("#mapsvg-gauge-options").hide(),s.admin.updateScroll()}),s.view.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){var o=r(this).find("input");""==o.val()&&r(this).find("i").css({"background-color":""}),s.formToObjectUpdate({target:o[0]})})}}(jQuery,window);
!function(s,e){var t=function(e,t,s){this.name="css",this.disableHorizontalScroll=!0,MapSVGAdminController.call(this,e,t,s)};e.MapSVGAdminCssController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.viewLoaded=function(){var t=this;this.editors={},this.textarea=this.view.find("#mapsvg-css-editor"),this.textarea.val(t.mapsvg.getData().options.css),this.editors.css=CodeMirror.fromTextArea(this.textarea[0],{mode:"css",matchBrackets:!0,lineNumbers:!0}),this.editors.css.on("change",function(){t.mapsvg.setCss(t.editors.css.getValue())}),s(e).on("resize.codemirror.css",function(){t.resizeEditor()}),t.resizeEditor(),t.exampleCode=null,t.cssCodeLoaded=!1,this.view.on("click","#mapsvg-css-menu a",function(e){e.preventDefault(),s(this).tab("show"),"#mapsvg-css-default"==s(this).attr("href")?t.cssCodeLoaded?t.highlighDefaultCss():s.get(t.mapsvg.getCssUrl(),function(e){s("#mapsvg-css-default-editor").val(e),t.highlighDefaultCss(),t.cssCodeLoaded=!0}):t.exampleCode&&t.exampleCode.toTextArea()}).on("shown.bs.tab",function(e){t.resizeEditor()})},t.prototype.resizeEditor=function(){this.view.find(".CodeMirror")[0].CodeMirror.setSize(null,this.contentWrap.height()),this.view.find(".CodeMirror").height(this.contentWrap.height())},t.prototype.highlighDefaultCss=function(){this.exampleCode=CodeMirror.fromTextArea(s("#mapsvg-css-default-editor")[0],{mode:"css",lineNumbers:!0,matchBrackets:!0,readOnly:!0}),this.resizeEditor()},t.prototype.init=function(){}}(jQuery,window);
!function(i,t){var a=function(t,a,e){this.name="database",this.scrollable=!1,this.isParent=!0,this.database=e.getDatabaseService(),MapSVGAdminController.call(this,t,a,e)};t.MapSVGAdminDatabaseController=a,MapSVG.extend(a,t.MapSVGAdminController),a.prototype.viewLoaded=function(){var t=this;this.controllers.list=new MapSVGAdminDatabaseListController("mapsvg-data-list",t.admin,t.mapsvg),this.controllers.structure=new MapSVGAdminDatabaseStructureController("mapsvg-data-structure",t.admin,t.mapsvg),this.controllers.settings=new MapSVGAdminDatabaseSettingsController("mapsvg-data-settings",t.admin,t.mapsvg),this.controllers.csv=new MapSVGAdminDatabaseCsvController("mapsvg-data-csv",t.admin,t.mapsvg),this.controllers.csv.toolbarView=this.toolbarView,this.controllers.list.toolbarView=this.toolbarView,this.controllers.structure.toolbarView=this.toolbarView,this.controllers.settings.toolbarView=this.toolbarView,t.activeController=this.controllers.list,MapSVGAdminController.prototype.viewLoaded.call(this)},a.prototype.viewDidAppear=function(){MapSVGAdminController.prototype.viewDidAppear.call(this);var t=this;t.activeController&&t.activeController instanceof MapSVGAdminDatabaseStructureController&&(t.admin.rememberPanelsState(),t.admin.togglePanel("left",!1))},a.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this),this.admin.restorePanelsState()},a.prototype.setEventHandlers=function(){var s=this;s.database.on("dataLoaded",function(){s.setFilters()}),this.view.on("click",".mapsvg-filter-delete",function(){var t=i(this).data("filter");delete s.mapsvg.database.query.filters[t],"search"===t&&i("#mapsvg-data-search").val(""),s.mapsvg.loadDataObjects(),s.setFilters(),s.controllers.list.redrawDataList()}),i("#mapsvg-data-menu a").click(function(t){t.preventDefault(),i(this).tab("show")}).on("shown.bs.tab",function(t){var a=i(i(this).attr("href")).data("controller");(s.activeController=a).viewDidAppear();var e=i(t.relatedTarget).attr("href");if(e){var r=i(e).attr("data-controller");s.controllers[r].viewDidDisappear()}"#mapsvg-data-list"==i(this).attr("href")?s.toolbarView.find(".mapsvg-toolbar-buttons").show():s.toolbarView.find(".mapsvg-toolbar-buttons").hide(),"#mapsvg-data-structure"==i(this).attr("href")?(s.admin.rememberPanelsState(),s.admin.togglePanel("left",!1)):s.admin.restorePanelsState(),"#mapsvg-data-list"==i(this).attr("href")&&i(".mapsvg-toolbar-buttons").show()})},a.prototype.setFilters=function(t){var a=this;t=this.toolbarView.find(".mapsvg-toolbar-filters").empty();if(a.mapsvg.database.query.filters&&0<Object.keys(a.mapsvg.database.query.filters).length)for(var e in a.mapsvg.database.query.filters)t.append('<div class="mapsvg-filter-tag">'+e+": "+a.mapsvg.database.query.filters[e]+' <span class="mapsvg-filter-delete" data-filter="'+e+'">×</span></div>');var r=document.getElementById("mapsvg-admin-controller-database");r.style.display="none",r.offsetHeight,r.style.display="flex"}}(jQuery,window);
!function(o,e){var t=function(e,t,r){this.name="database-csv",this.database=r.getDatabaseService(),MapSVGAdminController.call(this,e,t,r)};e.MapSVGAdminDatabaseCsvController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.setEventHandlers=function(){var r=this;this.view.find("#mapsvg-btn-csv-upload").on("click",function(){o(this);o("#mapsvg-csv-file")[0].files[0]?Papa.parse(o("#mapsvg-csv-file")[0].files[0],{header:!0,skipEmptyLines:!0,complete:function(e){if(0===e.errors.length)r.import(e.data);else{var t="Errors: \n";t+=e.errors.map(function(e){return e.message+(void 0!==e.row?" (row: "+e.row+")":"")}).slice(0,5).join("\n"),5<e.errors.length&&(t+="\n...and "+(e.errors.length-5)+" more. "),alert(t)}}}):o.growl.error({title:"",message:"Please choose a file"})})},t.prototype.import=function(e){var t=o("#mapsvg-btn-csv-upload");t._button("loading");this.database.import(e).done(function(e){o.growl.notice({title:"",message:"File uploaded"})}).always(function(){t._button("reset")}).fail(function(){o.growl.error({title:"",message:"Server error"})})}}(jQuery,window);
!function(r,a){var t=function(a,t,e){var i=this;this.name="database-list",this.database=e.getDatabaseService(),this.database.on("schemaChange",function(){i.redrawDataList()}),i.database.on("dataLoaded",function(){i.redrawDataList()}),MapSVGAdminController.call(this,a,t,e)};a.MapSVGAdminDatabaseListController=t,MapSVG.extend(t,a.MapSVGAdminController),t.prototype.viewLoaded=function(){this.redrawDataList(),this.btnAdd=r("#mapsvg-btn-data-add")},t.prototype.viewDidAppear=function(){MapSVGAdminController.prototype.viewDidAppear.call(this),this.databaseTimestamp<this.database.lastChangeTime&&this.redrawDataList()},t.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this),this.closeFormHandler()},t.prototype.setEventHandlers=function(){var t,o=this;r("#mapsvg-data-search").on("keyup",function(){t&&clearTimeout(t);var a=this;t=setTimeout(function(){o.mapsvg.database.getAll({filters:{search:r(a).val()}}),o.redrawDataList()},300)}),r("#mapsvg-data-search-cols").on("click","li a",function(a){a.preventDefault();var t=r(this).text();r(this).closest(".input-group").find(".mapsvg-serch-field").text(t),o.searchField=t}),this.toolbarView.on("click",".mapsvg-data-cols a",function(a){a.preventDefault(),r(this).closest("li").toggleClass("active");var t=o.database.getSchema(),e=r(this).data("field");for(var i in t)e==t[i].name&&(t[i].visible=!t[i].visible);o.database.saveSchema(t)}),r("#mapsvg-btn-data-add").on("click",function(a){a.preventDefault(),o.editDataObject()}),this.view.on("click",".mapsvg-data-row",function(a){r(this).hasClass("active")||o.editDataObject(r(this).data("id"))}).on("click",".mapsvg-data-delete",function(a){a.preventDefault(),a.stopPropagation();var t=r(this).closest("tr");o.deleteDataRow(t)}).on("click",".mapsvg-data-copy",function(a){a.preventDefault(),a.stopPropagation(),o.copyDataObject(r(this).closest("tr").data("id"))})},t.prototype.getTemplateData=function(){return{fields:this.getDataFieldsForTemplate(!0),data:this.database.getLoaded()}},t.prototype.getDataFieldsForTemplate=function(t){var e=[{name:"id",visible:!0,type:"id"}],a=this.database.getSchema();for(var i in a&&a.forEach(function(a){return t?a.visible?e.push(a):void 0:e.push(a)}),e)"region"==e[i].type&&(e[i].options=[],e[i].optionsDict={},this.mapsvg.getData().regions.forEach(function(a){e[i].options.push({id:a.id,title:a.title}),e[i].optionsDict[a.id]=a.title?a.title:a.id}));return e},t.prototype.redrawDataList=function(){var a=this;a.redraw(),this.contentWrap.find(".jspPane").css({top:0});var t=a.database.getColumns();t.length<2&&(r("#mapsvg-data-list-table").hide(),r("#mapsvg-setup-database-msg").show());var e=a.toolbarView.find(".mapsvg-data-cols");e.empty(),t.forEach(function(a){e.append(r('<li class="'+(a.visible?"active":"")+'"><a href="#" data-field="'+a.name+'">'+a.name+"</a></li>"))});var i=this.mapsvg.getPagination(function(){a.redrawDataList()});this.view.find(".mapsvg-pagination-container").html(i)},t.prototype.addDataRow=function(a){var t=this,e={fields:t.database.getColumns({visible:!0}),params:a};for(var i in e.fields)"region"==e.fields[i].type&&(e.fields[i].options=[],e.fields[i].optionsDict={},t.mapsvg.getData().regions.forEach(function(a){e.fields[i].options.push({id:a.id,title:a.title}),e.fields[i].optionsDict[a.id]=a.title?a.title:a.id}));var o=r(t.templates.item(e));return this.view.find("#mapsvg-data-list-table tbody").prepend(o),o},t.prototype.updateDataRow=function(a,t){var e=this,i={fields:e.database.getColumns({visible:!0}),params:a};for(var o in i.fields)"region"==i.fields[o].type&&(i.fields[o].options=[],i.fields[o].optionsDict={},e.mapsvg.getData().regions.forEach(function(a){i.fields[o].options.push({id:a.id,title:a.title}),i.fields[o].optionsDict[a.id]=a.title?a.title:a.id}));var s=r(e.templates.item(i));(t=t||r("#mapsvg-data-"+a.id)).replaceWith(s),s.addClass("mapsvg-row-updated"),setTimeout(function(){s.removeClass("mapsvg-row-updated")},2600)},t.prototype.deleteDataRow=function(a){var t=a.data("id"),e=this.database.getLoadedObject(t);e.location&&e.location.marker&&e.location.marker.delete(),this.database.delete(t),a.fadeOut(300,function(){a.remove()})},t.prototype.editDataObject=function(a,t,e){var i=this;a=a||{},newRecord="string"!=typeof a&&"number"!=typeof a||(a=i.database.getLoadedObject(a),!1),e=!0===e||!newRecord,i.btnAdd.addClass("disabled"),i.tableDataActiveRow&&i.tableDataActiveRow.removeClass("mapsvg-row-selected"),a&&a.id&&(newRecord=!1,i.updateScroll(),i.tableDataActiveRow=r("#mapsvg-data-"+a.id),i.tableDataActiveRow.addClass("mapsvg-row-selected"),t&&i.contentWrap.data("jsp").scrollToElement(i.tableDataActiveRow,!0,!1)),i.admin.mediaUploader||(i.admin.mediaUploader=wp.media.frames.file_frame=wp.media({title:"Choose images",button:{text:"Choose images"},multiple:!0})),i.formBuilder&&(i.formBuilder.destroy(),i.formBuilder=null,i.formBuilderRow&&i.formBuilderRow.remove()),i.formContainer&&i.formContainer.empty().remove(),i.formContainer=r('<div class="mapsvg-modal-edit"></div>'),this.view.append(i.formContainer);a.marker&&a.marker.id&&a.marker.id;i.formBuilder=new MapSVG.FormBuilder({container:i.formContainer,schema:i.database.getSchema(),editMode:!1,mapsvg:i.mapsvg,mediaUploader:i.admin.mediaUploader,data:a,admin:i.admin,closeOnSave:e,events:{save:function(a){newRecord?(i.formBuilder.marker&&(i.unsavedMarker=i.formBuilder.marker),i.saveDataObject(a).done(function(){})):i.updateDataObject(a).done(function(){}),e?this.close():(i.formBuilder.redraw(),i.mapsvg.hideMarkersExceptOne())},close:function(){i.closeFormHandler()},init:function(a){var t=a.location&&a.location.marker?a.location.marker.id:null;i.mapsvg.hideMarkersExceptOne(t)}}})},t.prototype.copyDataObject=function(a){var t={};if(r.extend(t,this.database.getLoadedObject(a)),t.id=null,t.location&&t.location instanceof MapSVG.Location){var e=t.location.toJSON();t.location=new MapSVG.Location(e),new MapSVG.Marker({location:t.location,mapsvg:this.mapsvg,object:t})}this.editDataObject(t,!1,!0)},t.prototype.saveDataObject=function(a){var t=this,e=this.addDataRow(a);return this.database.create(a).done(function(a){t.updateDataRow(a,e),a.location&&t.unsavedMarker&&a.location.marker.setObject(a)}).fail(function(){r.growl.error({title:"Server error",message:"Can't create object"}),e.remove()})},t.prototype.updateDataObject=function(a){if(a.location&&a.location.marker){var t=this.mapsvg.getMarker(a.location.marker.id);t.setId("marker_"+a.id),t.setObject(a)}return this.closeFormHandler(),this.updateDataRow(a),this.database.update(a).fail(function(){r.growl.error({title:"Server error",message:"Can't update object"})})},t.prototype.closeFormHandler=function(){var a=this;a.btnAdd.removeClass("disabled"),a.mapsvg.showMarkers(),a.formBuilder&&(a.formBuilder.destroy(),a.formBuilder=null,a.formContainer.empty().remove(),a.tableDataActiveRow&&a.tableDataActiveRow.removeClass("mapsvg-row-selected"),a.tableDataActiveRow&&!a.tableDataActiveRow.hasClass("mapsvg-row-updated")&&a.tableDataActiveRow.addClass("mapsvg-row-closed"),setTimeout(function(){a.tableDataActiveRow&&!a.tableDataActiveRow.hasClass("mapsvg-row-updated")&&a.tableDataActiveRow.removeClass("mapsvg-row-closed")},1600),r("a.browser").remove(),"editMarkers"==a.admin.getData().mode&&a.admin.setPreviousMode()),this.updateScroll()}}(jQuery,window);
!function(c,e,a){a.DatabaseService=function(e,t){var r=this;this.mapsvg=t,this.map_id=e.map_id,this.table=e.table,this.perpage=parseInt(e.perpage)||0,this.sortBy=e.sortBy||null,this.sortDir=e.sortDir||null,this.type=e.type||"mysql",this.loaded=!1,"local"==this.type&&(this.dbObject=e.dbObject),this.server="mysql"==this.type?new a.ServerMySQL({map_id:this.map_id,table:this.table,perpage:this.perpage,mapsvg:this.mapsvg}):new a.ServerLocal({storage:this.dbObject}),this.lastChangeTime=Date.now(),this.cols=[],this.schemaDict={},this.index={},this.page=1,this.query=new a.DatabaseQuery,this.events={create:[],update:[],change:[],schemaChange:[],dataLoaded:[]},this.schema=new a.DatabaseSchema(e,t),this.schema.on("change",function(){r.getAll(),r.trigger("schemaChange")})},a.DatabaseService.setQuery=function(e){},a.DatabaseService.prototype.setPerpage=function(e){this.server.perpage=e},a.DatabaseService.prototype.lastChangeTime=function(){return this.lastChangeTime},a.DatabaseService.prototype.onFirstPage=function(){return 1===this.query.page},a.DatabaseService.prototype.onLastPage=function(){return!1===this.server.hasMoreRecords},a.DatabaseService.prototype.import=function(e){var t=this,r=t.getSchemaFieldByType("location"),a="en";return r&&r.language&&(a=r.language),e=this.formatCSV(e),this.server.import(e,a).done(function(){t.getAll()})},a.DatabaseService.prototype.create=function(e){var t=this;return this.server.create(e).done(function(){t.trigger("create",e),t.trigger("change",e)})},a.DatabaseService.prototype.update=function(e){var t=this;return this.server.update(e).done(function(){t.trigger("update",e),t.trigger("change",e)})},a.DatabaseService.prototype.delete=function(e){var t=this;return this.server.delete(e).done(function(){t.trigger("delete",e),t.trigger("change",e)})},a.DatabaseService.prototype.clear=function(e){var t=this;return this.server.clear().done(function(){t.getAll(),t.trigger("delete"),t.trigger("change")})},a.DatabaseService.prototype.getLoadedObject=function(e){return this.server.getLoadedObject(e)},a.DatabaseService.prototype.getAll=function(e){var t=this;"object"==typeof e&&Object.keys(e).length&&!e.page&&(t.query.page=1),t.query.set(e),this.page=e&&e.page?parseInt(e.page):this.page;var r={search:t.query.search,searchField:t.query.searchField,searchFallback:t.query.searchFallback,filters:t.query.filters,filterout:t.query.filterout,page:this.page,sortBy:this.sortBy,sortDir:this.sortDir,perpage:void 0!==t.query.perpage?parseInt(t.query.perpage):this.perpage};return this.schema.loaded()||(r.with_schema=!0),this.server.get(r).done(function(e){!t.schema.loaded()&&e.schema&&t.schema.set(e.schema),t.loaded=!0,t.trigger("dataLoaded")})},a.DatabaseService.prototype.getLoaded=function(){return this.server.rows},a.DatabaseService.prototype.formatData=function(e){return e},a.DatabaseService.prototype.formatCSV=function(o){var h=this;return o.forEach(function(e,t){var r={};for(var a in e){if(void 0!==(s=h.schema.getField(a)))switch(s.type){case"region":r[a]=e[a].split(",").map(function(e){return e.trim()}).filter(function(e){return void 0!==h.mapsvg.getRegion(e)}).map(function(e){return{id:e,title:h.mapsvg.getRegion(e).title}});break;case"location":if(e[a].match(/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/g)){var i=e[a].split(",").map(function(e){return parseFloat(e)});2==i.length&&-90<i[0]&&i[0]<90&&-180<i[1]&&i[1]<180?r[a]={lat:i[0],lng:i[1]}:r[a]=""}else e[a]&&(r[a]={address:e[a]});"object"==typeof r[a]&&(r[a].img=h.mapsvg.getData().options.defaultMarkerImage);break;case"select":var s;if((s=h.schema.getField(a)).multiselect){var n=h.schema.getField(a).options.map(function(e){return e.label});r[a]=e[a].split(",").map(function(e){return e.trim()}).filter(function(e){return-1!==n.indexOf(e)}).map(function(t){return h.schema.getField(a).options.filter(function(e){return e.label==t})[0]})}else r[a]=e[a];break;case"radio":case"text":case"textarea":case"status":default:r[a]=e[a]}}o[t]=r}),o},a.DatabaseService.prototype.on=function(e,t){this.lastChangeTime=Date.now(),this.events[e]||(this.events[e]=[]),this.events[e].push(t)},a.DatabaseService.prototype.trigger=function(e,t){this.events[e]&&this.events[e].length&&this.events[e].forEach(function(e){e&&e(t)})},a.DatabaseService.prototype.onSchemaChange=function(e){this.onSchemaChangeCallbacks.push(e)},a.DatabaseService.prototype.getSchema=function(e){return this.schema.get(e)},a.DatabaseService.prototype.getSchemaField=function(e){return this.schema.getField(e)},a.DatabaseService.prototype.getSchemaFieldByType=function(e){return this.schema.getFieldByType(e)},a.DatabaseService.prototype.setSchema=function(e){return this.schema.set(e)},a.DatabaseService.prototype.loadSchema=function(e){return this.schema.load(e)},a.DatabaseService.prototype.saveSchema=function(e){return this.schema.save(e)},a.DatabaseService.prototype.getColumns=function(e){return this.schema.getColumns(e)},a.DatabaseSchema=function(e,t){this.mapsvg=t,this.map_id=e.map_id,this.table=e.table,this.lastChangeTime=Date.now(),this.cols=[],this.schema=[],this.schemaDict={},this.events={create:[],update:[],change:[]}},a.DatabaseSchema.prototype.loaded=function(e){return 0!==this.schema.length},a.DatabaseSchema.prototype.set=function(e){var t=this;e&&(t.schema=e.map(function(e){return e.visible=a.parseBoolean(e.visible),t.schemaDict[e.name]=e}))},a.DatabaseSchema.prototype.save=function(e){var t=this;for(var r in this.set(e),this.schema)this.schema[r]||this.schema.splice(r,1);return e=(e=(e=(e=(e=JSON.stringify(e)).replace(/select/g,"!mapsvg-encoded-slct")).replace(/table/g,"!mapsvg-encoded-tbl")).replace(/database/g,"!mapsvg-encoded-db")).replace(/varchar/g,"!mapsvg-encoded-vc"),c.post(ajaxurl,{action:"mapsvg_save_schema",schema:e,map_id:this.map_id,table:this.table}).done(function(){t.trigger("change")})},a.DatabaseSchema.prototype.get=function(e){return this.schema},a.DatabaseSchema.prototype.getField=function(e){return"id"==e?{name:"id",visible:!0,type:"id"}:this.schemaDict[e]},a.DatabaseSchema.prototype.getFieldByType=function(t){var r=null;return this.schema.forEach(function(e){e.type===t&&(r=e)}),r},a.DatabaseSchema.prototype.load=function(e){var t=this;return c.get(ajaxurl,{action:"mapsvg_get_schema",map_id:this.map_id,table:this.table},null,"json").done(function(e){t.set(e)})},a.DatabaseSchema.prototype.getColumns=function(r){r=r||{};var e=this.get().slice(0);"regions"==this.table&&e.unshift({name:"title",visible:!0,type:"title"});var t=!0;e.forEach(function(e){"id"==e.name&&(t=!1)}),t&&e.unshift({name:"id",visible:!0,type:"id"});var a,i=0!==Object.keys(r).length,s=[];i?e.forEach(function(e){for(var t in a=!0,r)a=e[t]==r[t];a&&s.push(e)}):s=e;return s},a.DatabaseSchema.prototype.on=function(e,t){this.lastChangeTime=Date.now(),this.events[e]||(this.events={}),this.events[e].push(t)},a.DatabaseSchema.prototype.trigger=function(e){this.events[e]&&this.events[e].length&&this.events[e].forEach(function(e){e&&e()})},a.Server=function(e){this.index={},this.hasMoreRecords=!1},a.Server.prototype.reindex=function(){var r=this;this.index={},this.rows&&this.rows.forEach(function(e,t){r.index[e.id]=t})},a.Server.prototype.getLoadedObject=function(e){var t=this.index[e];return null!=t?this.rows[t]:{}},a.ServerMySQL=function(e){this.map_id=e.map_id,this.table=e.table,this.perpage=e.perpage,this.rows=[],a.Server.call(this)},a.extend(a.ServerMySQL,a.Server),a.ServerMySQL.prototype.formatData=function(e){var t={};for(var r in e)!e[r]||"object"!=typeof e[r]&&"function"!=typeof e[r]||null==e[r].getOptions?null===e[r]||void 0===e[r]||"object"==typeof e[r]&&0===e[r].length?t[r]="":t[r]=e[r]:t[r]=e[r].getOptions();return JSON.stringify(t)},a.ServerMySQL.prototype.actionData=function(e,t){return t.action=e,t.map_id=this.map_id,t.table=this.table,t.perpage=this.perpage,t},a.ServerMySQL.prototype.get=function(t){var r=this;return void 0!==t.perpage&&(this.perpage=t.perpage),c.getJSON(ajaxurl,this.actionData("mapsvg_data_get_all",t)).done(function(e){e.objects&&e.objects.length?(r.hasMoreRecords=!!(t.perpage&&e.objects.length>t.perpage),r.hasMoreRecords&&e.objects.pop(),r.rows=e.objects):(r.hasMoreRecords=!1,r.rows=[]),r.reindex()})},a.ServerMySQL.prototype.import=function(e,r){var t,a,i,s=this,n=[];for(t=0,a=e.length;t<a;t+=50)i=e.slice(t,t+50),n.push(i);if(0<n.length){var o=0,h=n[0][0]&&n[0][0].location?1e3:0;defer=c.Deferred(),defer.promise(),s.completeChunks=0,n.forEach(function(t){setTimeout(function(){var e=JSON.stringify(t);c.post(ajaxurl,s.actionData("mapsvg_data_import",{data:e,language:r}),null,"json").done(function(e){s.completeChunk(n,defer)})},o+=h)})}return defer},a.ServerMySQL.prototype.completeChunk=function(e,t){this.completeChunks++,this.completeChunks===e.length&&t.resolve()},a.ServerMySQL.prototype.create=function(t){var r=this;this.rows.push(t);var e=c.extend({},t);e.post&&delete e.post;var a=this.formatData(e);return c.post(ajaxurl,this.actionData("mapsvg_data_create",{data:a}),null,"json").done(function(e){}).then(function(e){return t.id=e.id,r.reindex(),t})},a.ServerMySQL.prototype.update=function(e){var t=this.index[e.id];if(void 0!==t){c.extend(this.rows[t],e);var r=c.extend({},e);r.post&&delete r.post;var a=this.formatData(r);return c.post(ajaxurl,this.actionData("mapsvg_data_update",{data:a}),null,"json")}},a.ServerMySQL.prototype.delete=function(e){var t=this,r=this.index[e];return this.rows.splice(r,1),c.post(ajaxurl,this.actionData("mapsvg_data_delete",{data:{id:e}}),null,"json").done(function(){t.reindex()})},a.ServerMySQL.prototype.clear=function(e){var t=this;return c.post(ajaxurl,this.actionData("mapsvg_data_clear",{data:{}}),null,"json").done(function(){this.rows=[],t.reindex()})},a.ServerLocal=function(e){this.rows=e.storage,a.Server.call(this,e),this.reindex()},a.extend(a.ServerLocal,a.Server),a.ServerLocal.prototype.get=function(e){defer=c.Deferred();var t=this.rows;return defer.promise(),defer.resolve(t),defer},a.ServerLocal.prototype.create=function(e){if(e.id){var t=this.index[e.id];if(this.rows[t])return this.update(e)}else e.id=this.getId();return this.rows.push(e),this.reindex(),defer=c.Deferred(),defer.promise(),defer.resolve(e),defer},a.ServerLocal.prototype.update=function(e){defer=c.Deferred();var t=this.index[e.id];return this.rows[t]?c.extend(!0,this.rows[t],e):this.rows.push(e),this.reindex(),defer.promise(),defer.resolve(e),defer},a.ServerLocal.prototype.delete=function(e){var t=this.index[e];return this.rows.splice(t,1),this.reindex(),defer=c.Deferred(),defer.promise(),defer.resolve(this.storage),defer},a.ServerLocal.prototype.getId=function(){var e=this.rows.map(function(e){return e.id});return e.length||(e=[0]),e?Math.max.apply(null,e)+1:1},a.Filters=function(e){this.schema={},this.schemaDict={},this.fields={},this.events={change:[]},this.setSchema(e)},a.Filters.prototype.set=function(e){this.fields=e},a.Filters.prototype.save=function(e){this.fields=e},a.Filters.prototype.reset=function(e){this.fields={}},a.Filters.prototype.get=function(e){return this.fields},a.Filters.prototype.getField=function(e){return this.schemaDict[e]},a.Filters.prototype.getSchema=function(e){return this.schema},a.Filters.prototype.setSchema=function(e){var r=this;return e&&e.forEach(function(e){var t=e.parameterName.split(".")[1];r.schemaDict[t]=e}),this.schema=e,this.schema},a.Filters.prototype.on=function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},a.Filters.prototype.trigger=function(e){var t=this;this.events[e]&&this.events[e].length&&this.events[e].forEach(function(e){e&&e(t)})},a.DatabaseQuery=function(e){e=e||{},this.sortBy=e.sortBy||null,this.sortDir=e.sortDir||null,this.page=e.page||1,this.perpage=e.perpage,this.search=e.search,this.searchField=e.searchField,this.filters=e.filters||{},this.filterout=e.filterout||{}},a.DatabaseQuery.prototype.set=function(e){for(var t in e)"filters"==t?this.setFilters(e[t]):this[t]=e[t]},a.DatabaseQuery.prototype.setFilters=function(e){for(var t in e)null===e[t]||""===e[t]||void 0===e[t]?this.filters[t]&&delete this.filters[t]:this.filters[t]=e[t]},a.DatabaseQuery.prototype.setFilterOut=function(e){for(var t in e)this.filterout[t]=e[t]},a.DatabaseQuery.prototype.resetFilters=function(e){this.filters={}},a.DatabaseQuery.prototype.setFilterField=function(e,t){this.filters[e]=t}}(jQuery,window,MapSVG);
!function(a,e){var t=function(e,a,t){this.name="database-settings",this.database=t.getDatabaseService(),MapSVGAdminController.call(this,e,a,t)};e.MapSVGAdminDatabaseSettingsController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.setEventHandlers=function(){var e=this;this.view.on("click","#mapsvg-clear-database-btn",function(){confirm("Are you sure you want to clear the database?")&&e.database.clear().done(function(){a.growl.notice({title:"",message:"Database is cleared"})}).fail(function(){a.growl.error({title:"Server error",message:"Can't clear the database"})})})}}(jQuery,window);
!function(a,e){var t=function(e,t,a,i){this.name="database-structure",this.scrollable=!1,this.database=a.getDatabaseService(),MapSVGAdminController.call(this,e,t,a)};e.MapSVGAdminDatabaseStructureController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.viewDidAppear=function(){var t=this;MapSVGAdminController.prototype.viewDidAppear.call(this),t.formBuilder=new MapSVG.FormBuilder({schema:t.database.getSchema(),editMode:!0,mapsvg:t.mapsvg,admin:t.admin,container:this.contentView,events:{saveSchema:function(e){t.database.schema.get();t.mapsvg.id?t.database.saveSchema(e).done(function(){a.growl.notice({title:"",message:"Settings saved",duration:700}),t.admin.save()}).fail(function(){a.growl.error({title:"Server error",message:"Can't save settings"})}):t.admin.save().done(function(){t.database.map_id=t.mapsvg.id,t.database.saveSchema(e).done(function(){}).fail(function(){a.growl.error({title:"Error",message:"Can't save settings"})})}).fail(function(){a.growl.error({title:"Error",message:"Can't save settings"})})},load:function(){setTimeout(function(){a("#mapsvg-btn-database-structure").tooltip("show").tooltip("hide")},200)}}})},t.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this),this.formBuilder&&this.formBuilder.destroy()},t.prototype.setEventHandlers=function(){}}(jQuery,window);
!function(n,o){var t=function(n,o,t){this.name="details",MapSVGAdminController.call(this,n,o,t)};o.MapSVGAdminDetailsController=t,MapSVG.extend(t,o.MapSVGAdminController),t.prototype.viewLoaded=function(){}}(jQuery,window);
!function(r,t){var e=function(t,e,i){this.name="directory",MapSVGAdminController.call(this,t,e,i)};t.MapSVGAdminDirectoryController=e,MapSVG.extend(e,t.MapSVGAdminController),e.prototype.setEventHandlers=function(){var t=this.view.find("#mapsvg-directory-filterout");t.on("change","#mapsvg-directory-filter-control",function(){r(this).val()?t.find("#mapsvg-filterout-extra").show():t.find("#mapsvg-filterout-extra").hide()})},e.prototype.updateDirSource=function(t){t=t||this.mapsvg.getData().options.menu.source,this.view.find("#mapsvg-dir-object-2").html("database"==t?"Database object":"Region object")},e.prototype.setDatabase=function(t){this.database="regions"==t?this.mapsvg.regionsDatabase:this.mapsvg.database},e.prototype.viewLoaded=function(){var e=this;e.setDatabase(this.mapsvg.getData().options.menu.source),e.updateDirSource(),e.setSortFields(),this.mapsvg.database.on("schemaChange",function(){e.setSortFields()}),this.mapsvg.regionsDatabase.on("schemaChange",function(){e.setSortFields()}),this.view.find("#mapsvg-directory-data-source").on("change",":radio",function(){var t=r(this).val();e.setDatabase(t),e.setSortFields(),e.updateDirSource(t),e.admin.getData().controllers.actions&&e.admin.getData().controllers.actions.updateDirSource(t)}),this.view.find("#mapsvg-directory-sort-control").mselect2(),this.view.find("#mapsvg-directory-filter-control").mselect2(),this.view.find("#mapsvg-directory-filter-cond-control").mselect2(),this.view.on("change","#mapsvg-details-width :radio",function(){"full"!=r(this).closest(".form-group").find(":radio:checked").val()?r("#mapsvg-details-width-custom").prop("disabled",!1).trigger("keyup"):r("#mapsvg-details-width-custom").prop("disabled",!0)}),e.updateSortList()},e.prototype.updateSortList=function(){},MapSVGAdminController.prototype.getTemplateData=function(){var t=this.mapsvg.getOptions(!0,null,this.admin.getData().optionsDelta);return t.fulltext_min_word_len=mapsvg_fulltext_min_word,t},e.prototype.setSortFields=function(){var e=this,i="regions"==r("#mapsvg-directory-data-source :radio:checked").val()?["id","title"]:["id"],t=this.database.getSchema();t&&t.forEach(function(t){i.push(t.name)});var o=i.map(function(t){return"<option "+(e.templateData.menu.sortBy==t?"selected":"")+">"+t+"</option>"}),a=i.map(function(t){return"<option "+(e.templateData.menu.filterout.field==t?"selected":"")+">"+t+"</option>"});a.unshift('<option value="">(no filter)</option>'),this.view.find("#mapsvg-directory-sort-control").html(o).trigger("change"),this.view.find("#mapsvg-directory-filter-control").html(a).trigger("change"),this.view.find("#mapsvg-directory-filter-cond-control").val(e.templateData.menu.filterout.cond)}}(jQuery,window);
!function(i,t){var e=function(t,e,i){this.name="draw-region",this.svgObject=null,MapSVGAdminController.call(this,t,e,i)};t.MapSVGAdminDrawRegionController=e,MapSVG.extend(e,t.MapSVGAdminController),e.prototype.setEventHandlers=function(){var a=this;this.svgObject&&"image"==this.svgObject.tagName?a.view.on("change",".mapsvg-draw-image-upload",function(t){i.each(t.target.files,function(t,e){var i=new FileReader;i.onload=function(t){var e=t.target.result,i=new Image;i.onload=function(){a.drawer.updateShape(a.svgObject,{"xlink:href":e}),a.drawer.updateShape(a.svgObject,{width:this.width}),a.drawer.updateShape(a.svgObject,{height:this.height}),a.view.find('[name="width"]').val(this.width),a.view.find('[name="height"]').val(this.height)},i.src=e},i.readAsDataURL(e)})}):a.view.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(t){var e=i(this).find("input");""==e.val()&&i(this).find("i").css({"background-color":""}),a.formToObjectUpdate({target:e[0]})})},e.prototype.setObject=function(t){this.svgObject=t,this.setMainTemplate(t.tagName),this.loaded&&(this.redraw(),this.setEventHandlers())},e.prototype.destroy=function(){this.view.find(".cpicker").colorpicker("destroy"),MapSVGAdminController.prototype.destroy.call(this)},e.prototype.viewUnloaded=function(){MapSVGAdminController.prototype.viewUnloaded.call(this)},e.prototype.setDrawer=function(t){this.drawer=t},e.prototype.formToObjectUpdater=function(t){this.drawer.updateShape(this.svgObject,t)},e.prototype.getTemplateData=function(){var t=this,e={};if(t.svgObject)switch(e={id:i(t.svgObject).data("new-id")?i(t.svgObject).data("new-id"):t.svgObject.getAttribute("id"),title:t.svgObject.getAttribute("title")},this.svgObject.tagName){case"path":case"ellipse":case"circle":case"rect":case"polygon":e.style={fill:i(t.svgObject).css("fill")||t.svgObject.getAttribute("fill"),stroke:i(t.svgObject).css("stroke")||t.svgObject.getAttribute("stroke"),"stroke-width":i(t.svgObject).data("stroke-width")};break;case"image":e.x=t.svgObject.getAttribute("x"),e.y=t.svgObject.getAttribute("y"),e.width=t.svgObject.getAttribute("width"),e.height=t.svgObject.getAttribute("height")}return e}}(jQuery,window);
!function(d,a){var t=function(t,e,a){this.name="draw",this.map=a.getData().$map,this.svg=a.getData().$svg,this.changed=!1,this.scrollable=!1,this.changes=[],this.mode="edit",this.snap=!0,this.lastClickTime=0,this.lastChangeTime=0,this.hints=[],this.hintHover="",MapSVGAdminController.call(this,t,e,a),this.filepath=this.mapsvg.getData().options.source,-1==this.filepath.indexOf(mapsvg_paths.uploads)&&(this.readOnly=!0)};a.MapSVGAdminDrawController=t,MapSVG.extend(t,a.MapSVGAdminController),t.prototype.viewDidAppear=function(){var t=this;MapSVGAdminController.prototype.viewDidAppear.call(this),this.defScroll=t.mapsvg.getData().options.scroll.on,t.mapsvg.setScroll({on:!1}),d("#mapsvg-save").hide(),d("#mapsvg-save-svg").show(),t.readOnly&&t.setReadOnly(!0),this.loaded&&t.setEventHandlers(),this.reindex()},t.prototype.reindex=function(t){for(var e=this.svg[0].getElementsByTagName("*"),a=0;a<e.length;a++)d(e[a]).data("index",a),this.lastindex=a},t.prototype.viewUnloaded=function(t){var e=this;MapSVGAdminController.prototype.viewUnloaded.call(e),d("#mapsvg-save-svg").hide(),d("#mapsvg-save").show(),e.mapsvg.eventsRestore(),e.mapsvg.setScroll({on:this.defScroll}),this.resaveMsg&&this.resaveMsg.remove(),e.editingShape&&(e.editingShape.unclosed?e.removeShape(e.editingShape.obj):e.editingShapeUnset()),e.controllers.region&&(e.admin.unloadController(e.controllers.region),e.controllers.region=null),d(a).off(".draw.mapsvg"),this.map.off(".draw.mapsvg"),this.view.off(),d("body").off("click.mapsvg-save-svg"),d("body").off("click.mapsvg-save-svg-copy"),e.hide(),e.viewDidDisappear()},t.prototype.viewLoaded=function(t){MapSVGAdminController.prototype.viewLoaded.call(this),this.hint()},t.prototype.setReadOnly=function(t){if(t){this.readOnly=!0,d("#mapsvg-admin").addClass("mapsvg-read-only"),d("#mapsvg-save-svg").prop("disabled",!0),this.resaveMsg=d('<div id="mapsvg-save-svg-copy-message" class="well"></div>'),this.resaveMsg.html('This SVG file is "read-only". Save a copy of the file into WP Uploads folder?<br /><br />');var e=d('<button class="btn btn-sm btn-primary" id="mapsvg-save-svg-copy" data-loading-text="Saving...">Save</button>');this.resaveMsg.append(e),d("#mapsvg-admin").append(this.resaveMsg)}else this.readOnly&&(this.readOnly=!1,d("#mapsvg-admin").removeClass("mapsvg-read-only"),d("#mapsvg-save-svg").prop("disabled",!1),this.resaveMsg.remove())},t.prototype.clickToSVG=function(t){var e=this,a=MapSVG.mouseCoords(t),i=a.x-e.svg.offset().left,n=a.y-e.svg.offset().top;return e.mapsvg.convertPixelToSVG([i,n])},t.prototype.setEventHandlers=function(){var o=this;switch(d(a).off(".draw.mapsvg"),this.map.off(".draw.mapsvg"),this.view.off(),this.view.on("mouseenter","#mapsvg-draw-tools .btn",function(t){d(this).data("hint")&&(o.hintHover=d(this).data("hint"),o.hint())}).on("mouseleave","#mapsvg-draw-tools .btn",function(t){d(this).data("hint")&&(o.hintHover=null,o.hint())}),this.mode){case"draw":o.mapsvg.eventsPrevent("click"),o.mapsvg.eventsPrevent("mouseover"),o.mapsvg.eventsPrevent("mouseout");o.map.on("click.draw.mapsvg",function(t){var e=o.clickToSVG(t),a=(new Date).getTime();a-o.lastClickTime<300?o.closePath():o.editingShape?o.addPointToPath(o.editingShape.lastPoint):o.startPath(e),o.lastClickTime=a});break;case"edit":o.mapsvg.eventsPrevent("click"),o.mapsvg.eventsPrevent("mouseover"),o.mapsvg.eventsPrevent("mouseout"),d(a).on("keyup.draw.mapsvg",function(t){t.preventDefault(),"INPUT"!=t.target.tagName&&8==t.keyCode&&(o.editingPoint?o.removeEditingPoint():o.editingShape&&o.removeShape(o.editingShape.obj))}),o.mapsvg.getData().$map.on("mouseover.draw.mapsvg",".mapsvg-region",function(){}),o.mapsvg.getData().$map.on("mouseout.draw.mapsvg",".mapsvg-region",function(){}),o.mapsvg.getData().$map.on("mousedown.draw.mapsvg",function(t){if(t.originalEvent.preventDefault(),d(t.target).hasClass("mapsvg-path-point-new")){var e=o.addNewPoint(o.editingShape.newPoint.getAttribute("cx"),o.editingShape.newPoint.getAttribute("cy"),t);o.dragPointStart(t,e)}else if(d(t.target).hasClass("mapsvg-path-point"))o.dragPointStart(t);else{if(-1===["path","image","circle","polyline","polygon","ellipse","rect"].indexOf(t.target.tagName))return!1;o.editingShape&&o.editingShape.obj===this||o.editShape(t.target),o.editingPoint&&o.editingPointUnset(),-1!==["path","image","polygon","polyline","rect","ellipse","circle"].indexOf(t.target.tagName)&&(o.dragShapeStart(t),o.mapsvg.getData().$map.on("mousemove.2.draw.mapsvg",function(t){o.dragShapeMove(t)}),o.mapsvg.getData().$map.on("mouseup.2.draw.mapsvg",function(t){o.dragShapeEnd(t)}))}}),o.mapsvg.getData().$map.on("mouseup.draw.mapsvg",".mapsvg-image-background",function(t){t.originalEvent.preventDefault(),o.editingShape&&o.editingShape.obj===this||o.editShape(this)}),o.editingShape&&(d(a).off("keyup.esc.draw.mapsvg"),d(a).on("keyup.esc.draw.mapsvg",function(t){27==t.keyCode&&o.editingShape&&o.editingShapeUnset()}),"path"==o.editingShape.obj.tagName&&o.mapsvg.getData().$map.on("mousemove.draw.mapsvg",function(t){var e=o.mapsvg.convertMouseToSVG(t);e={x:e[0],y:e[1]};var i=o.getIntersectionWithEditingShape(e);if(i){var n=o.mapsvg.getScale();o.editingShape.points.forEach(function(t){var e=t.getAttribute("cx"),a=t.getAttribute("cy");Math.abs(i.x-e)<10/n&&Math.abs(i.y-a)<10/n&&(i=!1)})}o.editingShape.newPoint.style.display=i?(o.editingShape.newPoint.setAttribute("cx",i.x),o.editingShape.newPoint.setAttribute("cy",i.y),"block"):"none"}))}d("body").off("click.mapsvg-save-svg"),d("body").on("click.mapsvg-save-svg","#mapsvg-save-svg",function(){o.saveSvg()}),this.view.on("change","#mapsvg-draw-mode input",function(t){o.setMode(d(this).val())}),this.view.on("change","#mapsvg-draw-btn-magnet",function(){o.setSnap(d(this).prop("checked"))}),this.view.on("click","#mapsvg-draw-undo",function(){o.undo()}),o.readOnly&&d("body").on("click.mapsvg-save-copy","#mapsvg-save-svg-copy",function(){d(this)._button("loading"),d.post(ajaxurl,{action:"mapsvg_svg_copy",filepath:o.filepath}).done(function(t){(t=jQuery.parseJSON(t)).filepath?(o.filepath=t.filepath,o.mapsvg.update({source:o.filepath}),o.admin.save(!0),o.setReadOnly(!1)):t.error&&alert(t.error)}).always(function(){d("#mapsvg-save-svg-copy")._button("reset")})})},t.prototype.drawStart=function(t){},t.prototype.drawMove=function(t){},t.prototype.drawEnd=function(t){},t.prototype.dragPointStart=function(t,e){var a=this;a.isDragging=!0;e=void 0!==e?e:d(t.target).data("index");a.editingShape.pathData=a.editingShape.obj.getPathData({normalize:!0});var i=a.editingShape.pathData[e];a.editingPoint&&a.editingPointUnset();var n=a.editingShape.points[e];d(n).addClass("active"),a.editingPoint={pointOriginal:d.extend(!0,{},i),circle:n,index:e},a.dragStartMouseCoords=a.clickToSVG(t),a.editingShape.d=a.editingShape.obj.getAttribute("d"),a.loadSnapPoints(),a.mapsvg.getData().$map.on("mousemove.dragpoint.draw.mapsvg",function(t){a.dragPointMove(t)}),a.mapsvg.getData().$map.on("mouseup.dragpoint.draw.mapsvg",function(t){a.dragPointEnd(t,i)}),a.hint()},t.prototype.dragPointMove=function(t){var e=this,a=e.clickToSVG(t),i=a[0]-e.dragStartMouseCoords[0],n=a[1]-e.dragStartMouseCoords[1],o=d.extend(!0,{},e.editingPoint.pointOriginal);o.values[0]+=i,o.values[1]+=n,this.snap&&(o.values=e.doSnap(o.values)),e.editingPoint.circle.setAttribute("cx",o.values[0]),e.editingPoint.circle.setAttribute("cy",o.values[1]),e.editingShape.pathData[e.editingPoint.index]=o,e.editingShape.obj.setPathData(e.editingShape.pathData)},t.prototype.dragPointEnd=function(t){var e=this;this.mapsvg.getData().$map.off("mousemove.dragpoint.draw.mapsvg"),this.mapsvg.getData().$map.off("mouseup.dragpoint.draw.mapsvg"),this.isDragging=!1;var a=e.clickToSVG(t);a[0]!=e.dragStartMouseCoords[0]&&a[1]!=e.dragStartMouseCoords[1]&&e.addChange("update",e.editingShape.obj,{d:e.editingShape.obj.getAttribute("d")},{d:e.editingShape.d}),e.loadIntersectionPoints()},t.prototype.getDragShapeProperties=function(t){var e=this;switch(e.editingShape.obj.tagName){case"path":return{d:e.editingShape.obj.getAttribute("d")};case"ellipse":case"circle":return{cx:parseFloat(e.editingShape.obj.getAttribute("cx")),cy:parseFloat(e.editingShape.obj.getAttribute("cy"))};case"image":case"rect":return{x:parseFloat(e.editingShape.obj.getAttribute("x")),y:parseFloat(e.editingShape.obj.getAttribute("y"))};case"polygon":case"polyline":return{points:parseFloat(e.editingShape.obj.getAttribute("points"))}}},t.prototype.dragShapeStart=function(t){var e=this;this.isDragging=!0,e.dragXY=e.clickToSVG(t),e.dragStartMouseCoords=e.dragXY,e.editingShape.dragProperties=e.getDragShapeProperties()},t.prototype.dragShapeMove=function(t,e,a){var i=this,n=i.clickToSVG(t),o=n[0]-i.dragXY[0],s=n[1]-i.dragXY[1];switch(i.editingShape.obj.tagName){case"path":(r=i.editingShape.obj.getPathData({normalize:!0})).forEach(function(t,e){if(t.values&&t.values.length){for(var a in t.values)t.values[a]+=a%2?s:o;t.values[t.values.length-2],t.values[t.values.length-1];i.editingShape.points[e].setAttribute("cx",t.values[0]),i.editingShape.points[e].setAttribute("cy",t.values[1])}}),i.editingShape.obj.setPathData(r);break;case"ellipse":case"circle":var p=parseFloat(i.editingShape.obj.getAttribute("cx"))+o,d=parseFloat(i.editingShape.obj.getAttribute("cy"))+s;i.editingShape.obj.setAttribute("cx",p),i.editingShape.obj.setAttribute("cy",d);break;case"image":case"rect":p=parseFloat(i.editingShape.obj.getAttribute("x"))+o,d=parseFloat(i.editingShape.obj.getAttribute("y"))+s;i.editingShape.obj.setAttribute("x",p),i.editingShape.obj.setAttribute("y",d);break;case"polygon":case"polyline":var r=i.editingShape.obj.getAttribute("points").replace(/\s\s+/g," ").split(" ");for(var g in r){var h=r[g].split(",");h[0]=parseFloat(h[0])+o,h[1]=parseFloat(h[1])+s,r[g]=h.join(",")}i.editingShape.obj.setAttribute("points",r.join(" "))}i.dragXY=n},t.prototype.dragShapeEnd=function(t){var e=this;this.mapsvg.getData().$map.off("mousemove.2.draw.mapsvg"),this.mapsvg.getData().$map.off("mouseup.2.draw.mapsvg"),this.isDragging=!1;var a=e.clickToSVG(t);a[0]!=e.dragStartMouseCoords[0]&&a[1]!=e.dragStartMouseCoords[1]&&e.addChange("update",e.editingShape.obj,e.getDragShapeProperties(),e.editingShape.dragProperties),"path"==e.editingShape.obj.tagName&&e.loadIntersectionPoints()},t.prototype.editShape=function(t){var o=this;if(o.editingShapeUnset(),o.editingShape={obj:t},"polygon"==t.tagName||"polyline"==t.tagName){var e=document.createElementNS("http://www.w3.org/2000/svg","path");for(var a in t.attributes)["points"].includes(a.name)||e.setAttribute(a.name,a.value);e.setPathData(t.getPathData({normalized:!0})),o.removeShape(t);var i=t.parentNode;t=e,i.appendChild(t),o.addChange("create",t),o.reindex();d(o.changes[o.changes.length-1].data).data("index")}o.editingShape={obj:t};var n=t.getAttribute("class")||"";if(n&&-1!=n.indexOf("active")||t.setAttribute("class",n+" active"),o.controllers.region&&(o.admin.unloadController(o.controllers.region),o.controllers.region=null),o.controllers.region=o.admin.loadController("tab_draw_region","drawRegion"),o.controllers.region.events={onload:function(){this.setObject(t)}},o.controllers.region.setDrawer(o),"path"==t.tagName){e=t.getPathData({normalize:!0});o.editingShape.points=[],e.forEach(function(t,e){if(t.values&&t.values.length){var a=document.createElementNS(o.svg[0].namespaceURI,"circle"),i=t.values[t.values.length-2],n=t.values[t.values.length-1];a.setAttribute("cx",i),a.setAttribute("cy",n),a.setAttribute("r",5/o.mapsvg.getScale()),a.setAttribute("class","mapsvg-path-point"),d(a).css("stroke-width",1),d(a).data("stroke-width",1),d(a).data("index",e),o.svg[0].appendChild(a),o.editingShape.points.push(a)}});var s=document.createElementNS(o.svg[0].namespaceURI,"circle");s.setAttribute("cx",0),s.setAttribute("cy",0),s.setAttribute("r",5/o.mapsvg.getScale()),s.setAttribute("class","mapsvg-path-point mapsvg-path-point-new"),d(s).css("stroke-width",1),d(s).data("stroke-width",1),d(s).hide(),o.svg[0].appendChild(s),o.editingShape.newPoint=s,o.loadIntersectionPoints(),o.mapsvg.mapAdjustStrokes(),o.mapsvg.on("zoom",function(){o.adjustPointsSize()})}o.setEventHandlers(),this.hint()},t.prototype.adjustPointsSize=function(){var e=this;e.editingShape&&(e.editingShape.points&&e.editingShape.points.forEach(function(t){t.setAttribute("r",5/e.mapsvg.getScale()),d(t).css("stroke-width",1/e.mapsvg.getScale())}),e.editingShape.newPoint&&(e.editingShape.newPoint.setAttribute("r",5/e.mapsvg.getScale()),d(e.editingShape.newPoint).css("stroke-width",1/e.mapsvg.getScale())))},t.prototype.editingPointUnset=function(){d(this.editingPoint.circle).removeClass("active"),this.editingPoint=null,this.hint()},t.prototype.editingShapeUnset=function(){var e=this;e.editingShape&&e.editingShape.obj&&(e.mapsvg.off("zoom"),e.editingShape.points&&e.editingShape.points.forEach(function(t){e.svg[0].removeChild(t)}),e.editingShape.newPoint&&(d(e.editingShape.newPoint).remove(),e.editingShape.newPoint=null),e.editingShape.stroke&&e.svg[0].removeChild(e.editingShape.stroke),-1!=e.editingShape.obj.getAttribute("class").indexOf("active")&&e.editingShape.obj.setAttribute("class",e.editingShape.obj.getAttribute("class").replace("active",""))),e.map.off("mousemove.draw.mapsvg"),this.editingShape=null,e.editingPoint=null,this.hint()},t.prototype.setMode=function(t){this.mode=t,this.editingShapeUnset(),this.setEventHandlers(),this.hint()},t.prototype.hint=function(t){if(this.hintHover)d("#mapsvg-draw-status-line").html(this.hintHover);else switch(this.mode){case"draw":this.editingShape&&this.editingShape.obj?this.setHint("<code>Click</code> to add point. <code>Enter</code>: close path. <code>Double Click</code>: add point & close path. <code>Esc</code>: cancel. Hold <code>Spacebar</code> to scroll."):this.setHint("<code>Click</code> to start drawing. Hold <code>Spacebar</code> to scroll.");break;case"edit":if(this.editingShape&&this.editingShape.obj)if(this.editingPoint)this.setHint("<b>Point</b>: <code>Backspace</code>: delete point. Hold  <code>Spacebar</code> to scroll.");else{var e=this.editingShape.obj.tagName;t="<b>"+this.editingShape.obj.tagName+"</b>";t+=": <code>Drag</code> the object"+("path"==e?" or its points":"")+". <code>Backspace</code>: delete object. Hold  <code>Spacebar</code> to scroll.",this.setHint(t)}else this.setHint("<code>Click</code> on an object to edit it. Hold  <code>Spacebar</code> to scroll.")}},t.prototype.setHint=function(t){d("#mapsvg-draw-status-line").html(t)},t.prototype.setSnap=function(t){this.snap=t,this.snap&&this.loadSnapPoints()},t.prototype.startPath=function(t){var e=this;return e.editingShape={},e.editingShape.unclosed=!0,e.editingShape.obj=document.createElementNS(e.svg[0].namespaceURI,"path"),e.editingShape.obj.setAttribute("d","M"+t[0]+" "+t[1]+" "),e.editingShape.d=e.editingShape.obj.getAttribute("d"),e.editingShape.lastPoint=t,e.editingShape.obj.setAttribute("class","active mapsvg-custom-shape mapsvg-region"),d(e.editingShape.obj).css({fill:"rgba(255,0,0,0.4)",stroke:"rgba(255,100,100,0.4)"}),e.svg[0].appendChild(e.editingShape.obj),e.loadSnapPoints(),e.map.on("mousemove.draw.mapsvg",function(t){e.moveLastPathPoint(t)}),d(a).off("keyup.draw.mapsvg"),d(a).on("keyup.draw.mapsvg",function(t){13==t.keyCode?e.closePath():27==t.keyCode&&e.editingShape&&(e.editingShape.unclosed?(e.removeShape(e.editingShape.obj),e.map.off("mousemove.draw.mapsvg")):e.editingShapeUnset())}),this.hint(),e.editingShape},t.prototype.moveLastPathPoint=function(t){var e=this;e.editingShape.lastPoint=e.clickToSVG(t),this.snap&&(e.editingShape.lastPoint=e.doSnap(e.editingShape.lastPoint)),e.editingShape.obj.setAttribute("d",e.editingShape.d+"L"+e.editingShape.lastPoint[0]+" "+e.editingShape.lastPoint[1]+" ")},t.prototype.closePath=function(){var t=this;t.editingShape.obj.setAttribute("d",t.editingShape.d+"L"+t.editingShape.lastPoint[0]+" "+t.editingShape.lastPoint[1]+" "),t.editingShape.obj.setAttribute("d",t.editingShape.d+"z");var e=prompt("Enter Region ID");e?(t.editingShape.obj.setAttribute("id",e),t.addChange("create",t.editingShape.obj),d(t.editingShape.obj).data("index",++t.lastindex),t.editingShape=null):t.removeShape(t.editingShape.obj),this.hint(),t.map.off("mousemove.draw.mapsvg"),d(a).off("keyup.draw.mapsvg")},t.prototype.addPointToPath=function(t){var e=this;return e.editingShape.obj.setAttribute("d",e.editingShape.d+"L"+t[0]+" "+t[1]+" "),e.editingShape.d=e.editingShape.obj.getAttribute("d"),e.editingShape},t.prototype.updateShape=function(t,e,a){var i=this,n={},o="string"==typeof t?i.svg.find("#"+t)[0]:t;for(var s in e)if("style"==s&&"string"!=typeof e[s]){for(var p in n.style={},e[s])n.style[p]=d(o).css(p)||o.getAttribute(p),o.getAttribute(p)&&o.removeAttribute(p);"stroke-width"==p?(d(o).data("stroke-width",e[s][p]),i.mapsvg.mapAdjustStrokes()):d(o).css(e[s]),!a&&i.addChange("update",o,e,n)}else n[s]="id"==s?i.getObjectId(o):o.getAttribute(s),!a&&i.addChange("update",o,e,n),"id"==s?d(o).data("new-id",e[s]):o.setAttribute(s,e[s])},t.prototype.addChange=function(t,e,a,i){var n=this;switch(t){case"create":n.changes.push({action:"create",data:e});break;case"update":var o=n.changes[n.changes.length-1],s=Object.keys(a)[0],p=(new Date).getTime();p-n.lastChangeTime<500&&o&&"update"==o.action&&o.id==n.getObjectId(e)&&o.dataNew[s]?n.changes[n.changes.length-1].dataNew[s]=a[s]:n.changes.push({action:"update",data:e,idReal:e.id,id:n.getObjectId(e),dataOld:i,dataNew:a}),n.lastChangeTime=p;break;case"delete":n.changes.push({action:"delete",data:e})}n.changed=!0},t.prototype.addUpdateChange=function(t,e,a){},t.prototype.getObjectId=function(t){return d(t).data("new-id")?d(t).data("new-id"):d(t).data("id")?d(t).data("id"):t.id},t.prototype.saveSvg=function(){var a=this;d("#mapsvg-save-svg")._button("loading");d.get(a.filepath+"?v="+Math.random()).done(function(t){a.changes.length&&a.changes.forEach(function(t){switch(t.action){case"update":for(var e in t.dataNew)"id"==e&&t.data.setAttribute(e,t.dataNew[e])}}),a.editingShape&&(a.editingShape.unclosed?a.removeShape(a.editingShape.obj):a.editingShapeUnset()),a.controllers.region&&(a.admin.unloadController(a.controllers.region),a.controllers.region=null);var e=a.svg.clone(!0);e.css("transform",""),e.find("[data-deleted]").remove(),e.find("path, polygon, circle, ellipse, rect").each(function(t){d(this).data("stroke-width")&&d(this).css("stroke-width",d(this).data("stroke-width")),d(this).attr("class")&&(d(this).attr("class",d(this).attr("class").replace("active","")),d(this).attr("class",d(this).attr("class").replace("mapsvg-custom-shape","")),d(this).attr("class",d(this).attr("class").replace("mapsvg-region","")),d(this).attr("class",d(this).attr("class").replace("mapsvg-disabled","")))}),d.post(ajaxurl,{action:"mapsvg_save_svg",map_id:a.mapsvg.id,body:e[0].outerHTML.replace(/\sgeoViewBox/gi," mapsvg:geoViewBox"),filepath:a.filepath}).done(function(t){e=null,a.changed=!1,a.changes=[],a.mapsvg.getData().options.svgFileVersion++,a.mapsvg.reloadRegions(),a.mapsvg.regionsDatabase.getAll().done(function(){})}).fail(function(t){}).always(function(){d("#mapsvg-save-svg")._button("reset")})})},t.prototype.close=function(){},t.prototype.undo=function(){var t=this;if(!t.changes.length)return!1;var e=t.changes.pop();switch(e.action){case"create":t.editingShape&&t.editingShape.obj===e.data&&t.editingShapeUnset(),e.data.remove();break;case"delete":e.data.style.display="block",e.data.setAttribute("id",e.data.getAttribute("data-id")),e.data.setAttribute("data-id",""),e.data.removeAttribute("data-deleted");break;case"update":t.updateShape(e.idReal,e.dataOld,!0),!t.isReverting&&t.editingShape&&t.editingShape.obj.id==e.idReal&&t.editShape(t.editingShape.obj)}return!0},t.prototype.revert=function(){var t=!0;for(this.isReverting=!0;t;)t=this.undo()},t.prototype.removeEditingPoint=function(t){var e=this;e.editingShape.pathData.splice(e.editingPoint.index,1),2==e.editingShape.pathData.length?e.removeShape(e.editingShape.obj):("M"!=e.editingShape.pathData[0].type&&(e.editingShape.pathData[0].type="M"),e.editingShape.points.splice(e.editingPoint.index,1),e.editingShape.obj.setPathData(e.editingShape.pathData),d(e.editingPoint.circle).remove(),e.editingPoint=null,e.editingShape.points.forEach(function(t,e){d(t).data("index",e)})),this.hint()},t.prototype.removeShape=function(t){var e=this;if(t){var a=e.editingShape&&e.editingShape.obj==t;(!e.editingShape||a&&!e.editingShape.unclosed)&&e.addChange("delete",t),a&&(e.editingShape.obj.style.display="none",e.editingShape.obj.setAttribute("data-id",e.editingShape.obj.id),e.editingShape.obj.setAttribute("id",""),e.editingShape.obj.setAttribute("data-deleted","true"),e.editingShape.points&&e.editingShape.points.forEach(function(t){t.remove()}),e.editingShape.stroke&&d(e.editingShape.stroke).remove(),e.editingShape=null,e.controllers.region&&(e.admin.unloadController(e.controllers.region),e.controllers.region=null),e.setEventHandlers())}},t.prototype.doSnap=function(t){for(var e,a=this,i=!0,n=10/a.mapsvg.getScale(),o=a.snapPoints.length-1;i&&0<=o;)a.snapPoints[o]&&a.snapPoints[o].values&&null!=a.snapPoints[o].values[0]&&(e=a.snapPoints[o],Math.abs(t[0]-e.values[0])<n&&Math.abs(t[1]-e.values[1])<n&&(t[0]=e.values[0],t[1]=e.values[1],i=!1)),o--;return t},t.prototype.loadSnapPoints=function(){var a=this;this.snapPoints=[],a.svg.find("path, polygon, rect, circle, ellipse, polyline").not(":hidden").not(".mapsvg-path-point").each(function(t,e){a.editingShape&&e===a.editingShape.obj||"none"!=d(e).css("display")&&(a.snapPoints=a.snapPoints.concat(e.getPathData({normalize:!0})))})},t.prototype.loadIntersectionPoints=function(){var t=this;t.editingShape.pathLength=t.editingShape.obj.getTotalLength(),t.editingShape.pathPoints=[];for(var e=0;e<t.editingShape.pathLength;e++)t.editingShape.pathPoints.push(t.editingShape.obj.getPointAtLength(e))},t.prototype.getIntersectionWithEditingShape=function(t){for(var e=0;e<this.editingShape.pathPoints.length;e++)if(this.pointIntersect(t,this.editingShape.pathPoints[e]))return this.editingShape.pathPoints[e+1]},t.prototype.getPreviousPointIndex=function(t){for(var e=!0,a=0,i=1,n=1;e;){var o=this.editingShape.pathPoints[a];if(o.x==t.x&&o.y==t.y)e=!1;else{var s=this.editingShape.points[n];(s={x:s.getAttribute("cx"),y:s.getAttribute("cy")}).x==o.x&&s.y==o.y&&(i=n,n++)}a++}return i},t.prototype.pointIntersect=function(t,e){var a=5/this.mapsvg.getScale();return Math.abs(t.x-e.x)<a&&Math.abs(t.y-e.y)<a},t.prototype.addNewPoint=function(t,e){var a=this,i={x:parseFloat(t),y:parseFloat(e)},n=1;a.editingShape.pathData=a.editingShape.obj.getPathData({normalize:!0});for(var o=1;o<a.editingShape.pathData.length;o++){var s=o-1,p=o,d=a.editingShape.pathData[s],r=a.editingShape.pathData[p];d.values&&("Z"!=r.type&&"z"!=r.type||(r=a.editingShape.pathData[0]),d={x:d.values[0],y:d.values[1]},r={x:r.values[0],y:r.values[1]},0==a.distanceToLine(d,r,i)&&(n=o))}var g={type:"L",values:[t,e]};return a.editingShape.pathData.splice(n,0,g),a.editingShape.d=a.editingShape.obj.getAttribute("d"),a.editingShape.obj.setPathData(a.editingShape.pathData),a.addChange("update",a.editingShape.obj,{d:a.editingShape.obj.getAttribute("d")},{d:a.editingShape.d}),a.editShape(a.editingShape.obj),n},t.prototype.isOnLine=function(t,e,a){var i;return Math.abs((i=a.px,(e.y-t.y)/(e.x-t.x)*(i-t.x)+t.y-a.py))<.001},t.prototype.distanceToLine=function(t,e,a){var i=(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y);if(0==i)return!1;var n=((t.y-a.y)*(e.x-t.x)-(t.x-a.x)*(e.y-t.y))/i;return(Math.abs(n)*Math.sqrt(i)).toFixed(3)}}(jQuery,window);
!function(n,t){var e=function(t,e,r){this.name="filters",this.scrollable=!1,this.isParent=!0,MapSVGAdminController.call(this,t,e,r)};t.MapSVGAdminFiltersController=e,MapSVG.extend(e,t.MapSVGAdminController),e.prototype.viewLoaded=function(){var t=this;this.controllers.structure=new MapSVGAdminFiltersStructureController("mapsvg-filters-structure",t.admin,t.mapsvg),this.controllers.settings=new MapSVGAdminFiltersSettingsController("mapsvg-filters-settings",t.admin,t.mapsvg),t.activeController=this.controllers.settings,MapSVGAdminController.prototype.viewLoaded.call(this)},e.prototype.viewDidAppear=function(){var t=this;t.activeController&&t.activeController instanceof MapSVGAdminFiltersStructureController&&(t.admin.rememberPanelsState(),t.admin.togglePanel("left",!1))},e.prototype.viewDidDisappear=function(){this.admin.restorePanelsState()},e.prototype.setEventHandlers=function(){var i=this;n("#mapsvg-filters-menu a").click(function(t){t.preventDefault(),n(this).tab("show")}).on("shown.bs.tab",function(t){var e=n(n(this).attr("href")).data("controller");(i.activeController=e).viewDidAppear();var r=n(t.relatedTarget).attr("href");if(r){var a=n(r).attr("data-controller");i.controllers[a].viewDidDisappear()}"#mapsvg-filters-structure"==n(this).attr("href")?(i.admin.rememberPanelsState(),i.admin.togglePanel("left",!1)):i.admin.restorePanelsState(),"#mapsvg-filters-settings"==n(this).attr("href")&&n(".mapsvg-toolbar-buttons").show()})}}(jQuery,window);
!function(t,n){var e=function(t,n,e){this.name="filters-settings",MapSVGAdminController.call(this,t,n,e)};n.MapSVGAdminFiltersSettingsController=e,MapSVG.extend(e,n.MapSVGAdminController),e.prototype.viewLoaded=function(){},e.prototype.setEventHandlers=function(){}}(jQuery,window);
!function(i,e){var t=function(e,t,i,s){this.name="filters-structure",this.scrollable=!1,MapSVGAdminController.call(this,e,t,i),this.filtersSchema=this.mapsvg.filtersSchema};e.MapSVGAdminFiltersStructureController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.viewLoaded=function(){},t.prototype.viewDidAppear=function(){var t=this;t.formBuilder=new MapSVG.FormBuilder({schema:t.filtersSchema.getSchema(),editMode:!0,filtersMode:!0,mapsvg:t.mapsvg,admin:t.admin,container:this.contentView,template:"form-builder-filters",types:["select","distance","search"],events:{saveSchema:function(e){t.mapsvg.id?(t.filtersSchema.setSchema(e),i.growl.notice({title:"",message:"Settings saved",duration:700}),t.admin.save(),t.mapsvg.setFilters()):t.admin.save().done(function(){t.filtersSchema.setSchema(e),t.mapsvg.setFilters()})},load:function(){setTimeout(function(){i("#mapsvg-btn-filters-structure").tooltip("show").tooltip("hide")},200)}}})},t.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this),this.formBuilder&&this.formBuilder.destroy()},t.prototype.setEventHandlers=function(){}}(jQuery,window);
!function(o,t){var i=function(o,t,i){this.name="floors",this.scrollable=!1,this.isParent=!0,MapSVGAdminController.call(this,o,t,i)};t.MapSVGAdminFloorsController=i,MapSVG.extend(i,t.MapSVGAdminController),i.prototype.viewLoaded=function(){var o=this;this.controllers.list=new MapSVGAdminFloorsListController("mapsvg-floors-list",o.admin,o.mapsvg),this.controllers.list.toolbarView=this.toolbarView,o.activeController=this.controllers.list,MapSVGAdminController.prototype.viewLoaded.call(this)},i.prototype.viewDidAppear=function(){MapSVGAdminController.prototype.viewDidAppear.call(this)},i.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this)},i.prototype.setEventHandlers=function(){}}(jQuery,window);
!function(l,e){var t=function(e,t,a){this.name="floors-list",this.database=new MapSVG.DatabaseService({type:"local",dbObject:a.getData().options.floors},a),this.database.on("change",function(){}),this.database.setSchema([{name:"id",label:"ID",visible:!0,type:"id"},{name:"object_id",label:"Object ID",visible:!0,type:"select",optionsGrouped:!0,options:a.getGroupSelectOptions()},{name:"title",label:"Title",visible:!0,type:"text"},{name:"visible",label:"Visible",visible:!1,type:"checkbox"}]),MapSVGAdminController.call(this,e,t,a)};e.MapSVGAdminFloorsListController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.viewLoaded=function(){this.redrawDataList()},t.prototype.viewDidAppear=function(){MapSVGAdminController.prototype.viewDidAppear.call(this)},t.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this),this.closeFormHandler()},t.prototype.setEventHandlers=function(){var o=this;l("#mapsvg-btn-floor-add").on("click",function(e){e.preventDefault(),o.btnAdd=l(this),o.btnAdd.addClass("disabled"),o.editDataRow()}),this.view.on("click",".mapsvg-data-row",function(e){l(this).hasClass("active")||o.editDataRow(l(this))}).on("click",".mapsvg-floor-view-toggle",function(e){e.preventDefault(),e.stopPropagation(),l(this).toggleClass("active");var t=l(this).closest("tr").data("id"),a=o.database.getLoadedObject(t);a.visible=!l(this).hasClass("active"),a.visible?(l(this).find("i").toggleClass("fa-eye",!0),l(this).find("i").toggleClass("fa-eye-slash",!1)):(l(this).find("i").toggleClass("fa-eye",!1),l(this).find("i").toggleClass("fa-eye-slash",!0)),o.mapsvg.setGroups(),o.mapsvg.setFloorsControl()}).on("click",".mapsvg-floor-delete",function(e){e.preventDefault(),e.stopPropagation();var t=l(this).closest("tr");o.deleteDataRow(t)})},t.prototype.getTemplateData=function(){return{fields:this.getDataFieldsForTemplate(!0),data:this.database.getLoaded()}},t.prototype.getDataFieldsForTemplate=function(e){return[{name:"id",visible:!0,type:"id"},{name:"object_id",visible:!0,type:"select"},{name:"title",visible:!0,type:"text"}]},t.prototype.redrawDataList=function(){var e=this;e.redraw();var t=this.mapsvg.getPagination(function(){e.redrawDataList()});this.view.find(".mapsvg-pagination-container").html(t)},t.prototype.getObjectRow=function(e){return this.view.find("#mapsvg-floor-row-"+e.id)},t.prototype.addDataRow=function(e){var t={fields:this.database.getColumns({visible:!0}),params:e},a=l(this.templates.item(t));return this.view.find("#mapsvg-floors-list-table tbody").prepend(a),a},t.prototype.updateDataRow=function(e,t){var a={fields:this.database.getColumns({visible:!0}),params:e},o=l(this.templates.item(a));(t=t||l("#mapsvg-floor-row-"+e.id)).replaceWith(o),o.addClass("mapsvg-row-updated"),setTimeout(function(){o.removeClass("mapsvg-row-updated")},2600)},t.prototype.deleteDataRow=function(e){var t=e.data("id"),a=this.database.getLoadedObject(t);if(!a)return!1;a.marker&&this.mapsvg.markerDelete(a.marker),this.database.delete(t),e.fadeOut(300,function(){e.remove()})},t.prototype.editDataRow=function(e,t){var a=this,o=!e,i={};if(a.tableDataActiveRow&&a.tableDataActiveRow.removeClass("mapsvg-row-selected"),e){a.updateScroll(),t&&a.contentWrap.data("jsp").scrollToElement(e,!0,!1),a.tableDataActiveRow=e,a.tableDataActiveRow.addClass("mapsvg-row-selected");var s=a.tableDataActiveRow.data("id");i=a.database.getLoadedObject(s)}else i={visible:!0};var r=wp.media.frames.file_frame=wp.media({title:"Choose images",button:{text:"Choose images"},multiple:!0});a.formBuilder&&(a.formBuilder.destroy(),a.formBuilder=null,a.formBuilderRow&&a.formBuilderRow.remove(),l("#mapsvg-btn-floor-add").removeClass("disabled")),a.formContainer&&a.formContainer.empty().remove(),a.formContainer=l('<div class="mapsvg-modal-edit"></div>'),this.view.append(a.formContainer),a.formBuilder=new MapSVG.FormBuilder({container:a.formContainer,schema:a.database.getSchema(),editMode:!1,mapsvg:a.mapsvg,mediaUploader:r,data:i,admin:a.admin,events:{save:function(e){o?(a.saveDataObject(e),this.redraw()):(a.updateDataObject(e),this.close())},close:function(){a.closeFormHandler()}}})},t.prototype.saveDataObject=function(e){var t,a,o=this;if(e.id&&(t=this.getObjectRow(e)),t&&t.length||(a=!0,t=this.addDataRow(e)),a)this.database.create(e).done(function(e){a&&o.updateDataRow(e,t)}).fail(function(){l.growl.error({title:"Server error",message:"Can't save object"}),t.remove()});else{if(this.database.update(e).fail(function(){l.growl.error({title:"Server error",message:"Can't update object"})}),e.marker){var i=o.mapsvg.getMarker(e.marker.id);i.setId("marker_"+e.id),i.setObject(e)}this.closeFormHandler(),this.updateDataRow(e)}},t.prototype.updateDataObject=function(e){if(this.database.update(e).fail(function(){l.growl.error({title:"Server error",message:"Can't update object"})}),e.marker){var t=this.mapsvg.getMarker(e.marker.id);t.setId("marker_"+e.id),t.setObject(e)}this.closeFormHandler(),this.updateDataRow(e)},t.prototype.closeFormHandler=function(){var e=this;l("#mapsvg-btn-floor-add").removeClass("disabled"),e.mapsvg.showMarkers(),e.formBuilder&&(e.formBuilder.destroy(),e.formBuilder=null,e.formContainer.empty().remove(),e.tableDataActiveRow&&e.tableDataActiveRow.removeClass("mapsvg-row-selected"),e.tableDataActiveRow&&!e.tableDataActiveRow.hasClass("mapsvg-row-updated")&&e.tableDataActiveRow.addClass("mapsvg-row-closed"),setTimeout(function(){e.tableDataActiveRow&&!e.tableDataActiveRow.hasClass("mapsvg-row-updated")&&e.tableDataActiveRow.removeClass("mapsvg-row-closed")},1600),l("a.browser").remove()),this.updateScroll()}}(jQuery,window);
var scripts=document.getElementsByTagName("script"),myScript=scripts[scripts.length-1].src.split("/");myScript.pop();var pluginRootURL=myScript.join("/")+"/";!function(p,d,e){function i(e,t){e=e||{};var a=this;if(this.formBuilder=t,this.images=[],this.type=e.type,this.value=e.value,this.searchable=d.parseBoolean(e.searchable),this.databaseFields=this.formBuilder.mapsvg.database.getSchema().map(function(e){if("text"==e.type||"region"==e.type||"textarea"==e.type||"post"==e.type||"select"==e.type||"radio"==e.type||"checkbox"==e.type)return"post"==e.type?"Object.post.post_title":"Object."+e.name}),this.regionFields=this.formBuilder.mapsvg.regionsDatabase.getSchema().map(function(e){if("status"==e.type||"text"==e.type||"textarea"==e.type||"post"==e.type||"select"==e.type||"radio"==e.type||"checkbox"==e.type)return"post"==e.type?"Region.post.post_title":"Region."+e.name}),this.db_type="varchar(255)","region"==this.type)this.options=this.formBuilder.getRegionsList(),this.label="Regions",this.name="regions",this.db_type="text";else if("textarea"==this.type)this.autobr=e.autobr,this.html=e.html,this.db_type="text";else if("modal"==this.type)this.buttonText=e.buttonText;else if("location"==this.type)this.location=this.value,this.label=this.label||(void 0===e.label?"Location":e.label),this.name="location",this.db_type="text",this.languages=[{value:"sq",label:"Albanian"},{value:"ar",label:"Arabic"},{value:"eu",label:"Basque"},{value:"be",label:"Belarusian"},{value:"bg",label:"Bulgarian"},{value:"my",label:"Burmese"},{value:"bn",label:"Bengali"},{value:"ca",label:"Catalan"},{value:"zh-cn",label:"Chinese (simplified)"},{value:"zh-tw",label:"Chinese (traditional)"},{value:"hr",label:"Croatian"},{value:"cs",label:"Czech"},{value:"da",label:"Danish"},{value:"nl",label:"Dutch"},{value:"en",label:"English"},{value:"en-au",label:"English (australian)"},{value:"en-gb",label:"English (great Britain)"},{value:"fa",label:"Farsi"},{value:"fi",label:"Finnish"},{value:"fil",label:"Filipino"},{value:"fr",label:"French"},{value:"gl",label:"Galician"},{value:"de",label:"German"},{value:"el",label:"Greek"},{value:"gu",label:"Gujarati"},{value:"iw",label:"Hebrew"},{value:"hi",label:"Hindi"},{value:"hu",label:"Hungarian"},{value:"id",label:"Indonesian"},{value:"it",label:"Italian"},{value:"ja",label:"Japanese"},{value:"kn",label:"Kannada"},{value:"kk",label:"Kazakh"},{value:"ko",label:"Korean"},{value:"ky",label:"Kyrgyz"},{value:"lt",label:"Lithuanian"},{value:"lv",label:"Latvian"},{value:"mk",label:"Macedonian"},{value:"ml",label:"Malayalam"},{value:"mr",label:"Marathi"},{value:"no",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"pt",label:"Portuguese"},{value:"pt-br",label:"Portuguese (brazil)"},{value:"pt-pt",label:"Portuguese (portugal)"},{value:"pa",label:"Punjabi"},{value:"ro",label:"Romanian"},{value:"ru",label:"Russian"},{value:"sr",label:"Serbian"},{value:"sk",label:"Slovak"},{value:"sl",label:"Slovenian"},{value:"es",label:"Spanish"},{value:"sv",label:"Swedish"},{value:"tl",label:"Tagalog"},{value:"ta",label:"Tamil"},{value:"te",label:"Telugu"},{value:"th",label:"Thai"},{value:"tr",label:"Turkish"},{value:"uk",label:"Ukrainian"},{value:"uz",label:"Uzbek"},{value:"vi",label:"Vietnamese"}],this.language=e.language,this.markerImages=d.markerImages;else if("search"==this.type)this.fallback=d.parseBoolean(e.fallback),this.placeholder=e.placeholder||"Search",this.noResultsText=e.noResultsText||"No results found",this.width=a.formBuilder.filtersHide&&!a.formBuilder.modal?null:e.width||"100%";else if("distance"==this.type){this.label=this.label||(void 0===e.label?"Search radius":e.label),this.distanceControl=e.distanceControl||"select",this.distanceUnits=e.distanceUnits||"km",this.distanceUnitsLabel=e.distanceUnitsLabel||"km",this.fromLabel=e.fromLabel||"from",this.placeholder=e.placeholder,this.userLocationButton=e.userLocationButton||!1,this.type=e.type,this.addressField=e.addressField||!0,this.addressFieldPlaceholder=e.addressFieldPlaceholder||"Address",this.languages=[{value:"sq",label:"Albanian"},{value:"ar",label:"Arabic"},{value:"eu",label:"Basque"},{value:"be",label:"Belarusian"},{value:"bg",label:"Bulgarian"},{value:"my",label:"Burmese"},{value:"bn",label:"Bengali"},{value:"ca",label:"Catalan"},{value:"zh-cn",label:"Chinese (simplified)"},{value:"zh-tw",label:"Chinese (traditional)"},{value:"hr",label:"Croatian"},{value:"cs",label:"Czech"},{value:"da",label:"Danish"},{value:"nl",label:"Dutch"},{value:"en",label:"English"},{value:"en-au",label:"English (australian)"},{value:"en-gb",label:"English (great Britain)"},{value:"fa",label:"Farsi"},{value:"fi",label:"Finnish"},{value:"fil",label:"Filipino"},{value:"fr",label:"French"},{value:"gl",label:"Galician"},{value:"de",label:"German"},{value:"el",label:"Greek"},{value:"gu",label:"Gujarati"},{value:"iw",label:"Hebrew"},{value:"hi",label:"Hindi"},{value:"hu",label:"Hungarian"},{value:"id",label:"Indonesian"},{value:"it",label:"Italian"},{value:"ja",label:"Japanese"},{value:"kn",label:"Kannada"},{value:"kk",label:"Kazakh"},{value:"ko",label:"Korean"},{value:"ky",label:"Kyrgyz"},{value:"lt",label:"Lithuanian"},{value:"lv",label:"Latvian"},{value:"mk",label:"Macedonian"},{value:"ml",label:"Malayalam"},{value:"mr",label:"Marathi"},{value:"no",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"pt",label:"Portuguese"},{value:"pt-br",label:"Portuguese (brazil)"},{value:"pt-pt",label:"Portuguese (portugal)"},{value:"pa",label:"Punjabi"},{value:"ro",label:"Romanian"},{value:"ru",label:"Russian"},{value:"sr",label:"Serbian"},{value:"sk",label:"Slovak"},{value:"sl",label:"Slovenian"},{value:"es",label:"Spanish"},{value:"sv",label:"Swedish"},{value:"tl",label:"Tagalog"},{value:"ta",label:"Tamil"},{value:"te",label:"Telugu"},{value:"th",label:"Thai"},{value:"tr",label:"Turkish"},{value:"uk",label:"Ukrainian"},{value:"uz",label:"Uzbek"},{value:"vi",label:"Vietnamese"}],this.language=e.language,this.options=e.options||[{value:"10",default:!0},{value:"30",default:!1},{value:"50",default:!1},{value:"100",default:!1}];var i=!1;a.value&&this.options.forEach(function(e){e.value===a.value.length&&(e.selected=!0,i=!0)}),i||this.options.forEach(function(e){e.default&&(e.selected=!0)})}else"post"==this.type?(a.formBuilder.admin&&(this.post_types=this.formBuilder.admin.getPostTypes()),this.post_type=e.post_type||this.post_types[0],this.add_fields=d.parseBoolean(e.add_fields),this.db_type="int(11)",this.name="post_id",this.post_id=e.post_id,this.post=e.post):"checkbox"==this.type?(this.db_type="tinyint(1)",this.checkboxLabel=e.checkboxLabel,this.checkboxValue=e.checkboxValue):"radio"==this.type||"select"==this.type?(this.options=e.options||[{label:"Option one",name:"option_one",value:1},{label:"Option two",name:"option_two",value:2}],"select"==this.type&&(this.multiselect=e.multiselect,this.optionsGrouped=e.optionsGrouped,this.db_type=this.multiselect?"text":"varchar(255)"),this.optionsDict=e.optionsDict||{},this.optionsDict||this.options.forEach(function(e){a.optionsDict[e.value]=e.label})):"image"==this.type?(this.button_text=e.button_text||"Browse...",this.db_type="text",this.label=e.label||"Images",this.name=e.name||"images"):"status"==this.type?(this.label=e.label||"Status",this.name="status",this.options=e.options||[{label:"Enabled",value:1,color:"",disabled:!1},{label:"Disabled",value:0,color:"",disabled:!0}]):"date"==this.type&&(a.formBuilder.admin&&(this.languages=["en-GB","ar","az","bg","bs","ca","cs","cy","da","de","el","es","et","eu","fa","fi","fo","fr","gl","he","hr","hu","hy","id","is","it","ja","ka","kh","kk","kr","lt","lv","mk","ms","nb","nl","nl-BE","no","pl","pt-BR","pt","ro","rs","rs-latin","ru","sk","sl","sq","sr","sr-latin","sv","sw","th","tr","uk","vi","zh-CN","zh-TW"]),this.db_type="varchar(50)",this.language=e.language);this.label=this.label||(void 0===e.label?"Label":e.label),this.name=this.name||e.name||"label",this.help=e.help||"",this.placeholder=e.placeholder;var s=this.type;if("marker"===s&&a.formBuilder.mapsvg.isGeo()&&(s="marker-geo"),"location"===s&&a.formBuilder.mapsvg.isGeo()&&(s="location-geo"),this.formBuilder.filtersMode?(this.parameterName=e.parameterName||"",this.parameterNameShort=this.parameterName.split(".")[1],this.placeholder=e.placeholder||"Any",this.templates={result:Handlebars.compile(p("#mapsvg-filters-tmpl-"+s+"-view").html())}):this.templates={result:Handlebars.compile(p("#mapsvg-data-tmpl-"+s+"-view").html())},this.views={result:p(this.templates.result(this.get()))},this.views.result.data("formElement",this),p().mselect2&&("distance"!==this.type?this.views.result.find("select").css({width:"100%",display:"block"}).mselect2().on("select2:focus",function(){p(this).mselect2("open")}):this.views.result.find("select").mselect2().on("select2:focus",function(){p(this).mselect2("open")})),p().colorpicker&&(this.views.result.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){""==p(this).find("input").val()&&p(this).find("i").css({"background-color":""})}),this.views.edit&&this.views.edit.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){""==p(this).find("input").val()&&p(this).find("i").css({"background-color":""})})),this.html){var l=this.views.result.find("textarea")[0];this.editor=CodeMirror.fromTextArea(l,{mode:{name:"handlebars",base:"text/html"},matchBrackets:!0,lineNumbers:!0}),a.formBuilder.admin&&this.editor.on("change",this.setTextareaValue)}"image"==this.type&&(this.images=this.value||[],this.redrawImages()),"marker"!=this.type&&"location"!=this.type||(this.templates.marker=Handlebars.compile(p("#mapsvg-data-tmpl-marker").html()),this.location&&this.location.marker&&a.renderMarker()),this.setEventHandlers()}d.parseBoolean=function(e){switch(String(e).toLowerCase()){case"on":case"true":case"1":case"yes":case"y":return!0;case"off":case"false":case"0":case"no":case"n":return!1;default:return}},i.prototype.setTextareaValue=function(e,t){var a=e.getValue();p(e.getTextArea()).val(a).trigger("change")},i.prototype.setEventHandlers=function(){var n=this;if(this.formBuilder.editMode)this.views.result.on("click",function(){n.formBuilder.edit(n)});else{if("image"==this.type){var e=n.views.result.find(".mapsvg-data-images");this.formBuilder.mediaUploader.on("select",function(){if(n.formBuilder.mediaUploaderFor!==n)return!1;n.formBuilder.mediaUploader.state().get("selection").toJSON().forEach(function(e){var t={sizes:{}};for(var a in e.sizes)t[a]=e.sizes[a].url.replace("http://","//").replace("https://","//"),t.sizes[a]={width:e.sizes[a].width,height:e.sizes[a].height};t.thumbnail||(t.thumbnail=t.full,t.sizes.thumbnail={width:e.sizes.full.width,height:e.sizes.full.height}),t.medium||(t.medium=t.full,t.sizes.medium={width:e.sizes.full.width,height:e.sizes.full.height}),n.images.push(t)}),n.redrawImages()}),n.views.result.on("click",".mapsvg-upload-image",function(e){e.preventDefault(),(n.formBuilder.mediaUploaderFor=n).formBuilder.mediaUploader.open()}),n.views.result.on("click",".mapsvg-image-delete",function(e){e.preventDefault(),p(this).closest(".mapsvg-thumbnail-wrap").remove(),n.images=[],n.views.result.find("img").each(function(e,t){n.images.push(p(t).data("image"))}),n.views.result.find("input").val(JSON.stringify(n.images))}),n.sortable=new Sortable(e[0],{animation:150,onStart:function(){n.elements.containers.form_view.addClass("sorting")},onEnd:function(e){n.images=[],n.views.result.find("img").each(function(e,t){n.images.push(p(t).data("image"))}),n.views.result.find("input").val(JSON.stringify(n.images))}})}if("post"==this.type){n.views.result.find(".mapsvg-find-post").mselect2({ajax:{url:ajaxurl+"?action=mapsvg_search_posts&post_type="+n.post_type,dataType:"json",delay:250,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,{results:e,pagination:{more:!1}}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:function(e){return e.loading?e.text:"<div class='select2-result-repository clearfix'>"+e.post_title+"</div>"},templateSelection:function(e){return e.post_title||e.text}}).on("select2:select",function(e){n.post=e.params.data,n.views.result.find(".mapsvg-post-id").text(n.post.ID),n.views.result.find(".mapsvg-post-url").text(n.post.url).attr("href",n.post.url),n.views.result.find('input[name="post_id"]').val(n.post.ID)})}if("location"===this.type){if(n.formBuilder.mapsvg.isGeo()){var t=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("formatted_address"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:ajaxurl+"?action=mapsvg_geocoding&address=%QUERY%&language="+this.language,wildcard:"%QUERY%",transform:function(e){return e.error_message&&alert(e.error_message),e.results},rateLimitWait:600}});(o=this.views.result.find(".typeahead")).typeahead({minLength:3},{name:"mapsvg-addresses",display:"formatted_address",source:t});o.on("typeahead:select",function(e,t){n.location&&n.location.marker&&n.deleteMarker();var a={};a.formatted=t.formatted_address,t.address_components.forEach(function(e){var t=e.types[0];a[t]=e.long_name,e.short_name!=e.long_name&&(a[t+"_short"]=e.short_name)});var i={address:a,lat:t.geometry.location.lat,lng:t.geometry.location.lng,img:n.formBuilder.mapsvg.getData().options.defaultMarkerImage};n.location=new d.Location(i,n.formBuilder.mapsvg),n.formBuilder.location=this.location;var s=new d.Marker({location:n.location,mapsvg:n.formBuilder.mapsvg});n.location.marker=s,n.formBuilder.mapsvg.setEditingMarker(s.id),n.formBuilder.marker=s.getOptions(),n.renderMarker();var l=n.formBuilder.view.find('select[name="regions"]');if(-1!==n.formBuilder.mapsvg.getData().options.source.indexOf("/geo-calibrated/usa.svg"))0!==l.length&&n.location.address.state_short&&(l.val(["US-"+n.location.address.state_short]),l.trigger("change"));else if(-1!==n.formBuilder.mapsvg.getData().options.source.indexOf("/geo-calibrated/world.svg"))0!==l.length&&n.location.address.country_short&&(l.val([n.location.address.country_short]),l.trigger("change"));else if(0!==l.length&&n.location.address.administrative_area_level_1){var r=n.formBuilder.mapsvg.getData().regions.filter(function(e){return e.title===n.location.address.administrative_area_level_1||e.title===n.location.address.administrative_area_level_2||e.id===n.location.address.country_short+"-"+n.location.address.administrative_area_level_1_short});0<r.length&&(r=r[0],l.val([r.id]),l.trigger("change"))}o.typeahead("val","")})}n.views.result.on("click",".mapsvg-marker-image-btn-trigger",function(e){p(this).toggleClass("active"),n.toggleMarkerSelector.call(n,p(this),e)}),n.views.result.on("click",".mapsvg-marker-delete",function(e){e.preventDefault(),n.deleteMarker()})}if("distance"===this.type){if(n.formBuilder.mapsvg.isGeo()){var o;t=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("formatted_address"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:ajaxurl+"?action=mapsvg_geocoding&address=%QUERY%&language="+this.language,wildcard:"%QUERY%",transform:function(e){return e.error_message&&alert(e.error_message),e.results},rateLimitWait:600}}),(o=this.views.result.find(".typeahead")).typeahead({minLength:3},{name:"mapsvg-addresses",display:"formatted_address",source:t,limit:5});o.on("change keyup",function(){""===p(this).val()&&n.formBuilder.view.find('[name="distanceLatLng"]').val("").trigger("change")}),o.on("typeahead:select",function(e,t){t.formatted_address;var a=t.geometry.location;n.formBuilder.view.find('[name="distanceLatLng"]').val(a.lat+","+a.lng).trigger("change"),o.blur()})}n.views.result.on("click",".mapsvg-marker-image-btn-trigger",function(e){p(this).toggleClass("active"),n.toggleMarkerSelector.call(n,p(this),e)}),n.views.result.on("click",".mapsvg-marker-delete",function(e){e.preventDefault(),n.deleteMarker()})}}},i.prototype.toggleMarkerSelector=function(e,t){t.preventDefault();var a=this;if(a.markerSelector&&a.markerSelector.is(":visible"))a.markerSelector.hide();else if(a.markerSelector&&a.markerSelector.not(":visible"))a.markerSelector.show();else{a.markerImageButton=e.find("img");var i=a.markerImageButton.attr("src"),s=d.markerImages.map(function(e){return'<button class="btn btn-default mapsvg-marker-image-btn mapsvg-marker-image-btn-choose '+(i==e.url?"active":"")+'"><img src="'+e.url+'" /></button>'});a.markerSelector||(a.markerSelector=a.views.result.find(".mapsvg-marker-image-selector")),a.markerSelector&&a.markerSelector.empty(),a.formBuilder.markerSelector=a.markerSelector,a.formBuilder.marker?a.markerSelector.data("marker",a.formBuilder.marker):a.markerSelector.data("marker",null),a.markerSelector.html(s.join("")),a.markerSelector.on("click",".mapsvg-marker-image-btn-choose",function(e){e.preventDefault();var t=p(this).find("img").attr("src");a.formBuilder.marker&&a.formBuilder.mapsvg.getMarker(a.formBuilder.marker.id).setImage(t);a.markerSelector.hide(),a.views.result.find(".mapsvg-marker-image-btn-trigger").toggleClass("active",!1),a.markerImageButton.attr("src",t)})}},i.prototype.deleteMarker=function(){this.formBuilder.marker&&(this.formBuilder.mapsvg.getMarker(this.formBuilder.marker.id).delete(),delete this.formBuilder.marker),this.views.result.find(".mapsvg-new-marker").hide(),this.views.result.find(".mapsvg-marker-id").attr("disabled","disabled")},i.prototype.renderMarker=function(e){var t=this;if(!this.location&&!e.location)return!1;e&&e.location&&(this.location=e.location),t.views.result.find(".mapsvg-new-marker").show().html(this.templates.marker(this.location)),this.location.marker.onChange=function(){t.renderMarker()}},i.prototype.redrawImages=function(){var i=this.views.result.find(".mapsvg-data-images");i.empty(),this.images&&this.images.forEach(function(e){var t=p('<img class="mapsvg-data-thumbnail" />').attr("src",e.thumbnail).data("image",e),a=p('<div class="mapsvg-thumbnail-wrap"></div>').data("image",e);a.append(t),a.append('<i class="fa fa-times  mapsvg-image-delete"></i>'),i.append(a)}),this.views.result.find("input").val(JSON.stringify(this.images))},i.prototype.setEditorEventHandlers=function(){var r=this;this.views.edit.on("click","button.mapsvg-remove",function(){r.views.result.empty().remove(),r.views.edit.empty().remove(),r.formBuilder.delete(r)}).on("keyup change paste",".mapsvg-edit-status-row input",function(){r.mayBeAddStatusRow()}).on("keyup change paste",".mapsvg-edit-distance-row input",function(){r.mayBeAddDistanceRow()}),this.views.edit.on("change","#marker-file-uploader",function(){for(var e=0;e<this.files.length;e++){var t=new FormData;t.append("file",this.files[0]),t.append("action","mapsvg_marker_upload"),p.ajax({url:ajaxurl,type:"POST",data:t,processData:!1,contentType:!1}).done(function(e){console.log(e)})}}),this.views.edit.on("click",".mapsvg-filter-insert-options",function(){var e,t,a=r.parameterName.split(".")[0],i=r.parameterName.split(".")[1];(e="Object"==a?r.formBuilder.mapsvg.database.getSchemaField(i):"id"==i?{options:r.formBuilder.mapsvg.getData().regions.map(function(e){return{label:e.id,value:e.id}})}:"region_title"==i?{options:r.formBuilder.mapsvg.getData().regions.map(function(e){return{label:e.title,value:e.title}})}:r.formBuilder.mapsvg.regionsDatabase.getSchemaField(i))&&e.options&&(t="regions"==i?(e.options[0].title&&e.options[0].title.length&&e.options.sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:0}),e.options.map(function(e){return(e.title||e.id)+":"+e.id})):e.options.map(function(e){return e.label+":"+e.value}),p(this).closest(".form-group").find("textarea").val(t.join("\n")).trigger("change"))}),this.views.edit.on("keyup change paste","input, textarea, select",function(){var e=p(this).attr("name"),t=p(this).data("array");if("status"===r.type&&t){var a=p(this).data("param"),i=p(this).closest("tr").index();r.options[i]=r.options[i]||{label:"",value:"",color:"",disabled:!1},r.options[i][a]=p(this).is(":checkbox")?p(this).prop("checked"):p(this).val(),r.redraw()}else if("distance"===r.type&&t){a=p(this).data("param"),i=p(this).closest("tr").index();r.options[i]||(r.options[i]={value:"",default:!1}),"default"===a?(r.options.forEach(function(e,t){e.default=!1}),r.options[i].default=p(this).prop("checked")):r.options[i].value=p(this).val(),r.redraw()}else{if("label"==e||"name"==e)return!1;var s;if(s="checkbox"==p(this).attr("type")?p(this).prop("checked"):p(this).val(),"radio"==p(this).attr("type")){var l=p(this).attr("name");s=p('input[name="'+l+'"]:checked').val()}r.update(e,s)}}),this.views.edit.on("keyup change paste",'input[name="label"]',function(){if(!r.nameChanged){if(r.label=p(this).val(),"region"!=r.type&&"location"!=r.type){var e=p(this).val();e=e.toLowerCase().replace(/ /g,"_").replace(/\W/g,""),r.views.edit.find('input[name="name"]').val(e),r.name=e}r.views.result.find("label").first().html(r.label),r.formBuilder.filtersMode||r.views.result.find("label").first().append('<div class="field-name">'+r.name+"</div>")}}),this.views.edit.on("keyup change paste",'input[name="name"]',function(){this.value&&(this.value.match(/[^a-zA-Z0-9_]/g)&&(this.value=this.value.replace(/[^a-zA-Z0-9_]/g,""),p(this).trigger("change")),this.value[0].match(/[^a-zA-Z_]/g)&&(this.value=this.value[0].replace(/[^a-zA-Z_]/g,"")+this.value.slice(1),p(this).trigger("change"))),"region"!=r.type&&(r.name=this.value),r.views.result.find("label").html(r.label+'<div class="field-name">'+r.name+"</div>"),r.nameChanged=!0})},i.prototype.getEditor=function(){return this.formBuilder.filtersMode?this.templates.edit=this.templates.edit||Handlebars.compile(p("#mapsvg-filters-tmpl-"+this.type+"-control").html()):this.templates.edit=this.templates.edit||Handlebars.compile(p("#mapsvg-data-tmpl-"+this.type+"-control").html()),this.views.edit=p(this.templates.edit(this.get())),this.views.edit},i.prototype.destroyEditor=function(){this.views.edit.empty().remove()},i.prototype.initEditor=function(){var i=this;this.views.edit.find("input").first().select(),p().mselect2&&("distance"!==this.type?this.views.edit.find("select").css({width:"100%",display:"block"}).mselect2():this.views.edit.find("select").mselect2()),"status"==this.type&&(i.views.edit.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){var t=p(this).find("input"),a=p(this).closest("tr").index();""==t.val()&&p(this).find("i").css({"background-color":""}),i.options[a]=i.options[a]||{label:"",value:"",color:"",disabled:!1},i.options[a].color=t.val()}),i.mayBeAddStatusRow()),"distance"===this.type&&i.mayBeAddDistanceRow(),this.views.edit.find(".mapsvg-onoff").bootstrapToggle({onstyle:"default",offstyle:"default"}),this.setEditorEventHandlers()},i.prototype.mayBeAddStatusRow=function(){var i=this;this.templates.editStatusRow=this.templates.editStatusRow||p(p("#mapsvg-edit-status-row").html());var e=i.views.edit.find(".mapsvg-edit-status-label:last-child");if(e&&e.last()&&e.last().val()&&e.last().val().trim().length){var t=this.templates.editStatusRow.clone();t.insertAfter(i.views.edit.find(".mapsvg-edit-status-row:last-child")),t.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){var t=p(this).find("input"),a=p(this).closest("tr").index();""==t.val()&&p(this).find("i").css({"background-color":""}),i.options[a]=i.options[a]||{label:"",value:"",color:"",disabled:!1},i.options[a].color=t.val()})}var a=i.views.edit.find(".mapsvg-edit-status-row"),s=a.eq(a.length-2),l=a.eq(a.length-1);s.length&&l.length&&!(s.find("input:eq(0)").val().trim()||s.find("input:eq(1)").val().trim()||s.find("input:eq(2)").val().trim())&&!(l.find("input:eq(0)").val().trim()||l.find("input:eq(1)").val().trim()||l.find("input:eq(2)").val().trim())&&l.remove()},i.prototype.mayBeAddDistanceRow=function(){this.templates.editDistanceRow=this.templates.editDistanceRow||p(p("#mapsvg-edit-distance-row").html());var e=this.views.edit.find(".mapsvg-edit-distance-row:last-child input");e&&e.last()&&e.last().val()&&e.last().val().trim().length&&this.templates.editDistanceRow.clone().insertAfter(this.views.edit.find(".mapsvg-edit-distance-row:last-child"));var t=this.views.edit.find(".mapsvg-edit-distance-row"),a=t.eq(t.length-2),i=t.eq(t.length-1);a.length&&i.length&&!a.find("input:eq(0)").val().trim()&&!i.find("input:eq(0)").val().trim()&&i.remove()},i.prototype.getSchema=function(){var t=this,a={type:this.type,db_type:this.db_type,label:this.label,name:this.name,value:this.value,searchable:d.parseBoolean(this.searchable)};if("select"==this.type&&(a.multiselect=d.parseBoolean(this.multiselect),a.multiselect&&(a.db_type="text"),a.optionsGrouped=this.optionsGrouped),this.options){var e=p.extend(!0,{},{options:this.options});a.options=e.options,a.optionsDict={},"region"==a.type?a.options.forEach(function(e){a.optionsDict[e.id]=e.title||e.id}):"status"==t.type?a.options.forEach(function(e,t){""===a.options[t].value?a.options.splice(t,1):(a.options[t].disabled=d.parseBoolean(a.options[t].disabled),a.optionsDict[e.value]=e)}):"distance"==t.type?a.options.forEach(function(e,t){""===a.options[t].value?a.options.splice(t,1):a.options[t].default=d.parseBoolean(a.options[t].default)}):a.options.forEach(function(e){a.optionsDict[e.value]="status"==t.type?e:e.label})}return this.help&&(a.help=this.help),this.button_text&&(a.button_text=this.button_text),"post"==this.type&&(a.post_type=this.post_type,a.add_fields=this.add_fields),"date"==this.type&&(a.language=this.language),"location"==this.type&&(a.language=this.language),"textarea"==this.type&&(a.autobr=this.autobr,a.html=this.html),"modal"==this.type&&(a.buttonText=this.buttonText),"distance"==this.type&&(a.distanceControl=this.distanceControl,a.distanceUnits=this.distanceUnits,a.distanceUnitsLabel=this.distanceUnitsLabel,a.fromLabel=this.fromLabel,a.addressField=this.addressField,a.addressFieldPlaceholder=this.addressFieldPlaceholder,a.userLocationButton=this.userLocationButton,a.placeholder=this.placeholder,a.language=this.language,"none"===a.distanceControl&&(a.distanceDefault=a.options.filter(function(e){return e.default})[0].value)),"search"==this.type&&(a.fallback=d.parseBoolean(this.fallback),a.placeholder=this.placeholder,a.noResultsText=this.noResultsText,a.width=this.width),this.checkboxLabel&&(a.checkboxLabel=this.checkboxLabel),this.checkboxValue&&(a.checkboxValue=this.checkboxValue),this.formBuilder.filtersMode&&(a.parameterName=this.parameterName,a.parameterNameShort=this.parameterName.split(".")[1],a.placeholder=this.placeholder),a.visible=void 0===this.visible||this.visible,a},i.prototype.get=function(){var e=this.getSchema();if(e._name=e.name,this.formBuilder.namespace){e.name=this.name.split("[")[0];var t=this.name.split("[")[1]||"";t&&(t="["+t),e.name=this.formBuilder.namespace+"["+e.name+"]"+t}if("post"==this.type&&(this.formBuilder.admin&&(e.post_types=this.formBuilder.admin.getPostTypes()),e.post_type=this.post_type,e.post=this.post,e.add_fields=this.add_fields||0),"date"==this.type&&(this.formBuilder.admin&&(e.languages=this.languages),e.language=this.language),"distance"==this.type&&(this.formBuilder.admin&&(e.languages=this.languages),e.language=this.language),"location"==this.type){if(this.formBuilder.admin){e.languages=this.languages,e.markerImages=d.markerImages;var a=this;e.markerImages.forEach(function(e){e.url===a.formBuilder.mapsvg.getData().options.defaultMarkerImage?e.default=!0:e.default=!1})}e.language=this.language}return"location"===this.type&&this.location&&(e.location=this.location,this.location.marker&&(e.location.img=(0===this.location.marker.src.indexOf(d.urls.uploads)?"uploads/":"")+this.location.marker.src.split("/").pop())),"textarea"==this.type&&(e.html=this.html),e.databaseFields=this.databaseFields,e.regionFields=this.regionFields,e.placeholder=this.placeholder,e},i.prototype.update=function(e,t){var a=this;if("options"==e){var i=[];t=t.split("\n").forEach(function(e){e=e.trim().split(":"),"checkbox"==a.type&&3==e.length?i.push({label:e[0],name:e[1],value:e[2]}):"radio"!=a.type&&"select"!=a.type||2!=e.length||i.push({label:e[0],value:e[1]})}),this.options=i}else this[e]=t;"parameterName"==e&&this.views.edit.find(".mapsvg-filter-param-name").text(t),this.redraw()},i.prototype.redraw=function(){var e=p(this.templates.result(this.get()));this.views.result.html(e.html()),p().mselect2&&("distance"!==this.type?this.views.result.find("select").css({width:"100%",display:"block"}).mselect2().on("select2:focus",function(){p(this).mselect2("open")}):this.views.result.find("select").mselect2().on("select2:focus",function(){p(this).mselect2("open")})),p().colorpicker&&this.views.edit&&this.views.edit.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){""==p(this).find("input").val()&&p(this).find("i").css({"background-color":""})})};var t=function(e){var t=this;this.container=e.container,this.namespace=e.namespace,this.mediaUploader=e.mediaUploader,this.schema=e.schema||[],this.editMode=null!=e.editMode&&e.editMode,this.filtersMode=null!=e.filtersMode&&e.filtersMode,this.filtersHide=null!=e.filtersHide&&e.filtersHide,this.modal=null!=e.modal&&e.modal,this.admin=e.admin,this.mapsvg=e.mapsvg,this.data=e.data||{},this.eventHandlers=e.events,this.template="form-builder",this.closeOnSave=!0===e.closeOnSave,this.newRecord=!0===e.newRecord,this.types=e.types||["text","textarea","checkbox","radio","select","image","region","location","post","date"],this.templates={},this.elements={},this.view=p("<div />").addClass("mapsvg-form-builder"),this.editMode&&this.view.addClass("full-flex"),this.formControls=[],d.templatesLoaded[this.template]?this.init():p.get(d.urls.templates+t.template+".hbs?"+Math.random(),function(e){p(e).appendTo("body"),d.templatesLoaded[t.template]=!0,Handlebars.registerPartial("dataMarkerPartial",p("#mapsvg-data-tmpl-marker").html()),t.init()})};t.prototype.init=function(){var e=this;if(d.formBuilder=this,e.editMode){var t=Handlebars.compile(p("#mapsvg-form-editor-tmpl-ui").html());e.view.append(t({types:this.types})),e.view.addClass("edit")}else{var a=p('<div class="mapsvg-data-form-view"></div>');e.view.append(a),this.filtersMode||a.addClass("form-horizontal")}e.elements={buttons:{text:e.view.find("#mapsvg-data-btn-text"),textarea:e.view.find("#mapsvg-data-btn-textarea"),checkbox:e.view.find("#mapsvg-data-btn-checkbox"),radio:e.view.find("#mapsvg-data-btn-radio"),select:e.view.find("#mapsvg-data-btn-select"),image:e.view.find("#mapsvg-data-btn-image"),region:e.view.find("#mapsvg-data-btn-region"),marker:e.view.find("#mapsvg-data-btn-marker"),saveSchema:e.view.find("#mapsvg-data-btn-save-schema")},containers:{buttons_add:e.view.find("#mapsvg-data-buttons-add"),form_view:e.view.find(".mapsvg-data-form-view"),form_edit:e.view.find("#mapsvg-data-form-edit")}},e.redraw()},t.prototype.viewDidLoad=function(){_this.formControls.forEach(function(e){if(e.html){var t=e.views.result.find("textarea")[0];e.htmlEditor=CodeMirror.fromTextArea(t,{mode:{name:"handlebars",base:"text/html"},matchBrackets:!0,lineNumbers:!0})}})},t.prototype.setEventHandlers=function(){var m=this;p(e).off("keydown.form.mapsvg").on("keydown.form.mapsvg",function(e){d.formBuilder&&((e.metaKey||e.ctrlKey)&&13==e.keyCode?d.formBuilder.save():27==e.keyCode&&d.formBuilder.close())}),this.editMode?(this.view.on("click",".mapsvg-marker-image-selector button",function(e){e.preventDefault();var t=p(this).find("img").attr("src");p(this).parent().find("button").removeClass("active"),p(this).addClass("active"),m.mapsvg.setDefaultMarkerImage(t)}),this.view.on("click","#mapsvg-data-buttons-add button",function(e){e.preventDefault();var t=p(this).data("create");m.add({type:t})}),this.view.on("click","#mapsvg-data-btn-save-schema",function(e){e.preventDefault();var t=m.getSchema(),l={};m.formControls.forEach(function(e){l[e.name]=(l[e.name]||0)+1}),m.elements.containers.form_view.find(".form-group").removeClass("has-error");var r,n,o=[],d=["id","lat","lon","lng","location","location_lat","location_lon","location_lng","location_address","location_img","marker","marker_id","regions","region_id","post_id","post","post_title","post_url","keywords","status"],u={regions:"region",status:"status",post_id:"post",marker:"marker",location:"location"};m.formControls.forEach(function(e,t){var a=!1;if(!m.filtersMode)if(1<l[e.name])r||(r="Field names should be unique",o.push(r),a=!0);else if(0===e.name.length)n||(n="Field name can't be empty",o.push(n),a=!0);else if(-1!=d.indexOf(e.name)&&(!u[e.name]||u[e.name]&&u[e.name]!=e.type)){var i='Field name "'+e.name+'" is reserved, please set another name';o.push(i),a=!0}if(e.options&&"region"!=e.type&&"marker"!=e.type){var s=_.pluck(e.options,"value");s.length!=_.uniq(s).length&&(o.push('Check "Options" list - values should not repeat'),a=!0)}a&&e.views.result.addClass("has-error")}),0==o.length?m.eventHandlers.saveSchema&&m.eventHandlers.saveSchema(t):p.growl.error({title:"Errors",message:o.join("<br />")})}),setTimeout(function(){var e=m.elements.containers.form_view[0];m.sortable=new Sortable(e,{animation:150,onStart:function(){m.elements.containers.form_view.addClass("sorting")},onEnd:function(){setTimeout(function(){m.elements.containers.form_view.removeClass("sorting"),m.formControls=[],p(e).find(".form-group").each(function(e,t){m.formControls.push(p(t).data("formElement"))})},500)}})},1e3)):(m.view.on("click","button.btn-save",function(e){e.preventDefault(),m.save()}),m.view.on("click","button.btn-close",function(e){e.preventDefault(),m.close()})),new d.ResizeSensor(this.view[0],function(){m.scrollApi&&m.scrollApi.reinitialise()})},t.prototype.save=function(){var e=this;e.marker&&(e.marker.onChange=null,e.mapsvg.unsetEditingMarker());var t=e.getData();e.saved=!0,e.eventHandlers.save&&e.eventHandlers.save.call(e,t)},t.prototype.getData=function(){var a=this,e=a.toJSON(!0);return a.formControls.forEach(function(t){if("image"==t.type&&(e[t.name]=[],t.images&&t.images.length&&null!=t.images[0])){var i=[];t.views.result.find(".mapsvg-thumbnail-wrap").each(function(e,t){var a=p(t).data("image");i.push(a)}),t.images=i,e[t.name]=e[t.name].concat(t.images)}"location"==t.type&&(t.location?e[t.name]=t.location:e[t.name]=""),"post"==t.type&&(e.post=t.post),"region"==t.type&&(e.regions&&"object"==typeof e.regions&&e.regions.length?e.regions=e.regions.map(function(e){return{id:e,title:a.mapsvg.getRegion(e).title}}):e.regions=""),"select"==t.type&&t.multiselect&&e[t.name]&&e[t.name].length&&(e[t.name]=e[t.name].map(function(e){return{value:e,label:t.optionsDict[e]}}))}),null!=a.data.id&&(e.id=a.data.id),delete e.marker_id,e},t.prototype.getDataJSON=function(){var t=this,a=t.toJSON(!0);return t.formControls.forEach(function(e){if("image"==e.type&&(a[e.name]=[],e.images&&e.images.length&&null!=e.images[0])){var i=[];t.view.find(".mapsvg-thumbnail-wrap").each(function(e,t){var a=p(t).data("image");i.push(a)}),e.images=i,a[e.name]=a[e.name].concat(e.images)}"location"==e.type&&(a[e.name]=e.location)}),null!=t.data.id&&(a.id=t.data.id),a},t.prototype.redraw=function(e){var a=this;if(delete a.marker,a.container.empty(),a.elements.containers.form_view.empty(),a.formControls=[],a.data&&a.data.id&&a.add({type:"id",label:"ID",name:"id",value:a.data.id}),a.data&&a.data._title&&a.add({type:"title",label:"Title",name:"title",value:a.data._title}),a.schema&&a.schema.length&&a.schema.forEach(function(e){if(a.admin&&a.admin.isMetabox&&"post"==e.type);else{if(a.filtersMode?"distance"==e.type?e.value=a.data.distance?a.data.distance:void 0!==e.value?e.value:null:e.value=a.data[e.parameterNameShort]:e.value=a.data?a.data[e.name]:void 0!==e.value?e.value:null,"location"!=e.type||a.editMode?"post"==e.type&&(e.post=a.data.post):(e.value&&e.value.marker&&e.value.marker.id&&(a.marker=a.mapsvg.getMarker(e.value.marker.id).getOptions(),a.mapsvg.setEditingMarker(a.marker.id)),a.admin&&a.admin.setMode&&a.admin.setMode("editMarkers"),a.admin&&a.admin.enableMarkersMode(!0),a.mapsvg.setMarkerEditHandler(function(){a.marker=this.getOptions(),a.mapsvg.setEditingMarker(this.id),a.locationFormElement&&a.locationFormElement.renderMarker(a.mapsvg.getMarker(a.marker.id))})),a.filtersMode){if(!a.filtersHide||a.filtersHide&&a.modal&&"search"!==e.type||!a.modal&&"search"===e.type)var t=a.add(e)}else t=a.add(e);"location"==e.type&&(a.locationFormElement=t)}}),a.editMode||(0==this.schema.length?a.add({type:"empty"}):a.admin&&!a.admin.isMetabox&&a.add({type:"save"})),a.filtersMode&&a.filtersHide&&!a.modal&&(this.showFiltersButton=a.add({type:"modal",buttonText:a.mapsvg.getData().options.filters.buttonText})),a.editMode||a.filtersMode)a.container.html(this.view);else{var t=p('<div class="nano"></div>'),i=p('<div class="nano-content"></div>');t.append(i),i.html(this.view),a.container.html(t),t.jScrollPane(),a.scrollApi=t.data("jsp")}a.eventHandlers.load&&a.eventHandlers.load(a),this.editMode||a.filtersMode||this.view.find("input:visible,textarea:visible").not(".tt-hint").first().focus(),this.container.find(".CodeMirror").each(function(e,t){t&&t.CodeMirror.refresh()}),a.setEventHandlers(),a.eventHandlers.init&&a.eventHandlers.init(a.data)},t.prototype.delete=function(a){var i=this;i.formControls.forEach(function(e,t){e===a&&(i.formControls.splice(t,1),i.structureChanged=!0)})},t.prototype.add=function(t){if(-1!=["region","marker","post","status","distance","location","search"].indexOf(t.type)){var a=!1;if(this.formControls.forEach(function(e){e.type==t.type&&(a=!0)}),a)return void p.growl.error({title:"Error",message:'You can add only 1 "'+d.ucfirst(t.type)+'" field'})}"date"==t.type&&(d.datepicker=d.datepicker||{});var e=new i(t,this);return this.formControls.push(e),this.elements.containers.form_view.append(e.views.result),this.editMode&&this.edit(e),e},t.prototype.edit=function(e){var t=this;t.currentlyEditing&&t.currentlyEditing.destroyEditor(),t.elements.containers.form_edit.append(e.getEditor()),e.initEditor(),t.currentlyEditing=e,t.elements.containers.form_view.find(".form-group.active").removeClass("active"),e.views.result.addClass("active")},t.prototype.get=function(){return this.formControls.map(function(e){return e.get()})},t.prototype.getSchema=function(){return this.formControls.map(function(e){return e.getSchema()})},t.prototype.close=function(){var e=this;if(!e.saved){if(null==e.data.id&&e.marker){var t=e.mapsvg.getMarker(e.marker.id);t.onChange=null,t.delete(),delete e.marker}if(e.marker){var a=e.mapsvg.getEditingMarker();a&&(a.update(e.marker),e.mapsvg.unsetEditingMarker())}}if(e.markerSelector&&e.markerSelector.popover("destroy"),p().mselect2){var i=e.view.find(".mapsvg-select2");i.length&&i.mselect2("destroy")}var s=e.view.find(".CodeMirror");s.length&&s.empty().remove(),e.admin&&e.admin.enableMarkersMode(!1),d.formBuilder=null,e.eventHandlers.close&&e.eventHandlers.close()},t.prototype.destroy=function(){this.view.empty().remove(),this.sortable=null},t.prototype.on=function(e,t){this.eventHandlers[e]=t},t.prototype.toJSON=function(s){var t={};return this.elements.containers.form_view.find("input, textarea, select").each(function(){var e;p(this).data("skip")||p(this).prop("disabled")||!p(this).attr("name")||!s&&"checkbox"==p(this).attr("type")&&null==p(this).attr("checked")||"radio"==p(this).attr("type")&&null==p(this).attr("checked")||(e="checkbox"==p(this).attr("type")?p(this).prop("checked"):p(this).val(),function e(t,a,i){if(!s&&!i)return!1;1==a.length?t[a[0]]=i:(null==t[a[0]]&&(t[a[0]]={}),e(t[a[0]],a.slice(1),i))}(t,p(this).attr("name").replace(/]/g,"").split("["),e))}),t},t.prototype.getRegionsList=function(){return this.mapsvg.getData().regions.map(function(e){return{id:e.id,title:e.title}})},t.prototype.getMarkersList=function(){return this.mapsvg.getData().markers.map(function(e){return{id:e.id}})},d.FormBuilder=t}(jQuery,MapSVG,window);
!function(l,e){var t=function(e,t,l){this.name="google-maps",MapSVGAdminController.call(this,e,t,l),this.styles={default:{},silver:[{elementType:"geometry",stylers:[{color:"#f5f5f5"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f5f5"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#dadada"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]}],retro:[{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#dcd2be"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#ae9e90"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#93817c"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#a5b076"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#db8555"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#806b63"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"transit.line",elementType:"labels.text.fill",stylers:[{color:"#8f7d77"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{color:"#ebe3cd"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#b9d3c2"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}],dark:[{elementType:"geometry",stylers:[{color:"#212121"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{elementType:"labels.text.stroke",stylers:[{color:"#212121"}]},{featureType:"administrative",elementType:"geometry",stylers:[{color:"#757575"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#181818"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"poi.park",elementType:"labels.text.stroke",stylers:[{color:"#1b1b1b"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#2c2c2c"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#8a8a8a"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#373737"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#3c3c3c"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#4e4e4e"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#3d3d3d"}]}],night:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}],blue:[{elementType:"geometry",stylers:[{color:"#1d2c4d"}]},{elementType:"labels.text.fill",stylers:[{color:"#8ec3b9"}]},{elementType:"labels.text.stroke",stylers:[{color:"#1a3646"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#64779e"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{color:"#334e87"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#023e58"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#283d6a"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#6f9ba5"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#023e58"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#3C7680"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#304a7d"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#2c6675"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#255763"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b0d5ce"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{color:"#023e58"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"transit",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{color:"#283d6a"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#3a4762"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0e1626"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#4e6d70"}]}]}};e.MapSVGAdminGoogleMapsController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.viewLoaded=function(){this.mapsvg.getData().mapIsGeo||(this.view.find("#mapsvg-can-use-gmap").show(),this.view.find("form").css({opacity:.4,"pointer-events":"none"}))},t.prototype.setEventHandlers=function(){var o=this;MapSVG.GoogleMapBadApiKey=function(){alert('Google maps API key is incorrect. Change API key, click "Save" and RELOAD the page to reload Google maps scripts with correct API key.'),o.view.find("#googleMapsOn").prop("checked",!1).trigger("change")};var e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("formatted_address"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:ajaxurl+"?action=mapsvg_geocoding&address=%QUERY%",wildcard:"%QUERY%",transform:function(e){return e.error_message&&alert(e.error_message),e.results},rateLimitWait:500}}),t=o.view.find("#mapsvg-gm-address");t.typeahead(null,{name:"mapsvg-addresses",display:"formatted_address",source:e,minLength:2});t.on("typeahead:select",function(e,t){var l=t.geometry.bounds?t.geometry.bounds:t.geometry.viewport,r=new google.maps.LatLngBounds(l.southwest,l.northeast);o.mapsvg.getData().googleMaps.map.fitBounds(r)}),this.view.on("change",'input[name="googleMaps[style]"]',function(e){var t=l(this).val();"custom"==t?(o.view.find("#mapsvg-gm-custom-style-extra").show(),o.updateScroll(),l("#mapsvg-gm-custom-style-textarea").trigger("change")):(o.view.find("#mapsvg-gm-custom-style-extra").hide(),o.updateScroll(),o.mapsvg.getData().options.googleMaps.styleJSON=o.styles[t],o.mapsvg.getData().googleMaps.map.setOptions({styles:o.styles[t]}))}),this.view.on("change paste keyup","#mapsvg-gm-custom-style-textarea",function(e){try{var t=JSON.parse(l(this).val());o.mapsvg.getData().options.googleMaps.styleJSON=t,o.mapsvg.getData().googleMaps.map.setOptions({styles:t}),l("#mapsvg-gm-invalid-json").hide()}catch(e){console.log(e),l("#mapsvg-gm-invalid-json").show()}})}}(jQuery,window);
!function(o,a){var e=function(e,t,r){this.name="javascript",this.errorLines=[],this.disableHorizontalScroll=!0,this.scrollable=!1,MapSVGAdminController.call(this,e,t,r)};a.MapSVGAdminJavascriptController=e,MapSVG.extend(e,a.MapSVGAdminController),e.prototype.viewLoaded=function(){this.setEditor()},e.prototype.setEventHandlers=function(){var e=this;this.toolbarView.find("select").mselect2().on("select2:select",function(){e.setEditor()})},e.prototype.setEditor=function(){var e=this;this.view.find("#mapsvg-js-container").empty();var t=this.toolbarView.find("select").val(),r=o('<textarea id="mapsvg-js-textarea"  class="form-control" rows="8" data-live="change" name="events['+t+']"></textarea>'),i=this.mapsvg.getData().options.events[t];i||(i=""),i=i&&"string"!=typeof i?MapSVG.convertToText(this.mapsvg.getData().options.events[t]):i,r.val(i),this.view.find("#mapsvg-js-container").append(r),this.editor=CodeMirror.fromTextArea(r[0],{lint:!0,mode:"javascript",matchBrackets:!0,lineNumbers:!0}),this.editor.on("change",e.setTextareaValue),e.resizeEditor(),o(a).off("resize.codemirror.js"),o(a).on("resize.codemirror.js",function(){e.resizeEditor()})},e.prototype.resizeEditor=function(){this.view.find(".CodeMirror")[0].CodeMirror.setSize(null,this.contentWrap.height()),this.view.find(".CodeMirror").height(this.contentWrap.height())},e.prototype.setTextareaValue=function(e,t){var r=e.getValue();o(e.getTextArea()).val(r).trigger("change")},e.prototype.highlightErrors=function(){var e=this,t=o(e.editor.getTextArea()),r=e.editor.getValue();t.val(r),e.editor.operation(function(){e.error&&e.editor.removeLineClass(e.error.line-2,"background","line-error"),e.error=e.admin.validateInput(t),e.error instanceof TypeError||e.error instanceof SyntaxError?e.editor.addLineClass(e.error.line-2,"background","line-error"):(e.error=null,e.setTextareaValue())})}}(jQuery,window);
!function(e,t){var i=function(t,e,i){this.name="layers",this.scrollable=!1,this.isParent=!0,MapSVGAdminController.call(this,t,e,i)};t.MapSVGAdminLayersController=i,MapSVG.extend(i,t.MapSVGAdminController),i.prototype.viewLoaded=function(){var t=this;this.controllers.list=new MapSVGAdminLayersListController("mapsvg-layers-list",t.admin,t.mapsvg),this.controllers.settings=new MapSVGAdminLayersSettingsController("mapsvg-layers-settings",t.admin,t.mapsvg),this.controllers.list.toolbarView=this.toolbarView,this.controllers.settings.toolbarView=this.toolbarView},i.prototype.viewDidAppear=function(){MapSVGAdminController.prototype.viewDidAppear.call(this)},i.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this)},i.prototype.setEventHandlers=function(){e("#mapsvg-layers-menu a").click(function(t){t.preventDefault(),e(this).tab("show"),e("#mapsvg-btn-layer-add").toggle("#mapsvg-layers-list"===e(this).attr("href"))})}}(jQuery,window);
!function(l,e){var t=function(e,t,a){var i=this;this.name="layers-list",this.database=new MapSVG.DatabaseService({type:"local",dbObject:a.getData().options.groups},a),this.database.on("change",function(){i.mapsvg.setLayersControl()}),this.database.setSchema([{name:"id",label:"ID",visible:!0,type:"id"},{name:"objects",help:"You can select multiple objects",multiselect:!0,label:"Objects",visible:!0,type:"select",optionsGrouped:!0,options:a.getGroupSelectOptions()},{name:"title",label:"Title",visible:!0,type:"text"},{name:"visible",label:"Visible",visible:!1,type:"checkbox"}]),MapSVGAdminController.call(this,e,t,a)};e.MapSVGAdminLayersListController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.viewLoaded=function(){this.redrawDataList()},t.prototype.viewDidAppear=function(){MapSVGAdminController.prototype.viewDidAppear.call(this),this.database.setSchema()},t.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this),this.closeFormHandler()},t.prototype.setEventHandlers=function(){var i=this;l("#mapsvg-btn-layer-add").on("click",function(e){e.preventDefault(),i.btnAdd=l(this),i.btnAdd.addClass("disabled"),i.editDataRow()}),this.view.on("click",".mapsvg-data-row",function(e){l(this).hasClass("active")||i.editDataRow(l(this))}).on("click",".mapsvg-layer-view-toggle",function(e){e.preventDefault(),e.stopPropagation(),l(this).toggleClass("active");var t=l(this).closest("tr").data("id"),a=i.database.getLoadedObject(t);a.visible=!l(this).hasClass("active"),a.visible?(l(this).find("i").toggleClass("fa-eye",!0),l(this).find("i").toggleClass("fa-eye-slash",!1)):(l(this).find("i").toggleClass("fa-eye",!1),l(this).find("i").toggleClass("fa-eye-slash",!0)),i.mapsvg.setGroups(),i.mapsvg.setLayersControl()}).on("click",".mapsvg-layer-delete",function(e){e.preventDefault(),e.stopPropagation();var t=l(this).closest("tr");i.deleteDataRow(t)})},t.prototype.getTemplateData=function(){return{fields:this.getDataFieldsForTemplate(!0),data:this.database.getLoaded()}},t.prototype.getDataFieldsForTemplate=function(e){return[{name:"id",visible:!0,type:"id"},{name:"objects",visible:!0,type:"select",optionsGrouped:!0,options:this.mapsvg.getGroupSelectOptions()},{name:"title",visible:!0,type:"text"}]},t.prototype.redrawDataList=function(){var e=this;e.redraw();var t=this.mapsvg.getPagination(function(){e.redrawDataList()});this.view.find(".mapsvg-pagination-container").html(t)},t.prototype.getObjectRow=function(e){return this.view.find("#mapsvg-layer-row-"+e.id)},t.prototype.addDataRow=function(e){var t={fields:this.database.getColumns({visible:!0}),params:e},a=l(this.templates.item(t));return this.view.find("#mapsvg-layers-list-table tbody").prepend(a),a},t.prototype.updateDataRow=function(e,t){var a={fields:this.database.getColumns({visible:!0}),params:e},i=l(this.templates.item(a));(t=t||l("#mapsvg-layer-row-"+e.id)).replaceWith(i),i.addClass("mapsvg-row-updated"),setTimeout(function(){i.removeClass("mapsvg-row-updated")},2600)},t.prototype.deleteDataRow=function(e){var t=e.data("id"),a=this.database.getLoadedObject(t);if(!a)return!1;a.marker&&this.mapsvg.markerDelete(a.marker),this.database.delete(t),e.fadeOut(300,function(){e.remove()})},t.prototype.editDataRow=function(e,t){var a=this,i=!e,s={};if(a.tableDataActiveRow&&a.tableDataActiveRow.removeClass("mapsvg-row-selected"),e){a.updateScroll(),t&&a.contentWrap.data("jsp").scrollToElement(e,!0,!1),a.tableDataActiveRow=e,a.tableDataActiveRow.addClass("mapsvg-row-selected");var o=a.tableDataActiveRow.data("id");s=a.database.getLoadedObject(o)}else s={visible:!0};var r=wp.media.frames.file_frame=wp.media({title:"Choose images",button:{text:"Choose images"},multiple:!0});a.formBuilder&&(a.formBuilder.destroy(),a.formBuilder=null,a.formBuilderRow&&a.formBuilderRow.remove(),l("#mapsvg-btn-layer-add").removeClass("disabled")),a.formContainer&&a.formContainer.empty().remove(),a.formContainer=l('<div class="mapsvg-modal-edit"></div>'),this.view.append(a.formContainer),a.formBuilder=new MapSVG.FormBuilder({container:a.formContainer,schema:a.database.getSchema(),editMode:!1,mapsvg:a.mapsvg,mediaUploader:r,data:s,admin:a.admin,events:{save:function(e){i?(a.saveDataObject(e),this.redraw()):(a.updateDataObject(e),this.close())},close:function(){a.closeFormHandler()}}})},t.prototype.saveDataObject=function(e){var t,a,i=this;if(e.id&&(t=this.getObjectRow(e)),t&&t.length||(a=!0,t=this.addDataRow(e)),a)this.database.create(e).done(function(e){a&&i.updateDataRow(e,t)}).fail(function(){l.growl.error({title:"Server error",message:"Can't save object"}),t.remove()});else{if(this.database.update(e).fail(function(){l.growl.error({title:"Server error",message:"Can't update object"})}),e.marker){var s=i.mapsvg.getMarker(e.marker.id);s.setId("marker_"+e.id),s.setObject(e)}this.closeFormHandler(),this.updateDataRow(e)}},t.prototype.updateDataObject=function(e){if(this.database.update(e).fail(function(){l.growl.error({title:"Server error",message:"Can't update object"})}),e.marker){var t=this.mapsvg.getMarker(e.marker.id);t.setId("marker_"+e.id),t.setObject(e)}this.closeFormHandler(),this.updateDataRow(e)},t.prototype.closeFormHandler=function(){var e=this;l("#mapsvg-btn-layer-add").removeClass("disabled"),e.mapsvg.showMarkers(),e.formBuilder&&(e.formBuilder.destroy(),e.formBuilder=null,e.formContainer.empty().remove(),e.tableDataActiveRow&&e.tableDataActiveRow.removeClass("mapsvg-row-selected"),e.tableDataActiveRow&&!e.tableDataActiveRow.hasClass("mapsvg-row-updated")&&e.tableDataActiveRow.addClass("mapsvg-row-closed"),setTimeout(function(){e.tableDataActiveRow&&!e.tableDataActiveRow.hasClass("mapsvg-row-updated")&&e.tableDataActiveRow.removeClass("mapsvg-row-closed")},1600),l("a.browser").remove()),this.updateScroll()}}(jQuery,window);
!function(n,t){var e=function(n,t,e){this.name="layers-settings",this.database=e.regionsDatabase,MapSVGAdminController.call(this,n,t,e)};t.MapSVGAdminLayersSettingsController=e,MapSVG.extend(e,t.MapSVGAdminController),e.prototype.setEventHandlers=function(){}}(jQuery,window);
!function(m,e){var t=function(e,t,a){this.name="markers",MapSVGAdminController.call(this,e,t,a)};e.MapSVGAdminMarkersController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.setEventHandlers=function(){var d=this;if(this.admin.hbData.isGeo){var e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("formatted_address"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"//maps.googleapis.com/maps/api/geocode/json?address=%QUERY%&sensor=true",wildcard:"%QUERY%",transform:function(e){return e.results},rateLimitWait:600}});m("#mapsvg-geocode .typeahead").typeahead(null,{name:"mapsvg-addresses",display:"formatted_address",source:e,minLength:2});m("#mapsvg-geocode .typeahead").on("typeahead:select",function(e,t){var a=m("#mapsvg-geocode img").attr("src");d.mapsvg.markerAdd({src:a,geoCoords:[t.geometry.location.lat,t.geometry.location.lng]},!0),m("#mapsvg-geocode .typeahead").typeahead("val","")})}this.view.on("click","a.editable",function(){m(this).parent();var a=m(this),e=a.width();m(this).hide();var r=m(this).text(),s=m(this).closest("tr"),t=s.data("marker-id"),i=d.mapsvg.getMarker(t),o=m('<input class="editable" value="'+r+'"/>');o.width(e),o.insertBefore(m(this)),o.select();var n=a.data("field");o.on("blur",function(){if(text=m(this).val(),r!=text){if("id"==n){text=text.replace(" ","_");var e=d.mapsvg.checkId(text);if(e.error)return m().message(e.error),!1}var t={};t[n]=text,a.html(text),i.update(t),"id"==n&&(d.mapsvg.updateMarkersDict(),s.attr("id","mapsvg-marker-"+text),s.data("marker-id",text))}a.show(),m(this).off().remove()}).on("keypress",function(e){13!=e.which&&13!=event.keyCode||(e.preventDefault(),m(this).blur().trigger("blur"))})}).on("click",".mapsvg-marker-delete",function(e){e.preventDefault();var t=m(this).closest("tr"),a=t.data("marker-id"),r=d.mapsvg.getMarker(a);d.mapsvg.markerDelete(r),t.fadeOut(300,function(){m(this).remove()})}),m("#mapsvg-geocode .mapsvg-marker-image-btn-trigger img").attr("src",MapSVG.markerImages[0].url),this.view.on("click",".mapsvg-link-btn",function(e){e.preventDefault();var t=m(this).parent(),a=m(this),r=m(this).closest("tr").data("marker-id"),s=d.mapsvg.getMarker(r),i=s.href,o=m('<input class="link-editable form-control" value="'+(s.href||"")+'"/>');t.append(o),a.addClass("opened"),o.select(),o.on("blur",function(){var e=m(this).val();e!=i&&(s.update({href:e}),e.length?a.addClass("active"):a.removeClass("active")),m(this).off().remove(),a.removeClass("opened")}).on("keypress",function(e){13!=e.which&&13!=event.keyCode||(e.preventDefault(),m(this).blur().trigger("blur"))})}),m("#mapsvg-markers-search input#mapsvg-markers-search-1").on("keyup",function(){var e=m(this).data("t");e&&clearTimeout(e);var r=this;m(this).data("t",setTimeout(function(){var e=m(r).val();if(m("#mapsvg-search-markers-no-matches").hide(),e.length){var t=d.mapsvg.searchMarkers(e);if(m("#table-markers tr").hide(),0<t.length)for(var a in t)m("#table-markers tr#mapsvg-marker-"+t[a]).show();else m("#mapsvg-search-markers-no-matches").show()}else m("#table-markers tr").show()},300))})},t.prototype.addMarker=function(e){var t=m(this.templates.item(e));m("#table-markers").prepend(t)}}(jQuery,window);
!function(t,a,e){MetaboxAdmin=function(a){this.mapOptions=a.mapOptions,this.isMetabox=!0,this.mapSchema=a.mapSchema,this.mapId=a.mapId,this.view=t("#"+a.containerId),this.mapContainerId=a.mapContainerId,this.$map=t("#"+a.mapContainerId),this.mapTitle=a.mapTitle,this.markerImages=a.markerImages,e.markerImages=a.markerImages,e.defaultMarkerImage=e.markerImages[0].url,this.dataObject=a.dataObject||{},this.postTypes=a.postTypes||[],this.init()},e.MetaboxAdmin=MetaboxAdmin,MetaboxAdmin.prototype.init=function(){var t=this,a=wp.media.frames.file_frame=wp.media({title:"Choose images",button:{text:"Choose images"},multiple:!0});this.mapOptions.afterLoad=function(){t.dataObject.marker&&(t.dataObject.marker=this.markerAdd(t.dataObject.marker)),t.formBuilder=new e.FormBuilder(t.mapSchema,!1,t.mapsvg,a,t.dataObject,t,"mapsvg"),t.formBuilder.on("update",function(a){t.updateDataObject(a)}),t.formBuilder.view.appendTo(t.view.find(".mapsvg-metabox-form"))},this.mapsvg=this.$map.mapSvg(this.mapOptions)},MetaboxAdmin.prototype.getPostTypes=function(){return this.postTypes}}(jQuery,window,MapSVG);
!function(t,n){var o=function(t,n,o){this.name="modal",this.content="",MapSVGAdminController.call(this,t,n,o)};n.MapSVGAdminModalController=o,MapSVG.extend(o,n.MapSVGAdminController),o.prototype.setContent=function(t){this.content=t},o.prototype.getTemplateData=function(){return{content:this.content}}}(jQuery,window);
!function(a,t){var e=function(t,e,r){this.name="regions",this.scrollable=!1,this.isParent=!0,MapSVGAdminController.call(this,t,e,r)};t.MapSVGAdminRegionsController=e,MapSVG.extend(e,t.MapSVGAdminController),e.prototype.viewLoaded=function(){var t=this;this.controllers.list=new MapSVGAdminRegionsListController("mapsvg-regions-list",t.admin,t.mapsvg),this.controllers.structure=new MapSVGAdminRegionsStructureController("mapsvg-regions-structure",t.admin,t.mapsvg),this.controllers.settings=new MapSVGAdminRegionsSettingsController("mapsvg-regions-settings",t.admin,t.mapsvg),this.controllers.csv=new MapSVGAdminRegionsCsvController("mapsvg-data-r-csv",t.admin,t.mapsvg),this.controllers.list.toolbarView=this.toolbarView,this.controllers.structure.toolbarView=this.toolbarView,this.controllers.csv.toolbarView=this.toolbarView,this.activeController=this.controllers.list,MapSVGAdminController.prototype.viewLoaded.call(this)},e.prototype.viewDidAppear=function(){MapSVGAdminController.prototype.viewDidAppear.call(this);var t=this;t.activeController&&t.activeController instanceof MapSVGAdminDatabaseStructureController&&(t.admin.rememberPanelsState(),t.admin.togglePanel("left",!1))},e.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this),this.admin.restorePanelsState()},e.prototype.setEventHandlers=function(){var i=this;a("#mapsvg-regions-menu a").click(function(t){t.preventDefault(),a(this).tab("show")}).on("shown.bs.tab",function(t){var e=a(a(this).attr("href")).data("controller");(i.activeController=e).viewDidAppear();var r=a(t.relatedTarget).attr("href");if(r){var o=a(r).attr("data-controller");i.controllers[o].viewDidDisappear()}"#mapsvg-regions-list"==a(this).attr("href")?i.toolbarView.find(".mapsvg-toolbar-buttons").show():i.toolbarView.find(".mapsvg-toolbar-buttons").hide(),"#mapsvg-regions-structure"==a(this).attr("href")?(i.admin.rememberPanelsState(),i.admin.togglePanel("left",!1)):i.admin.restorePanelsState()})}}(jQuery,window);
!function(t,e){var r=function(e,r,o){this.name="regions-csv",this.database=o.regionsDatabase,MapSVGAdminController.call(this,e,r,o)};e.MapSVGAdminRegionsCsvController=r,MapSVG.extend(r,e.MapSVGAdminController),r.prototype.setEventHandlers=function(){var o=this;this.view.find("#mapsvg-btn-r-csv-upload").on("click",function(){t(this);t("#mapsvg-r-csv-file")[0].files[0]?Papa.parse(t("#mapsvg-r-csv-file")[0].files[0],{header:!0,skipEmptyLines:!0,complete:function(e){if(0===e.errors.length)o.import(e.data);else{var r="Errors: \n";r+=e.errors.map(function(e){return e.message+(void 0!==e.row?" (row: "+e.row+")":"")}).slice(0,5).join("\n"),5<e.errors.length&&(r+="\n...and "+(e.errors.length-5)+" more. "),alert(r)}}}):t.growl.error({title:"",message:"Please choose a file"})})},r.prototype.import=function(e){var r=t("#mapsvg-btn-r-csv-upload");r._button("loading");this.database.import(e).done(function(e){t.growl.notice({title:"",message:"File uploaded"})}).always(function(){r._button("reset")}).fail(function(){t.growl.error({title:"",message:"Server error"})})}}(jQuery,window);
!function(l,i){var e=function(e,t,a){var i=this;this.name="regions-list",this.database=a.regionsDatabase,i.database.on("schemaChange",function(){i.redrawDataList()}),i.database.on("dataLoaded",function(){i.redrawDataList()}),MapSVGAdminController.call(this,e,t,a)};i.MapSVGAdminRegionsListController=e,MapSVG.extend(e,i.MapSVGAdminController),e.prototype.viewLoaded=function(){var e=this.database.getColumns();this.databaseTimestamp=Date.now();var t=this.toolbarView.find(".mapsvg-data-cols");t.empty(),e.forEach(function(e){t.append(l('<li class="'+(e.visible?"active":"")+'"><a href="#" data-field="'+e.name+'">'+e.name+"</a></li>"))})},e.prototype.getTemplateData=function(){var e=this,t=e.database.getLoaded(),a=e.mapsvg.getData().options.regions;return t.forEach(function(e){e.fill=a&&a[e.id]&&a[e.id].fill?a[e.id].fill:null}),{fields:e.getDataFieldsForTemplate(!0),data:t}},e.prototype.getDataFieldsForTemplate=function(t){var a=[{name:"id",visible:!0,type:"id"},{name:"title",visible:!0,type:"id"}],e=this.database.getSchema();return e&&e.forEach(function(e){return t?e.visible?a.push(e):void 0:a.push(e)}),a},e.prototype.setEventHandlers=function(){var t,n=this;this.toolbarView.on("click",".mapsvg-data-cols a",function(e){e.preventDefault(),l(this).closest("li").toggleClass("active");var t=n.database.getSchema(),a=l(this).data("field");for(var i in t)a==t[i].name&&(t[i].visible=!t[i].visible);n.database.saveSchema(t)}),this.view.on("click",".region-cpicker",function(e){e.preventDefault(),setTimeout(function(){n.view.addClass("mapsvg-cpicker-opened")},200);var o=l(this);n.colorpickerRegionBtn&&n.colorpickerRegionBtn.colorpicker("destroy"),n.colorpickerRegionBtn=o,n.colorpickerRegionId=l(this).closest(".mapsvg-data-row").data("region-id");var t=n.mapsvg.getOptions().regions[n.colorpickerRegionId],a=t?t.fill:"";n.colorpicker=o.colorpicker({template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-input-wrap"><input class="colorpicker-input" type="text"/><i></i></div><div class="colorpicker-reset-wrap"><button class="btn btn-xs btn-default colorpicker-reset">Reset</button><i></i></div></div>'}).colorpicker("show");var s=l(".colorpicker-input");l(".colorpicker-reset").on("click",function(){var e=n.colorpickerRegionId;n.mapsvg.getRegion(e).setFill(""),s.val(""),o.css({background:""}),o.colorpicker("destroy")}),a&&s.val(a),s.on("focus",function(){s.focused=!0}),s.on("blur",function(){s.focused=!1}),s.on("keyup paste",function(){var e=l(this).val();o.colorpicker("setValue",e)}),o.colorpicker().on("changeColor",function(e){var t,a=n.colorpickerRegionId,i=e.color.toRGB();t=1===i.a?e.color.toHex():"rgba("+i.r+","+i.g+","+i.b+","+i.a+")",n.mapsvg.getRegion(a).setFill(t),s.focused||s.val(t),o.css({background:t})}),a&&o.colorpicker("setValue",a),l(i).on("mousedown.colorpicker",function(e){l(e.target).not("input")&&(n.view.removeClass("mapsvg-cpicker-opened"),s.blur())})}),l("body").on("click",".colorpicker-input",function(){}),this.view.on("click",".mapsvg-link-btn",function(e){e.preventDefault();var t=l(this).parent(),a=l(this),i=l(this).closest("tr").data("region-id"),o=n.mapsvg.getRegion(i),s=o.href,r=l('<input class="link-editable form-control" value="'+(o.href||"")+'"/>');t.append(r),a.addClass("opened"),r.select(),r.on("blur",function(){var e=l(this).val();e!=s&&(o.update({href:e}),e.length?a.addClass("active"):a.removeClass("active")),l(this).off().remove(),a.removeClass("opened")}).on("keypress",function(e){13!=e.which&&13!=event.keyCode||(e.preventDefault(),l(this).blur().trigger("blur"))})}),l("#mapsvg-regions-search").on("keyup",function(){t&&clearTimeout(t);var e=this;t=setTimeout(function(){n.mapsvg.regionsDatabase.getAll({filters:{search:l(e).val()},searchFallback:!0}),n.redrawDataList()},300)}),this.view.on("mouseover",".mapsvg-data-row",function(){var e=l(this).data("region-id"),t=n.mapsvg.getRegion(e);t.selected||t.highlight()}).on("mouseout",".mapsvg-data-row",function(){var e=l(this).data("region-id"),t=n.mapsvg.getRegion(e);t.selected||t.unhighlight()}).on("click",".mapsvg-data-row",function(e){var t=l(e.target),a=l(this).data("region-id");if(!t.is(".btn")&&!t.parent().is(".btn"))if(void 0!==t.data("set-status")){var i=n.mapsvg.getRegion(a).data,o=t.data("set-status")+"";i.status=o,n.updateDataObject(i),t.closest("ul").find("li").removeClass("active"),t.parent().addClass("active"),t.closest("td").find(".mapsvg-status-text").html(t.text())}else{var s=n.mapsvg.getRegion(a);n.editRegion(s)}}),this.view.on("click",".mapsvg-data-btn",function(e){e.preventDefault();var t=l(this).closest("tr").data("region-id");l('#mapsvg-tabs-menu a[href="#tab_database"]').tab("show"),l("#mapsvg-data-search").val(t).trigger("keyup")})},e.prototype.updateDataRow=function(e,t){e.id_no_spaces=e.id.split(" ").join("_");var a=this.mapsvg.getData().options.regions,i={fields:this.database.getColumns({visible:!0}),params:e};i.id=e.id,i.id_no_spaces=e.id_no_spaces,i.fill=a&&a[i.id]&&a[i.id].fill?a[i.id].fill:null;var o=l(this.templates.item(i));(t=t||l("#mapsvg-region-"+e.id_no_spaces.replace(/(:|\(|\)|\.|\[|\]|,|=|@)/g,"\\$1"))).replaceWith(o),o.addClass("mapsvg-row-updated"),setTimeout(function(){o.removeClass("mapsvg-row-updated")},2600)},e.prototype.editRegion=function(e,t){var a=this,i=a.view.find("#mapsvg-region-"+e.id_no_spaces.replace(/(:|\(|\)|\.|\[|\]|,|=|@)/g,"\\$1"));a.tableDataActiveRow&&a.tableDataActiveRow.removeClass("mapsvg-row-selected"),e.selected||a.mapsvg.selectRegion(e);var o={};i&&(a.updateScroll(),t&&a.contentWrap.data("jsp").scrollToElement(i,!0,!1),a.tableDataActiveRow=i,a.tableDataActiveRow.addClass("mapsvg-row-selected"),l.extend(o,e.data,{id:e.id})),o._title=e.title,obj=o;var s=wp.media.frames.file_frame=wp.media({title:"Choose images",button:{text:"Choose images"},multiple:!0});a.formBuilder&&(a.formBuilder.destroy(),a.formBuilder=null,a.formBuilderRow&&a.formBuilderRow.remove()),a.formContainer&&a.formContainer.empty().remove(),a.formContainer=a.formContainer||l('<div class="mapsvg-modal-edit"></div>'),this.view.append(a.formContainer),obj.id,a.formBuilder=new MapSVG.FormBuilder({container:a.formContainer,schema:a.database.getSchema(),editMode:!1,mapsvg:a.mapsvg,mediaUploader:s,data:obj,admin:a.admin,events:{save:function(e){a.updateDataObject(e),this.close()},close:function(){a.closeFormHandler()}}})},e.prototype.updateDataObject=function(e){var t=this.mapsvg.getRegion(e.id),a={data:e};e.status&&(a.status=e.status),t.update(a),e.region_title=t.title||"",this.database.update(e).fail(function(){l.growl.error({title:"Server error",message:"Can't update region"})}),e.title=t.title||"",this.closeFormHandler(),this.updateDataRow(t.data)},e.prototype.closeFormHandler=function(){var e=this;e.formBuilder&&(e.formBuilder.destroy(),e.formBuilder=null,e.formContainer.empty().remove(),e.formBuilderRow&&e.formBuilderRow.remove()),l("a.browser").remove()},e.prototype.viewDidAppear=function(){MapSVGAdminController.prototype.viewDidAppear.call(this),this.databaseTimestamp<this.database.lastChangeTime&&this.redrawDataList()},e.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this),this.closeFormHandler()},e.prototype.redrawDataList=function(){this.redraw();var e=this.database.getColumns(),t=this.toolbarView.find(".mapsvg-data-cols");t.empty(),e.forEach(function(e){t.append(l('<li class="'+(e.visible?"active":"")+'"><a href="#" data-field="'+e.name+'">'+e.name+"</a></li>"))})}}(jQuery,window);
!function(t,e){var n=function(e,t,n){this.name="regions-settings",this.database=n.regionsDatabase,MapSVGAdminController.call(this,e,t,n)};e.MapSVGAdminRegionsSettingsController=n,MapSVG.extend(n,e.MapSVGAdminController),n.prototype.setEventHandlers=function(){var e=this;this.view.on("click","#mapsvg-clear-regions-btn",function(){confirm("Are you sure you want to clear the list of Regions?")&&e.database.clear().done(function(){t.growl.notice({title:"",message:"The list of Regions is cleared",duration:700})}).fail(function(){t.growl.error({title:"Server error",message:"Can't clear the list of regions"})})})}}(jQuery,window);
!function(a,t){var e=function(t,e,a,i){this.name="regions-structure",this.scrollable=!1,this.database=a.regionsDatabase,MapSVGAdminController.call(this,t,e,a)};t.MapSVGAdminRegionsStructureController=e,MapSVG.extend(e,t.MapSVGAdminController),e.prototype.viewDidAppear=function(){var e=this;MapSVGAdminController.prototype.viewDidAppear.call(this),e.formBuilder=new MapSVG.FormBuilder({schema:e.database.getSchema(),editMode:!0,mapsvg:e.mapsvg,admin:e.admin,container:this.contentView,types:["text","textarea","checkbox","radio","select","image","status","date","post"],events:{saveSchema:function(t){e.database.saveSchema(t).done(function(){(_status=e.database.getSchemaField("status"))&&(e.mapsvg.setRegionStatuses(_status.optionsDict),e.admin.save(!0)),a.growl.notice({title:"",message:"Settings saved",duration:700})}).fail(function(){a.growl.error({title:"Server error",message:"Can't save settings"})})},load:function(){setTimeout(function(){a("#mapsvg-btn-regions-structure").tooltip("show").tooltip("hide")},200)}}})},e.prototype.viewDidDisappear=function(){MapSVGAdminController.prototype.viewDidDisappear.call(this),this.formBuilder&&this.formBuilder.destroy()},e.prototype.setEventHandlers=function(){}}(jQuery,window);
!function(s,v){var t=function(t,e,a){this.name="settings",MapSVGAdminController.call(this,t,e,a)};v.MapSVGAdminSettingsController=t,MapSVG.extend(t,v.MapSVGAdminController),t.prototype.viewLoaded=function(){var e=this;this.view.find(".mapsvg-select2").mselect2(),e.updateGaugeFields(),e.mapsvg.regionsDatabase.on("schemaChange",function(){e.updateGaugeFields()}),zoomLimit=e.mapsvg.getData().options.zoom.limit,s("#mapsvg-controls-zoomlimit").ionRangeSlider({type:"double",grid:!0,min:-100,max:100,from_min:-100,from_max:0,to_min:1,to_max:100,onFinish:function(){var t=s("#mapsvg-controls-zoomlimit").val().split(";");e.mapsvg.update({zoom:{limit:[t[0],t[1]]}})},from:zoomLimit[0],to:zoomLimit[1]})},t.prototype.setEventHandlers=function(){var i=this;function e(t,e){var o="default"==t?mapsvg_paths.maps+e:mapsvg_paths.uploads+e;s.get(o,function(t){var e=s(t).find("svg"),a={svgDefault:{}};if(a.$svg=e,a.svgDefault.width=e.attr("width"),a.svgDefault.height=e.attr("height"),a.svgDefault.viewBox=e.attr("viewBox"),a.svgDefault.width&&a.svgDefault.height)a.svgDefault.width=parseFloat(a.svgDefault.width.replace(/px/g,"")),a.svgDefault.height=parseFloat(a.svgDefault.height.replace(/px/g,"")),a.svgDefault.viewBox=a.svgDefault.viewBox?a.svgDefault.viewBox.split(" "):[0,0,a.svgDefault.width,a.svgDefault.height];else{if(!a.svgDefault.viewBox)return alert("MapSVG needs width/height or viewBox parameter to be present in SVG file."),!1;a.svgDefault.viewBox=a.svgDefault.viewBox.split(" "),a.svgDefault.width=parseFloat(a.svgDefault.viewBox[2]),a.svgDefault.height=parseFloat(a.svgDefault.viewBox[3])}i.mapsvg.update({source:o,viewBox:a.svgDefault.viewBox,width:a.svgDefault.width,height:a.svgDefault.height}),i.admin.save(!0).done(function(){v.location.reload()})})}s("#mapsvg-controls-width").on("keyup",function(t){i.setHeight(t)}),s("#mapsvg-controls-height").on("keyup",function(t){i.setWidth(t)}),s("#mapsvg-controls-ratio").on("change",function(t){i.keepRatioClickHandler(t)}),s("#mapsvg-controls-set-viewbox").on("click",function(t){t.preventDefault();var e=i.mapsvg.getViewBox();s("#mapsvg-controls-viewbox").val(e.join(" ")).trigger("change")}),s("#mapsvg-controls-reset-viewbox").on("click",function(t){t.preventDefault();var e=i.mapsvg.getData().svgDefault.viewBox;s("#mapsvg-controls-viewbox").val(e.join(" ")).trigger("change"),i.mapsvg.viewBoxReset(!0)}),this.view.on("change","#mapsvg-header-control",function(){i.admin.resizeSVGCanvas()}),s("#mapsvg-controls-zoom").on("change",":radio",function(){MapSVG.parseBoolean(s("#mapsvg-controls-zoom :radio:checked").val())?s("#mapsvg-controls-zoom-options").show():s("#mapsvg-controls-zoom-options").hide(),i.admin.updateScroll()}),s("#mapsvg-controls-scroll").on("change",":radio",function(){MapSVG.parseBoolean(s("#mapsvg-controls-scroll :radio:checked").val())?s("#mapsvg-controls-scroll-options").show():s("#mapsvg-controls-scroll-options").hide(),i.admin.updateScroll()}),this.view.find("#mapsvg-gauge-control").on("change",":radio",function(){MapSVG.parseBoolean(s("#mapsvg-gauge-control").find(":radio:checked").val())?s("#table-regions").addClass("mapsvg-gauge-on"):s("#table-regions").removeClass("mapsvg-gauge-on")}),this.view.on("click","#mapsvg-set-prefix-btn",function(t){t.preventDefault(),i.admin.save().done(function(){v.location.reload()})}),this.view.on("click","#mapsvg-controls-file-remove",function(t){e("default","geo-calibrated/empty.svg")}),this.view.on("click","#mapsvg-controls-file-reload",function(t){i.mapsvg.getData().options.svgFileVersion++,i.admin.save(!0).done(function(){v.location.reload()})}),this.view.on("click","#mapsvg-controls-file-change",function(t){s("#mapsvg-hidden-file-select").show()}),this.view.on("click","#mapsvg-controls-file-hide",function(t){t.preventDefault(),s("#mapsvg-hidden-file-select").hide()}),this.view.find("#mapsvg-select2-map").mselect2().on("select2:select",function(){e(s(this).find("option:selected").data("package"),s(this).find("option:selected").data("path"))}),this.mapsvg.on("sizeChange",function(){i.admin.resizeDashboard()})},t.prototype.setWidth=function(){var t=this,e=s("#mapsvg-controls-width").val(),a=s("#mapsvg-controls-height").val();s("#mapsvg-controls-ratio").is(":checked")&&(e=Math.round(a*t.mapsvg.getData().svgDefault.width/t.mapsvg.getData().svgDefault.height),s("#mapsvg-controls-width").val(e)),t.mapsvg.viewBoxSetBySize(e,a),t.admin.resizeDashboard()},t.prototype.setHeight=function(){var t=this,e=s("#mapsvg-controls-width").val(),a=s("#mapsvg-controls-height").val();s("#mapsvg-controls-ratio").is(":checked")&&(a=Math.round(e*t.mapsvg.getData().svgDefault.height/t.mapsvg.getData().svgDefault.width),s("#mapsvg-controls-height").val(a)),t.mapsvg.viewBoxSetBySize(e,a),t.admin.resizeDashboard()},t.prototype.keepRatioClickHandler=function(){s("#mapsvg-controls-ratio").is(":checked")&&this.setHeight()},t.prototype.setWidthViewbox=function(){var t=this;if(s("#mapsvg-controls-ratio").is(":checked"))var e=t.mapsvg.getData().svgDefault.width/t.mapsvg.getData().svgDefault.height;else e=s("#map_width").val()/s("#map_height").val();var a=Math.round(s("#viewbox_height").val()*e);if(a>t.mapsvg.getData().svgDefault.viewBox[2]){a=t.mapsvg.getData().svgDefault.viewBox[2];var o=t.mapsvg.getData().svgDefault.viewBox[3]*e;s("#viewbox_height").val(o)}s("#viewbox_width").val(a)},t.prototype.setViewBoxRatio=function(){var t=s("#map_width").val()/s("#map_height").val(),e=s("#viewbox_width").val()/s("#viewbox_height").val();t!=e&&(e<=t?s("#viewbox_height").val(this.mapsvg.getData().svgDefault.viewBox[2]*t):s("#viewbox_width").val(this.mapsvg.getData().svgDefault.viewBox[3]/t))},t.prototype.setHeightViewbox=function(){var t=this;if(s("#mapsvg-controls-ratio").is(":checked"))var e=t.mapsvg.getData().svgDefault.height/t.mapsvg.getData().svgDefault.width;else e=s("#map_height").val()/s("#map_width").val();var a=Math.round(s("#viewbox_width").val()*e);if(a>t.mapsvg.getData().svgDefault.viewBox[3]){a=t.mapsvg.getData().svgDefault.viewBox[3];var o=t.mapsvg.getData().svgDefault.viewBox[2]*e;s("#viewbox_width").val(o)}s("#viewbox_height").val(a)},t.prototype.updateGaugeFields=function(){var t=this.mapsvg.regionsDatabase.getSchema(),e=this.mapsvg.getOptions().regionChoroplethField,a=this.view.find("#mapsvg-region-data-fields").empty();a.append("<option></option>"),t.forEach(function(t){a.append("<option "+(e==t.name?"selected":"")+">"+t.name+"</option>")}),a.trigger("change")}}(jQuery,window);
!function(i,e){var t=function(t,e,s){this.name="templates",this.disableHorizontalScroll=!0,MapSVGAdminController.call(this,t,e,s)};e.MapSVGAdminTemplatesController=t,MapSVG.extend(t,e.MapSVGAdminController),t.prototype.viewDidAppear=function(){this.setHints()},t.prototype.viewLoaded=function(){var t=this;t.setEditor(),i(e).on("resize.codemirror.tmpl",function(){t.resizeEditor()})},t.prototype.setEventHandlers=function(){var t=this;this.toolbarView.find("select").mselect2().on("change",function(){t.setEditor()})},t.prototype.setEditor=function(){var s=this;this.view.find("#mapsvg-template-container").empty(),this.template=this.toolbarView.find("select").val();var t=i('<textarea id="mapsvg-template-textarea" class="form-control" rows="8" name="templates['+this.template+']" data-live="change"></textarea>');t.val(this.mapsvg.getData().options.templates[this.template]),this.view.find("#mapsvg-template-container").append(t),s.setHints(),this.editor=CodeMirror.fromTextArea(t[0],{mode:{name:"handlebars",base:"text/html"},matchBrackets:!0,lineNumbers:!0}),this.editor.on("change",function(t,e){s.setTextareaValue(t,e)}),this.editor.on("inputRead",function(t,e){"{"==e.text[0]&&t.showHint({completeSingle:!1})}),s.resizeEditor()},t.prototype.resizeEditor=function(){this.view.find(".CodeMirror")[0].CodeMirror.setSize(null,this.contentWrap.height()),this.view.find(".CodeMirror").height(this.contentWrap.height())},t.prototype.getRegionHints=function(t){var e=t?"regions.0.":"",s=[];return s.push("{"+e+"id}}"),s.push("{"+e+"title}}"),this.mapsvg.regionsDatabase.getSchema().forEach(function(t){"image"==t.type?(s.push("{"+e+t.name+".0.thumbnail}}"),s.push("{"+e+t.name+".0.medium}}"),s.push("{"+e+t.name+".0.full}}")):"post"==t.type?(s.push("{"+e+"post.post_title}}"),s.push("{"+e+"post.content}}"),s.push("{"+e+"post.url}}")):(("select"==t.type||"radio"==t.type||"status"==t.type)&&s.push("{"+e+t.name+"_text}}"),s.push("{"+e+t.name+"}}"))}),t||(s=s.concat(this.getDBHints(!0))),s},t.prototype.getDBHints=function(e){var s=e?"objects.0.":"",a=[];a.push("{"+s+"id}}");var i=this;return this.mapsvg.database.getSchema().forEach(function(t){"post"==t.type?(a.push("{"+s+"post.post_title}}"),a.push("{"+s+"post.post_content}}"),a.push("{"+s+"post.url}}")):"location"==t.type?i.mapsvg.getData().mapIsGeo&&(a.push("{"+t.name+".address.formatted}}"),a.push("{"+t.name+".address.locality}}"),a.push("{"+t.name+".address.state}}"),a.push("{"+t.name+".address.state_short}}"),a.push("{"+t.name+".address.street_number}}"),a.push("{"+t.name+".address.route}}"),a.push("{"+t.name+".address.administrative_area_1}}"),a.push("{"+t.name+".address.administrative_area_1_short}}"),a.push("{"+t.name+".address.administrative_area_2}}"),a.push("{"+t.name+".address.administrative_area_2_short}}"),a.push("{"+t.name+".address.country}}"),a.push("{"+t.name+".address.zip}}"),a.push("{"+t.name+".address.postal_code}}"),a.push("{"+t.name+".lat}}"),a.push("{"+t.name+".lng}}")):"marker"==t.type?i.mapsvg.getData().mapIsGeo&&(a.push("{marker.geoCoords.[0]}}"),a.push("{marker.geoCoords.[1]}}")):"image"==t.type?(a.push("{"+s+t.name+".0.thumbnail}}"),a.push("{"+s+t.name+".0.medium}}"),a.push("{"+s+t.name+".0.full}}")):"region"==t.type?e||(a=a.concat(i.getRegionHints(!0))):(("select"==t.type||"radio"==t.type)&&a.push("{"+s+t.name+"_text}}"),a.push("{"+s+t.name+"}}"))}),a},t.prototype.setHints=function(){var t=("popoverRegion"==this.template||"tooltipRegion"==this.template||"detailsViewRegion"==this.template||"directoryItem"==this.template&&"regions"==this.mapsvg.getData().options.menu.source?this.getRegionHints():this.getDBHints()).concat([]);CodeMirror.registerHelper("hintWords","xml",t)},t.prototype.setTextareaValue=function(t,e){var s=t.getValue(),a=i(t.getTextArea());a.val(s).trigger("change"),"templates[labelMarker]"===a.attr("name")&&this.mapsvg.getData().options.labelsMarkers.on&&this.mapsvg.setLabelsMarkers(),"templates[labelRegion]"===a.attr("name")&&this.mapsvg.getData().options.labelsRegions.on&&this.mapsvg.setLabelsRegions()},t.prototype.init=function(){}}(jQuery,window);
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&"undefined"!=typeof exports?module.exports=t():e.Papa=t()}(this,function(){"use strict";var s,e,u="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==u?u:{},r=!u.document&&!!u.postMessage,o=r&&/(\?|&)papaworker(=|&|$)/.test(u.location.search),a=!1,h={},f=0,k={parse:function(e,t){var i=(t=t||{}).dynamicTyping||!1;if(M(i)&&(t.dynamicTypingFunction=i,i={}),t.dynamicTyping=i,t.transform=!!M(t.transform)&&t.transform,t.worker&&k.WORKERS_SUPPORTED){var n=function(){if(!k.WORKERS_SUPPORTED)return!1;if(!a&&null===k.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var e=k.SCRIPT_PATH||s;e+=(-1!==e.indexOf("?")?"&":"?")+"papaworker";var t=new u.Worker(e);return t.onmessage=v,t.id=f++,h[t.id]=t}();return n.userStep=t.step,n.userChunk=t.chunk,n.userComplete=t.complete,n.userError=t.error,t.step=M(t.step),t.chunk=M(t.chunk),t.complete=M(t.complete),t.error=M(t.error),delete t.worker,void n.postMessage({input:e,config:t,workerId:n.id})}var r=null;return e===k.NODE_STREAM_INPUT?(r=new g(t)).getStream():("string"==typeof e?r=t.download?new l(t):new _(t):!0===e.readable&&M(e.read)&&M(e.on)?r=new m(t):(u.File&&e instanceof File||e instanceof Object)&&(r=new p(t)),r.stream(e))},unparse:function(e,t){var i=!1,f=!0,d=",",c="\r\n",n='"';"object"==typeof t&&("string"!=typeof t.delimiter||k.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(d=t.delimiter),("boolean"==typeof t.quotes||t.quotes instanceof Array)&&(i=t.quotes),"string"==typeof t.newline&&(c=t.newline),"string"==typeof t.quoteChar&&(n=t.quoteChar),"boolean"==typeof t.header&&(f=t.header));var r=new RegExp(n,"g");if("string"==typeof e&&(e=JSON.parse(e)),e instanceof Array){if(!e.length||e[0]instanceof Array)return a(null,e);if("object"==typeof e[0])return a(s(e[0]),e)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),e.data instanceof Array&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=e.data[0]instanceof Array?e.fields:s(e.data[0])),e.data[0]instanceof Array||"object"==typeof e.data[0]||(e.data=[e.data])),a(e.fields||[],e.data||[]);throw"exception: Unable to serialize unrecognized input";function s(e){if("object"!=typeof e)return[];var t=[];for(var i in e)t.push(i);return t}function a(e,t){var i="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var n=e instanceof Array&&0<e.length,r=!(t[0]instanceof Array);if(n&&f){for(var s=0;s<e.length;s++)0<s&&(i+=d),i+=l(e[s],s);0<t.length&&(i+=c)}for(var a=0;a<t.length;a++){for(var o=n?e.length:t[a].length,h=0;h<o;h++){0<h&&(i+=d);var u=n&&r?e[h]:h;i+=l(t[a][u],h)}a<t.length-1&&(i+=c)}return i}function l(e,t){return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(e=e.toString().replace(r,n+n),"boolean"==typeof i&&i||i instanceof Array&&i[t]||function(e,t){for(var i=0;i<t.length;i++)if(-1<e.indexOf(t[i]))return!0;return!1}(e,k.BAD_DELIMITERS)||-1<e.indexOf(d)||" "===e.charAt(0)||" "===e.charAt(e.length-1)?n+e+n:e)}}};if(k.RECORD_SEP=String.fromCharCode(30),k.UNIT_SEP=String.fromCharCode(31),k.BYTE_ORDER_MARK="\ufeff",k.BAD_DELIMITERS=["\r","\n",'"',k.BYTE_ORDER_MARK],k.WORKERS_SUPPORTED=!r&&!!u.Worker,k.SCRIPT_PATH=null,k.NODE_STREAM_INPUT=1,k.LocalChunkSize=10485760,k.RemoteChunkSize=5242880,k.DefaultDelimiter=",",k.Parser=C,k.ParserHandle=i,k.NetworkStreamer=l,k.FileStreamer=p,k.StringStreamer=_,k.ReadableStreamStreamer=m,k.DuplexStreamStreamer=g,u.jQuery){var d=u.jQuery;d.fn.parse=function(a){var i=a.config||{},o=[];return this.each(function(e){if("INPUT"!==d(this).prop("tagName").toUpperCase()||"file"!==d(this).attr("type").toLowerCase()||!u.FileReader||!this.files||0===this.files.length)return!0;for(var t=0;t<this.files.length;t++)o.push({file:this.files[t],inputElem:this,instanceConfig:d.extend({},i)})}),e(),this;function e(){if(0!==o.length){var e,t,i,n=o[0];if(M(a.before)){var r=a.before(n.file,n.inputElem);if("object"==typeof r){if("abort"===r.action)return"AbortError",e=n.file,t=n.inputElem,i=r.reason,void(M(a.error)&&a.error({name:"AbortError"},e,t,i));if("skip"===r.action)return void h();"object"==typeof r.config&&(n.instanceConfig=d.extend(n.instanceConfig,r.config))}else if("skip"===r)return void h()}var s=n.instanceConfig.complete;n.instanceConfig.complete=function(e){M(s)&&s(e,n.file,n.inputElem),h()},k.parse(n.file,n.instanceConfig)}else M(a.complete)&&a.complete()}function h(){o.splice(0,1),e()}}}function c(e){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=E(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new i(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){if(this.isFirstChunk&&M(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1;var n=this._partialLine+e;this._partialLine="";var r=this._handle.parse(n,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=r.meta.cursor;this._finished||(this._partialLine=n.substring(s-this._baseIndex),this._baseIndex=s),r&&r.data&&(this._rowCount+=r.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)u.postMessage({results:r,workerId:k.WORKER_ID,finished:a});else if(M(this._config.chunk)&&!t){if(this._config.chunk(r,this._handle),this._handle.paused()||this._handle.aborted())return;r=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(r.data),this._completeResults.errors=this._completeResults.errors.concat(r.errors),this._completeResults.meta=r.meta),this._completed||!a||!M(this._config.complete)||r&&r.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),a||r&&r.meta.paused||this._nextChunk(),r}},this._sendError=function(e){M(this._config.error)?this._config.error(e):o&&this._config.error&&u.postMessage({workerId:k.WORKER_ID,error:e,finished:!1})}}function l(e){var n;(e=e||{}).chunkSize||(e.chunkSize=k.RemoteChunkSize),c.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(n=new XMLHttpRequest,this._config.withCredentials&&(n.withCredentials=this._config.withCredentials),r||(n.onload=R(this._chunkLoaded,this),n.onerror=R(this._chunkError,this)),n.open("GET",this._input,!r),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var t in e)n.setRequestHeader(t,e[t])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;n.setRequestHeader("Range","bytes="+this._start+"-"+i),n.setRequestHeader("If-None-Match","webkit-no-cache")}try{n.send()}catch(e){this._chunkError(e.message)}r&&0===n.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){var e;4===n.readyState&&(n.status<200||400<=n.status?this._chunkError():(this._finished=!this._config.chunkSize||this._start>(null===(e=n.getResponseHeader("Content-Range"))?-1:parseInt(e.substr(e.lastIndexOf("/")+1))),this.parseChunk(n.responseText)))},this._chunkError=function(e){var t=n.statusText||e;this._sendError(new Error(t))}}function p(e){var n,r;(e=e||{}).chunkSize||(e.chunkSize=k.LocalChunkSize),c.call(this,e);var s="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,s?((n=new FileReader).onload=R(this._chunkLoaded,this),n.onerror=R(this._chunkError,this)):n=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var t=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,t)}var i=n.readAsText(e,this._config.encoding);s||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(n.error)}}function _(e){var i;c.call(this,e=e||{}),this.stream=function(e){return i=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e=this._config.chunkSize,t=e?i.substr(0,e):i;return i=e?i.substr(e):"",this._finished=!i,this.parseChunk(t)}}}function m(e){c.call(this,e=e||{});var t=[],i=!0,n=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=R(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=R(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=R(function(){this._streamCleanUp(),n=!0,this._streamData("")},this),this._streamCleanUp=R(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function g(e){var t=require("stream").Duplex,i=E(e),n=!0,r=!1,s=[],a=null;this._onCsvData=function(e){for(var t=e.data,i=0;i<t.length;i++)a.push(t[i])||this._handle.paused()||this._handle.pause()},this._onCsvComplete=function(){a.push(null)},i.step=R(this._onCsvData,this),i.complete=R(this._onCsvComplete,this),c.call(this,i),this._nextChunk=function(){r&&1===s.length&&(this._finished=!0),s.length?s.shift()():n=!0},this._addToParseQueue=function(e,t){s.push(R(function(){if(this.parseChunk("string"==typeof e?e:e.toString(i.encoding)),M(t))return t()},this)),n&&(n=!1,this._nextChunk())},this._onRead=function(){this._handle.paused()&&this._handle.resume()},this._onWrite=function(e,t,i){this._addToParseQueue(e,i)},this._onWriteComplete=function(){r=!0,this._addToParseQueue("")},this.getStream=function(){return a},(a=new t({readableObjectMode:!0,decodeStrings:!1,read:R(this._onRead,this),write:R(this._onWrite,this)})).once("finish",R(this._onWriteComplete,this))}function i(m){var a,o,h,u=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,f=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,t=this,i=0,d=0,c=!1,e=!1,l=[],p={data:[],errors:[],meta:{}};if(M(m.step)){var n=m.step;m.step=function(e){if(p=e,r())_();else{if(_(),0===p.data.length)return;i+=e.data.length,m.preview&&i>m.preview?o.abort():n(p,t)}}}function g(e){return"greedy"===m.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function _(){if(p&&h&&(v("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+k.DefaultDelimiter+"'"),h=!1),m.skipEmptyLines)for(var e=0;e<p.data.length;e++)g(p.data[e])&&p.data.splice(e--,1);return r()&&function(){if(p){for(var e=0;r()&&e<p.data.length;e++)for(var t=0;t<p.data[e].length;t++){var i=p.data[e][t];m.trimHeaders&&(i=i.trim()),l.push(i)}p.data.splice(0,1)}}(),function(){if(!p||!m.header&&!m.dynamicTyping&&!m.transform)return p;for(var e=0;e<p.data.length;e++){var t,i=m.header?{}:[];for(t=0;t<p.data[e].length;t++){var n=t,r=p.data[e][t];m.header&&(n=t>=l.length?"__parsed_extra":l[t]),m.transform&&(r=m.transform(r,n)),s=r,a=void 0,a=n,m.dynamicTypingFunction&&void 0===m.dynamicTyping[a]&&(m.dynamicTyping[a]=m.dynamicTypingFunction(a)),r=!0===(m.dynamicTyping[a]||m.dynamicTyping)?"true"===s||"TRUE"===s||"false"!==s&&"FALSE"!==s&&(u.test(s)?parseFloat(s):f.test(s)?new Date(s):""===s?null:s):s,"__parsed_extra"===n?(i[n]=i[n]||[],i[n].push(r)):i[n]=r}p.data[e]=i,m.header&&(t>l.length?v("FieldMismatch","TooManyFields","Too many fields: expected "+l.length+" fields but parsed "+t,d+e):t<l.length&&v("FieldMismatch","TooFewFields","Too few fields: expected "+l.length+" fields but parsed "+t,d+e))}var s,a;return m.header&&p.meta&&(p.meta.fields=l),d+=p.data.length,p}()}function r(){return m.header&&0===l.length}function v(e,t,i,n){p.errors.push({type:e,code:t,message:i,row:n})}this.parse=function(e,t,i){var n=m.quoteChar||'"';if(m.newline||(m.newline=function(e,t){e=e.substr(0,1048576);var i=new RegExp(y(t)+"([^]*?)"+y(t),"gm"),n=(e=e.replace(i,"")).split("\r"),r=e.split("\n"),s=1<r.length&&r[0].length<n[0].length;if(1===n.length||s)return"\n";for(var a=0,o=0;o<n.length;o++)"\n"===n[o][0]&&a++;return a>=n.length/2?"\r\n":"\r"}(e,n)),h=!1,m.delimiter)M(m.delimiter)&&(m.delimiter=m.delimiter(e),p.meta.delimiter=m.delimiter);else{var r=function(e,t,i,n){for(var r,s,a,o=[",","\t","|",";",k.RECORD_SEP,k.UNIT_SEP],h=0;h<o.length;h++){var u=o[h],f=0,d=0,c=0;a=void 0;for(var l=new C({comments:n,delimiter:u,newline:t,preview:10}).parse(e),p=0;p<l.data.length;p++)if(i&&g(l.data[p]))c++;else{var _=l.data[p].length;d+=_,void 0!==a?1<_&&(f+=Math.abs(_-a),a=_):a=_}0<l.data.length&&(d/=l.data.length-c),(void 0===s||f<s)&&1.99<d&&(s=f,r=u)}return{successful:!!(m.delimiter=r),bestDelimiter:r}}(e,m.newline,m.skipEmptyLines,m.comments);r.successful?m.delimiter=r.bestDelimiter:(h=!0,m.delimiter=k.DefaultDelimiter),p.meta.delimiter=m.delimiter}var s=E(m);return m.preview&&m.header&&s.preview++,a=e,o=new C(s),p=o.parse(a,t,i),_(),c?{meta:{paused:!0}}:p||{meta:{paused:!1}}},this.paused=function(){return c},this.pause=function(){c=!0,o.abort(),a=a.substr(o.getCharIndex())},this.resume=function(){c=!1,t.streamer.parseChunk(a,!0)},this.aborted=function(){return e},this.abort=function(){e=!0,o.abort(),p.meta.aborted=!0,M(m.complete)&&m.complete(p),a=""}}function y(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C(e){var S,x=(e=e||{}).delimiter,T=e.newline,O=e.comments,I=e.step,D=e.preview,P=e.fastMode,A=S=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(A=e.escapeChar),("string"!=typeof x||-1<k.BAD_DELIMITERS.indexOf(x))&&(x=","),O===x)throw"Comment character same as delimiter";!0===O?O="#":("string"!=typeof O||-1<k.BAD_DELIMITERS.indexOf(O))&&(O=!1),"\n"!==T&&"\r"!==T&&"\r\n"!==T&&(T="\n");var L=0,F=!1;this.parse=function(n,t,i){if("string"!=typeof n)throw"Input must be a string";var r=n.length,e=x.length,s=T.length,a=O.length,o=M(I),h=[],u=[],f=[],d=L=0;if(!n)return E();if(P||!1!==P&&-1===n.indexOf(S)){for(var c=n.split(T),l=0;l<c.length;l++){if(f=c[l],L+=f.length,l!==c.length-1)L+=T.length;else if(i)return E();if(!O||f.substr(0,a)!==O){if(o){if(h=[],y(f.split(x)),R(),F)return E()}else y(f.split(x));if(D&&D<=l)return h=h.slice(0,D),E(!0)}}return E()}for(var p,_=n.indexOf(x,L),m=n.indexOf(T,L),g=new RegExp(A.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")+S,"g");;)if(n[L]!==S)if(O&&0===f.length&&n.substr(L,a)===O){if(-1===m)return E();L=m+s,m=n.indexOf(T,L),_=n.indexOf(x,L)}else if(-1!==_&&(_<m||-1===m))f.push(n.substring(L,_)),L=_+e,_=n.indexOf(x,L);else{if(-1===m)break;if(f.push(n.substring(L,m)),w(m+s),o&&(R(),F))return E();if(D&&h.length>=D)return E(!0)}else for(p=L,L++;;){if(-1===(p=n.indexOf(S,p+1)))return i||u.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:h.length,index:L}),b();if(p===r-1)return b(n.substring(L,p).replace(g,S));if(S!==A||n[p+1]!==A){if(S===A||0===p||n[p-1]!==A){var v=C(-1===m?_:Math.min(_,m));if(n[p+1+v]===x){f.push(n.substring(L,p).replace(g,S)),L=p+1+v+e,_=n.indexOf(x,L),m=n.indexOf(T,L);break}var k=C(m);if(n.substr(p+1+k,s)===T){if(f.push(n.substring(L,p).replace(g,S)),w(p+1+k+s),_=n.indexOf(x,L),o&&(R(),F))return E();if(D&&h.length>=D)return E(!0);break}u.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:h.length,index:L}),p++}}else p++}return b();function y(e){h.push(e),d=L}function C(e){var t=0;if(-1!==e){var i=n.substring(p+1,e);i&&""===i.trim()&&(t=i.length)}return t}function b(e){return i||(void 0===e&&(e=n.substr(L)),f.push(e),L=r,y(f),o&&R()),E()}function w(e){L=e,y(f),f=[],m=n.indexOf(T,L)}function E(e){return{data:h,errors:u,meta:{delimiter:x,linebreak:T,aborted:F,truncated:!!e,cursor:d+(t||0)}}}function R(){I(E()),h=[],u=[]}},this.abort=function(){F=!0},this.getCharIndex=function(){return L}}function v(e){var t=e.data,i=h[t.workerId],n=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var r={abort:function(){n=!0,b(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:w,resume:w};if(M(i.userStep)){for(var s=0;s<t.results.data.length&&(i.userStep({data:[t.results.data[s]],errors:t.results.errors,meta:t.results.meta},r),!n);s++);delete t.results}else M(i.userChunk)&&(i.userChunk(t.results,r,t.file),delete t.results)}t.finished&&!n&&b(t.workerId,t.results)}function b(e,t){var i=h[e];M(i.userComplete)&&i.userComplete(t),i.terminate(),delete h[e]}function w(){throw"Not implemented."}function E(e){if("object"!=typeof e||null===e)return e;var t=e instanceof Array?[]:{};for(var i in e)t[i]=E(e[i]);return t}function R(e,t){return function(){e.apply(t,arguments)}}function M(e){return"function"==typeof e}return o?u.onmessage=function(e){var t=e.data;if(void 0===k.WORKER_ID&&t&&(k.WORKER_ID=t.workerId),"string"==typeof t.input)u.postMessage({workerId:k.WORKER_ID,results:k.parse(t.input,t.config),finished:!0});else if(u.File&&t.input instanceof File||t.input instanceof Object){var i=k.parse(t.input,t.config);i&&u.postMessage({workerId:k.WORKER_ID,results:i,finished:!0})}}:k.WORKERS_SUPPORTED&&(e=document.getElementsByTagName("script"),s=e.length?e[e.length-1].src:"",document.body?document.addEventListener("DOMContentLoaded",function(){a=!0},!0):a=!0),(l.prototype=Object.create(c.prototype)).constructor=l,(p.prototype=Object.create(c.prototype)).constructor=p,(_.prototype=Object.create(_.prototype)).constructor=_,(m.prototype=Object.create(c.prototype)).constructor=m,(g.prototype=Object.create(c.prototype)).constructor=g,k});
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(t){"use strict";var e=jQuery.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||2<e[0])throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 3")}(),function(o){"use strict";o.fn.emulateTransitionEnd=function(t){var e=!1,i=this;o(this).one("bsTransitionEnd",function(){e=!0});return setTimeout(function(){e||o(i).trigger(o.support.transition.end)},t),this},o(function(){o.support.transition=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}(),o.support.transition&&(o.event.special.bsTransitionEnd={bindType:o.support.transition.end,delegateType:o.support.transition.end,handle:function(t){return o(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),function(s){"use strict";var e='[data-dismiss="alert"]',a=function(t){s(t).on("click",e,this.close)};a.VERSION="3.3.6",a.TRANSITION_DURATION=150,a.prototype.close=function(t){function e(){n.detach().trigger("closed.bs.alert").remove()}var i=s(this),o=i.attr("data-target");o||(o=(o=i.attr("href"))&&o.replace(/.*(?=#[^\s]*$)/,""));var n=s(o);t&&t.preventDefault(),n.length||(n=i.closest(".alert")),n.trigger(t=s.Event("close.bs.alert")),t.isDefaultPrevented()||(n.removeClass("in"),s.support.transition&&n.hasClass("fade")?n.one("bsTransitionEnd",e).emulateTransitionEnd(a.TRANSITION_DURATION):e())};var t=s.fn.alert;s.fn.alert=function(i){return this.each(function(){var t=s(this),e=t.data("bs.alert");e||t.data("bs.alert",e=new a(this)),"string"==typeof i&&e[i].call(t)})},s.fn.alert.Constructor=a,s.fn.alert.noConflict=function(){return s.fn.alert=t,this},s(document).on("click.bs.alert.data-api",e,a.prototype.close)}(jQuery),function(s){"use strict";function i(o){return this.each(function(){var t=s(this),e=t.data("bs.button"),i="object"==typeof o&&o;e||t.data("bs.button",e=new n(this,i)),"toggle"==o?e.toggle():o&&e.setState(o)})}var n=function(t,e){this.$element=s(t),this.options=s.extend({},n.DEFAULTS,e),this.isLoading=!1};n.VERSION="3.3.6",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(t){var e="disabled",i=this.$element,o=i.is("input")?"val":"html",n=i.data();t+="Text",null==n.resetText&&i.data("resetText",i[o]()),setTimeout(s.proxy(function(){i[o](null==n[t]?this.options[t]:n[t]),"loadingText"==t?(this.isLoading=!0,i.addClass(e).attr(e,e)):this.isLoading&&(this.isLoading=!1,i.removeClass(e).removeAttr(e))},this),0)},n.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")?(i.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==i.prop("type")&&(i.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),i.prop("checked",this.$element.hasClass("active")),t&&i.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var t=s.fn._button;s.fn._button=i,s.fn._button.Constructor=n,s.fn._button.noConflict=function(){return s.fn._button=t,this},s(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var e=s(t.target);e.hasClass("btn")||(e=e.closest(".btn")),i.call(e,"toggle"),s(t.target).is('input[type="radio"]')||s(t.target).is('input[type="checkbox"]')||t.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){s(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),function(p){"use strict";function a(n){return this.each(function(){var t=p(this),e=t.data("bs.carousel"),i=p.extend({},c.DEFAULTS,t.data(),"object"==typeof n&&n),o="string"==typeof n?n:i.slide;e||t.data("bs.carousel",e=new c(this,i)),"number"==typeof n?e.to(n):o?e[o]():i.interval&&e.pause().cycle()})}var c=function(t,e){this.$element=p(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=e,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",p.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",p.proxy(this.pause,this)).on("mouseleave.bs.carousel",p.proxy(this.cycle,this))};c.VERSION="3.3.6",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},c.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(p.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},c.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e);if(("prev"==t&&0===i||"next"==t&&i==this.$items.length-1)&&!this.options.wrap)return e;var o=(i+("prev"==t?-1:1))%this.$items.length;return this.$items.eq(o)},c.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||t<0?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(i<t?"next":"prev",this.$items.eq(t))},c.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&p.support.transition&&(this.$element.trigger(p.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){return this.sliding?void 0:this.slide("next")},c.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},c.prototype.slide=function(t,e){var i=this.$element.find(".item.active"),o=e||this.getItemForDirection(t,i),n=this.interval,s="next"==t?"left":"right",a=this;if(o.hasClass("active"))return this.sliding=!1;var r=o[0],l=p.Event("slide.bs.carousel",{relatedTarget:r,direction:s});if(this.$element.trigger(l),!l.isDefaultPrevented()){if(this.sliding=!0,n&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var h=p(this.$indicators.children()[this.getItemIndex(o)]);h&&h.addClass("active")}var d=p.Event("slid.bs.carousel",{relatedTarget:r,direction:s});return p.support.transition&&this.$element.hasClass("slide")?(o.addClass(t),o[0].offsetWidth,i.addClass(s),o.addClass(s),i.one("bsTransitionEnd",function(){o.removeClass([t,s].join(" ")).addClass("active"),i.removeClass(["active",s].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger(d)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(i.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger(d)),n&&this.cycle(),this}};var t=p.fn.carousel;p.fn.carousel=a,p.fn.carousel.Constructor=c,p.fn.carousel.noConflict=function(){return p.fn.carousel=t,this};var e=function(t){var e,i=p(this),o=p(i.attr("data-target")||(e=i.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,""));if(o.hasClass("carousel")){var n=p.extend({},o.data(),i.data()),s=i.attr("data-slide-to");s&&(n.interval=!1),a.call(o,n),s&&o.data("bs.carousel").to(s),t.preventDefault()}};p(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),p(window).on("load",function(){p('[data-ride="carousel"]').each(function(){var t=p(this);a.call(t,t.data())})})}(jQuery),function(a){"use strict";function n(t){var e,i=t.attr("data-target")||(e=t.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"");return a(i)}function r(o){return this.each(function(){var t=a(this),e=t.data("bs.collapse"),i=a.extend({},l.DEFAULTS,t.data(),"object"==typeof o&&o);!e&&i.toggle&&/show|hide/.test(o)&&(i.toggle=!1),e||t.data("bs.collapse",e=new l(this,i)),"string"==typeof o&&e[o]()})}var l=function(t,e){this.$element=a(t),this.options=a.extend({},l.DEFAULTS,e),this.$trigger=a('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};l.VERSION="3.3.6",l.TRANSITION_DURATION=350,l.DEFAULTS={toggle:!0},l.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},l.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&((t=e.data("bs.collapse"))&&t.transitioning))){var i=a.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){e&&e.length&&(r.call(e,"hide"),t||e.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var n=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return n.call(this);var s=a.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",a.proxy(n,this)).emulateTransitionEnd(l.TRANSITION_DURATION)[o](this.$element[0][s])}}}},l.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=a.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var e=this.dimension();this.$element[e](this.$element[e]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[e](0).one("bsTransitionEnd",a.proxy(i,this)).emulateTransitionEnd(l.TRANSITION_DURATION):i.call(this)}}},l.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},l.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(t,e){var i=a(e);this.addAriaAndCollapsedClass(n(i),i)},this)).end()},l.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var t=a.fn.collapse;a.fn.collapse=r,a.fn.collapse.Constructor=l,a.fn.collapse.noConflict=function(){return a.fn.collapse=t,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var e=a(this);e.attr("data-target")||t.preventDefault();var i=n(e),o=i.data("bs.collapse")?"toggle":e.data();r.call(i,o)})}(jQuery),function(a){"use strict";function r(t){var e=t.attr("data-target");e||(e=(e=t.attr("href"))&&/#[A-Za-z]/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var i=e&&a(e);return i&&i.length?i:t.parent()}function s(o){o&&3===o.which||(a(".dropdown-backdrop").remove(),a(l).each(function(){var t=a(this),e=r(t),i={relatedTarget:this};e.hasClass("open")&&(o&&"click"==o.type&&/input|textarea/i.test(o.target.tagName)&&a.contains(e[0],o.target)||(e.trigger(o=a.Event("hide.bs.dropdown",i)),o.isDefaultPrevented()||(t.attr("aria-expanded","false"),e.removeClass("open").trigger(a.Event("hidden.bs.dropdown",i)))))}))}var l='[data-toggle="dropdown"]',o=function(t){a(t).on("click.bs.dropdown",this.toggle)};o.VERSION="3.3.6",o.prototype.toggle=function(t){var e=a(this);if(!e.is(".disabled, :disabled")){var i=r(e),o=i.hasClass("open");if(s(),!o){"ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",s);var n={relatedTarget:this};if(i.trigger(t=a.Event("show.bs.dropdown",n)),t.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger(a.Event("shown.bs.dropdown",n))}return!1}},o.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var e=a(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=r(e),o=i.hasClass("open");if(!o&&27!=t.which||o&&27==t.which)return 27==t.which&&i.find(l).trigger("focus"),e.trigger("click");var n=i.find(".dropdown-menu li:not(.disabled):visible a");if(n.length){var s=n.index(t.target);38==t.which&&0<s&&s--,40==t.which&&s<n.length-1&&s++,~s||(s=0),n.eq(s).trigger("focus")}}}};var t=a.fn.dropdown;a.fn.dropdown=function(i){return this.each(function(){var t=a(this),e=t.data("bs.dropdown");e||t.data("bs.dropdown",e=new o(this)),"string"==typeof i&&e[i].call(t)})},a.fn.dropdown.Constructor=o,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=t,this},a(document).on("click.bs.dropdown.data-api",s).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",l,o.prototype.toggle).on("keydown.bs.dropdown.data-api",l,o.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",o.prototype.keydown)}(jQuery),function(s){"use strict";function a(o,n){return this.each(function(){var t=s(this),e=t.data("bs.modal"),i=s.extend({},r.DEFAULTS,t.data(),"object"==typeof o&&o);e||t.data("bs.modal",e=new r(this,i)),"string"==typeof o?e[o](n):i.show&&e.show(n)})}var r=function(t,e){this.options=e,this.$body=s(document.body),this.$element=s(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,s.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};r.VERSION="3.3.6",r.TRANSITION_DURATION=300,r.BACKDROP_TRANSITION_DURATION=150,r.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},r.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},r.prototype.show=function(i){var o=this,t=s.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(t),this.isShown||t.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',s.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){o.$element.one("mouseup.dismiss.bs.modal",function(t){s(t.target).is(o.$element)&&(o.ignoreBackdropClick=!0)})}),this.backdrop(function(){var t=s.support.transition&&o.$element.hasClass("fade");o.$element.parent().length||o.$element.appendTo(o.$body),o.$element.show().scrollTop(0),o.adjustDialog(),t&&o.$element[0].offsetWidth,o.$element.addClass("in"),o.enforceFocus();var e=s.Event("shown.bs.modal",{relatedTarget:i});t?o.$dialog.one("bsTransitionEnd",function(){o.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(r.TRANSITION_DURATION):o.$element.trigger("focus").trigger(e)}))},r.prototype.hide=function(t){t&&t.preventDefault(),t=s.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),s(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),s.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",s.proxy(this.hideModal,this)).emulateTransitionEnd(r.TRANSITION_DURATION):this.hideModal())},r.prototype.enforceFocus=function(){s(document).off("focusin.bs.modal").on("focusin.bs.modal",s.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},r.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",s.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},r.prototype.resize=function(){this.isShown?s(window).on("resize.bs.modal",s.proxy(this.handleUpdate,this)):s(window).off("resize.bs.modal")},r.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},r.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},r.prototype.backdrop=function(t){var e=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=s.support.transition&&i;if(this.$backdrop=s(document.createElement("div")).addClass("modal-backdrop "+i).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",s.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;o?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(r.BACKDROP_TRANSITION_DURATION):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var n=function(){e.removeBackdrop(),t&&t()};s.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(r.BACKDROP_TRANSITION_DURATION):n()}else t&&t()},r.prototype.handleUpdate=function(){this.adjustDialog()},r.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},r.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},r.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},r.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},r.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},r.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var t=s.fn.modal;s.fn.modal=a,s.fn.modal.Constructor=r,s.fn.modal.noConflict=function(){return s.fn.modal=t,this},s(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var e=s(this),i=e.attr("href"),o=s(e.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),n=o.data("bs.modal")?"toggle":s.extend({remote:!/#/.test(i)&&i},o.data(),e.data());e.is("a")&&t.preventDefault(),o.one("show.bs.modal",function(t){t.isDefaultPrevented()||o.one("hidden.bs.modal",function(){e.is(":visible")&&e.trigger("focus")})}),a.call(o,n,this)})}(jQuery),function(g){"use strict";var v=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};v.VERSION="3.3.6",v.TRANSITION_DURATION=150,v.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},v.prototype.init=function(t,e,i){if(this.enabled=!0,this.type=t,this.$element=g(e),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&g(g.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),n=o.length;n--;){var s=o[n];if("click"==s)this.$element.on("click."+this.type,this.options.selector,g.proxy(this.toggle,this));else if("manual"!=s){var a="hover"==s?"mouseenter":"focusin",r="hover"==s?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,g.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,g.proxy(this.leave,this))}}this.options.selector?this._options=g.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},v.prototype.getDefaults=function(){return v.DEFAULTS},v.prototype.getOptions=function(t){return(t=g.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},v.prototype.getDelegateOptions=function(){var i={},o=this.getDefaults();return this._options&&g.each(this._options,function(t,e){o[t]!=e&&(i[t]=e)}),i},v.prototype.enter=function(t){var e=t instanceof this.constructor?t:g(t.currentTarget).data("bs."+this.type);return e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),g(t.currentTarget).data("bs."+this.type,e)),t instanceof g.Event&&(e.inState["focusin"==t.type?"focus":"hover"]=!0),e.tip().hasClass("in")||"in"==e.hoverState?void(e.hoverState="in"):(clearTimeout(e.timeout),e.hoverState="in",e.options.delay&&e.options.delay.show?void(e.timeout=setTimeout(function(){"in"==e.hoverState&&e.show()},e.options.delay.show)):e.show())},v.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},v.prototype.leave=function(t){var e=t instanceof this.constructor?t:g(t.currentTarget).data("bs."+this.type);return e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),g(t.currentTarget).data("bs."+this.type,e)),t instanceof g.Event&&(e.inState["focusout"==t.type?"focus":"hover"]=!1),e.isInStateTrue()?void 0:(clearTimeout(e.timeout),e.hoverState="out",e.options.delay&&e.options.delay.hide?void(e.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide)):e.hide())},v.prototype.show=function(){var t=g.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var e=g.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!e)return;var i=this,o=this.tip(),n=this.getUID(this.type);this.setContent(),o.attr("id",n),this.$element.attr("aria-describedby",n),this.options.animation&&o.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,r=a.test(s);r&&(s=s.replace(a,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var l=this.getPosition(),h=o[0].offsetWidth,d=o[0].offsetHeight;if(r){var p=s,c=this.getPosition(this.$viewport);s="bottom"==s&&l.bottom+d>c.bottom?"top":"top"==s&&l.top-d<c.top?"bottom":"right"==s&&l.right+h>c.width?"left":"left"==s&&l.left-h<c.left?"right":s,o.removeClass(p).addClass(s)}var f=this.getCalculatedOffset(s,l,h,d);this.applyPlacement(f,s);var u=function(){var t=i.hoverState;i.$element.trigger("shown.bs."+i.type),i.hoverState=null,"out"==t&&i.leave(i)};g.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",u).emulateTransitionEnd(v.TRANSITION_DURATION):u()}},v.prototype.applyPlacement=function(t,e){var i=this.tip(),o=i[0].offsetWidth,n=i[0].offsetHeight,s=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(a)&&(a=0),t.top+=s,t.left+=a,g.offset.setOffset(i[0],g.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},t),0),i.addClass("in");var r=i[0].offsetWidth,l=i[0].offsetHeight;"top"==e&&l!=n&&(t.top=t.top+n-l);var h=this.getViewportAdjustedDelta(e,t,r,l);h.left?t.left+=h.left:t.top+=h.top;var d=/top|bottom/.test(e),p=d?2*h.left-o+r:2*h.top-n+l,c=d?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(p,i[0][c],d)},v.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},v.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},v.prototype.hide=function(t){function e(){"in"!=i.hoverState&&o.detach(),i.$element.removeAttr("aria-describedby").trigger("hidden.bs."+i.type),t&&t()}var i=this,o=g(this.$tip),n=g.Event("hide.bs."+this.type);return this.$element.trigger(n),n.isDefaultPrevented()?void 0:(o.removeClass("in"),g.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",e).emulateTransitionEnd(v.TRANSITION_DURATION):e(),this.hoverState=null,this)},v.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},v.prototype.hasContent=function(){return this.getTitle()},v.prototype.getPosition=function(t){var e=(t=t||this.$element)[0],i="BODY"==e.tagName,o=e.getBoundingClientRect();null==o.width&&(o=g.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var n=i?{top:0,left:0}:t.offset(),s={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},a=i?{width:g(window).width(),height:g(window).height()}:null;return g.extend({},o,s,a,n)},v.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},v.prototype.getViewportAdjustedDelta=function(t,e,i,o){var n={top:0,left:0};if(!this.$viewport)return n;var s=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var r=e.top-s-a.scroll,l=e.top+s-a.scroll+o;r<a.top?n.top=a.top-r:l>a.top+a.height&&(n.top=a.top+a.height-l)}else{var h=e.left-s,d=e.left+s+i;h<a.left?n.left=a.left-h:d>a.right&&(n.left=a.left+a.width-d)}return n},v.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},v.prototype.getUID=function(t){for(;t+=~~(1e6*Math.random()),document.getElementById(t););return t},v.prototype.tip=function(){if(!this.$tip&&(this.$tip=g(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},v.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},v.prototype.enable=function(){this.enabled=!0},v.prototype.disable=function(){this.enabled=!1},v.prototype.toggleEnabled=function(){this.enabled=!this.enabled},v.prototype.toggle=function(t){var e=this;t&&((e=g(t.currentTarget).data("bs."+this.type))||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),g(t.currentTarget).data("bs."+this.type,e))),t?(e.inState.click=!e.inState.click,e.isInStateTrue()?e.enter(e):e.leave(e)):e.tip().hasClass("in")?e.leave(e):e.enter(e)},v.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null})};var t=g.fn.tooltip;g.fn.tooltip=function(o){return this.each(function(){var t=g(this),e=t.data("bs.tooltip"),i="object"==typeof o&&o;(e||!/destroy|hide/.test(o))&&(e||t.data("bs.tooltip",e=new v(this,i)),"string"==typeof o&&e[o]())})},g.fn.tooltip.Constructor=v,g.fn.tooltip.noConflict=function(){return g.fn.tooltip=t,this}}(jQuery),function(n){"use strict";var s=function(t,e){this.init("popover",t,e)};if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");s.VERSION="3.3.6",s.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),((s.prototype=n.extend({},n.fn.tooltip.Constructor.prototype)).constructor=s).prototype.getDefaults=function(){return s.DEFAULTS},s.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof i?"html":"append":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},s.prototype.hasContent=function(){return this.getTitle()||this.getContent()},s.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},s.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var t=n.fn.popover;n.fn.popover=function(o){return this.each(function(){var t=n(this),e=t.data("bs.popover"),i="object"==typeof o&&o;(e||!/destroy|hide/.test(o))&&(e||t.data("bs.popover",e=new s(this,i)),"string"==typeof o&&e[o]())})},n.fn.popover.Constructor=s,n.fn.popover.noConflict=function(){return n.fn.popover=t,this}}(jQuery),function(s){"use strict";function n(t,e){this.$body=s(document.body),this.$scrollElement=s(s(t).is(document.body)?window:t),this.options=s.extend({},n.DEFAULTS,e),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",s.proxy(this.process,this)),this.refresh(),this.process()}function e(o){return this.each(function(){var t=s(this),e=t.data("bs.scrollspy"),i="object"==typeof o&&o;e||t.data("bs.scrollspy",e=new n(this,i)),"string"==typeof o&&e[o]()})}n.VERSION="3.3.6",n.DEFAULTS={offset:10},n.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},n.prototype.refresh=function(){var t=this,o="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),s.isWindow(this.$scrollElement[0])||(o="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=s(this),e=t.data("target")||t.attr("href"),i=/^#./.test(e)&&s(e);return i&&i.length&&i.is(":visible")&&[[i[o]().top+n,e]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},n.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),o=this.options.offset+i-this.$scrollElement.height(),n=this.offsets,s=this.targets,a=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),o<=e)return a!=(t=s[s.length-1])&&this.activate(t);if(a&&e<n[0])return this.activeTarget=null,this.clear();for(t=n.length;t--;)a!=s[t]&&e>=n[t]&&(void 0===n[t+1]||e<n[t+1])&&this.activate(s[t])},n.prototype.activate=function(t){this.activeTarget=t,this.clear();var e=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=s(e).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},n.prototype.clear=function(){s(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var t=s.fn.scrollspy;s.fn.scrollspy=e,s.fn.scrollspy.Constructor=n,s.fn.scrollspy.noConflict=function(){return s.fn.scrollspy=t,this},s(window).on("load.bs.scrollspy.data-api",function(){s('[data-spy="scroll"]').each(function(){var t=s(this);e.call(t,t.data())})})}(jQuery),function(r){"use strict";function e(i){return this.each(function(){var t=r(this),e=t.data("bs.tab");e||t.data("bs.tab",e=new a(this)),"string"==typeof i&&e[i]()})}var a=function(t){this.element=r(t)};a.VERSION="3.3.6",a.TRANSITION_DURATION=150,a.prototype.show=function(){var t=this.element,e=t.closest("ul:not(.dropdown-menu)"),i=t.data("target");if(i||(i=(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var o=e.find(".active:last a"),n=r.Event("hide.bs.tab",{relatedTarget:t[0]}),s=r.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(n),t.trigger(s),!s.isDefaultPrevented()&&!n.isDefaultPrevented()){var a=r(i);this.activate(t.closest("li"),e),this.activate(a,a.parent(),function(){o.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:o[0]})})}}},a.prototype.activate=function(t,e,i){function o(){n.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu").length&&t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var n=e.find("> .active"),s=i&&r.support.transition&&(n.length&&n.hasClass("fade")||!!e.find("> .fade").length);n.length&&s?n.one("bsTransitionEnd",o).emulateTransitionEnd(a.TRANSITION_DURATION):o(),n.removeClass("in")};var t=r.fn.tab;r.fn.tab=e,r.fn.tab.Constructor=a,r.fn.tab.noConflict=function(){return r.fn.tab=t,this};var i=function(t){t.preventDefault(),e.call(r(this),"show")};r(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery),function(l){"use strict";function i(o){return this.each(function(){var t=l(this),e=t.data("bs.affix"),i="object"==typeof o&&o;e||t.data("bs.affix",e=new h(this,i)),"string"==typeof o&&e[o]()})}var h=function(t,e){this.options=l.extend({},h.DEFAULTS,e),this.$target=l(this.options.target).on("scroll.bs.affix.data-api",l.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",l.proxy(this.checkPositionWithEventLoop,this)),this.$element=l(t),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};h.VERSION="3.3.6",h.RESET="affix affix-top affix-bottom",h.DEFAULTS={offset:0,target:window},h.prototype.getState=function(t,e,i,o){var n=this.$target.scrollTop(),s=this.$element.offset(),a=this.$target.height();if(null!=i&&"top"==this.affixed)return n<i&&"top";if("bottom"==this.affixed)return null!=i?!(n+this.unpin<=s.top)&&"bottom":!(n+a<=t-o)&&"bottom";var r=null==this.affixed,l=r?n:s.top;return null!=i&&n<=i?"top":null!=o&&t-o<=l+(r?a:e)&&"bottom"},h.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(h.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},h.prototype.checkPositionWithEventLoop=function(){setTimeout(l.proxy(this.checkPosition,this),1)},h.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=this.$element.height(),e=this.options.offset,i=e.top,o=e.bottom,n=Math.max(l(document).height(),l(document.body).height());"object"!=typeof e&&(o=i=e),"function"==typeof i&&(i=e.top(this.$element)),"function"==typeof o&&(o=e.bottom(this.$element));var s=this.getState(n,t,i,o);if(this.affixed!=s){null!=this.unpin&&this.$element.css("top","");var a="affix"+(s?"-"+s:""),r=l.Event(a+".bs.affix");if(this.$element.trigger(r),r.isDefaultPrevented())return;this.affixed=s,this.unpin="bottom"==s?this.getPinnedOffset():null,this.$element.removeClass(h.RESET).addClass(a).trigger(a.replace("affix","affixed")+".bs.affix")}"bottom"==s&&this.$element.offset({top:n-t-o})}};var t=l.fn.affix;l.fn.affix=i,l.fn.affix.Constructor=h,l.fn.affix.noConflict=function(){return l.fn.affix=t,this},l(window).on("load",function(){l('[data-spy="affix"]').each(function(){var t=l(this),e=t.data();e.offset=e.offset||{},null!=e.offsetBottom&&(e.offset.bottom=e.offsetBottom),null!=e.offsetTop&&(e.offset.top=e.offsetTop),i.call(t,e)})})}(jQuery);
!function(a){"use strict";var i=function(t,e){this.$element=a(t),this.options=a.extend({},this.defaults(),e),this.render()};i.VERSION="2.2.0",i.DEFAULTS={on:"On",off:"Off",onstyle:"primary",offstyle:"default",size:"normal",style:"",width:null,height:null},i.prototype.defaults=function(){return{on:this.$element.attr("data-on")||i.DEFAULTS.on,off:this.$element.attr("data-off")||i.DEFAULTS.off,onstyle:this.$element.attr("data-onstyle")||i.DEFAULTS.onstyle,offstyle:this.$element.attr("data-offstyle")||i.DEFAULTS.offstyle,size:this.$element.attr("data-size")||i.DEFAULTS.size,style:this.$element.attr("data-style")||i.DEFAULTS.style,width:this.$element.attr("data-width")||i.DEFAULTS.width,height:this.$element.attr("data-height")||i.DEFAULTS.height}},i.prototype.render=function(){this._onstyle="btn-"+this.options.onstyle,this._offstyle="btn-"+this.options.offstyle;var t="large"===this.options.size?"btn-lg":"small"===this.options.size?"btn-sm":"mini"===this.options.size?"btn-xs":"",e=a('<label class="btn">').html(this.options.on).addClass(this._onstyle+" "+t+" active"),o=a('<label class="btn">').html(this.options.off).addClass(this._offstyle+" "+t),s=a('<span class="toggle-handle btn btn-default">').addClass(t),i=a('<div class="toggle-group">').append(e,o,s),n=a('<div class="toggle btn" data-toggle="toggle">').addClass(this.$element.prop("checked")?this._onstyle:this._offstyle+" off").addClass(t).addClass(this.options.style);this.$element.wrap(n),a.extend(this,{$toggle:this.$element.parent(),$toggleOn:e,$toggleOff:o,$toggleGroup:i}),this.$toggle.append(i);var l=this.options.width||Math.max(e.outerWidth(),o.outerWidth())+s.outerWidth()/2,h=this.options.height||Math.max(e.outerHeight(),o.outerHeight());e.addClass("toggle-on"),o.addClass("toggle-off"),this.$toggle.css({width:l,height:h}),this.options.height&&(e.css("line-height",e.height()+"px"),o.css("line-height",o.height()+"px")),this.update(!0),this.trigger(!0)},i.prototype.toggle=function(){this.$element.prop("checked")?this.off():this.on()},i.prototype.on=function(t){return!this.$element.prop("disabled")&&(this.$toggle.removeClass(this._offstyle+" off").addClass(this._onstyle),this.$element.prop("checked",!0),void(t||this.trigger()))},i.prototype.off=function(t){return!this.$element.prop("disabled")&&(this.$toggle.removeClass(this._onstyle).addClass(this._offstyle+" off"),this.$element.prop("checked",!1),void(t||this.trigger()))},i.prototype.enable=function(){this.$toggle.removeAttr("disabled"),this.$element.prop("disabled",!1)},i.prototype.disable=function(){this.$toggle.attr("disabled","disabled"),this.$element.prop("disabled",!0)},i.prototype.update=function(t){this.$element.prop("disabled")?this.disable():this.enable(),this.$element.prop("checked")?this.on(t):this.off(t)},i.prototype.trigger=function(t){this.$element.off("change.bs.toggle"),t||this.$element.change(),this.$element.on("change.bs.toggle",a.proxy(function(){this.update()},this))},i.prototype.destroy=function(){this.$element.off("change.bs.toggle"),this.$toggleGroup.remove(),this.$element.removeData("bs.toggle"),this.$element.unwrap()};var t=a.fn.bootstrapToggle;a.fn.bootstrapToggle=function(s){return this.each(function(){var t=a(this),e=t.data("bs.toggle"),o="object"==typeof s&&s;e||t.data("bs.toggle",e=new i(this,o)),"string"==typeof s&&e[s]&&e[s]()})},a.fn.bootstrapToggle.Constructor=i,a.fn.toggle.noConflict=function(){return a.fn.bootstrapToggle=t,this},a(function(){a("input[type=checkbox][data-toggle^=toggle]").bootstrapToggle()}),a(document).on("click.bs.toggle","div[data-toggle^=toggle]",function(t){a(this).find("input[type=checkbox]").bootstrapToggle("toggle"),t.preventDefault()})}(jQuery);
!function(t){"use strict";"object"==typeof exports?module.exports=t(window.jQuery):"function"==typeof define&&define.amd?define(["jquery"],t):window.jQuery&&!window.jQuery.fn.colorpicker&&t(window.jQuery)}(function(c){"use strict";var r=function(t,e){this.value={h:0,s:0,b:0,a:1},this.origFormat=null,e&&c.extend(this.colors,e),t&&(void 0!==t.toLowerCase?(t+="",this.setColor(t)):void 0!==t.h&&(this.value=t))},o={horizontal:!(r.prototype={constructor:r,colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"transparent"},_sanitizeNumber:function(t){return"number"==typeof t?t:isNaN(t)||null===t||""===t||void 0===t?1:""===t?0:void 0!==t.toLowerCase?(t.match(/^\./)&&(t="0"+t),Math.ceil(100*parseFloat(t))/100):1},isTransparent:function(t){return!!t&&("transparent"===(t=t.toLowerCase().trim())||t.match(/#?00000000/)||t.match(/(rgba|hsla)\(0,0,0,0?\.?0\)/))},rgbaIsTransparent:function(t){return 0===t.r&&0===t.g&&0===t.b&&0===t.a},setColor:function(t){(t=t.toLowerCase().trim())&&(this.isTransparent(t)?this.value={h:0,s:0,b:0,a:0}:this.value=this.stringToHSB(t)||{h:0,s:0,b:0,a:1})},stringToHSB:function(s){var a;s=s.toLowerCase(),void 0!==this.colors[s]&&(s=this.colors[s],a="alias");var n=this,l=!1;return c.each(this.stringParsers,function(t,e){var o=e.re.exec(s),i=o&&e.parse.apply(n,[o]),r=a||e.format||"rgba";return!i||(l=r.match(/hsla?/)?n.RGBtoHSB.apply(n,n.HSLtoRGB.apply(n,i)):n.RGBtoHSB.apply(n,i),n.origFormat=r,!1)}),l},setHue:function(t){this.value.h=1-t},setSaturation:function(t){this.value.s=t},setBrightness:function(t){this.value.b=1-t},setAlpha:function(t){this.value.a=Math.round(parseInt(100*(1-t),10)/100*100)/100},toRGB:function(t,e,o,i){var r,s,a,n,l;return t||(t=this.value.h,e=this.value.s,o=this.value.b),t=(t*=360)%360/60,r=s=a=o-(l=o*e),r+=[l,n=l*(1-Math.abs(t%2-1)),0,0,n,l][t=~~t],s+=[n,l,l,n,0,0][t],a+=[0,0,n,l,l,n][t],{r:Math.round(255*r),g:Math.round(255*s),b:Math.round(255*a),a:i||this.value.a}},toHex:function(t,e,o,i){var r=this.toRGB(t,e,o,i);return this.rgbaIsTransparent(r)?"transparent":"#"+(1<<24|parseInt(r.r)<<16|parseInt(r.g)<<8|parseInt(r.b)).toString(16).substr(1)},toHSL:function(t,e,o,i){t=t||this.value.h,e=e||this.value.s,o=o||this.value.b,i=i||this.value.a;var r=t,s=(2-e)*o,a=e*o;return a/=0<s&&s<=1?s:2-s,s/=2,1<a&&(a=1),{h:isNaN(r)?0:r,s:isNaN(a)?0:a,l:isNaN(s)?0:s,a:isNaN(i)?0:i}},toAlias:function(t,e,o,i){var r=this.toHex(t,e,o,i);for(var s in this.colors)if(this.colors[s]===r)return s;return!1},RGBtoHSB:function(t,e,o,i){var r,s,a,n;return t/=255,e/=255,o/=255,r=((r=0===(n=(a=Math.max(t,e,o))-Math.min(t,e,o))?null:a===t?(e-o)/n:a===e?(o-t)/n+2:(t-e)/n+4)+360)%6*60/360,s=0===n?0:n/a,{h:this._sanitizeNumber(r),s:s,b:a,a:this._sanitizeNumber(i)}},HueToRGB:function(t,e,o){return o<0?o+=1:1<o&&(o-=1),6*o<1?t+(e-t)*o*6:2*o<1?e:3*o<2?t+(e-t)*(2/3-o)*6:t},HSLtoRGB:function(t,e,o,i){var r;e<0&&(e=0);var s=2*o-(r=o<=.5?o*(1+e):o+e-o*e),a=t+1/3,n=t,l=t-1/3;return[Math.round(255*this.HueToRGB(s,r,a)),Math.round(255*this.HueToRGB(s,r,n)),Math.round(255*this.HueToRGB(s,r,l)),this._sanitizeNumber(i)]},toString:function(t){var e=!1;switch(t=t||"rgba"){case"rgb":return e=this.toRGB(),this.rgbaIsTransparent(e)?"transparent":"rgb("+e.r+","+e.g+","+e.b+")";case"rgba":return"rgba("+(e=this.toRGB()).r+","+e.g+","+e.b+","+e.a+")";case"hsl":return e=this.toHSL(),"hsl("+Math.round(360*e.h)+","+Math.round(100*e.s)+"%,"+Math.round(100*e.l)+"%)";case"hsla":return e=this.toHSL(),"hsla("+Math.round(360*e.h)+","+Math.round(100*e.s)+"%,"+Math.round(100*e.l)+"%,"+e.a+")";case"hex":return this.toHex();case"alias":return this.toAlias()||this.toHex();default:return e}},stringParsers:[{re:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*?\)/,format:"rgb",parse:function(t){return[t[1],t[2],t[3],1]}},{re:/rgb\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"rgb",parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],1]}},{re:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/hsl\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"hsl",parse:function(t){return[t[1]/360,t[2]/100,t[3]/100,t[4]]}},{re:/hsla\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"hsla",parse:function(t){return[t[1]/360,t[2]/100,t[3]/100,t[4]]}},{re:/#?([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,format:"hex",parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),1]}},{re:/#?([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,format:"hex",parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),1]}}],colorNameToHex:function(t){return void 0!==this.colors[t.toLowerCase()]&&this.colors[t.toLowerCase()]}}),inline:!1,color:!1,format:!1,input:"input",container:!1,component:".add-on, .input-group-addon",sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},slidersHorz:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:100,maxTop:0,callLeft:"setHue",callTop:!1},alpha:{maxLeft:100,maxTop:0,callLeft:"setAlpha",callTop:!1}},template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div><div class="colorpicker-selectors"></div></div>',align:"right",customClass:null,colorSelectors:null},s=function(t,e){if(this.element=c(t).addClass("colorpicker-element"),this.options=c.extend(!0,{},o,this.element.data(),e),this.component=this.options.component,this.component=!1!==this.component&&this.element.find(this.component),this.component&&0===this.component.length&&(this.component=!1),this.container=!0===this.options.container?this.element:this.options.container,this.container=!1!==this.container&&c(this.container),this.input=this.element.is("input")?this.element:!!this.options.input&&this.element.find(this.options.input),this.input&&0===this.input.length&&(this.input=!1),this.color=new r(!1!==this.options.color?this.options.color:this.getValue(),this.options.colorSelectors),this.format=!1!==this.options.format?this.options.format:this.color.origFormat,!1!==this.options.color&&(this.updateInput(this.color),this.updateData(this.color)),this.picker=c(this.options.template),this.options.customClass&&this.picker.addClass(this.options.customClass),this.options.inline?this.picker.addClass("colorpicker-inline colorpicker-visible"):this.picker.addClass("colorpicker-hidden"),this.options.horizontal&&this.picker.addClass("colorpicker-horizontal"),"rgba"!==this.format&&"hsla"!==this.format&&!1!==this.options.format||this.picker.addClass("colorpicker-with-alpha"),"right"===this.options.align&&this.picker.addClass("colorpicker-right"),!0===this.options.inline&&this.picker.addClass("colorpicker-no-arrow"),this.options.colorSelectors){var i=this;c.each(this.options.colorSelectors,function(t,e){var o=c("<i />").css("background-color",e).data("class",t);o.click(function(){i.setValue(c(this).css("background-color"))}),i.picker.find(".colorpicker-selectors").append(o)}),this.picker.find(".colorpicker-selectors").show()}this.picker.on("mousedown.colorpicker touchstart.colorpicker",c.proxy(this.mousedown,this)),this.picker.appendTo(this.container?this.container:c("body")),!1!==this.input&&(this.input.on({"keyup.colorpicker":c.proxy(this.keyup,this)}),this.input.on({"change.colorpicker":c.proxy(this.change,this)}),!1===this.component&&this.element.on({"focus.colorpicker":c.proxy(this.show,this)}),!1===this.options.inline&&this.element.on({"focusout.colorpicker":c.proxy(this.hide,this)})),!1!==this.component&&this.component.on({"click.colorpicker":c.proxy(this.show,this)}),!1===this.input&&!1===this.component&&this.element.on({"click.colorpicker":c.proxy(this.show,this)}),!1!==this.input&&!1!==this.component&&"color"===this.input.attr("type")&&this.input.on({"click.colorpicker":c.proxy(this.show,this),"focus.colorpicker":c.proxy(this.show,this)}),this.update(),c(c.proxy(function(){this.element.trigger("create")},this))};s.Color=r,s.prototype={constructor:s,destroy:function(){this.picker.remove(),this.element.removeData("colorpicker","color").off(".colorpicker"),!1!==this.input&&this.input.off(".colorpicker"),!1!==this.component&&this.component.off(".colorpicker"),this.element.removeClass("colorpicker-element"),this.element.trigger({type:"destroy"})},reposition:function(){if(!1!==this.options.inline||this.options.container)return!1;var t=this.container&&this.container[0]!==document.body?"position":"offset",e=this.component||this.element,o=e[t]();"right"===this.options.align&&(o.left-=this.picker.outerWidth()-e.outerWidth()),this.picker.css({top:o.top+e.outerHeight(),left:o.left})},show:function(t){return!this.isDisabled()&&(this.picker.addClass("colorpicker-visible").removeClass("colorpicker-hidden"),this.reposition(),c(window).on("resize.colorpicker",c.proxy(this.reposition,this)),!t||this.hasInput()&&"color"!==this.input.attr("type")||t.stopPropagation&&t.preventDefault&&(t.stopPropagation(),t.preventDefault()),!this.component&&this.input||!1!==this.options.inline||c(window.document).on({"mousedown.colorpicker":c.proxy(this.hide,this)}),void this.element.trigger({type:"showPicker",color:this.color}))},hide:function(t){c(t.target).closest(".colorpicker").length||(this.picker.addClass("colorpicker-hidden").removeClass("colorpicker-visible"),c(window).off("resize.colorpicker",this.reposition),c(document).off({"mousedown.colorpicker":this.hide}),this.update(),this.element.trigger({type:"hidePicker",color:this.color}))},updateData:function(t){return t=t||this.color.toString(this.format),this.element.data("color",t),t},updateInput:function(t){if(t=t||this.color.toString(this.format),!1!==this.input){if(this.options.colorSelectors){var e=new r(t,this.options.colorSelectors).toAlias();void 0!==this.options.colorSelectors[e]&&(t=e)}this.input.prop("value",t)}return t},updatePicker:function(t){void 0!==t&&(this.color=new r(t,this.options.colorSelectors));var e=!1===this.options.horizontal?this.options.sliders:this.options.slidersHorz,o=this.picker.find("i");if(0!==o.length)return!1===this.options.horizontal?(e=this.options.sliders,o.eq(1).css("top",e.hue.maxTop*(1-this.color.value.h)).end().eq(2).css("top",e.alpha.maxTop*(1-this.color.value.a))):(e=this.options.slidersHorz,o.eq(1).css("left",e.hue.maxLeft*(1-this.color.value.h)).end().eq(2).css("left",e.alpha.maxLeft*(1-this.color.value.a))),o.eq(0).css({top:e.saturation.maxTop-this.color.value.b*e.saturation.maxTop,left:this.color.value.s*e.saturation.maxLeft}),this.picker.find(".colorpicker-saturation").css("backgroundColor",this.color.toHex(this.color.value.h,1,1,1)),this.picker.find(".colorpicker-alpha").css("backgroundColor",this.color.toHex()),this.picker.find(".colorpicker-color, .colorpicker-color div").css("backgroundColor",this.color.toString(this.format)),t},updateComponent:function(t){if(t=t||this.color.toString(this.format),!1!==this.component){var e=this.component.find("i").eq(0);0<e.length?e.css({backgroundColor:t}):this.component.css({backgroundColor:t})}return t},update:function(t){var e;return!1===this.getValue(!1)&&!0!==t||(e=this.updateComponent(),this.updateInput(e),this.updateData(e),this.updatePicker()),e},setValue:function(t){this.color=new r(t,this.options.colorSelectors),this.update(!0),this.element.trigger({type:"changeColor",color:this.color,value:t})},getValue:function(t){var e;return t=void 0===t?"#000000":t,void 0!==(e=this.hasInput()?this.input.val():this.element.data("color"))&&""!==e&&null!==e||(e=t),e},hasInput:function(){return!1!==this.input},isDisabled:function(){return!!this.hasInput()&&!0===this.input.prop("disabled")},disable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!0),this.element.trigger({type:"disable",color:this.color,value:this.getValue()}),!0)},enable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!1),this.element.trigger({type:"enable",color:this.color,value:this.getValue()}),!0)},currentSlider:null,mousePointer:{left:0,top:0},mousedown:function(t){if(!c(t.target).is("input")){c(t.target).closest(".colorpicker").find("input").blur(),!t.pageX&&!t.pageY&&t.originalEvent&&t.originalEvent.touches&&(t.pageX=t.originalEvent.touches[0].pageX,t.pageY=t.originalEvent.touches[0].pageY),t.stopPropagation(),t.preventDefault();var e=c(t.target).closest("div"),o=this.options.horizontal?this.options.slidersHorz:this.options.sliders;if(!e.is(".colorpicker")){if(e.is(".colorpicker-saturation"))this.currentSlider=c.extend({},o.saturation);else if(e.is(".colorpicker-hue"))this.currentSlider=c.extend({},o.hue);else{if(!e.is(".colorpicker-alpha"))return!1;this.currentSlider=c.extend({},o.alpha)}var i=e.offset();this.currentSlider.guide=e.find("i")[0].style,this.currentSlider.left=t.pageX-i.left,this.currentSlider.top=t.pageY-i.top,this.mousePointer={left:t.pageX,top:t.pageY},c(document).on({"mousemove.colorpicker":c.proxy(this.mousemove,this),"touchmove.colorpicker":c.proxy(this.mousemove,this),"mouseup.colorpicker":c.proxy(this.mouseup,this),"touchend.colorpicker":c.proxy(this.mouseup,this)}).trigger("mousemove")}return!1}},mousemove:function(t){!t.pageX&&!t.pageY&&t.originalEvent&&t.originalEvent.touches&&(t.pageX=t.originalEvent.touches[0].pageX,t.pageY=t.originalEvent.touches[0].pageY),t.stopPropagation(),t.preventDefault();var e=Math.max(0,Math.min(this.currentSlider.maxLeft,this.currentSlider.left+((t.pageX||this.mousePointer.left)-this.mousePointer.left))),o=Math.max(0,Math.min(this.currentSlider.maxTop,this.currentSlider.top+((t.pageY||this.mousePointer.top)-this.mousePointer.top)));return this.currentSlider.guide.left=e+"px",this.currentSlider.guide.top=o+"px",this.currentSlider.callLeft&&this.color[this.currentSlider.callLeft].call(this.color,e/this.currentSlider.maxLeft),this.currentSlider.callTop&&this.color[this.currentSlider.callTop].call(this.color,o/this.currentSlider.maxTop),"setAlpha"===this.currentSlider.callTop&&!1===this.options.format&&(1!==this.color.value.a?(this.format="rgba",this.color.origFormat="rgba"):(this.format="hex",this.color.origFormat="hex")),this.update(!0),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(t){return t.stopPropagation(),t.preventDefault(),c(document).off({"mousemove.colorpicker":this.mousemove,"touchmove.colorpicker":this.mousemove,"mouseup.colorpicker":this.mouseup,"touchend.colorpicker":this.mouseup}),!1},change:function(t){this.keyup(t)},keyup:function(t){38===t.keyCode?(this.color.value.a<1&&(this.color.value.a=Math.round(100*(this.color.value.a+.01))/100),this.update(!0)):40===t.keyCode?(0<this.color.value.a&&(this.color.value.a=Math.round(100*(this.color.value.a-.01))/100),this.update(!0)):(this.color=new r(this.input.val(),this.options.colorSelectors),this.color.origFormat&&!1===this.options.format&&(this.format=this.color.origFormat),!1!==this.getValue(!1)&&(this.updateData(),this.updateComponent(),this.updatePicker())),this.element.trigger({type:"changeColor",color:this.color,value:this.input.val()})}},c.colorpicker=s,c.fn.colorpicker=function(o){var i=Array.prototype.slice.call(arguments,1),t=1===this.length,r=null,e=this.each(function(){var t=c(this),e=t.data("colorpicker");e||(e=new s(this,"object"==typeof o?o:{}),t.data("colorpicker",e)),r="string"==typeof o?c.isFunction(e[o])?e[o].apply(e,i):(i.length&&(e[o]=i[0]),e[o]):t});return t?r:e},c.fn.colorpicker.constructor=s});
(function(){"use strict";var s,o,i,n=function(t,i){return function(){return t.apply(i,arguments)}};s=jQuery,o=function(){function t(){}return t.transitions={webkitTransition:"webkitTransitionEnd",mozTransition:"mozTransitionEnd",oTransition:"oTransitionEnd",transition:"transitionend"},t.transition=function(t){var i,s,n,e;for(e in i=t[0],s=this.transitions)if(n=s[e],null!=i.style[e])return n},t}(),i=function(){function i(t){null==t&&(t={}),this.container=n(this.container,this),this.content=n(this.content,this),this.html=n(this.html,this),this.$growl=n(this.$growl,this),this.$growls=n(this.$growls,this),this.animate=n(this.animate,this),this.remove=n(this.remove,this),this.dismiss=n(this.dismiss,this),this.present=n(this.present,this),this.cycle=n(this.cycle,this),this.close=n(this.close,this),this.click=n(this.click,this),this.unbind=n(this.unbind,this),this.bind=n(this.bind,this),this.render=n(this.render,this),this.settings=s.extend({},i.settings,t),this.$growls().attr("class",this.settings.location),this.render()}return i.settings={namespace:"growl",duration:3200,close:"&#215;",location:"default",style:"default",size:"medium"},i.growl=function(t){return null==t&&(t={}),this.initialize(),new i(t)},i.initialize=function(){return s("body:not(:has(#growls))").append('<div id="growls" />')},i.prototype.render=function(){var t;t=this.$growl(),this.$growls().append(t),this.settings.fixed?this.present():this.cycle()},i.prototype.bind=function(t){return null==t&&(t=this.$growl()),t.on("click",this.click),t.on("contextmenu",this.close).find("."+this.settings.namespace+"-close").on("click",this.close)},i.prototype.unbind=function(t){return null==t&&(t=this.$growl()),t.off("click",this.click),t.off("contextmenu",this.close).find("."+this.settings.namespace+"-close").off("click",this.close)},i.prototype.click=function(t){if(null!=this.settings.url)return t.preventDefault(),t.stopPropagation(),window.open(this.settings.url)},i.prototype.close=function(t){return t.preventDefault(),t.stopPropagation(),this.$growl().stop().queue(this.dismiss).queue(this.remove)},i.prototype.cycle=function(){return this.$growl().queue(this.present).delay(this.settings.duration).queue(this.dismiss).queue(this.remove)},i.prototype.present=function(t){var i;return i=this.$growl(),this.bind(i),this.animate(i,this.settings.namespace+"-incoming","out",t)},i.prototype.dismiss=function(t){var i;return i=this.$growl(),this.unbind(i),this.animate(i,this.settings.namespace+"-outgoing","in",t)},i.prototype.remove=function(t){return this.$growl().remove(),t()},i.prototype.animate=function(t,i,s,n){var e;null==s&&(s="in"),e=o.transition(t),t["in"===s?"removeClass":"addClass"](i),t.offset().position,t["in"===s?"addClass":"removeClass"](i),null!=n&&(null!=e?t.one(e,n):n())},i.prototype.$growls=function(){return null!=this.$_growls?this.$_growls:this.$_growls=s("#growls")},i.prototype.$growl=function(){return null!=this.$_growl?this.$_growl:this.$_growl=s(this.html())},i.prototype.html=function(){return this.container(this.content())},i.prototype.content=function(){return"<div class='"+this.settings.namespace+"-close'>"+this.settings.close+"</div>\n<div class='"+this.settings.namespace+"-title'>"+this.settings.title+"</div>\n<div class='"+this.settings.namespace+"-message'>"+this.settings.message+"</div>"},i.prototype.container=function(t){return"<div class='"+this.settings.namespace+" "+this.settings.namespace+"-"+this.settings.style+" "+this.settings.namespace+"-"+this.settings.size+"'>\n  "+t+"\n</div>"},i}(),this.Growl=i,s.growl=function(t){return null==t&&(t={}),i.growl(t)},s.growl.error=function(t){var i;return null==t&&(t={}),i={title:"Error!",style:"error"},s.growl(s.extend(i,t))},s.growl.notice=function(t){var i;return null==t&&(t={}),i={title:"Notice!",style:"notice"},s.growl(s.extend(i,t))},s.growl.warning=function(t){var i;return null==t&&(t={}),i={title:"Warning!",style:"warning"},s.growl(s.extend(i,t))}}).call(this);
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(n){var e=function(){if(n&&n.fn&&n.fn.mselect2&&n.fn.mselect2.amd)var e=n.fn.mselect2.amd;var t,o,c,u;return e&&e.requirejs||(e?c=e:e={},function(p){function h(e,t){return n.call(e,t)}function s(e,t){var n,i,o,r,s,a,l,c,u,d,p,h=t&&t.split("/"),f=$.map,g=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(s=(e=e.split("/")).length-1,$.nodeIdCompat&&x.test(e[s])&&(e[s]=e[s].replace(x,"")),e=h.slice(0,h.length-1).concat(e),u=0;u<e.length;u+=1)if("."===(p=e[u]))e.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===e[2]||".."===e[0]))break;0<u&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||g)&&f){for(u=(n=e.split("/")).length;0<u;u-=1){if(i=n.slice(0,u).join("/"),h)for(d=h.length;0<d;d-=1)if((o=f[h.slice(0,d).join("/")])&&(o=o[i])){r=o,a=u;break}if(r)break;!l&&g&&g[i]&&(l=g[i],c=u)}!r&&l&&(r=l,a=c),r&&(n.splice(0,a,r),e=n.join("/"))}return e}function f(t,n){return function(){var e=i.call(arguments,0);return"string"!=typeof e[0]&&1===e.length&&e.push(null),l.apply(p,e.concat([t,n]))}}function g(t){return function(e){_[t]=e}}function m(e){if(h(w,e)){var t=w[e];delete w[e],b[e]=!0,r.apply(p,t)}if(!h(_,e)&&!h(b,e))throw new Error("No "+e);return _[e]}function a(e){var t,n=e?e.indexOf("!"):-1;return-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}var r,l,v,y,_={},w={},$={},b={},n=Object.prototype.hasOwnProperty,i=[].slice,x=/\.js$/;v=function(e,t){var n,i,o=a(e),r=o[0];return e=o[1],r&&(n=m(r=s(r,t))),r?e=n&&n.normalize?n.normalize(e,(i=t,function(e){return s(e,i)})):s(e,t):(r=(o=a(e=s(e,t)))[0],e=o[1],r&&(n=m(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},y={require:function(e){return f(e)},exports:function(e){var t=_[e];return void 0!==t?t:_[e]={}},module:function(e){return{id:e,uri:"",exports:_[e],config:(t=e,function(){return $&&$.config&&$.config[t]||{}})};var t}},r=function(e,t,n,i){var o,r,s,a,l,c,u=[],d=typeof n;if(i=i||e,"undefined"===d||"function"===d){for(t=!t.length&&n.length?["require","exports","module"]:t,l=0;l<t.length;l+=1)if("require"===(r=(a=v(t[l],i)).f))u[l]=y.require(e);else if("exports"===r)u[l]=y.exports(e),c=!0;else if("module"===r)o=u[l]=y.module(e);else if(h(_,r)||h(w,r)||h(b,r))u[l]=m(r);else{if(!a.p)throw new Error(e+" missing "+r);a.p.load(a.n,f(i,!0),g(r),{}),u[l]=_[r]}s=n?n.apply(_[e],u):void 0,e&&(o&&o.exports!==p&&o.exports!==_[e]?_[e]=o.exports:s===p&&c||(_[e]=s))}else e&&(_[e]=n)},o=c=l=function(e,t,n,i,o){if("string"==typeof e)return y[e]?y[e](t):m(v(e,t).f);if(!e.splice){if(($=e).deps&&l($.deps,$.callback),!t)return;t.splice?(e=t,t=n,n=null):e=p}return t=t||function(){},"function"==typeof n&&(n=i,i=o),i?r(p,e,t,n):setTimeout(function(){r(p,e,t,n)},4),l},l.config=function(e){return l(e)},o._defined=_,(u=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),h(_,e)||h(w,e)||(w[e]=[e,t,n])}).amd={jQuery:!0}}(),e.requirejs=o,e.require=c,e.define=u),e.define("almond",function(){}),e.define("jquery",[],function(){var e=n||$;return null==e&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),e}),e.define("select2/utils",["jquery"],function(r){function u(e){var t=e.prototype,n=[];for(var i in t){"function"==typeof t[i]&&"constructor"!==i&&n.push(i)}return n}var e={Extend:function(e,t){function n(){this.constructor=e}var i={}.hasOwnProperty;for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},Decorate:function(i,o){function r(){var e=Array.prototype.unshift,t=o.prototype.constructor.length,n=i.prototype.constructor;0<t&&(e.call(arguments,i.prototype.constructor),n=o.prototype.constructor),n.apply(this,arguments)}var e=u(o),t=u(i);o.displayName=i.displayName,r.prototype=new function(){this.constructor=r};for(var n=0;n<t.length;n++){var s=t[n];r.prototype[s]=i.prototype[s]}for(var a=function(e){var t=function(){};e in r.prototype&&(t=r.prototype[e]);var n=o.prototype[e];return function(){return Array.prototype.unshift.call(arguments,t),n.apply(this,arguments)}},l=0;l<e.length;l++){var c=e[l];r.prototype[c]=a(c)}return r}},t=function(){this.listeners={}};return t.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},t.prototype.trigger=function(e){var t=Array.prototype.slice,n=t.call(arguments,1);this.listeners=this.listeners||{},null==n&&(n=[]),0===n.length&&n.push({}),(n[0]._type=e)in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},t.prototype.invoke=function(e,t){for(var n=0,i=e.length;n<i;n++)e[n].apply(this,t)},e.Observable=t,e.generateChars=function(e){for(var t="",n=0;n<e;n++){t+=Math.floor(36*Math.random()).toString(36)}return t},e.bind=function(e,t){return function(){e.apply(t,arguments)}},e._convertData=function(e){for(var t in e){var n=t.split("-"),i=e;if(1!==n.length){for(var o=0;o<n.length;o++){var r=n[o];(r=r.substring(0,1).toLowerCase()+r.substring(1))in i||(i[r]={}),o==n.length-1&&(i[r]=e[t]),i=i[r]}delete e[t]}}return e},e.hasScroll=function(e,t){var n=r(t),i=t.style.overflowX,o=t.style.overflowY;return(i!==o||"hidden"!==o&&"visible"!==o)&&("scroll"===i||"scroll"===o||(n.innerHeight()<t.scrollHeight||n.innerWidth()<t.scrollWidth))},e.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},e.appendMany=function(e,t){if("1.7"===r.fn.jquery.substr(0,3)){var n=r();r.map(t,function(e){n=n.add(e)}),t=n}e.append(t)},e}),e.define("select2/results",["jquery","./utils"],function(p,e){function i(e,t,n){this.$element=e,this.data=n,this.options=t,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=p('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&e.attr("aria-multiselectable","true"),this.$results=e},i.prototype.clear=function(){this.$results.empty()},i.prototype.displayMessage=function(e){var t=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=p('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),i=this.options.get("translations").get(e.message);n.append(t(i(e.args))),n[0].className+=" select2-results__message",this.$results.append(n)},i.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},i.prototype.append=function(e){this.hideLoading();var t=[];if(null!=e.results&&0!==e.results.length){e.results=this.sort(e.results);for(var n=0;n<e.results.length;n++){var i=e.results[n],o=this.option(i);t.push(o)}this.$results.append(t)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},i.prototype.position=function(e,t){t.find(".select2-results").append(e)},i.prototype.sort=function(e){return this.options.get("sorter")(e)},i.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option[aria-selected]"),t=e.filter("[aria-selected=true]");0<t.length?t.first().trigger("mouseenter"):e.first().trigger("mouseenter"),this.ensureHighlightVisible()},i.prototype.setClasses=function(){var t=this;this.data.current(function(e){var i=p.map(e,function(e){return e.id.toString()});t.$results.find(".select2-results__option[aria-selected]").each(function(){var e=p(this),t=p.data(this,"data"),n=""+t.id;null!=t.element&&t.element.selected||null==t.element&&-1<p.inArray(n,i)?e.attr("aria-selected","true"):e.attr("aria-selected","false")})})},i.prototype.showLoading=function(e){this.hideLoading();var t={disabled:!0,loading:!0,text:this.options.get("translations").get("searching")(e)},n=this.option(t);n.className+=" loading-results",this.$results.prepend(n)},i.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},i.prototype.option=function(e){var t=document.createElement("li");t.className="select2-results__option";var n={role:"treeitem","aria-selected":"false"};for(var i in e.disabled&&(delete n["aria-selected"],n["aria-disabled"]="true"),null==e.id&&delete n["aria-selected"],null!=e._resultId&&(t.id=e._resultId),e.title&&(t.title=e.title),e.children&&(n.role="group",n["aria-label"]=e.text,delete n["aria-selected"]),n){var o=n[i];t.setAttribute(i,o)}if(e.children){var r=p(t),s=document.createElement("strong");s.className="select2-results__group",p(s),this.template(e,s);for(var a=[],l=0;l<e.children.length;l++){var c=e.children[l],u=this.option(c);a.push(u)}var d=p("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});d.append(a),r.append(s),r.append(d)}else this.template(e,t);return p.data(t,"data",e),t},i.prototype.bind=function(t,e){var l=this,n=t.id+"-results";this.$results.attr("id",n),t.on("results:all",function(e){l.clear(),l.append(e.data),t.isOpen()&&(l.setClasses(),l.highlightFirstItem())}),t.on("results:append",function(e){l.append(e.data),t.isOpen()&&l.setClasses()}),t.on("query",function(e){l.hideMessages(),l.showLoading(e)}),t.on("select",function(){t.isOpen()&&(l.setClasses(),l.highlightFirstItem())}),t.on("unselect",function(){t.isOpen()&&(l.setClasses(),l.highlightFirstItem())}),t.on("open",function(){l.$results.attr("aria-expanded","true"),l.$results.attr("aria-hidden","false"),l.setClasses(),l.ensureHighlightVisible()}),t.on("close",function(){l.$results.attr("aria-expanded","false"),l.$results.attr("aria-hidden","true"),l.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=l.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e=l.getHighlightedResults();if(0!==e.length){var t=e.data("data");"true"==e.attr("aria-selected")?l.trigger("close",{}):l.trigger("select",{data:t})}}),t.on("results:previous",function(){var e=l.getHighlightedResults(),t=l.$results.find("[aria-selected]"),n=t.index(e);if(0!==n){var i=n-1;0===e.length&&(i=0);var o=t.eq(i);o.trigger("mouseenter");var r=l.$results.offset().top,s=o.offset().top,a=l.$results.scrollTop()+(s-r);0===i?l.$results.scrollTop(0):s-r<0&&l.$results.scrollTop(a)}}),t.on("results:next",function(){var e=l.getHighlightedResults(),t=l.$results.find("[aria-selected]"),n=t.index(e)+1;if(!(n>=t.length)){var i=t.eq(n);i.trigger("mouseenter");var o=l.$results.offset().top+l.$results.outerHeight(!1),r=i.offset().top+i.outerHeight(!1),s=l.$results.scrollTop()+r-o;0===n?l.$results.scrollTop(0):o<r&&l.$results.scrollTop(s)}}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){l.displayMessage(e)}),p.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=l.$results.scrollTop(),n=l.$results.get(0).scrollHeight-t+e.deltaY,i=0<e.deltaY&&t-e.deltaY<=0,o=e.deltaY<0&&n<=l.$results.height();i?(l.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):o&&(l.$results.scrollTop(l.$results.get(0).scrollHeight-l.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(e){var t=p(this),n=t.data("data");return"true"===t.attr("aria-selected")?void(l.options.get("multiple")?l.trigger("unselect",{originalEvent:e,data:n}):l.trigger("close",{})):void l.trigger("select",{originalEvent:e,data:n})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(e){var t=p(this).data("data");l.getHighlightedResults().removeClass("select2-results__option--highlighted"),l.trigger("results:focus",{data:t,element:p(this)})})},i.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},i.prototype.destroy=function(){this.$results.remove()},i.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]").index(e),n=this.$results.offset().top,i=e.offset().top,o=this.$results.scrollTop()+(i-n),r=i-n;o-=2*e.outerHeight(!1),t<=2?this.$results.scrollTop(0):(r>this.$results.outerHeight()||r<0)&&this.$results.scrollTop(o)}},i.prototype.template=function(e,t){var n=this.options.get("templateResult"),i=this.options.get("escapeMarkup"),o=n(e,t);null==o?t.style.display="none":"string"==typeof o?t.innerHTML=i(o):p(t).append(o)},i}),e.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),e.define("select2/selection/base",["jquery","../utils","../keys"],function(n,e,o){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=n('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),e.attr("title",this.$element.attr("title")),e.attr("tabindex",this._tabindex),this.$selection=e},i.prototype.bind=function(e,t){var n=this,i=(e.id,e.id+"-results");this.container=e,this.$selection.on("focus",function(e){n.trigger("focus",e)}),this.$selection.on("blur",function(e){n._handleBlur(e)}),this.$selection.on("keydown",function(e){n.trigger("keypress",e),e.which===o.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){n.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){n.update(e.data)}),e.on("open",function(){n.$selection.attr("aria-expanded","true"),n.$selection.attr("aria-owns",i),n._attachCloseHandler(e)}),e.on("close",function(){n.$selection.attr("aria-expanded","false"),n.$selection.removeAttr("aria-activedescendant"),n.$selection.removeAttr("aria-owns"),n.$selection.focus(),n._detachCloseHandler(e)}),e.on("enable",function(){n.$selection.attr("tabindex",n._tabindex)}),e.on("disable",function(){n.$selection.attr("tabindex","-1")})},i.prototype._handleBlur=function(e){var t=this;window.setTimeout(function(){document.activeElement==t.$selection[0]||n.contains(t.$selection[0],document.activeElement)||t.trigger("blur",e)},1)},i.prototype._attachCloseHandler=function(e){n(document.body).on("mousedown.select2."+e.id,function(e){var t=n(e.target).closest(".select2");n(".select2.select2-container--open").each(function(){var e=n(this);this!=t[0]&&e.data("element").mselect2("close")})})},i.prototype._detachCloseHandler=function(e){n(document.body).off("mousedown.select2."+e.id)},i.prototype.position=function(e,t){t.find(".selection").append(e)},i.prototype.destroy=function(){this._detachCloseHandler(this.container)},i.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},i}),e.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,n,i){function o(){o.__super__.constructor.apply(this,arguments)}return n.Extend(o,t),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},o.prototype.bind=function(t,e){var n=this;o.__super__.bind.apply(this,arguments);var i=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i),this.$selection.attr("aria-labelledby",i),this.$selection.on("mousedown",function(e){1===e.which&&n.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),t.on("focus",function(e){t.isOpen()||n.$selection.focus()}),t.on("selection:update",function(e){n.update(e.data)})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},o.prototype.selectionContainer=function(){return e("<span></span>")},o.prototype.update=function(e){if(0!==e.length){var t=e[0],n=this.$selection.find(".select2-selection__rendered"),i=this.display(t,n);n.empty().append(i),n.prop("title",t.title||t.text)}else this.clear()},o}),e.define("select2/selection/multiple",["jquery","./base","../utils"],function(i,e,a){function o(e,t){o.__super__.constructor.apply(this,arguments)}return a.Extend(o,e),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},o.prototype.bind=function(e,t){var n=this;o.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){n.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(e){if(!n.options.get("disabled")){var t=i(this).parent().data("data");n.trigger("unselect",{originalEvent:e,data:t})}})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},o.prototype.selectionContainer=function(){return i('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},o.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],n=0;n<e.length;n++){var i=e[n],o=this.selectionContainer(),r=this.display(i,o);o.append(r),o.prop("title",i.title||i.text),o.data("data",i),t.push(o)}var s=this.$selection.find(".select2-selection__rendered");a.appendMany(s,t)}},o}),e.define("select2/selection/placeholder",["../utils"],function(e){function t(e,t,n){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n)}return t.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},t.prototype.createPlaceholder=function(e,t){var n=this.selectionContainer();return n.html(this.display(t)),n.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),n},t.prototype.update=function(e,t){var n=1==t.length&&t[0].id!=this.placeholder.id;if(1<t.length||n)return e.call(this,t);this.clear();var i=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(i)},t}),e.define("select2/selection/allowClear",["jquery","../keys"],function(i,o){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){i._handleClear(e)}),t.on("keypress",function(e){i._handleKeyboardClear(e,t)})},e.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){t.stopPropagation();for(var i=n.data("data"),o=0;o<i.length;o++){var r={data:i[o]};if(this.trigger("unselect",r),r.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},e.prototype._handleKeyboardClear=function(e,t,n){n.isOpen()||(t.which==o.DELETE||t.which==o.BACKSPACE)&&this._handleClear(t)},e.prototype.update=function(e,t){if(e.call(this,t),!(0<this.$selection.find(".select2-selection__placeholder").length||0===t.length)){var n=i('<span class="select2-selection__clear">&times;</span>');n.data("data",t),this.$selection.find(".select2-selection__rendered").prepend(n)}},e}),e.define("select2/selection/search",["jquery","../utils","../keys"],function(i,e,s){function t(e,t,n){e.call(this,t,n)}return t.prototype.render=function(e){var t=i('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=t,this.$search=t.find("input");var n=e.call(this);return this._transferTabIndex(),n},t.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("open",function(){i.$search.trigger("focus")}),t.on("close",function(){i.$search.val(""),i.$search.removeAttr("aria-activedescendant"),i.$search.trigger("focus")}),t.on("enable",function(){i.$search.prop("disabled",!1),i._transferTabIndex()}),t.on("disable",function(){i.$search.prop("disabled",!0)}),t.on("focus",function(e){i.$search.trigger("focus")}),t.on("results:focus",function(e){i.$search.attr("aria-activedescendant",e.id)}),this.$selection.on("focusin",".select2-search--inline",function(e){i.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){i._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){if(e.stopPropagation(),i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented(),e.which===s.BACKSPACE&&""===i.$search.val()){var t=i.$searchContainer.prev(".select2-selection__choice");if(0<t.length){var n=t.data("data");i.searchRemoveChoice(n),e.preventDefault()}}});var o=document.documentMode,r=o&&o<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){return r?void i.$selection.off("input.search input.searchcheck"):void i.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(r&&"input"===e.type)i.$selection.off("input.search input.searchcheck");else{var t=e.which;t!=s.SHIFT&&t!=s.CTRL&&t!=s.ALT&&t!=s.TAB&&i.handleSearch(e)}})},t.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},t.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},t.prototype.update=function(e,t){var n=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),n&&this.$search.focus()},t.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},t.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},t.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";""!==this.$search.attr("placeholder")?e=this.$selection.find(".select2-selection__rendered").innerWidth():e=.75*(this.$search.val().length+1)+"em";this.$search.css("width",e)},t}),e.define("select2/selection/eventRelay",["jquery"],function(s){function e(){}return e.prototype.bind=function(e,t,n){var i=this,o=["open","opening","close","closing","select","selecting","unselect","unselecting"],r=["opening","closing","selecting","unselecting"];e.call(this,t,n),t.on("*",function(e,t){if(-1!==s.inArray(e,o)){t=t||{};var n=s.Event("select2:"+e,{params:t});i.$element.trigger(n),-1!==s.inArray(e,r)&&(t.prevented=n.isDefaultPrevented())}})},e}),e.define("select2/translation",["jquery","require"],function(t,n){function i(e){this.dict=e||{}}return i.prototype.all=function(){return this.dict},i.prototype.get=function(e){return this.dict[e]},i.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)},i._cache={},i.loadPath=function(e){if(!(e in i._cache)){var t=n(e);i._cache[e]=t}return new i(i._cache[e])},i}),e.define("select2/diacritics",[],function(){return{"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"}}),e.define("select2/data/base",["../utils"],function(i){function n(e,t){n.__super__.constructor.call(this)}return i.Extend(n,i.Observable),n.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},n.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},n.prototype.bind=function(e,t){},n.prototype.destroy=function(){},n.prototype.generateResultId=function(e,t){var n=e.id+"-result-";return(n+=i.generateChars(4))+(null!=t.id?"-"+t.id.toString():"-"+i.generateChars(4))},n}),e.define("select2/data/select",["./base","../utils","jquery"],function(e,t,a){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,e),n.prototype.current=function(e){var n=[],i=this;this.$element.find(":selected").each(function(){var e=a(this),t=i.item(e);n.push(t)}),e(n)},n.prototype.select=function(o){var r=this;if(o.selected=!0,a(o.element).is("option"))return o.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(e){var t=[];(o=[o]).push.apply(o,e);for(var n=0;n<o.length;n++){var i=o[n].id;-1===a.inArray(i,t)&&t.push(i)}r.$element.val(t),r.$element.trigger("change")});else{var e=o.id;this.$element.val(e),this.$element.trigger("change")}},n.prototype.unselect=function(o){var r=this;if(this.$element.prop("multiple"))return o.selected=!1,a(o.element).is("option")?(o.element.selected=!1,void this.$element.trigger("change")):void this.current(function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n].id;i!==o.id&&-1===a.inArray(i,t)&&t.push(i)}r.$element.val(t),r.$element.trigger("change")})},n.prototype.bind=function(e,t){var n=this;(this.container=e).on("select",function(e){n.select(e.data)}),e.on("unselect",function(e){n.unselect(e.data)})},n.prototype.destroy=function(){this.$element.find("*").each(function(){a.removeData(this,"data")})},n.prototype.query=function(i,e){var o=[],r=this;this.$element.children().each(function(){var e=a(this);if(e.is("option")||e.is("optgroup")){var t=r.item(e),n=r.matches(i,t);null!==n&&o.push(n)}}),e({results:o})},n.prototype.addOptions=function(e){t.appendMany(this.$element,e)},n.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup")).label=e.text:void 0!==(t=document.createElement("option")).textContent?t.textContent=e.text:t.innerText=e.text,e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var n=a(t),i=this._normalizeItem(e);return i.element=t,a.data(t,"data",i),n},n.prototype.item=function(e){var t={};if(null!=(t=a.data(e[0],"data")))return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var n=e.children("option"),i=[],o=0;o<n.length;o++){var r=a(n[o]),s=this.item(r);i.push(s)}t.children=i}return(t=this._normalizeItem(t)).element=e[0],a.data(e[0],"data",t),t},n.prototype._normalizeItem=function(e){a.isPlainObject(e)||(e={id:e,text:e});return null!=(e=a.extend({},{text:""},e)).id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),a.extend({},{selected:!1,disabled:!1},e)},n.prototype.matches=function(e,t){return this.options.get("matcher")(e,t)},n}),e.define("select2/data/array",["./select","../utils","jquery"],function(e,f,g){function i(e,t){var n=t.get("data")||[];i.__super__.constructor.call(this,e,t),this.addOptions(this.convertToOptions(n))}return f.Extend(i,e),i.prototype.select=function(n){var e=this.$element.find("option").filter(function(e,t){return t.value==n.id.toString()});0===e.length&&(e=this.option(n),this.addOptions(e)),i.__super__.select.call(this,n)},i.prototype.convertToOptions=function(e){function t(e){return function(){return g(this).val()==e.id}}for(var n=this,i=this.$element.find("option"),o=i.map(function(){return n.item(g(this)).id}).get(),r=[],s=0;s<e.length;s++){var a=this._normalizeItem(e[s]);if(0<=g.inArray(a.id,o)){var l=i.filter(t(a)),c=this.item(l),u=g.extend(!0,{},a,c),d=this.option(u);l.replaceWith(d)}else{var p=this.option(a);if(a.children){var h=this.convertToOptions(a.children);f.appendMany(p,h)}r.push(p)}}return r},i}),e.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,r){function n(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),n.__super__.constructor.call(this,e,t)}return t.Extend(n,e),n.prototype._applyDefaults=function(e){var t={data:function(e){return r.extend({},e,{q:e.term})},transport:function(e,t,n){var i=r.ajax(e);return i.then(t),i.fail(n),i}};return r.extend({},t,e,!0)},n.prototype.processResults=function(e){return e},n.prototype.query=function(n,i){function e(){var e=t.transport(t,function(e){var t=o.processResults(e,n);o.options.get("debug")&&window.console&&console.error&&(t&&t.results&&r.isArray(t.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),i(t)},function(){e.status&&"0"===e.status||o.trigger("results:message",{message:"errorLoading"})});o._request=e}var o=this;null!=this._request&&(r.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var t=r.extend({type:"GET"},this.ajaxOptions);"function"==typeof t.url&&(t.url=t.url.call(this.$element,n)),"function"==typeof t.data&&(t.data=t.data.call(this.$element,n)),this.ajaxOptions.delay&&null!=n.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(e,this.ajaxOptions.delay)):e()},n}),e.define("select2/data/tags",["jquery"],function(u){function e(e,t,n){var i=n.get("tags"),o=n.get("createTag");void 0!==o&&(this.createTag=o);var r=n.get("insertTag");if(void 0!==r&&(this.insertTag=r),e.call(this,t,n),u.isArray(i))for(var s=0;s<i.length;s++){var a=i[s],l=this._normalizeItem(a),c=this.option(l);this.$element.append(c)}}return e.prototype.query=function(e,c,u){var d=this;return this._removeOldTags(),null==c.term||null!=c.page?void e.call(this,c,u):void e.call(this,c,function e(t,n){for(var i=t.results,o=0;o<i.length;o++){var r=i[o],s=null!=r.children&&!e({results:r.children},!0);if(r.text===c.term||s)return!n&&(t.data=i,void u(t))}if(n)return!0;var a=d.createTag(c);if(null!=a){var l=d.option(a);l.attr("data-select2-tag",!0),d.addOptions([l]),d.insertTag(i,a)}t.results=i,u(t)})},e.prototype.createTag=function(e,t){var n=u.trim(t.term);return""===n?null:{id:n,text:n}},e.prototype.insertTag=function(e,t,n){t.unshift(n)},e.prototype._removeOldTags=function(e){(this._lastTag,this.$element.find("option[data-select2-tag]")).each(function(){this.selected||u(this).remove()})},e}),e.define("select2/data/tokenizer",["jquery"],function(d){function e(e,t,n){var i=n.get("tokenizer");void 0!==i&&(this.tokenizer=i),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){e.call(this,t,n),this.$search=t.dropdown.$search||t.selection.$search||n.find(".select2-search__field")},e.prototype.query=function(e,t,n){var o=this;t.term=t.term||"";var i=this.tokenizer(t,this.options,function(e){var t,n=o._normalizeItem(e);if(!o.$element.find("option").filter(function(){return d(this).val()===n.id}).length){var i=o.option(n);i.attr("data-select2-tag",!0),o._removeOldTags(),o.addOptions([i])}t=n,o.trigger("select",{data:t})});i.term!==t.term&&(this.$search.length&&(this.$search.val(i.term),this.$search.focus()),t.term=i.term),e.call(this,t,n)},e.prototype.tokenizer=function(e,t,n,i){for(var o=n.get("tokenSeparators")||[],r=t.term,s=0,a=this.createTag||function(e){return{id:e.term,text:e.term}};s<r.length;){var l=r[s];if(-1!==d.inArray(l,o)){var c=r.substr(0,s),u=a(d.extend({},t,{term:c}));null!=u?(i(u),r=r.substr(s+1)||"",s=0):s++}else s++}return{term:r}},e}),e.define("select2/data/minimumInputLength",[],function(){function e(e,t,n){this.minimumInputLength=n.get("minimumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",t.term.length<this.minimumInputLength?void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),e.define("select2/data/maximumInputLength",[],function(){function e(e,t,n){this.maximumInputLength=n.get("maximumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",0<this.maximumInputLength&&t.term.length>this.maximumInputLength?void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),e.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,n){this.maximumSelectionLength=n.get("maximumSelectionLength"),e.call(this,t,n)}return e.prototype.query=function(n,i,o){var r=this;this.current(function(e){var t=null!=e?e.length:0;return 0<r.maximumSelectionLength&&t>=r.maximumSelectionLength?void r.trigger("results:message",{message:"maximumSelected",args:{maximum:r.maximumSelectionLength}}):void n.call(r,i,o)})},e}),e.define("select2/dropdown",["jquery","./utils"],function(t,e){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return e.Extend(n,e.Observable),n.prototype.render=function(){var e=t('<span class="select2-dropdown"><span class="select2-results"></span></span>');return e.attr("dir",this.options.get("dir")),this.$dropdown=e},n.prototype.bind=function(){},n.prototype.position=function(e,t){},n.prototype.destroy=function(){this.$dropdown.remove()},n}),e.define("select2/dropdown/search",["jquery","../utils"],function(o,e){function t(){}return t.prototype.render=function(e){var t=e.call(this),n=o('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=n,this.$search=n.find("input"),t.prepend(n),t},t.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),this.$search.on("keydown",function(e){i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(e){o(this).off("keyup")}),this.$search.on("keyup input",function(e){i.handleSearch(e)}),t.on("open",function(){i.$search.attr("tabindex",0),i.$search.focus(),window.setTimeout(function(){i.$search.focus()},0)}),t.on("close",function(){i.$search.attr("tabindex",-1),i.$search.val("")}),t.on("focus",function(){t.isOpen()&&i.$search.focus()}),t.on("results:all",function(e){null!=e.query.term&&""!==e.query.term||(i.showSearch(e)?i.$searchContainer.removeClass("select2-search--hide"):i.$searchContainer.addClass("select2-search--hide"))})},t.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},t.prototype.showSearch=function(e,t){return!0},t}),e.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,n,i){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n,i)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var n=t.slice(0),i=t.length-1;0<=i;i--){var o=t[i];this.placeholder.id===o.id&&n.splice(i,1)}return n},e}),e.define("select2/dropdown/infiniteScroll",["jquery"],function(o){function e(e,t,n,i){this.lastParams={},e.call(this,t,n,i),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return e.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("query",function(e){i.lastParams=e,i.loading=!0}),t.on("query:append",function(e){i.lastParams=e,i.loading=!0}),this.$results.on("scroll",function(){var e=o.contains(document.documentElement,i.$loadingMore[0]);if(!i.loading&&e){var t=i.$results.offset().top+i.$results.outerHeight(!1);i.$loadingMore.offset().top+i.$loadingMore.outerHeight(!1)<=t+50&&i.loadMore()}})},e.prototype.loadMore=function(){this.loading=!0;var e=o.extend({},{page:1},this.lastParams);e.page++,this.trigger("query:append",e)},e.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},e.prototype.createLoadingMore=function(){var e=o('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),t=this.options.get("translations").get("loadingMore");return e.html(t(this.lastParams)),e},e}),e.define("select2/dropdown/attachBody",["jquery","../utils"],function(f,a){function e(e,t,n){this.$dropdownParent=n.get("dropdownParent")||f(document.body),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){var i=this,o=!1;e.call(this,t,n),t.on("open",function(){i._showDropdown(),i._attachPositioningHandler(t),o||(o=!0,t.on("results:all",function(){i._positionDropdown(),i._resizeDropdown()}),t.on("results:append",function(){i._positionDropdown(),i._resizeDropdown()}))}),t.on("close",function(){i._hideDropdown(),i._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},e.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},e.prototype.position=function(e,t,n){t.attr("class",n.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=n},e.prototype.render=function(e){var t=f("<span></span>"),n=e.call(this);return t.append(n),this.$dropdownContainer=t},e.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},e.prototype._attachPositioningHandler=function(e,t){var n=this,i="scroll.select2."+t.id,o="resize.select2."+t.id,r="orientationchange.select2."+t.id,s=this.$container.parents().filter(a.hasScroll);s.each(function(){f(this).data("select2-scroll-position",{x:f(this).scrollLeft(),y:f(this).scrollTop()})}),s.on(i,function(e){var t=f(this).data("select2-scroll-position");f(this).scrollTop(t.y)}),f(window).on(i+" "+o+" "+r,function(e){n._positionDropdown(),n._resizeDropdown()})},e.prototype._detachPositioningHandler=function(e,t){var n="scroll.select2."+t.id,i="resize.select2."+t.id,o="orientationchange.select2."+t.id;this.$container.parents().filter(a.hasScroll).off(n),f(window).off(n+" "+i+" "+o)},e.prototype._positionDropdown=function(){var e=f(window),t=this.$dropdown.hasClass("select2-dropdown--above"),n=this.$dropdown.hasClass("select2-dropdown--below"),i=null,o=this.$container.offset();o.bottom=o.top+this.$container.outerHeight(!1);var r={height:this.$container.outerHeight(!1)};r.top=o.top,r.bottom=o.top+r.height;var s=this.$dropdown.outerHeight(!1),a=e.scrollTop(),l=e.scrollTop()+e.height(),c=a<o.top-s,u=l>o.bottom+s,d={left:o.left,top:r.bottom},p=this.$dropdownParent;"static"===p.css("position")&&(p=p.offsetParent());var h=p.offset();d.top-=h.top,d.left-=h.left,t||n||(i="below"),u||!c||t?!c&&u&&t&&(i="below"):i="above",("above"==i||t&&"below"!==i)&&(d.top=r.top-h.top-s),null!=i&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+i),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+i)),this.$dropdownContainer.css(d)},e.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},e.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},e}),e.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(e,t,n,i){this.minimumResultsForSearch=n.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,n,i)}return e.prototype.showSearch=function(e,t){return!(function e(t){for(var n=0,i=0;i<t.length;i++){var o=t[i];o.children?n+=e(o.children):n++}return n}(t.data.results)<this.minimumResultsForSearch)&&e.call(this,t)},e}),e.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("close",function(e){i._handleSelectOnClose(e)})},e.prototype._handleSelectOnClose=function(e,t){if(t&&null!=t.originalSelect2Event){var n=t.originalSelect2Event;if("select"===n._type||"unselect"===n._type)return}var i=this.getHighlightedResults();if(!(i.length<1)){var o=i.data("data");null!=o.element&&o.element.selected||null==o.element&&o.selected||this.trigger("select",{data:o})}},e}),e.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("select",function(e){i._selectTriggered(e)}),t.on("unselect",function(e){i._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var n=t.originalEvent;n&&n.ctrlKey||this.trigger("close",{originalEvent:n,originalSelect2Event:t})},e}),e.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,n="Please delete "+t+" character";return 1!=t&&(n+="s"),n},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"}}}),e.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(f,g,m,v,y,_,w,$,b,x,A,t,C,S,O,E,D,T,q,j,L,k,P,I,M,R,z,H,e){function n(){this.reset()}return n.prototype.apply=function(t){if(null==(t=f.extend(!0,{},this.defaults,t)).dataAdapter){if(null!=t.ajax?t.dataAdapter=O:null!=t.data?t.dataAdapter=S:t.dataAdapter=C,0<t.minimumInputLength&&(t.dataAdapter=x.Decorate(t.dataAdapter,T)),0<t.maximumInputLength&&(t.dataAdapter=x.Decorate(t.dataAdapter,q)),0<t.maximumSelectionLength&&(t.dataAdapter=x.Decorate(t.dataAdapter,j)),t.tags&&(t.dataAdapter=x.Decorate(t.dataAdapter,E)),(null!=t.tokenSeparators||null!=t.tokenizer)&&(t.dataAdapter=x.Decorate(t.dataAdapter,D)),null!=t.query){var e=g(t.amdBase+"compat/query");t.dataAdapter=x.Decorate(t.dataAdapter,e)}if(null!=t.initSelection){var n=g(t.amdBase+"compat/initSelection");t.dataAdapter=x.Decorate(t.dataAdapter,n)}}if(null==t.resultsAdapter&&(t.resultsAdapter=m,null!=t.ajax&&(t.resultsAdapter=x.Decorate(t.resultsAdapter,I)),null!=t.placeholder&&(t.resultsAdapter=x.Decorate(t.resultsAdapter,P)),t.selectOnClose&&(t.resultsAdapter=x.Decorate(t.resultsAdapter,z))),null==t.dropdownAdapter){if(t.multiple)t.dropdownAdapter=L;else{var i=x.Decorate(L,k);t.dropdownAdapter=i}if(0!==t.minimumResultsForSearch&&(t.dropdownAdapter=x.Decorate(t.dropdownAdapter,R)),t.closeOnSelect&&(t.dropdownAdapter=x.Decorate(t.dropdownAdapter,H)),null!=t.dropdownCssClass||null!=t.dropdownCss||null!=t.adaptDropdownCssClass){var o=g(t.amdBase+"compat/dropdownCss");t.dropdownAdapter=x.Decorate(t.dropdownAdapter,o)}t.dropdownAdapter=x.Decorate(t.dropdownAdapter,M)}if(null==t.selectionAdapter){if(t.multiple?t.selectionAdapter=y:t.selectionAdapter=v,null!=t.placeholder&&(t.selectionAdapter=x.Decorate(t.selectionAdapter,_)),t.allowClear&&(t.selectionAdapter=x.Decorate(t.selectionAdapter,w)),t.multiple&&(t.selectionAdapter=x.Decorate(t.selectionAdapter,$)),null!=t.containerCssClass||null!=t.containerCss||null!=t.adaptContainerCssClass){var r=g(t.amdBase+"compat/containerCss");t.selectionAdapter=x.Decorate(t.selectionAdapter,r)}t.selectionAdapter=x.Decorate(t.selectionAdapter,b)}if("string"==typeof t.language)if(0<t.language.indexOf("-")){var s=t.language.split("-")[0];t.language=[t.language,s]}else t.language=[t.language];if(f.isArray(t.language)){var a=new A;t.language.push("en");for(var l=t.language,c=0;c<l.length;c++){var u=l[c],d={};try{d=A.loadPath(u)}catch(e){try{u=this.defaults.amdLanguageBase+u,d=A.loadPath(u)}catch(e){t.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+u+'" could not be automatically loaded. A fallback will be used instead.');continue}}a.extend(d)}t.translations=a}else{var p=A.loadPath(this.defaults.amdLanguageBase+"en"),h=new A(t.language);h.extend(p),t.translations=h}return t},n.prototype.reset=function(){function a(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return t[e]||e})}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:x.escapeMarkup,language:e,matcher:function e(t,n){if(""===f.trim(t.term))return n;if(n.children&&0<n.children.length){for(var i=f.extend(!0,{},n),o=n.children.length-1;0<=o;o--)null==e(t,n.children[o])&&i.children.splice(o,1);return 0<i.children.length?i:e(t,i)}var r=a(n.text).toUpperCase(),s=a(t.term).toUpperCase();return-1<r.indexOf(s)?n:null},minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},n.prototype.set=function(e,t){var n={};n[f.camelCase(e)]=t;var i=x._convertData(n);f.extend(this.defaults,i)},new n}),e.define("select2/options",["require","jquery","./defaults","./utils"],function(i,r,o,s){function e(e,t){if(this.options=e,null!=t&&this.fromElement(t),this.options=o.apply(this.options),t&&t.is("input")){var n=i(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=s.Decorate(this.options.dataAdapter,n)}}return e.prototype.fromElement=function(e){var t=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.language&&(e.prop("lang")?this.options.language=e.prop("lang").toLowerCase():e.closest("[lang]").prop("lang")&&(this.options.language=e.closest("[lang]").prop("lang"))),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),e.data("data",e.data("select2Tags")),e.data("tags",!0)),e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",e.data("ajaxUrl")),e.data("ajax--url",e.data("ajaxUrl")));var n;n=r.fn.jquery&&"1."==r.fn.jquery.substr(0,2)&&e[0].dataset?r.extend(!0,{},e[0].dataset,e.data()):e.data();var i=r.extend(!0,{},n);for(var o in i=s._convertData(i))-1<r.inArray(o,t)||(r.isPlainObject(this.options[o])?r.extend(this.options[o],i[o]):this.options[o]=i[o]);return this},e.prototype.get=function(e){return this.options[e]},e.prototype.set=function(e,t){this.options[e]=t},e}),e.define("select2/core",["jquery","./options","./utils","./keys"],function(o,c,n,i){var u=function(e,t){null!=e.data("select2")&&e.data("select2").destroy(),this.$element=e,this.id=this._generateId(e),t=t||{},this.options=new c(t,e),u.__super__.constructor.call(this);var n=e.attr("tabindex")||0;e.data("old-tabindex",n),e.attr("tabindex","-1");var i=this.options.get("dataAdapter");this.dataAdapter=new i(e,this.options);var o=this.render();this._placeContainer(o);var r=this.options.get("selectionAdapter");this.selection=new r(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,o);var s=this.options.get("dropdownAdapter");this.dropdown=new s(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,o);var a=this.options.get("resultsAdapter");this.results=new a(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var l=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){l.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),e.data("select2",this)};return n.Extend(u,n.Observable),u.prototype._generateId=function(e){return"select2-"+(null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+n.generateChars(2):n.generateChars(4)).replace(/(:|\.|\[|\]|,)/g,"")},u.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},u.prototype._resolveWidth=function(e,t){var n=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var i=this._resolveWidth(e,"style");return null!=i?i:this._resolveWidth(e,"element")}if("element"==t){var o=e.outerWidth(!1);return o<=0?"auto":o+"px"}if("style"!=t)return t;var r=e.attr("style");if("string"!=typeof r)return null;for(var s=r.split(";"),a=0,l=s.length;a<l;a+=1){var c=s[a].replace(/\s/g,"").match(n);if(null!==c&&1<=c.length)return c[1]}return null},u.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},u.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this.$element.on("focus.select2",function(e){t.trigger("focus",e)}),this._syncA=n.bind(this._syncAttributes,this),this._syncS=n.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=e?(this._observer=new e(function(e){o.each(e,t._syncA),o.each(e,t._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},u.prototype._registerDataEvents=function(){var n=this;this.dataAdapter.on("*",function(e,t){n.trigger(e,t)})},u.prototype._registerSelectionEvents=function(){var n=this,i=["toggle","focus"];this.selection.on("toggle",function(){n.toggleDropdown()}),this.selection.on("focus",function(e){n.focus(e)}),this.selection.on("*",function(e,t){-1===o.inArray(e,i)&&n.trigger(e,t)})},u.prototype._registerDropdownEvents=function(){var n=this;this.dropdown.on("*",function(e,t){n.trigger(e,t)})},u.prototype._registerResultsEvents=function(){var n=this;this.results.on("*",function(e,t){n.trigger(e,t)})},u.prototype._registerEvents=function(){var n=this;this.on("open",function(){n.$container.addClass("select2-container--open")}),this.on("close",function(){n.$container.removeClass("select2-container--open")}),this.on("enable",function(){n.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){n.$container.addClass("select2-container--disabled")}),this.on("blur",function(){n.$container.removeClass("select2-container--focus")}),this.on("query",function(t){n.isOpen()||n.trigger("open",{}),this.dataAdapter.query(t,function(e){n.trigger("results:all",{data:e,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(e){n.trigger("results:append",{data:e,query:t})})}),this.on("keypress",function(e){var t=e.which;t===i.ENTER&&(e.ctrlKey||e.metaKey)&&(n.close()||MapSVG.formBuilder.save()),t!==i.ESC||n.isOpen()||n.close()||MapSVG.formBuilder.close(),n.isOpen()?t===i.ESC||t===i.TAB||t===i.UP&&e.altKey?(n.close(),e.preventDefault()):t!==i.ENTER||e.ctrlKey||e.metaKey?t===i.SPACE&&e.ctrlKey?(n.trigger("results:toggle",{}),e.preventDefault()):t===i.UP?(n.trigger("results:previous",{}),e.preventDefault()):t===i.DOWN&&(n.trigger("results:next",{}),e.preventDefault()):(n.trigger("results:select",{}),e.preventDefault()):(t===(i.ENTER&&!e.ctrlKey&&!e.metaKey)||t===i.SPACE||t===i.DOWN&&e.altKey)&&(n.open(),e.preventDefault())})},u.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},u.prototype._syncSubtree=function(e,t){var n=!1,i=this;if(!e||!e.target||"OPTION"===e.target.nodeName||"OPTGROUP"===e.target.nodeName){if(t)if(t.addedNodes&&0<t.addedNodes.length)for(var o=0;o<t.addedNodes.length;o++){t.addedNodes[o].selected&&(n=!0)}else t.removedNodes&&0<t.removedNodes.length&&(n=!0);else n=!0;n&&this.dataAdapter.current(function(e){i.trigger("selection:update",{data:e})})}},u.prototype.trigger=function(e,t){var n=u.__super__.trigger,i={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===t&&(t={}),e in i){var o=i[e],r={prevented:!1,name:e,args:t};if(n.call(this,o,r),r.prevented)return void(t.prevented=!0)}n.call(this,e,t)},u.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},u.prototype.open=function(){this.isOpen()||this.trigger("query",{})},u.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},u.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},u.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},u.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},u.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),(null==e||0===e.length)&&(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},u.prototype.data=function(){this.options.get("debug")&&0<arguments.length&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var t=[];return this.dataAdapter.current(function(e){t=e}),t},u.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==e||0===e.length)return this.$element.val();var t=e[0];o.isArray(t)&&(t=o.map(t,function(e){return e.toString()})),this.$element.val(t).trigger("change")},u.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},u.prototype.render=function(){var e=o('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return e.attr("dir",this.options.get("dir")),this.$container=e,this.$container.addClass("select2-container--"+this.options.get("theme")),e.data("element",this.$element),e},u}),e.define("select2/compat/utils",["jquery"],function(s){return{syncCssClasses:function(e,t,n){var i,o,r=[];(i=s.trim(e.attr("class")))&&s((i=""+i).split(/\s+/)).each(function(){0===this.indexOf("select2-")&&r.push(this)}),(i=s.trim(t.attr("class")))&&s((i=""+i).split(/\s+/)).each(function(){0!==this.indexOf("select2-")&&null!=(o=n(this))&&r.push(o)}),e.attr("class",r.join(" "))}}}),e.define("select2/compat/containerCss",["jquery","./utils"],function(s,a){function l(e){return null}function e(){}return e.prototype.render=function(e){var t=e.call(this),n=this.options.get("containerCssClass")||"";s.isFunction(n)&&(n=n(this.$element));var i=this.options.get("adaptContainerCssClass");if(i=i||l,-1!==n.indexOf(":all:")){n=n.replace(":all:","");var o=i;i=function(e){var t=o(e);return null!=t?t+" "+e:e}}var r=this.options.get("containerCss")||{};return s.isFunction(r)&&(r=r(this.$element)),a.syncCssClasses(t,this.$element,i),t.css(r),t.addClass(n),t},e}),e.define("select2/compat/dropdownCss",["jquery","./utils"],function(s,a){function l(e){return null}function e(){}return e.prototype.render=function(e){var t=e.call(this),n=this.options.get("dropdownCssClass")||"";s.isFunction(n)&&(n=n(this.$element));var i=this.options.get("adaptDropdownCssClass");if(i=i||l,-1!==n.indexOf(":all:")){n=n.replace(":all:","");var o=i;i=function(e){var t=o(e);return null!=t?t+" "+e:e}}var r=this.options.get("dropdownCss")||{};return s.isFunction(r)&&(r=r(this.$element)),a.syncCssClasses(t,this.$element,i),t.css(r),t.addClass(n),t},e}),e.define("select2/compat/initSelection",["jquery"],function(i){function e(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2"),this.initSelection=n.get("initSelection"),this._isInitialized=!1,e.call(this,t,n)}return e.prototype.current=function(e,t){var n=this;return this._isInitialized?void e.call(this,t):void this.initSelection.call(null,this.$element,function(e){n._isInitialized=!0,i.isArray(e)||(e=[e]),t(e)})},e}),e.define("select2/compat/inputData",["jquery"],function(s){function e(e,t,n){this._currentData=[],this._valueSeparator=n.get("valueSeparator")||",","hidden"===t.prop("type")&&n.get("debug")&&console&&console.warn&&console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead."),e.call(this,t,n)}return e.prototype.current=function(e,t){function i(e,t){var n=[];return e.selected||-1!==s.inArray(e.id,t)?(e.selected=!0,n.push(e)):e.selected=!1,e.children&&n.push.apply(n,i(e.children,t)),n}for(var n=[],o=0;o<this._currentData.length;o++){var r=this._currentData[o];n.push.apply(n,i(r,this.$element.val().split(this._valueSeparator)))}t(n)},e.prototype.select=function(e,t){if(this.options.get("multiple")){var n=this.$element.val();n+=this._valueSeparator+t.id,this.$element.val(n),this.$element.trigger("change")}else this.current(function(e){s.map(e,function(e){e.selected=!1})}),this.$element.val(t.id),this.$element.trigger("change")},e.prototype.unselect=function(e,o){var r=this;o.selected=!1,this.current(function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];o.id!=i.id&&t.push(i.id)}r.$element.val(t.join(r._valueSeparator)),r.$element.trigger("change")})},e.prototype.query=function(e,t,n){for(var i=[],o=0;o<this._currentData.length;o++){var r=this._currentData[o],s=this.matches(t,r);null!==s&&i.push(s)}n({results:i})},e.prototype.addOptions=function(e,t){var n=s.map(t,function(e){return s.data(e[0],"data")});this._currentData.push.apply(this._currentData,n)},e}),e.define("select2/compat/matcher",["jquery"],function(s){return function(r){return function(e,t){var n=s.extend(!0,{},t);if(null==e.term||""===s.trim(e.term))return n;if(t.children){for(var i=t.children.length-1;0<=i;i--){var o=t.children[i];r(e.term,o.text,o)||n.children.splice(i,1)}if(0<n.children.length)return n}return r(e.term,t.text,t)?n:null}}}),e.define("select2/compat/query",[],function(){function e(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2."),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.callback=n,this.options.get("query").call(null,t)},e}),e.define("select2/dropdown/attachContainer",[],function(){function e(e,t,n){e.call(this,t,n)}return e.prototype.position=function(e,t,n){n.find(".dropdown-wrapper").append(t),t.addClass("select2-dropdown--below"),n.addClass("select2-container--below")},e}),e.define("select2/dropdown/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);this.$dropdown.on(["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"].join(" "),function(e){e.stopPropagation()})},e}),e.define("select2/selection/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);this.$selection.on(["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"].join(" "),function(e){e.stopPropagation()})},e}),t=function(p){function t(e){var t=e||window.event,n=v.call(arguments,1),i=0,o=0,r=0,s=0,a=0,l=0;if((e=p.event.fix(t)).type="mousewheel","detail"in t&&(r=-1*t.detail),"wheelDelta"in t&&(r=t.wheelDelta),"wheelDeltaY"in t&&(r=t.wheelDeltaY),"wheelDeltaX"in t&&(o=-1*t.wheelDeltaX),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(o=-1*r,r=0),i=0===r?o:r,"deltaY"in t&&(i=r=-1*t.deltaY),"deltaX"in t&&(o=t.deltaX,0===r&&(i=-1*o)),0!==r||0!==o){if(1===t.deltaMode){var c=p.data(this,"mousewheel-line-height");i*=c,r*=c,o*=c}else if(2===t.deltaMode){var u=p.data(this,"mousewheel-page-height");i*=u,r*=u,o*=u}if(s=Math.max(Math.abs(r),Math.abs(o)),(!m||s<m)&&(f(t,m=s)&&(m/=40)),f(t,s)&&(i/=40,o/=40,r/=40),i=Math[1<=i?"floor":"ceil"](i/m),o=Math[1<=o?"floor":"ceil"](o/m),r=Math[1<=r?"floor":"ceil"](r/m),y.settings.normalizeOffset&&this.getBoundingClientRect){var d=this.getBoundingClientRect();a=e.clientX-d.left,l=e.clientY-d.top}return e.deltaX=o,e.deltaY=r,e.deltaFactor=m,e.offsetX=a,e.offsetY=l,e.deltaMode=0,n.unshift(e,i,o,r),g&&clearTimeout(g),g=setTimeout(h,200),(p.event.dispatch||p.event.handle).apply(this,n)}}function h(){m=null}function f(e,t){return y.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var g,m,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],n="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],v=Array.prototype.slice;if(p.event.fixHooks)for(var i=e.length;i;)p.event.fixHooks[e[--i]]=p.event.mouseHooks;var y=p.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t;p.data(this,"mousewheel-line-height",y.getLineHeight(this)),p.data(this,"mousewheel-page-height",y.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null;p.removeData(this,"mousewheel-line-height"),p.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var t=p(e),n=t["offsetParent"in p.fn?"offsetParent":"parent"]();return n.length||(n=p("body")),parseInt(n.css("fontSize"),10)||parseInt(t.css("fontSize"),10)||16},getPageHeight:function(e){return p(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};p.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})},"function"==typeof e.define&&e.define.amd?e.define("jquery-mousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(n),e.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(o,e,r,t){if(null==o.fn.mselect2){var s=["open","close","destroy"];o.fn.mselect2=function(t){if("object"==typeof(t=t||{}))return this.each(function(){var e=o.extend(!0,{},t);new r(o(this),e)}),this;if("string"!=typeof t)throw new Error("Invalid arguments for Select2: "+t);var n,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=o(this).data("select2");null==e&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),n=e[t].apply(e,i)}),-1<o.inArray(t,s)?this:n}}return null==o.fn.mselect2.defaults&&(o.fn.mselect2.defaults=t),r}),{define:e.define,require:e.require}}(),t=e.require("jquery.select2");return n.fn.mselect2.amd=e,t});
!function(h,r,n,t,i){var s,o,e=0,a=(s=t.userAgent,o=/msie\s\d+/i,0<s.search(o)&&(s=(s=o.exec(s).toString()).split(" ")[1])<9&&(h("html").addClass("lt-ie9"),!0));Function.prototype.bind||(Function.prototype.bind=function(s){var o=this,e=[].slice;if("function"!=typeof o)throw new TypeError;var h=e.call(arguments,1),r=function(){if(this instanceof r){(t=function(){}).prototype=o.prototype;var t=new t,i=o.apply(t,h.concat(e.call(arguments)));return Object(i)===i?i:t}return o.apply(s,h.concat(e.call(arguments)))};return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,i){var s;if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),e=o.length>>>0;if(0===e)return-1;if(s=+i||0,1/0===Math.abs(s)&&(s=0),e<=s)return-1;for(s=Math.max(0<=s?s:e-Math.abs(s),0);s<e;){if(s in o&&o[s]===t)return s;s++}return-1});var c=function(t,i,s){this.VERSION="2.1.2",this.input=t,this.plugin_count=s,this.old_to=this.old_from=this.update_tm=this.calc_count=this.current_plugin=0,this.raf_id=this.old_min_interval=null,this.is_update=this.is_key=this.no_diapason=this.force_redraw=this.dragging=!1,this.is_start=!0,this.is_click=this.is_resize=this.is_active=this.is_finish=!1,this.$cache={win:h(n),body:h(r.body),input:h(t),cont:null,rs:null,min:null,max:null,from:null,to:null,single:null,bar:null,line:null,s_single:null,s_from:null,s_to:null,shad_single:null,shad_from:null,shad_to:null,edge:null,grid:null,grid_labels:[]},this.coords={x_gap:0,x_pointer:0,w_rs:0,w_rs_old:0,w_handle:0,p_gap:0,p_gap_left:0,p_gap_right:0,p_step:0,p_pointer:0,p_handle:0,p_single_fake:0,p_single_real:0,p_from_fake:0,p_from_real:0,p_to_fake:0,p_to_real:0,p_bar_x:0,p_bar_w:0,grid_gap:0,big_num:0,big:[],big_w:[],big_p:[],big_x:[]},this.labels={w_min:0,w_max:0,w_from:0,w_to:0,w_single:0,p_min:0,p_max:0,p_from_fake:0,p_from_left:0,p_to_fake:0,p_to_left:0,p_single_fake:0,p_single_left:0};var o,e=this.$cache.input;for(o in t=e.prop("value"),s={type:"single",min:10,max:100,from:null,to:null,step:1,min_interval:0,max_interval:0,drag_interval:!1,values:[],p_values:[],from_fixed:!1,from_min:null,from_max:null,from_shadow:!1,to_fixed:!1,to_min:null,to_max:null,to_shadow:!1,prettify_enabled:!0,prettify_separator:" ",prettify:null,force_edges:!1,keyboard:!1,keyboard_step:5,grid:!1,grid_margin:!0,grid_num:4,grid_snap:!1,hide_min_max:!1,hide_from_to:!1,prefix:"",postfix:"",max_postfix:"",decorate_both:!0,values_separator:" — ",input_values_separator:";",disable:!1,onStart:null,onChange:null,onFinish:null,onUpdate:null},(e={type:e.data("type"),min:e.data("min"),max:e.data("max"),from:e.data("from"),to:e.data("to"),step:e.data("step"),min_interval:e.data("minInterval"),max_interval:e.data("maxInterval"),drag_interval:e.data("dragInterval"),values:e.data("values"),from_fixed:e.data("fromFixed"),from_min:e.data("fromMin"),from_max:e.data("fromMax"),from_shadow:e.data("fromShadow"),to_fixed:e.data("toFixed"),to_min:e.data("toMin"),to_max:e.data("toMax"),to_shadow:e.data("toShadow"),prettify_enabled:e.data("prettifyEnabled"),prettify_separator:e.data("prettifySeparator"),force_edges:e.data("forceEdges"),keyboard:e.data("keyboard"),keyboard_step:e.data("keyboardStep"),grid:e.data("grid"),grid_margin:e.data("gridMargin"),grid_num:e.data("gridNum"),grid_snap:e.data("gridSnap"),hide_min_max:e.data("hideMinMax"),hide_from_to:e.data("hideFromTo"),prefix:e.data("prefix"),postfix:e.data("postfix"),max_postfix:e.data("maxPostfix"),decorate_both:e.data("decorateBoth"),values_separator:e.data("valuesSeparator"),input_values_separator:e.data("inputValuesSeparator"),disable:e.data("disable")}).values=e.values&&e.values.split(","),e)e.hasOwnProperty(o)&&(e[o]||0===e[o]||delete e[o]);t&&((t=t.split(e.input_values_separator||i.input_values_separator||";"))[0]&&t[0]==+t[0]&&(t[0]=+t[0]),t[1]&&t[1]==+t[1]&&(t[1]=+t[1]),i&&i.values&&i.values.length?(s.from=t[0]&&i.values.indexOf(t[0]),s.to=t[1]&&i.values.indexOf(t[1])):(s.from=t[0]&&+t[0],s.to=t[1]&&+t[1])),h.extend(s,i),h.extend(s,e),this.options=s,this.validate(),this.result={input:this.$cache.input,slider:null,min:this.options.min,max:this.options.max,from:this.options.from,from_percent:0,from_value:null,to:this.options.to,to_percent:0,to_value:null},this.init()};c.prototype={init:function(t){this.no_diapason=!1,this.coords.p_step=this.convertToPercent(this.options.step,!0),this.target="base",this.toggleInput(),this.append(),this.setMinMax(),t?(this.force_redraw=!0,this.calc(!0),this.callOnUpdate()):(this.force_redraw=!0,this.calc(!0),this.callOnStart()),this.updateScene()},append:function(){this.$cache.input.before('<span class="irs js-irs-'+this.plugin_count+'"></span>'),this.$cache.input.prop("readonly",!0),this.$cache.cont=this.$cache.input.prev(),this.result.slider=this.$cache.cont,this.$cache.cont.html('<span class="irs"><span class="irs-line" tabindex="-1"><span class="irs-line-left"></span><span class="irs-line-mid"></span><span class="irs-line-right"></span></span><span class="irs-min">0</span><span class="irs-max">1</span><span class="irs-from">0</span><span class="irs-to">0</span><span class="irs-single">0</span></span><span class="irs-grid"></span><span class="irs-bar"></span>'),this.$cache.rs=this.$cache.cont.find(".irs"),this.$cache.min=this.$cache.cont.find(".irs-min"),this.$cache.max=this.$cache.cont.find(".irs-max"),this.$cache.from=this.$cache.cont.find(".irs-from"),this.$cache.to=this.$cache.cont.find(".irs-to"),this.$cache.single=this.$cache.cont.find(".irs-single"),this.$cache.bar=this.$cache.cont.find(".irs-bar"),this.$cache.line=this.$cache.cont.find(".irs-line"),this.$cache.grid=this.$cache.cont.find(".irs-grid"),"single"===this.options.type?(this.$cache.cont.append('<span class="irs-bar-edge"></span><span class="irs-shadow shadow-single"></span><span class="irs-slider single"></span>'),this.$cache.edge=this.$cache.cont.find(".irs-bar-edge"),this.$cache.s_single=this.$cache.cont.find(".single"),this.$cache.from[0].style.visibility="hidden",this.$cache.to[0].style.visibility="hidden",this.$cache.shad_single=this.$cache.cont.find(".shadow-single")):(this.$cache.cont.append('<span class="irs-shadow shadow-from"></span><span class="irs-shadow shadow-to"></span><span class="irs-slider from"></span><span class="irs-slider to"></span>'),this.$cache.s_from=this.$cache.cont.find(".from"),this.$cache.s_to=this.$cache.cont.find(".to"),this.$cache.shad_from=this.$cache.cont.find(".shadow-from"),this.$cache.shad_to=this.$cache.cont.find(".shadow-to"),this.setTopHandler()),this.options.hide_from_to&&(this.$cache.from[0].style.display="none",this.$cache.to[0].style.display="none",this.$cache.single[0].style.display="none"),this.appendGrid(),this.options.disable?(this.appendDisableMask(),this.$cache.input[0].disabled=!0):(this.$cache.cont.removeClass("irs-disabled"),this.$cache.input[0].disabled=!1,this.bindEvents()),this.options.drag_interval&&(this.$cache.bar[0].style.cursor="ew-resize")},setTopHandler:function(){var t=this.options.max,i=this.options.to;this.options.from>this.options.min&&i===t?this.$cache.s_from.addClass("type_last"):i<t&&this.$cache.s_to.addClass("type_last")},changeLevel:function(t){switch(t){case"single":this.coords.p_gap=this.toFixed(this.coords.p_pointer-this.coords.p_single_fake);break;case"from":this.coords.p_gap=this.toFixed(this.coords.p_pointer-this.coords.p_from_fake),this.$cache.s_from.addClass("state_hover"),this.$cache.s_from.addClass("type_last"),this.$cache.s_to.removeClass("type_last");break;case"to":this.coords.p_gap=this.toFixed(this.coords.p_pointer-this.coords.p_to_fake),this.$cache.s_to.addClass("state_hover"),this.$cache.s_to.addClass("type_last"),this.$cache.s_from.removeClass("type_last");break;case"both":this.coords.p_gap_left=this.toFixed(this.coords.p_pointer-this.coords.p_from_fake),this.coords.p_gap_right=this.toFixed(this.coords.p_to_fake-this.coords.p_pointer),this.$cache.s_to.removeClass("type_last"),this.$cache.s_from.removeClass("type_last")}},appendDisableMask:function(){this.$cache.cont.append('<span class="irs-disable-mask"></span>'),this.$cache.cont.addClass("irs-disabled")},remove:function(){this.$cache.cont.remove(),this.$cache.cont=null,this.$cache.line.off("keydown.irs_"+this.plugin_count),this.$cache.body.off("touchmove.irs_"+this.plugin_count),this.$cache.body.off("mousemove.irs_"+this.plugin_count),this.$cache.win.off("touchend.irs_"+this.plugin_count),this.$cache.win.off("mouseup.irs_"+this.plugin_count),a&&(this.$cache.body.off("mouseup.irs_"+this.plugin_count),this.$cache.body.off("mouseleave.irs_"+this.plugin_count)),this.$cache.grid_labels=[],this.coords.big=[],this.coords.big_w=[],this.coords.big_p=[],this.coords.big_x=[],cancelAnimationFrame(this.raf_id)},bindEvents:function(){this.no_diapason||(this.$cache.body.on("touchmove.irs_"+this.plugin_count,this.pointerMove.bind(this)),this.$cache.body.on("mousemove.irs_"+this.plugin_count,this.pointerMove.bind(this)),this.$cache.win.on("touchend.irs_"+this.plugin_count,this.pointerUp.bind(this)),this.$cache.win.on("mouseup.irs_"+this.plugin_count,this.pointerUp.bind(this)),this.$cache.line.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.line.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.options.drag_interval&&"double"===this.options.type?(this.$cache.bar.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"both")),this.$cache.bar.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"both"))):(this.$cache.bar.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.bar.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"))),"single"===this.options.type?(this.$cache.single.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"single")),this.$cache.s_single.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"single")),this.$cache.shad_single.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.single.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"single")),this.$cache.s_single.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"single")),this.$cache.edge.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.shad_single.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"))):(this.$cache.single.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,null)),this.$cache.single.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,null)),this.$cache.from.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"from")),this.$cache.s_from.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"from")),this.$cache.to.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"to")),this.$cache.s_to.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"to")),this.$cache.shad_from.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.shad_to.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.from.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"from")),this.$cache.s_from.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"from")),this.$cache.to.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"to")),this.$cache.s_to.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"to")),this.$cache.shad_from.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.shad_to.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"))),this.options.keyboard&&this.$cache.line.on("keydown.irs_"+this.plugin_count,this.key.bind(this,"keyboard")),a&&(this.$cache.body.on("mouseup.irs_"+this.plugin_count,this.pointerUp.bind(this)),this.$cache.body.on("mouseleave.irs_"+this.plugin_count,this.pointerUp.bind(this))))},pointerMove:function(t){this.dragging&&(this.coords.x_pointer=(t.pageX||t.originalEvent.touches&&t.originalEvent.touches[0].pageX)-this.coords.x_gap,this.calc())},pointerUp:function(t){this.current_plugin===this.plugin_count&&this.is_active&&(this.is_active=!1,this.$cache.cont.find(".state_hover").removeClass("state_hover"),this.force_redraw=!0,a&&h("*").prop("unselectable",!1),this.updateScene(),this.restoreOriginalMinInterval(),(h.contains(this.$cache.cont[0],t.target)||this.dragging)&&(this.is_finish=!0,this.callOnFinish()),this.dragging=!1)},pointerDown:function(t,i){i.preventDefault();var s=i.pageX||i.originalEvent.touches&&i.originalEvent.touches[0].pageX;2!==i.button&&("both"===t&&this.setTempMinInterval(),t||(t=this.target),this.current_plugin=this.plugin_count,this.target=t,this.dragging=this.is_active=!0,this.coords.x_gap=this.$cache.rs.offset().left,this.coords.x_pointer=s-this.coords.x_gap,this.calcPointerPercent(),this.changeLevel(t),a&&h("*").prop("unselectable",!0),this.$cache.line.trigger("focus"),this.updateScene())},pointerClick:function(t,i){i.preventDefault();var s=i.pageX||i.originalEvent.touches&&i.originalEvent.touches[0].pageX;2!==i.button&&(this.current_plugin=this.plugin_count,this.target=t,this.is_click=!0,this.coords.x_gap=this.$cache.rs.offset().left,this.coords.x_pointer=+(s-this.coords.x_gap).toFixed(),this.force_redraw=!0,this.calc(),this.$cache.line.trigger("focus"))},key:function(t,i){if(!(this.current_plugin!==this.plugin_count||i.altKey||i.ctrlKey||i.shiftKey||i.metaKey)){switch(i.which){case 83:case 65:case 40:case 37:i.preventDefault(),this.moveByKey(!1);break;case 87:case 68:case 38:case 39:i.preventDefault(),this.moveByKey(!0)}return!0}},moveByKey:function(t){var i=this.coords.p_pointer;i=t?i+this.options.keyboard_step:i-this.options.keyboard_step;this.coords.x_pointer=this.toFixed(this.coords.w_rs/100*i),this.is_key=!0,this.calc()},setMinMax:function(){this.options&&(this.options.hide_min_max?(this.$cache.min[0].style.display="none",this.$cache.max[0].style.display="none"):(this.options.values.length?(this.$cache.min.html(this.decorate(this.options.p_values[this.options.min])),this.$cache.max.html(this.decorate(this.options.p_values[this.options.max]))):(this.$cache.min.html(this.decorate(this._prettify(this.options.min),this.options.min)),this.$cache.max.html(this.decorate(this._prettify(this.options.max),this.options.max))),this.labels.w_min=this.$cache.min.outerWidth(!1),this.labels.w_max=this.$cache.max.outerWidth(!1)))},setTempMinInterval:function(){var t=this.result.to-this.result.from;null===this.old_min_interval&&(this.old_min_interval=this.options.min_interval),this.options.min_interval=t},restoreOriginalMinInterval:function(){null!==this.old_min_interval&&(this.options.min_interval=this.old_min_interval,this.old_min_interval=null)},calc:function(t){if(this.options&&(this.calc_count++,(10===this.calc_count||t)&&(this.calc_count=0,this.coords.w_rs=this.$cache.rs.outerWidth(!1),this.calcHandlePercent()),this.coords.w_rs)){switch(this.calcPointerPercent(),t=this.getHandleX(),"click"===this.target&&(this.coords.p_gap=this.coords.p_handle/2,t=this.getHandleX(),this.target=this.options.drag_interval?"both_one":this.chooseHandle(t)),this.target){case"base":var i=(this.options.max-this.options.min)/100;t=(this.result.from-this.options.min)/i,i=(this.result.to-this.options.min)/i,this.coords.p_single_real=this.toFixed(t),this.coords.p_from_real=this.toFixed(t),this.coords.p_to_real=this.toFixed(i),this.coords.p_single_real=this.checkDiapason(this.coords.p_single_real,this.options.from_min,this.options.from_max),this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max),this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max),this.coords.p_single_fake=this.convertToFakePercent(this.coords.p_single_real),this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real),this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real),this.target=null;break;case"single":if(this.options.from_fixed)break;this.coords.p_single_real=this.convertToRealPercent(t),this.coords.p_single_real=this.calcWithStep(this.coords.p_single_real),this.coords.p_single_real=this.checkDiapason(this.coords.p_single_real,this.options.from_min,this.options.from_max),this.coords.p_single_fake=this.convertToFakePercent(this.coords.p_single_real);break;case"from":if(this.options.from_fixed)break;this.coords.p_from_real=this.convertToRealPercent(t),this.coords.p_from_real=this.calcWithStep(this.coords.p_from_real),this.coords.p_from_real>this.coords.p_to_real&&(this.coords.p_from_real=this.coords.p_to_real),this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max),this.coords.p_from_real=this.checkMinInterval(this.coords.p_from_real,this.coords.p_to_real,"from"),this.coords.p_from_real=this.checkMaxInterval(this.coords.p_from_real,this.coords.p_to_real,"from"),this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real);break;case"to":if(this.options.to_fixed)break;this.coords.p_to_real=this.convertToRealPercent(t),this.coords.p_to_real=this.calcWithStep(this.coords.p_to_real),this.coords.p_to_real<this.coords.p_from_real&&(this.coords.p_to_real=this.coords.p_from_real),this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max),this.coords.p_to_real=this.checkMinInterval(this.coords.p_to_real,this.coords.p_from_real,"to"),this.coords.p_to_real=this.checkMaxInterval(this.coords.p_to_real,this.coords.p_from_real,"to"),this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real);break;case"both":if(this.options.from_fixed||this.options.to_fixed)break;t=this.toFixed(t+.1*this.coords.p_handle),this.coords.p_from_real=this.convertToRealPercent(t)-this.coords.p_gap_left,this.coords.p_from_real=this.calcWithStep(this.coords.p_from_real),this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max),this.coords.p_from_real=this.checkMinInterval(this.coords.p_from_real,this.coords.p_to_real,"from"),this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real),this.coords.p_to_real=this.convertToRealPercent(t)+this.coords.p_gap_right,this.coords.p_to_real=this.calcWithStep(this.coords.p_to_real),this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max),this.coords.p_to_real=this.checkMinInterval(this.coords.p_to_real,this.coords.p_from_real,"to"),this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real);break;case"both_one":if(this.options.from_fixed||this.options.to_fixed)break;var s=this.convertToRealPercent(t),o=(t=this.result.to_percent-this.result.from_percent)/2;i=s-o,s=s+o;i<0&&(s=(i=0)+t),100<s&&(i=(s=100)-t),this.coords.p_from_real=this.calcWithStep(i),this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max),this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real),this.coords.p_to_real=this.calcWithStep(s),this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max),this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real)}"single"===this.options.type?(this.coords.p_bar_x=this.coords.p_handle/2,this.coords.p_bar_w=this.coords.p_single_fake,this.result.from_percent=this.coords.p_single_real,this.result.from=this.convertToValue(this.coords.p_single_real),this.options.values.length&&(this.result.from_value=this.options.values[this.result.from])):(this.coords.p_bar_x=this.toFixed(this.coords.p_from_fake+this.coords.p_handle/2),this.coords.p_bar_w=this.toFixed(this.coords.p_to_fake-this.coords.p_from_fake),this.result.from_percent=this.coords.p_from_real,this.result.from=this.convertToValue(this.coords.p_from_real),this.result.to_percent=this.coords.p_to_real,this.result.to=this.convertToValue(this.coords.p_to_real),this.options.values.length&&(this.result.from_value=this.options.values[this.result.from],this.result.to_value=this.options.values[this.result.to])),this.calcMinMax(),this.calcLabels()}},calcPointerPercent:function(){this.coords.w_rs?(this.coords.x_pointer<0||isNaN(this.coords.x_pointer)?this.coords.x_pointer=0:this.coords.x_pointer>this.coords.w_rs&&(this.coords.x_pointer=this.coords.w_rs),this.coords.p_pointer=this.toFixed(this.coords.x_pointer/this.coords.w_rs*100)):this.coords.p_pointer=0},convertToRealPercent:function(t){return t/(100-this.coords.p_handle)*100},convertToFakePercent:function(t){return t/100*(100-this.coords.p_handle)},getHandleX:function(){var t=100-this.coords.p_handle,i=this.toFixed(this.coords.p_pointer-this.coords.p_gap);return i<0?i=0:t<i&&(i=t),i},calcHandlePercent:function(){this.coords.w_handle="single"===this.options.type?this.$cache.s_single.outerWidth(!1):this.$cache.s_from.outerWidth(!1),this.coords.p_handle=this.toFixed(this.coords.w_handle/this.coords.w_rs*100)},chooseHandle:function(t){return"single"===this.options.type?"single":t>=this.coords.p_from_real+(this.coords.p_to_real-this.coords.p_from_real)/2?this.options.to_fixed?"from":"to":this.options.from_fixed?"to":"from"},calcMinMax:function(){this.coords.w_rs&&(this.labels.p_min=this.labels.w_min/this.coords.w_rs*100,this.labels.p_max=this.labels.w_max/this.coords.w_rs*100)},calcLabels:function(){this.coords.w_rs&&!this.options.hide_from_to&&("single"===this.options.type?(this.labels.w_single=this.$cache.single.outerWidth(!1),this.labels.p_single_fake=this.labels.w_single/this.coords.w_rs*100,this.labels.p_single_left=this.coords.p_single_fake+this.coords.p_handle/2-this.labels.p_single_fake/2):(this.labels.w_from=this.$cache.from.outerWidth(!1),this.labels.p_from_fake=this.labels.w_from/this.coords.w_rs*100,this.labels.p_from_left=this.coords.p_from_fake+this.coords.p_handle/2-this.labels.p_from_fake/2,this.labels.p_from_left=this.toFixed(this.labels.p_from_left),this.labels.p_from_left=this.checkEdges(this.labels.p_from_left,this.labels.p_from_fake),this.labels.w_to=this.$cache.to.outerWidth(!1),this.labels.p_to_fake=this.labels.w_to/this.coords.w_rs*100,this.labels.p_to_left=this.coords.p_to_fake+this.coords.p_handle/2-this.labels.p_to_fake/2,this.labels.p_to_left=this.toFixed(this.labels.p_to_left),this.labels.p_to_left=this.checkEdges(this.labels.p_to_left,this.labels.p_to_fake),this.labels.w_single=this.$cache.single.outerWidth(!1),this.labels.p_single_fake=this.labels.w_single/this.coords.w_rs*100,this.labels.p_single_left=(this.labels.p_from_left+this.labels.p_to_left+this.labels.p_to_fake)/2-this.labels.p_single_fake/2,this.labels.p_single_left=this.toFixed(this.labels.p_single_left)),this.labels.p_single_left=this.checkEdges(this.labels.p_single_left,this.labels.p_single_fake))},updateScene:function(){this.raf_id&&(cancelAnimationFrame(this.raf_id),this.raf_id=null),clearTimeout(this.update_tm),this.update_tm=null,this.options&&(this.drawHandles(),this.is_active?this.raf_id=requestAnimationFrame(this.updateScene.bind(this)):this.update_tm=setTimeout(this.updateScene.bind(this),300))},drawHandles:function(){this.coords.w_rs=this.$cache.rs.outerWidth(!1),this.coords.w_rs&&(this.coords.w_rs!==this.coords.w_rs_old&&(this.target="base",this.is_resize=!0),(this.coords.w_rs!==this.coords.w_rs_old||this.force_redraw)&&(this.setMinMax(),this.calc(!0),this.drawLabels(),this.options.grid&&(this.calcGridMargin(),this.calcGridLabels()),this.force_redraw=!0,this.coords.w_rs_old=this.coords.w_rs,this.drawShadow()),this.coords.w_rs&&(this.dragging||this.force_redraw||this.is_key)&&((this.old_from!==this.result.from||this.old_to!==this.result.to||this.force_redraw||this.is_key)&&(this.drawLabels(),this.$cache.bar[0].style.left=this.coords.p_bar_x+"%",this.$cache.bar[0].style.width=this.coords.p_bar_w+"%","single"===this.options.type?(this.$cache.s_single[0].style.left=this.coords.p_single_fake+"%",this.$cache.single[0].style.left=this.labels.p_single_left+"%",this.options.values.length?this.$cache.input.prop("value",this.result.from_value):this.$cache.input.prop("value",this.result.from),this.$cache.input.data("from",this.result.from)):(this.$cache.s_from[0].style.left=this.coords.p_from_fake+"%",this.$cache.s_to[0].style.left=this.coords.p_to_fake+"%",(this.old_from!==this.result.from||this.force_redraw)&&(this.$cache.from[0].style.left=this.labels.p_from_left+"%"),(this.old_to!==this.result.to||this.force_redraw)&&(this.$cache.to[0].style.left=this.labels.p_to_left+"%"),this.$cache.single[0].style.left=this.labels.p_single_left+"%",this.options.values.length?this.$cache.input.prop("value",this.result.from_value+this.options.input_values_separator+this.result.to_value):this.$cache.input.prop("value",this.result.from+this.options.input_values_separator+this.result.to),this.$cache.input.data("from",this.result.from),this.$cache.input.data("to",this.result.to)),this.old_from===this.result.from&&this.old_to===this.result.to||this.is_start||this.$cache.input.trigger("change"),this.old_from=this.result.from,this.old_to=this.result.to,this.is_resize||this.is_update||this.is_start||this.is_finish||this.callOnChange(),(this.is_key||this.is_click)&&(this.is_click=this.is_key=!1,this.callOnFinish()),this.is_finish=this.is_resize=this.is_update=!1),this.force_redraw=this.is_click=this.is_key=this.is_start=!1))},drawLabels:function(){if(this.options){var t,i=this.options.values.length,s=this.options.p_values;if(!this.options.hide_from_to)if("single"===this.options.type)i=i?this.decorate(s[this.result.from]):this.decorate(this._prettify(this.result.from),this.result.from),this.$cache.single.html(i),this.calcLabels(),this.$cache.min[0].style.visibility=this.labels.p_single_left<this.labels.p_min+1?"hidden":"visible",this.$cache.max[0].style.visibility=this.labels.p_single_left+this.labels.p_single_fake>100-this.labels.p_max-1?"hidden":"visible";else{s=i?(this.options.decorate_both?(i=this.decorate(s[this.result.from]),i+=this.options.values_separator,i+=this.decorate(s[this.result.to])):i=this.decorate(s[this.result.from]+this.options.values_separator+s[this.result.to]),t=this.decorate(s[this.result.from]),this.decorate(s[this.result.to])):(this.options.decorate_both?(i=this.decorate(this._prettify(this.result.from),this.result.from),i+=this.options.values_separator,i+=this.decorate(this._prettify(this.result.to),this.result.to)):i=this.decorate(this._prettify(this.result.from)+this.options.values_separator+this._prettify(this.result.to),this.result.to),t=this.decorate(this._prettify(this.result.from),this.result.from),this.decorate(this._prettify(this.result.to),this.result.to)),this.$cache.single.html(i),this.$cache.from.html(t),this.$cache.to.html(s),this.calcLabels(),s=Math.min(this.labels.p_single_left,this.labels.p_from_left),i=this.labels.p_single_left+this.labels.p_single_fake,t=this.labels.p_to_left+this.labels.p_to_fake;var o=Math.max(i,t);this.labels.p_from_left+this.labels.p_from_fake>=this.labels.p_to_left?(this.$cache.from[0].style.visibility="hidden",this.$cache.to[0].style.visibility="hidden",this.$cache.single[0].style.visibility="visible",o=this.result.from===this.result.to?("from"===this.target?this.$cache.from[0].style.visibility="visible":"to"===this.target&&(this.$cache.to[0].style.visibility="visible"),this.$cache.single[0].style.visibility="hidden",t):(this.$cache.from[0].style.visibility="hidden",this.$cache.to[0].style.visibility="hidden",this.$cache.single[0].style.visibility="visible",Math.max(i,t))):(this.$cache.from[0].style.visibility="visible",this.$cache.to[0].style.visibility="visible",this.$cache.single[0].style.visibility="hidden"),this.$cache.min[0].style.visibility=s<this.labels.p_min+1?"hidden":"visible",this.$cache.max[0].style.visibility=o>100-this.labels.p_max-1?"hidden":"visible"}}},drawShadow:function(){var t=this.options,i=this.$cache,s="number"==typeof t.from_min&&!isNaN(t.from_min),o="number"==typeof t.from_max&&!isNaN(t.from_max),e="number"==typeof t.to_min&&!isNaN(t.to_min),h="number"==typeof t.to_max&&!isNaN(t.to_max);"single"===t.type?t.from_shadow&&(s||o)?(s=this.convertToPercent(s?t.from_min:t.min),o=this.convertToPercent(o?t.from_max:t.max)-s,s=this.toFixed(s-this.coords.p_handle/100*s),o=this.toFixed(o-this.coords.p_handle/100*o),s+=this.coords.p_handle/2,i.shad_single[0].style.display="block",i.shad_single[0].style.left=s+"%",i.shad_single[0].style.width=o+"%"):i.shad_single[0].style.display="none":(t.from_shadow&&(s||o)?(s=this.convertToPercent(s?t.from_min:t.min),o=this.convertToPercent(o?t.from_max:t.max)-s,s=this.toFixed(s-this.coords.p_handle/100*s),o=this.toFixed(o-this.coords.p_handle/100*o),s+=this.coords.p_handle/2,i.shad_from[0].style.display="block",i.shad_from[0].style.left=s+"%",i.shad_from[0].style.width=o+"%"):i.shad_from[0].style.display="none",t.to_shadow&&(e||h)?(e=this.convertToPercent(e?t.to_min:t.min),t=this.convertToPercent(h?t.to_max:t.max)-e,e=this.toFixed(e-this.coords.p_handle/100*e),t=this.toFixed(t-this.coords.p_handle/100*t),e+=this.coords.p_handle/2,i.shad_to[0].style.display="block",i.shad_to[0].style.left=e+"%",i.shad_to[0].style.width=t+"%"):i.shad_to[0].style.display="none")},callOnStart:function(){this.options.onStart&&"function"==typeof this.options.onStart&&this.options.onStart(this.result)},callOnChange:function(){this.options.onChange&&"function"==typeof this.options.onChange&&this.options.onChange(this.result)},callOnFinish:function(){this.options.onFinish&&"function"==typeof this.options.onFinish&&this.options.onFinish(this.result)},callOnUpdate:function(){this.options.onUpdate&&"function"==typeof this.options.onUpdate&&this.options.onUpdate(this.result)},toggleInput:function(){this.$cache.input.toggleClass("irs-hidden-input")},convertToPercent:function(t,i){var s=this.options.max-this.options.min;return s?this.toFixed((i?t:t-this.options.min)/(s/100)):(this.no_diapason=!0,0)},convertToValue:function(t){var i,s,o=this.options.min,e=this.options.max,h=o.toString().split(".")[1],r=e.toString().split(".")[1],n=0,a=0;return 0===t?this.options.min:100===t?this.options.max:(h&&(n=i=h.length),r&&(n=s=r.length),i&&s&&(n=s<=i?i:s),o<0&&(o=+(o+(a=Math.abs(o))).toFixed(n),e=+(e+a).toFixed(n)),t=(e-o)/100*t+o,t=(o=this.options.step.toString().split(".")[1])?+t.toFixed(o.length):(t/=this.options.step,+(t*=this.options.step).toFixed(0)),a&&(t-=a),(a=o?+t.toFixed(o.length):this.toFixed(t))<this.options.min?a=this.options.min:a>this.options.max&&(a=this.options.max),a)},calcWithStep:function(t){var i=Math.round(t/this.coords.p_step)*this.coords.p_step;return 100<i&&(i=100),100===t&&(i=100),this.toFixed(i)},checkMinInterval:function(t,i,s){var o=this.options;return o.min_interval?(t=this.convertToValue(t),i=this.convertToValue(i),"from"===s?i-t<o.min_interval&&(t=i-o.min_interval):t-i<o.min_interval&&(t=i+o.min_interval),this.convertToPercent(t)):t},checkMaxInterval:function(t,i,s){var o=this.options;return o.max_interval?(t=this.convertToValue(t),i=this.convertToValue(i),"from"===s?i-t>o.max_interval&&(t=i-o.max_interval):t-i>o.max_interval&&(t=i+o.max_interval),this.convertToPercent(t)):t},checkDiapason:function(t,i,s){t=this.convertToValue(t);var o=this.options;return"number"!=typeof i&&(i=o.min),"number"!=typeof s&&(s=o.max),t<i&&(t=i),s<t&&(t=s),this.convertToPercent(t)},toFixed:function(t){return+(t=t.toFixed(9))},_prettify:function(t){return this.options.prettify_enabled?this.options.prettify&&"function"==typeof this.options.prettify?this.options.prettify(t):this.prettify(t):t},prettify:function(t){return t.toString().replace(/(\d{1,3}(?=(?:\d\d\d)+(?!\d)))/g,"$1"+this.options.prettify_separator)},checkEdges:function(t,i){return this.options.force_edges&&(t<0?t=0:100-i<t&&(t=100-i)),this.toFixed(t)},validate:function(){var t,i,s=this.options,o=this.result,e=s.values,h=e.length;if("string"==typeof s.min&&(s.min=+s.min),"string"==typeof s.max&&(s.max=+s.max),"string"==typeof s.from&&(s.from=+s.from),"string"==typeof s.to&&(s.to=+s.to),"string"==typeof s.step&&(s.step=+s.step),"string"==typeof s.from_min&&(s.from_min=+s.from_min),"string"==typeof s.from_max&&(s.from_max=+s.from_max),"string"==typeof s.to_min&&(s.to_min=+s.to_min),"string"==typeof s.to_max&&(s.to_max=+s.to_max),"string"==typeof s.keyboard_step&&(s.keyboard_step=+s.keyboard_step),"string"==typeof s.grid_num&&(s.grid_num=+s.grid_num),s.max<s.min&&(s.max=s.min),h)for(s.p_values=[],s.min=0,s.max=h-1,s.step=1,s.grid_num=s.max,s.grid_snap=!0,i=0;i<h;i++)t=+e[i],t=isNaN(t)?e[i]:(e[i]=t,this._prettify(t)),s.p_values.push(t);("number"!=typeof s.from||isNaN(s.from))&&(s.from=s.min),("number"!=typeof s.to||isNaN(s.from))&&(s.to=s.max),"single"===s.type?(s.from<s.min&&(s.from=s.min),s.from>s.max&&(s.from=s.max)):((s.from<s.min||s.from>s.max)&&(s.from=s.min),(s.to>s.max||s.to<s.min)&&(s.to=s.max),s.from>s.to&&(s.from=s.to)),("number"!=typeof s.step||isNaN(s.step)||!s.step||s.step<0)&&(s.step=1),("number"!=typeof s.keyboard_step||isNaN(s.keyboard_step)||!s.keyboard_step||s.keyboard_step<0)&&(s.keyboard_step=5),"number"==typeof s.from_min&&s.from<s.from_min&&(s.from=s.from_min),"number"==typeof s.from_max&&s.from>s.from_max&&(s.from=s.from_max),"number"==typeof s.to_min&&s.to<s.to_min&&(s.to=s.to_min),"number"==typeof s.to_max&&s.from>s.to_max&&(s.to=s.to_max),o&&(o.min!==s.min&&(o.min=s.min),o.max!==s.max&&(o.max=s.max),(o.from<o.min||o.from>o.max)&&(o.from=s.from),(o.to<o.min||o.to>o.max)&&(o.to=s.to)),("number"!=typeof s.min_interval||isNaN(s.min_interval)||!s.min_interval||s.min_interval<0)&&(s.min_interval=0),("number"!=typeof s.max_interval||isNaN(s.max_interval)||!s.max_interval||s.max_interval<0)&&(s.max_interval=0),s.min_interval&&s.min_interval>s.max-s.min&&(s.min_interval=s.max-s.min),s.max_interval&&s.max_interval>s.max-s.min&&(s.max_interval=s.max-s.min)},decorate:function(t,i){var s="",o=this.options;return o.prefix&&(s+=o.prefix),s+=t,o.max_postfix&&(o.values.length&&t===o.p_values[o.max]?(s+=o.max_postfix,o.postfix&&(s+=" ")):i===o.max&&(s+=o.max_postfix,o.postfix&&(s+=" "))),o.postfix&&(s+=o.postfix),s},updateFrom:function(){this.result.from=this.options.from,this.result.from_percent=this.convertToPercent(this.result.from),this.options.values&&(this.result.from_value=this.options.values[this.result.from])},updateTo:function(){this.result.to=this.options.to,this.result.to_percent=this.convertToPercent(this.result.to),this.options.values&&(this.result.to_value=this.options.values[this.result.to])},updateResult:function(){this.result.min=this.options.min,this.result.max=this.options.max,this.updateFrom(),this.updateTo()},appendGrid:function(){if(this.options.grid){var t,i,s=this.options;t=s.max-s.min;var o,e,h=s.grid_num,r=0,n=0,a=4,c=0,l="";for(this.calcGridMargin(),r=s.grid_snap?(h=t/s.step,this.toFixed(s.step/(t/100))):this.toFixed(100/h),4<h&&(a=3),7<h&&(a=2),14<h&&(a=1),28<h&&(a=0),t=0;t<h+1;t++){for(o=a,100<(n=this.toFixed(r*t))&&(n=100,(o-=2)<0&&(o=0)),e=((this.coords.big[t]=n)-r*(t-1))/(o+1),i=1;i<=o&&0!==n;i++)l+='<span class="irs-grid-pol small" style="left: '+(c=this.toFixed(n-e*i))+'%"></span>';l+='<span class="irs-grid-pol" style="left: '+n+'%"></span>',c=this.convertToValue(n),l+='<span class="irs-grid-text js-grid-text-'+t+'" style="left: '+n+'%">'+(c=s.values.length?s.p_values[c]:this._prettify(c))+"</span>"}this.coords.big_num=Math.ceil(h+1),this.$cache.cont.addClass("irs-with-grid"),this.$cache.grid.html(l),this.cacheGridLabels()}},cacheGridLabels:function(){var t,i,s=this.coords.big_num;for(i=0;i<s;i++)t=this.$cache.grid.find(".js-grid-text-"+i),this.$cache.grid_labels.push(t);this.calcGridLabels()},calcGridLabels:function(){var t,i;i=[];var s=[],o=this.coords.big_num;for(t=0;t<o;t++)this.coords.big_w[t]=this.$cache.grid_labels[t].outerWidth(!1),this.coords.big_p[t]=this.toFixed(this.coords.big_w[t]/this.coords.w_rs*100),this.coords.big_x[t]=this.toFixed(this.coords.big_p[t]/2),i[t]=this.toFixed(this.coords.big[t]-this.coords.big_x[t]),s[t]=this.toFixed(i[t]+this.coords.big_p[t]);for(this.options.force_edges&&(i[0]<-this.coords.grid_gap&&(i[0]=-this.coords.grid_gap,s[0]=this.toFixed(i[0]+this.coords.big_p[0]),this.coords.big_x[0]=this.coords.grid_gap),s[o-1]>100+this.coords.grid_gap&&(s[o-1]=100+this.coords.grid_gap,i[o-1]=this.toFixed(s[o-1]-this.coords.big_p[o-1]),this.coords.big_x[o-1]=this.toFixed(this.coords.big_p[o-1]-this.coords.grid_gap))),this.calcGridCollision(2,i,s),this.calcGridCollision(4,i,s),t=0;t<o;t++)(i=this.$cache.grid_labels[t][0]).style.marginLeft=-this.coords.big_x[t]+"%"},calcGridCollision:function(t,i,s){var o,e,h=this.coords.big_num;for(o=0;o<h&&!(h<=(e=o+t/2));o+=t)this.$cache.grid_labels[e][0].style.visibility=s[o]<=i[e]?"visible":"hidden"},calcGridMargin:function(){this.options.grid_margin&&(this.coords.w_rs=this.$cache.rs.outerWidth(!1),this.coords.w_rs&&(this.coords.w_handle="single"===this.options.type?this.$cache.s_single.outerWidth(!1):this.$cache.s_from.outerWidth(!1),this.coords.p_handle=this.toFixed(this.coords.w_handle/this.coords.w_rs*100),this.coords.grid_gap=this.toFixed(this.coords.p_handle/2-.1),this.$cache.grid[0].style.width=this.toFixed(100-this.coords.p_handle)+"%",this.$cache.grid[0].style.left=this.coords.grid_gap+"%"))},update:function(t){this.input&&(this.is_update=!0,this.options.from=this.result.from,this.options.to=this.result.to,this.options=h.extend(this.options,t),this.validate(),this.updateResult(t),this.toggleInput(),this.remove(),this.init(!0))},reset:function(){this.input&&(this.updateResult(),this.update())},destroy:function(){this.input&&(this.toggleInput(),this.$cache.input.prop("readonly",!1),h.data(this.input,"ionRangeSlider",null),this.remove(),this.options=this.input=null)}},h.fn.ionRangeSlider=function(t){return this.each(function(){h.data(this,"ionRangeSlider")||h.data(this,"ionRangeSlider",new c(this,t,e++))})},function(){for(var h=0,t=["ms","moz","webkit","o"],i=0;i<t.length&&!n.requestAnimationFrame;++i)n.requestAnimationFrame=n[t[i]+"RequestAnimationFrame"],n.cancelAnimationFrame=n[t[i]+"CancelAnimationFrame"]||n[t[i]+"CancelRequestAnimationFrame"];n.requestAnimationFrame||(n.requestAnimationFrame=function(t,i){var s=(new Date).getTime(),o=Math.max(0,16-(s-h)),e=n.setTimeout(function(){t(s+o)},o);return h=s+o,e}),n.cancelAnimationFrame||(n.cancelAnimationFrame=function(t){clearTimeout(t)})}()}(jQuery,document,window,navigator);
!function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define([],e);(this||window).CodeMirror=e()}}(function(){"use strict";var e=navigator.userAgent,t=navigator.platform,g=/gecko\/\d/i.test(e),r=/MSIE \d/.test(e),n=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),w=r||n,x=w&&(r?document.documentMode||6:n[1]),v=/WebKit\//.test(e),i=v&&/Qt\/\d+\.\d+/.test(e),o=/Chrome\//.test(e),m=/Opera\//.test(e),a=/Apple Computer/.test(navigator.vendor),l=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),u=/PhantomJS/.test(e),s=/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e),c=s||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),y=s||/Mac/.test(t),h=/win/i.test(t),f=m&&e.match(/Version\/(\d*\.\d*)/);f&&(f=Number(f[1])),f&&15<=f&&(v=!(m=!1));var d=y&&(i||m&&(null==f||f<12.11)),p=g||w&&9<=x,b=!1,C=!1;function S(e,t){if(!(this instanceof S))return new S(e,t);this.options=t=t?bo(t):{},bo(qr,t,!1),E(t);var r=t.value;"string"==typeof r&&(r=new pi(r,t.mode,null,t.lineSeparator)),this.doc=r;var n=new S.inputStyles[t.inputStyle](this),i=this.display=new L(e,r,n);O(i.wrapper.CodeMirror=this),W(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),t.autofocus&&!c&&i.input.focus(),R(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new so,keySeq:null,specialChars:null};var o=this;for(var l in w&&x<11&&setTimeout(function(){o.display.input.reset(!0)},20),function(i){var o=i.display;Ki(o.scroller,"mousedown",Yt(i,sr)),Ki(o.scroller,"dblclick",w&&x<11?Yt(i,function(e){if(!Qi(i,e)){var t=lr(i,e);if(t&&!ur(i,e)&&!or(i.display,e)){Fi(e);var r=i.findWordAt(t);Be(i.doc,r.anchor,r.head)}}}):function(e){Qi(i,e)||Fi(e)});p||Ki(o.scroller,"contextmenu",function(e){Wr(i,e)});var r,n={end:0};function l(){o.activeTouch&&(r=setTimeout(function(){o.activeTouch=null},1e3),(n=o.activeTouch).end=+new Date)}function s(e,t){if(null==t.left)return!0;var r=t.left-e.left,n=t.top-e.top;return 400<r*r+n*n}Ki(o.scroller,"touchstart",function(e){if(!Qi(i,e)&&!function(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}(e)){clearTimeout(r);var t=+new Date;o.activeTouch={start:t,moved:!1,prev:t-n.end<=300?n:null},1==e.touches.length&&(o.activeTouch.left=e.touches[0].pageX,o.activeTouch.top=e.touches[0].pageY)}}),Ki(o.scroller,"touchmove",function(){o.activeTouch&&(o.activeTouch.moved=!0)}),Ki(o.scroller,"touchend",function(e){var t=o.activeTouch;if(t&&!or(o,e)&&null!=t.left&&!t.moved&&new Date-t.start<300){var r,n=i.coordsChar(o.activeTouch,"page");r=!t.prev||s(t,t.prev)?new De(n,n):!t.prev.prev||s(t,t.prev.prev)?i.findWordAt(n):new De(fe(n.line,0),Ie(i.doc,fe(n.line+1,0))),i.setSelection(r.anchor,r.head),i.focus(),Fi(e)}l()}),Ki(o.scroller,"touchcancel",l),Ki(o.scroller,"scroll",function(){o.scroller.clientHeight&&(dr(i,o.scroller.scrollTop),pr(i,o.scroller.scrollLeft,!0),_i(i,"scroll",i))}),Ki(o.scroller,"mousewheel",function(e){yr(i,e)}),Ki(o.scroller,"DOMMouseScroll",function(e){yr(i,e)}),Ki(o.wrapper,"scroll",function(){o.wrapper.scrollTop=o.wrapper.scrollLeft=0}),o.dragFunctions={enter:function(e){Qi(i,e)||Gi(e)},over:function(e){Qi(i,e)||(!function(e,t){var r=lr(e,t);if(!r)return;var n=document.createDocumentFragment();tt(e,r,n),e.display.dragCursor||(e.display.dragCursor=No("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv));Ao(e.display.dragCursor,n)}(i,e),Gi(e))},start:function(e){!function(e,t){if(w&&(!e.state.draggingText||+new Date-cr<100))return Gi(t);if(Qi(e,t)||or(e.display,t))return;if(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.setDragImage&&!a){var r=No("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",m&&(r.width=r.height=1,e.display.wrapper.appendChild(r),r._top=r.offsetTop),t.dataTransfer.setDragImage(r,0,0),m&&r.parentNode.removeChild(r)}}(i,e)},drop:Yt(i,hr),leave:function(){fr(i)}};var e=o.input.getField();Ki(e,"keyup",function(e){Tr.call(i,e)}),Ki(e,"keydown",Yt(i,Lr)),Ki(e,"keypress",Yt(i,kr)),Ki(e,"focus",wo(Mr,i)),Ki(e,"blur",wo(Nr,i))}(this),function(){if(Fo)return;Ki(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,zo(ir)},100))}),Ki(window,"blur",function(){zo(Nr)}),Fo=!0;var e}(),Bt(this),this.curOp.forceUpdate=!0,yi(this,r),t.autofocus&&!c||o.hasFocus()?setTimeout(wo(Mr,this),20):Nr(this),Zr)Zr.hasOwnProperty(l)&&Zr[l](this,t[l],Jr);K(this),t.finishInit&&t.finishInit(this);for(var s=0;s<nn.length;++s)nn[s](this);Gt(this),v&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(i.lineDiv).textRendering&&(i.lineDiv.style.textRendering="auto")}function L(e,t,r){var n=this;this.input=r,n.scrollbarFiller=No("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("cm-not-content","true"),n.gutterFiller=No("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("cm-not-content","true"),n.lineDiv=No("div",null,"CodeMirror-code"),n.selectionDiv=No("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=No("div",null,"CodeMirror-cursors"),n.measure=No("div",null,"CodeMirror-measure"),n.lineMeasure=No("div",null,"CodeMirror-measure"),n.lineSpace=No("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none"),n.mover=No("div",[No("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=No("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=No("div",null,null,"position: absolute; height: "+ro+"px; width: 1px;"),n.gutters=No("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=No("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=No("div",[n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),w&&x<8&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),v||g&&c||(n.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(n.wrapper):e(n.wrapper)),n.viewFrom=n.viewTo=t.first,n.reportedViewFrom=n.reportedViewTo=t.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.alignWidgets=!1,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null,n.activeTouch=null,r.init(n)}function T(e){e.doc.mode=S.getMode(e.options,e.doc.modeOption),k(e)}function k(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,it(e,100),e.state.modeGen++,e.curOp&&Qt(e)}function M(n){var i=Pt(n.display),o=n.options.lineWrapping,l=o&&Math.max(5,n.display.scroller.clientWidth/Et(n.display)-3);return function(e){if(Bn(n.doc,e))return 0;var t=0;if(e.widgets)for(var r=0;r<e.widgets.length;r++)e.widgets[r].height&&(t+=e.widgets[r].height);return o?t+(Math.ceil(e.text.length/l)||1)*i:t+i}}function N(e){var t=e.doc,r=M(e);t.iter(function(e){var t=r(e);t!=e.height&&Ci(e,t)})}function W(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),St(e)}function A(e){O(e),Qt(e),setTimeout(function(){V(e)},20)}function O(e){var t=e.display.gutters,r=e.options.gutters;Wo(t);for(var n=0;n<r.length;++n){var i=r[n],o=t.appendChild(No("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&((e.display.lineGutter=o).style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=n?"":"none",D(e)}function D(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function H(e){if(0==e.height)return 0;for(var t,r=e.text.length,n=e;t=Pn(n);){n=(i=t.find(0,!0)).from.line,r+=i.from.ch-i.to.ch}for(n=e;t=En(n);){var i=t.find(0,!0);r-=n.text.length-i.from.ch,r+=(n=i.to.line).text.length-i.to.ch}return r}function P(e){var r=e.display,t=e.doc;r.maxLine=bi(t,t.first),r.maxLineLength=H(r.maxLine),r.maxLineChanged=!0,t.iter(function(e){var t=H(e);t>r.maxLineLength&&(r.maxLineLength=t,r.maxLine=e)})}function E(e){var t=go(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):-1<t&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function I(e){var t=e.display,r=t.gutters.offsetWidth,n=Math.round(e.doc.height+at(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?r:0,docHeight:n,scrollHeight:n+ct(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:r}}function z(e,t,r){this.cm=r;var n=this.vert=No("div",[No("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=No("div",[No("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(n),e(i),Ki(n,"scroll",function(){n.clientHeight&&t(n.scrollTop,"vertical")}),Ki(i,"scroll",function(){i.clientWidth&&t(i.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,w&&x<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function F(){}function R(r){r.display.scrollbars&&(r.display.scrollbars.clear(),r.display.scrollbars.addClass&&Po(r.display.wrapper,r.display.scrollbars.addClass)),r.display.scrollbars=new S.scrollbarModel[r.options.scrollbarStyle](function(e){r.display.wrapper.insertBefore(e,r.display.scrollbarFiller),Ki(e,"mousedown",function(){r.state.focused&&setTimeout(function(){r.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,t){"horizontal"==t?pr(r,e):dr(r,e)},r),r.display.scrollbars.addClass&&Eo(r.display.wrapper,r.display.scrollbars.addClass)}function B(e,t){t||(t=I(e));var r=e.display.barWidth,n=e.display.barHeight;G(e,t);for(var i=0;i<4&&r!=e.display.barWidth||n!=e.display.barHeight;i++)r!=e.display.barWidth&&e.options.lineWrapping&&Q(e),G(e,I(e)),r=e.display.barWidth,n=e.display.barHeight}function G(e,t){var r=e.display,n=r.scrollbars.update(t);r.sizer.style.paddingRight=(r.barWidth=n.right)+"px",r.sizer.style.paddingBottom=(r.barHeight=n.bottom)+"px",n.right&&n.bottom?(r.scrollbarFiller.style.display="block",r.scrollbarFiller.style.height=n.bottom+"px",r.scrollbarFiller.style.width=n.right+"px"):r.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(r.gutterFiller.style.display="block",r.gutterFiller.style.height=n.bottom+"px",r.gutterFiller.style.width=t.gutterWidth+"px"):r.gutterFiller.style.display=""}function U(e,t,r){var n=r&&null!=r.top?Math.max(0,r.top):e.scroller.scrollTop;n=Math.floor(n-st(e));var i=r&&null!=r.bottom?r.bottom:n+e.wrapper.clientHeight,o=Li(t,n),l=Li(t,i);if(r&&r.ensure){var s=r.ensure.from.line,a=r.ensure.to.line;s<o?l=Li(t,Ti(bi(t,o=s))+e.wrapper.clientHeight):Math.min(a,t.lastLine())>=l&&(o=Li(t,Ti(bi(t,a))-e.wrapper.clientHeight),l=a)}return{from:o,to:Math.max(l,o+1)}}function V(e){var t=e.display,r=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=X(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=n+"px",l=0;l<r.length;l++)if(!r[l].hidden){e.options.fixedGutter&&r[l].gutter&&(r[l].gutter.style.left=o);var s=r[l].alignable;if(s)for(var a=0;a<s.length;a++)s[a].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=n+i+"px")}}function K(e){if(!e.options.lineNumbers)return!1;var t=e.doc,r=j(e.options,t.first+t.size-1),n=e.display;if(r.length==n.lineNumChars)return!1;var i=n.measure.appendChild(No("div",[No("div",r)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=i.firstChild.offsetWidth,l=i.offsetWidth-o;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(o,n.lineGutter.offsetWidth-l)+1,n.lineNumWidth=n.lineNumInnerWidth+l,n.lineNumChars=n.lineNumInnerWidth?r.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",D(e),!0}function j(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function X(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Y(e,t,r){var n=e.display;this.viewport=t,this.visible=U(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=ht(e),this.force=r,this.dims=ee(e),this.events=[]}function _(e,t){var r=e.display,n=e.doc;if(t.editorIsHidden)return er(e),!1;if(!t.force&&t.visible.from>=r.viewFrom&&t.visible.to<=r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&0==nr(e))return!1;K(e)&&(er(e),t.dims=ee(e));var i=n.first+n.size,o=Math.max(t.visible.from-e.options.viewportMargin,n.first),l=Math.min(i,t.visible.to+e.options.viewportMargin);r.viewFrom<o&&o-r.viewFrom<20&&(o=Math.max(n.first,r.viewFrom)),r.viewTo>l&&r.viewTo-l<20&&(l=Math.min(i,r.viewTo)),C&&(o=Fn(e.doc,o),l=Rn(e.doc,l));var s=o!=r.viewFrom||l!=r.viewTo||r.lastWrapHeight!=t.wrapperHeight||r.lastWrapWidth!=t.wrapperWidth;!function(e,t,r){var n=e.display;0==n.view.length||t>=n.viewTo||r<=n.viewFrom?(n.view=Zt(e,t,r),n.viewFrom=t):(n.viewFrom>t?n.view=Zt(e,t,n.viewFrom).concat(n.view):n.viewFrom<t&&(n.view=n.view.slice(tr(e,t))),n.viewFrom=t,n.viewTo<r?n.view=n.view.concat(Zt(e,n.viewTo,r)):n.viewTo>r&&(n.view=n.view.slice(0,tr(e,r))));n.viewTo=r}(e,o,l),r.viewOffset=Ti(bi(e.doc,r.viewFrom)),e.display.mover.style.top=r.viewOffset+"px";var a=nr(e);if(!s&&0==a&&!t.force&&r.renderedView==r.view&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo))return!1;var u=Do();return 4<a&&(r.lineDiv.style.display="none"),function(r,e,t){var n=r.display,i=r.options.lineNumbers,o=n.lineDiv,l=o.firstChild;function s(e){var t=e.nextSibling;return v&&y&&r.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),t}for(var a=n.view,u=n.viewFrom,c=0;c<a.length;c++){var h=a[c];if(h.hidden);else if(h.node&&h.node.parentNode==o){for(;l!=h.node;)l=s(l);var f=i&&null!=e&&e<=u&&h.lineNumber;h.changes&&(-1<go(h.changes,"gutter")&&(f=!1),te(r,h,u,t)),f&&(Wo(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(j(r.options,u)))),l=h.node.nextSibling}else{var d=ae(r,h,u,t);o.insertBefore(d,l)}u+=h.size}for(;l;)l=s(l)}(e,r.updateLineNumbers,t.dims),4<a&&(r.lineDiv.style.display=""),r.renderedView=r.view,u&&Do()!=u&&u.offsetHeight&&u.focus(),Wo(r.cursorDiv),Wo(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,s&&(r.lastWrapHeight=t.wrapperHeight,r.lastWrapWidth=t.wrapperWidth,it(e,400)),!(r.updateLineNumbers=null)}function $(e,t){for(var r=t.viewport,n=!0;(n&&e.options.lineWrapping&&t.oldDisplayWidth!=ht(e)||(r&&null!=r.top&&(r={top:Math.min(e.doc.height+at(e.display)-ft(e),r.top)}),t.visible=U(e.display,e.doc,r),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&_(e,t);n=!1){Q(e);var i=I(e);Je(e),Z(e,i),B(e,i)}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function q(e,t){var r=new Y(e,t);if(_(e,r)){Q(e),$(e,r);var n=I(e);Je(e),Z(e,n),B(e,n),r.finish()}}function Z(e,t){e.display.sizer.style.minHeight=t.docHeight+"px";var r=t.docHeight+e.display.barHeight;e.display.heightForcer.style.top=r+"px",e.display.gutters.style.height=Math.max(r+ct(e),t.clientHeight)+"px"}function Q(e){for(var t=e.display,r=t.lineDiv.offsetTop,n=0;n<t.view.length;n++){var i,o=t.view[n];if(!o.hidden){if(w&&x<8){var l=o.node.offsetTop+o.node.offsetHeight;i=l-r,r=l}else{var s=o.node.getBoundingClientRect();i=s.bottom-s.top}var a=o.line.height-i;if(i<2&&(i=Pt(t)),(.001<a||a<-.001)&&(Ci(o.line,i),J(o.line),o.rest))for(var u=0;u<o.rest.length;u++)J(o.rest[u])}}}function J(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.parentNode.offsetHeight}function ee(e){for(var t=e.display,r={},n={},i=t.gutters.clientLeft,o=t.gutters.firstChild,l=0;o;o=o.nextSibling,++l)r[e.options.gutters[l]]=o.offsetLeft+o.clientLeft+i,n[e.options.gutters[l]]=o.clientWidth;return{fixedPos:X(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:r,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function te(e,t,r,n){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];"text"==o?ie(e,t):"gutter"==o?le(e,t,r,n):"class"==o?oe(t):"widget"==o&&se(e,t,n)}t.changes=null}function re(e){return e.node==e.text&&(e.node=No("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),w&&x<8&&(e.node.style.zIndex=2)),e.node}function ne(e,t){var r=e.display.externalMeasured;return r&&r.line==t.line?(e.display.externalMeasured=null,t.measure=r.measure,r.built):ni(e,t)}function ie(e,t){var r=t.text.className,n=ne(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,oe(t)):r&&(t.text.className=r)}function oe(e){!function(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var r=re(e);e.background=r.insertBefore(No("div",null,t),r.firstChild)}}(e),e.line.wrapClass?re(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function le(e,t,r,n){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var i=re(t);t.gutterBackground=No("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px"),i.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){i=re(t);var l=t.gutter=No("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px");if(e.display.input.setUneditable(l),i.insertBefore(l,t.text),t.line.gutterClass&&(l.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=l.appendChild(No("div",j(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var s=0;s<e.options.gutters.length;++s){var a=e.options.gutters[s],u=o.hasOwnProperty(a)&&o[a];u&&l.appendChild(No("div",[u],"CodeMirror-gutter-elt","left: "+n.gutterLeft[a]+"px; width: "+n.gutterWidth[a]+"px"))}}}function se(e,t,r){t.alignable&&(t.alignable=null);for(var n=t.node.firstChild;n;n=i){var i=n.nextSibling;"CodeMirror-linewidget"==n.className&&t.node.removeChild(n)}ue(e,t,r)}function ae(e,t,r,n){var i=ne(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),oe(t),le(e,t,r,n),ue(e,t,n),t.node}function ue(e,t,r){if(ce(e,t.line,t,r,!0),t.rest)for(var n=0;n<t.rest.length;n++)ce(e,t.rest[n],t,r,!1)}function ce(e,t,r,n,i){if(t.widgets)for(var o=re(r),l=0,s=t.widgets;l<s.length;++l){var a=s[l],u=No("div",[a.node],"CodeMirror-linewidget");a.handleMouseEvents||u.setAttribute("cm-ignore-events","true"),he(a,u,r,n),e.display.input.setUneditable(u),i&&a.above?o.insertBefore(u,r.gutter||r.text):o.appendChild(u),qi(a,"redraw")}}function he(e,t,r,n){if(e.noHScroll){(r.alignable||(r.alignable=[])).push(t);var i=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(i-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}z.prototype=bo({update:function(e){var t=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1,n=e.nativeBarWidth;if(r){this.vert.style.display="block",this.vert.style.bottom=t?n+"px":"0";var i=e.viewHeight-(t?n:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=r?n+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(r?n:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+o+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&0<e.clientHeight&&(0==n&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?n:0,bottom:t?n:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var e=y&&!l?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new so,this.disableVert=new so},enableZeroWidthBar:function(r,n){r.style.pointerEvents="auto",n.set(1e3,function e(){var t=r.getBoundingClientRect();document.elementFromPoint(t.left+1,t.bottom-1)!=r?r.style.pointerEvents="none":n.set(1e3,e)})},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},z.prototype),F.prototype=bo({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},F.prototype),S.scrollbarModel={native:z,null:F},Y.prototype.signal=function(e,t){eo(e,t)&&this.events.push(arguments)},Y.prototype.finish=function(){for(var e=0;e<this.events.length;e++)_i.apply(null,this.events[e])};var fe=S.Pos=function(e,t){if(!(this instanceof fe))return new fe(e,t);this.line=e,this.ch=t},de=S.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch};function pe(e){return fe(e.line,e.ch)}function ge(e,t){return de(e,t)<0?t:e}function ve(e,t){return de(e,t)<0?e:t}function me(e){e.state.focused||(e.display.input.focus(),Mr(e))}var ye=null;function be(e,t,r,n,i){var o=e.doc;e.display.shift=!1,n||(n=o.sel);var l=e.state.pasteIncoming||"paste"==i,s=o.splitLines(t),a=null;if(l&&1<n.ranges.length)if(ye&&ye.join("\n")==t){if(n.ranges.length%ye.length==0){a=[];for(var u=0;u<ye.length;u++)a.push(o.splitLines(ye[u]))}}else s.length==n.ranges.length&&(a=vo(s,function(e){return[e]}));for(u=n.ranges.length-1;0<=u;u--){var c=n.ranges[u],h=c.from(),f=c.to();c.empty()&&(r&&0<r?h=fe(h.line,h.ch-r):e.state.overwrite&&!l&&(f=fe(f.line,Math.min(bi(o,f.line).text.length,f.ch+fo(s).length))));var d=e.curOp.updateInput,p={from:h,to:f,text:a?a[u%a.length]:s,origin:i||(l?"paste":e.state.cutIncoming?"cut":"+input")};Er(e.doc,p),qi(e,"inputRead",e,p)}t&&!l&&xe(e,t),Vr(e),e.curOp.updateInput=d,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function we(e,t){var r=e.clipboardData&&e.clipboardData.getData("text/plain");if(r)return e.preventDefault(),t.isReadOnly()||t.options.disableInput||Xt(t,function(){be(t,r,0,null,"paste")}),!0}function xe(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var r=e.doc.sel,n=r.ranges.length-1;0<=n;n--){var i=r.ranges[n];if(!(100<i.head.ch||n&&r.ranges[n-1].head.line==i.head.line)){var o=e.getModeAt(i.head),l=!1;if(o.electricChars){for(var s=0;s<o.electricChars.length;s++)if(-1<t.indexOf(o.electricChars.charAt(s))){l=jr(e,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(bi(e.doc,i.head.line).text.slice(0,i.head.ch))&&(l=jr(e,i.head.line,"smart"));l&&qi(e,"electricInput",e,i.head.line)}}}function Ce(e){for(var t=[],r=[],n=0;n<e.doc.sel.ranges.length;n++){var i=e.doc.sel.ranges[n].head.line,o={anchor:fe(i,0),head:fe(i+1,0)};r.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:r}}function Se(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function Le(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new so,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function Te(){var e=No("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=No("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return v?e.style.width="1000px":e.setAttribute("wrap","off"),s&&(e.style.border="1px solid black"),Se(e),t}function ke(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new so,this.gracePeriod=!1}function Me(e,t){var r=gt(e,t.line);if(!r||r.hidden)return null;var n=bi(e.doc,t.line),i=dt(r,n,t.line),o=ki(n),l="left";o&&(l=nl(o,t.ch)%2?"right":"left");var s=wt(i.map,t.ch,l);return s.offset="right"==s.collapse?s.end:s.start,s}function Ne(e,t){return t&&(e.bad=!0),e}function We(e,t,r){var n;if(t==e.display.lineDiv){if(!(n=e.display.lineDiv.childNodes[r]))return Ne(e.clipPos(fe(e.display.viewTo-1)),!0);t=null,r=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var o=e.display.view[i];if(o.node==n)return Ae(o,t,r)}}function Ae(u,e,t){var r=u.text.firstChild,n=!1;if(!e||!Oo(r,e))return Ne(fe(Si(u.line),0),!0);if(e==r&&(n=!0,e=r.childNodes[t],t=0,!e)){var i=u.rest?fo(u.rest):u.line;return Ne(fe(Si(i),i.text.length),n)}var o=3==e.nodeType?e:null,l=e;for(o||1!=e.childNodes.length||3!=e.firstChild.nodeType||(o=e.firstChild,t&&(t=o.nodeValue.length));l.parentNode!=r;)l=l.parentNode;var c=u.measure,h=c.maps;function s(e,t,r){for(var n=-1;n<(h?h.length:0);n++)for(var i=n<0?c.map:h[n],o=0;o<i.length;o+=3){var l=i[o+2];if(l==e||l==t){var s=Si(n<0?u.line:u.rest[n]),a=i[o]+r;return(r<0||l!=e)&&(a=i[o+(r?1:0)]),fe(s,a)}}}var a=s(o,l,t);if(a)return Ne(a,n);for(var f=l.nextSibling,d=o?o.nodeValue.length-t:0;f;f=f.nextSibling){if(a=s(f,f.firstChild,0))return Ne(fe(a.line,a.ch-d),n);d+=f.textContent.length}var p=l.previousSibling;for(d=t;p;p=p.previousSibling){if(a=s(p,p.firstChild,-1))return Ne(fe(a.line,a.ch+d),n);d+=f.textContent.length}}function Oe(e,t){this.ranges=e,this.primIndex=t}function De(e,t){this.anchor=e,this.head=t}function He(e,t){var r=e[t];e.sort(function(e,t){return de(e.from(),t.from())}),t=go(e,r);for(var n=1;n<e.length;n++){var i=e[n],o=e[n-1];if(0<=de(o.to(),i.from())){var l=ve(o.from(),i.from()),s=ge(o.to(),i.to()),a=o.empty()?i.from()==i.head:o.from()==o.head;n<=t&&--t,e.splice(--n,2,new De(a?s:l,a?l:s))}}return new Oe(e,t)}function Pe(e,t){return new Oe([new De(e,t||e)],0)}function Ee(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function Ie(e,t){if(t.line<e.first)return fe(e.first,0);var r,n,i,o=e.first+e.size-1;return t.line>o?fe(o,bi(e,o).text.length):(n=bi(e,(r=t).line).text.length,null==(i=r.ch)||n<i?fe(r.line,n):i<0?fe(r.line,0):r)}function ze(e,t){return t>=e.first&&t<e.first+e.size}function Fe(e,t){for(var r=[],n=0;n<t.length;n++)r[n]=Ie(e,t[n]);return r}function Re(e,t,r,n){if(e.cm&&e.cm.display.shift||e.extend){var i=t.anchor;if(n){var o=de(r,i)<0;o!=de(n,i)<0?(i=r,r=n):o!=de(r,n)<0&&(r=n)}return new De(i,r)}return new De(n||r,r)}function Be(e,t,r,n){je(e,new Oe([Re(e,e.sel.primary(),t,r)],0),n)}function Ge(e,t,r){for(var n=[],i=0;i<e.sel.ranges.length;i++)n[i]=Re(e,e.sel.ranges[i],t[i],null);je(e,He(n,e.sel.primIndex),r)}function Ue(e,t,r,n){var i=e.sel.ranges.slice(0);i[t]=r,je(e,He(i,e.sel.primIndex),n)}function Ve(e,t,r,n){je(e,Pe(t,r),n)}function Ke(e,t,r){var n=e.history.done,i=fo(n);i&&i.ranges?Xe(e,n[n.length-1]=t,r):je(e,t,r)}function je(e,t,r){Xe(e,t,r),function(e,t,r,n){var i=e.history,o=n&&n.origin;r==i.lastSelOp||o&&i.lastSelOrigin==o&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==o||(l=e,s=o,a=fo(i.done),u=t,c=s.charAt(0),"*"==c||"+"==c&&a.ranges.length==u.ranges.length&&a.somethingSelected()==u.somethingSelected()&&new Date-l.history.lastSelTime<=(l.cm?l.cm.options.historyEventDelay:500)))?i.done[i.done.length-1]=t:Oi(t,i.done);var l,s,a,u,c;i.lastSelTime=+new Date,i.lastSelOrigin=o,i.lastSelOp=r,n&&!1!==n.clearRedo&&Wi(i.undone)}(e,e.sel,e.cm?e.cm.curOp.id:NaN,r)}function Xe(e,t,r){var n,i,o,l;(eo(e,"beforeSelectionChange")||e.cm&&eo(e.cm,"beforeSelectionChange"))&&(n=e,o=r,l={ranges:(i=t).ranges,update:function(e){this.ranges=[];for(var t=0;t<e.length;t++)this.ranges[t]=new De(Ie(n,e[t].anchor),Ie(n,e[t].head))},origin:o&&o.origin},_i(n,"beforeSelectionChange",n,l),n.cm&&_i(n.cm,"beforeSelectionChange",n.cm,l),t=l.ranges!=i.ranges?He(l.ranges,l.ranges.length-1):i),Ye(e,$e(e,t,r&&r.bias||(de(t.primary().head,e.sel.primary().head)<0?-1:1),!0)),r&&!1===r.scroll||!e.cm||Vr(e.cm)}function Ye(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Ji(e.cm)),qi(e,"cursorActivity",e))}function _e(e){Ye(e,$e(e,e.sel,null,!1))}function $e(e,t,r,n){for(var i,o=0;o<t.ranges.length;o++){var l=t.ranges[o],s=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],a=Ze(e,l.anchor,s&&s.anchor,r,n),u=Ze(e,l.head,s&&s.head,r,n);(i||a!=l.anchor||u!=l.head)&&(i||(i=t.ranges.slice(0,o)),i[o]=new De(a,u))}return i?He(i,t.primIndex):t}function qe(e,t,r,n,i){var o=bi(e,t.line);if(o.markedSpans)for(var l=0;l<o.markedSpans.length;++l){var s=o.markedSpans[l],a=s.marker;if((null==s.from||(a.inclusiveLeft?s.from<=t.ch:s.from<t.ch))&&(null==s.to||(a.inclusiveRight?s.to>=t.ch:s.to>t.ch))){if(i&&(_i(a,"beforeCursorEnter"),a.explicitlyCleared)){if(o.markedSpans){--l;continue}break}if(!a.atomic)continue;if(r){var u,c=a.find(n<0?1:-1);if((n<0?a.inclusiveRight:a.inclusiveLeft)&&(c=Qe(e,c,-n,o)),c&&c.line==t.line&&(u=de(c,r))&&(n<0?u<0:0<u))return qe(e,c,t,n,i)}var h=a.find(n<0?-1:1);return(n<0?a.inclusiveLeft:a.inclusiveRight)&&(h=Qe(e,h,n,o)),h?qe(e,h,t,n,i):null}}return t}function Ze(e,t,r,n,i){var o=n||1,l=qe(e,t,r,o,i)||!i&&qe(e,t,r,o,!0)||qe(e,t,r,-o,i)||!i&&qe(e,t,r,-o,!0);return l||(e.cantEdit=!0,fe(e.first,0))}function Qe(e,t,r,n){return r<0&&0==t.ch?t.line>e.first?Ie(e,fe(t.line-1)):null:0<r&&t.ch==(n||bi(e,t.line)).text.length?t.line<e.first+e.size-1?fe(t.line+1,0):null:new fe(t.line,t.ch+r)}function Je(e){e.display.input.showSelection(e.display.input.prepareSelection())}function et(e,t){for(var r=e.doc,n={},i=n.cursors=document.createDocumentFragment(),o=n.selection=document.createDocumentFragment(),l=0;l<r.sel.ranges.length;l++)if(!1!==t||l!=r.sel.primIndex){var s=r.sel.ranges[l],a=s.empty();(a||e.options.showCursorWhenSelecting)&&tt(e,s.head,i),a||rt(e,s,o)}return n}function tt(e,t,r){var n=Wt(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),i=r.appendChild(No("div"," ","CodeMirror-cursor"));if(i.style.left=n.left+"px",i.style.top=n.top+"px",i.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",n.other){var o=r.appendChild(No("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=n.other.left+"px",o.style.top=n.other.top+"px",o.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function rt(i,e,t){var r=i.display,o=i.doc,l=document.createDocumentFragment(),n=ut(i.display),p=n.left,g=Math.max(r.sizerWidth,ht(i)-r.sizer.offsetLeft)-n.right;function v(e,t,r,n){t<0&&(t=0),t=Math.round(t),n=Math.round(n),l.appendChild(No("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==r?g-e:r)+"px; height: "+(n-t)+"px"))}function s(r,a,u){var c,h,n=bi(o,r),f=n.text.length;function d(e,t){return Nt(i,fe(r,e),"div",n,t)}return function(e,t,r,n){if(!e)return n(t,r,"ltr");for(var i=!1,o=0;o<e.length;++o){var l=e[o];(l.from<r&&l.to>t||t==r&&l.to==t)&&(n(Math.max(l.from,t),Math.min(l.to,r),1==l.level?"rtl":"ltr"),i=!0)}i||n(t,r,"ltr")}(ki(n),a||0,null==u?f:u,function(e,t,r){var n,i,o,l=d(e,"left");if(e==t)i=o=(n=l).left;else{if(n=d(t-1,"right"),"rtl"==r){var s=l;l=n,n=s}i=l.left,o=n.right}null==a&&0==e&&(i=p),3<n.top-l.top&&(v(i,l.top,null,l.bottom),i=p,l.bottom<n.top&&v(i,l.bottom,null,n.top)),null==u&&t==f&&(o=g),(!c||l.top<c.top||l.top==c.top&&l.left<c.left)&&(c=l),(!h||n.bottom>h.bottom||n.bottom==h.bottom&&n.right>h.right)&&(h=n),i<p+1&&(i=p),v(i,n.top,o-i,n.bottom)}),{start:c,end:h}}var a=e.from(),u=e.to();if(a.line==u.line)s(a.line,a.ch,u.ch);else{var c=bi(o,a.line),h=bi(o,u.line),f=zn(c)==zn(h),d=s(a.line,a.ch,f?c.text.length+1:null).end,m=s(u.line,f?0:null,u.ch).start;f&&(d.top<m.top-2?(v(d.right,d.top,null,d.bottom),v(p,m.top,m.left,m.bottom)):v(d.right,d.top,m.left-d.right,d.bottom)),d.bottom<m.top&&v(p,d.bottom,null,m.top)}t.appendChild(l)}function nt(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var r=!0;t.cursorDiv.style.visibility="",0<e.options.cursorBlinkRate?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(r=!r)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function it(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,wo(ot,e))}function ot(a){var u=a.doc;if(u.frontier<u.first&&(u.frontier=u.first),!(u.frontier>=a.display.viewTo)){var c=+new Date+a.options.workTime,h=ln(u.mode,lt(a,u.frontier)),f=[];u.iter(u.frontier,Math.min(u.first+u.size,a.display.viewTo+500),function(e){if(u.frontier>=a.display.viewFrom){var t=e.styles,r=e.text.length>a.options.maxHighlightLength,n=Zn(a,e,r?ln(u.mode,h):h,!0);e.styles=n.styles;var i=e.styleClasses,o=n.classes;o?e.styleClasses=o:i&&(e.styleClasses=null);for(var l=!t||t.length!=e.styles.length||i!=o&&(!i||!o||i.bgClass!=o.bgClass||i.textClass!=o.textClass),s=0;!l&&s<t.length;++s)l=t[s]!=e.styles[s];l&&f.push(u.frontier),e.stateAfter=r?h:ln(u.mode,h)}else e.text.length<=a.options.maxHighlightLength&&Jn(a,e.text,h),e.stateAfter=u.frontier%5==0?ln(u.mode,h):null;if(++u.frontier,+new Date>c)return it(a,a.options.workDelay),!0}),f.length&&Xt(a,function(){for(var e=0;e<f.length;e++)Jt(a,f[e],"text")})}}function lt(r,n,e){var i=r.doc,o=r.display;if(!i.mode.startState)return!0;var l=function(e,t,r){for(var n,i,o=e.doc,l=r?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;l<s;--s){if(s<=o.first)return o.first;var a=bi(o,s-1);if(a.stateAfter&&(!r||s<=o.frontier))return s;var u=ao(a.text,null,e.options.tabSize);(null==i||u<n)&&(i=s-1,n=u)}return i}(r,n,e),s=l>i.first&&bi(i,l-1).stateAfter;return s=s?ln(i.mode,s):sn(i.mode),i.iter(l,n,function(e){Jn(r,e.text,s);var t=l==n-1||l%5==0||l>=o.viewFrom&&l<o.viewTo;e.stateAfter=t?ln(i.mode,s):null,++l}),e&&(i.frontier=l),s}function st(e){return e.lineSpace.offsetTop}function at(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function ut(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=Ao(e.measure,No("pre","x")),r=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(r.paddingLeft),right:parseInt(r.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(e.cachedPaddingH=n),n}function ct(e){return ro-e.display.nativeBarWidth}function ht(e){return e.display.scroller.clientWidth-ct(e)-e.display.barWidth}function ft(e){return e.display.scroller.clientHeight-ct(e)-e.display.barHeight}function dt(e,t,r){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(n=0;n<e.rest.length;n++)if(Si(e.rest[n])>r)return{map:e.measure.maps[n],cache:e.measure.caches[n],before:!0}}function pt(e,t,r,n){return mt(e,vt(e,t),r,n)}function gt(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[tr(e,t)];var r=e.display.externalMeasured;return r&&t>=r.lineN&&t<r.lineN+r.size?r:void 0}function vt(e,t){var r=Si(t),n=gt(e,r);n&&!n.text?n=null:n&&n.changes&&(te(e,n,r,ee(e)),e.curOp.forceUpdate=!0),n||(n=function(e,t){var r=Si(t=zn(t)),n=e.display.externalMeasured=new qt(e.doc,t,r);n.lineN=r;var i=n.built=ni(e,n);return n.text=i.pre,Ao(e.display.lineMeasure,i.pre),n}(e,t));var i=dt(n,t,r);return{line:t,view:n,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function mt(e,t,r,n,i){t.before&&(r=-1);var o,l=r+(n||"");return t.cache.hasOwnProperty(l)?o=t.cache[l]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(!function(e,t,r){var n=e.options.lineWrapping,i=n&&ht(e);if(!t.measure.heights||n&&t.measure.width!=i){var o=t.measure.heights=[];if(n){t.measure.width=i;for(var l=t.text.firstChild.getClientRects(),s=0;s<l.length-1;s++){var a=l[s],u=l[s+1];2<Math.abs(a.bottom-u.bottom)&&o.push((a.bottom+u.top)/2-r.top)}}o.push(r.bottom-r.top)}}(e,t.view,t.rect),t.hasHeights=!0),(o=function(e,t,r,n){var i,o=wt(t.map,r,n),l=o.node,s=o.start,a=o.end,u=o.collapse;if(3==l.nodeType){for(var c=0;c<4;c++){for(;s&&Mo(t.line.text.charAt(o.coverStart+s));)--s;for(;o.coverStart+a<o.coverEnd&&Mo(t.line.text.charAt(o.coverStart+a));)++a;if(w&&x<9&&0==s&&a==o.coverEnd-o.coverStart)i=l.parentNode.getBoundingClientRect();else if(w&&e.options.lineWrapping){var h=To(l,s,a).getClientRects();i=h.length?h["right"==n?h.length-1:0]:bt}else i=To(l,s,a).getBoundingClientRect()||bt;if(i.left||i.right||0==s)break;a=s,s-=1,u="right"}w&&x<11&&(i=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(e){if(null!=_o)return _o;var t=Ao(e,No("span","x")),r=t.getBoundingClientRect(),n=To(t,0,1).getBoundingClientRect();return _o=1<Math.abs(r.left-n.left)}(e))return t;var r=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*r,right:t.right*r,top:t.top*n,bottom:t.bottom*n}}(e.display.measure,i))}else{0<s&&(u=n="right"),i=e.options.lineWrapping&&1<(h=l.getClientRects()).length?h["right"==n?h.length-1:0]:l.getBoundingClientRect()}if(w&&x<9&&!s&&(!i||!i.left&&!i.right)){var f=l.parentNode.getClientRects()[0];i=f?{left:f.left,right:f.left+Et(e.display),top:f.top,bottom:f.bottom}:bt}for(var d=i.top-t.rect.top,p=i.bottom-t.rect.top,g=(d+p)/2,v=t.view.measure.heights,c=0;c<v.length-1&&!(g<v[c]);c++);var m=c?v[c-1]:0,y=v[c],b={left:("right"==u?i.right:i.left)-t.rect.left,right:("left"==u?i.left:i.right)-t.rect.left,top:m,bottom:y};i.left||i.right||(b.bogus=!0);e.options.singleCursorHeightPerLine||(b.rtop=d,b.rbottom=p);return b}(e,t,r,n)).bogus||(t.cache[l]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}Le.prototype=bo({init:function(t){var r=this,n=this.cm,e=this.wrapper=Te(),i=this.textarea=e.firstChild;function o(e){if(!Qi(n,e)){if(n.somethingSelected())ye=n.getSelections(),r.inaccurateSelection&&(r.prevInput="",r.inaccurateSelection=!1,i.value=ye.join("\n"),po(i));else{if(!n.options.lineWiseCopyCut)return;var t=Ce(n);ye=t.text,"cut"==e.type?n.setSelections(t.ranges,null,io):(r.prevInput="",i.value=t.text.join("\n"),po(i))}"cut"==e.type&&(n.state.cutIncoming=!0)}}t.wrapper.insertBefore(e,t.wrapper.firstChild),s&&(i.style.width="0px"),Ki(i,"input",function(){w&&9<=x&&r.hasSelection&&(r.hasSelection=null),r.poll()}),Ki(i,"paste",function(e){Qi(n,e)||we(e,n)||(n.state.pasteIncoming=!0,r.fastPoll())}),Ki(i,"cut",o),Ki(i,"copy",o),Ki(t.scroller,"paste",function(e){or(t,e)||Qi(n,e)||(n.state.pasteIncoming=!0,r.focus())}),Ki(t.lineSpace,"selectstart",function(e){or(t,e)||Fi(e)}),Ki(i,"compositionstart",function(){var e=n.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}}),Ki(i,"compositionend",function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,r=e.doc,n=et(e);if(e.options.moveInputWithCursor){var i=Wt(e,r.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),l=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,i.top+l.top-o.top)),n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,i.left+l.left-o.left))}return n},showSelection:function(e){var t=this.cm.display;Ao(t.cursorDiv,e.cursors),Ao(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){var t,r,n=this.cm,i=n.doc;if(n.somethingSelected()){this.prevInput="";var o=i.sel.primary(),l=(t=Yo&&(100<o.to().line-o.from().line||1e3<(r=n.getSelection()).length))?"-":r||n.getSelection();this.textarea.value=l,n.state.focused&&po(this.textarea),w&&9<=x&&(this.hasSelection=l)}else e||(this.prevInput=this.textarea.value="",w&&9<=x&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!c||Do()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;e.pollingFast||e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){var t=!1,r=this;r.pollingFast=!0,r.polling.set(20,function e(){r.poll()||t?(r.pollingFast=!1,r.slowPoll()):(t=!0,r.polling.set(60,e))})},poll:function(){var e=this.cm,t=this.textarea,r=this.prevInput;if(this.contextMenuPending||!e.state.focused||Xo(t)&&!r&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var n=t.value;if(n==r&&!e.somethingSelected())return!1;if(w&&9<=x&&this.hasSelection===n||y&&/[\uf700-\uf7ff]/.test(n))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var i=n.charCodeAt(0);if(8203!=i||r||(r="​"),8666==i)return this.reset(),this.cm.execCommand("undo")}for(var o=0,l=Math.min(r.length,n.length);o<l&&r.charCodeAt(o)==n.charCodeAt(o);)++o;var s=this;return Xt(e,function(){be(e,n.slice(o),r.length-o,null,s.composing?"*compose":null),1e3<n.length||-1<n.indexOf("\n")?t.value=s.prevInput="":s.prevInput=n,s.composing&&(s.composing.range.clear(),s.composing.range=e.markText(s.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){w&&9<=x&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){var r=this,n=r.cm,i=n.display,o=r.textarea,t=lr(n,e),l=i.scroller.scrollTop;if(t&&!m){n.options.resetSelectionOnContextMenu&&-1==n.doc.sel.contains(t)&&Yt(n,je)(n.doc,Pe(t),io);var s=o.style.cssText;if(r.wrapper.style.position="absolute",o.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(w?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",v)var a=window.scrollY;if(i.input.focus(),v&&window.scrollTo(null,a),i.input.reset(),n.somethingSelected()||(o.value=r.prevInput=" "),r.contextMenuPending=!0,i.selForContextMenu=n.doc.sel,clearTimeout(i.detectingSelectAll),w&&9<=x&&c(),p){Gi(e);var u=function(){Yi(window,"mouseup",u),setTimeout(h,20)};Ki(window,"mouseup",u)}else setTimeout(h,50)}function c(){if(null!=o.selectionStart){var e=n.somethingSelected(),t="​"+(e?o.value:"");o.value="⇚",o.value=t,r.prevInput=e?"":"​",o.selectionStart=1,o.selectionEnd=t.length,i.selForContextMenu=n.doc.sel}}function h(){if(r.contextMenuPending=!1,r.wrapper.style.position="relative",o.style.cssText=s,w&&x<9&&i.scrollbars.setScrollTop(i.scroller.scrollTop=l),null!=o.selectionStart){(!w||w&&x<9)&&c();var e=0,t=function(){i.selForContextMenu==n.doc.sel&&0==o.selectionStart&&0<o.selectionEnd&&"​"==r.prevInput?Yt(n,an.selectAll)(n):e++<10?i.detectingSelectAll=setTimeout(t,500):i.input.reset()};i.detectingSelectAll=setTimeout(t,200)}}},readOnlyChanged:function(e){e||this.reset()},setUneditable:mo,needsContentAttribute:!1},Le.prototype),ke.prototype=bo({init:function(e){var i=this,o=i.cm,t=i.div=e.lineDiv;function r(e){if(!Qi(o,e)){if(o.somethingSelected())ye=o.getSelections(),"cut"==e.type&&o.replaceSelection("",null,"cut");else{if(!o.options.lineWiseCopyCut)return;var t=Ce(o);ye=t.text,"cut"==e.type&&o.operation(function(){o.setSelections(t.ranges,0,io),o.replaceSelection("",null,"cut")})}if(e.clipboardData&&!s)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",ye.join("\n"));else{var r=Te(),n=r.firstChild;o.display.lineSpace.insertBefore(r,o.display.lineSpace.firstChild),n.value=ye.join("\n");var i=document.activeElement;po(n),setTimeout(function(){o.display.lineSpace.removeChild(r),i.focus()},50)}}}Se(t),Ki(t,"paste",function(e){Qi(o,e)||we(e,o)}),Ki(t,"compositionstart",function(e){var t=e.data;if(i.composing={sel:o.doc.sel,data:t,startData:t},t){var r=o.doc.sel.primary(),n=o.getLine(r.head.line).indexOf(t,Math.max(0,r.head.ch-t.length));-1<n&&n<=r.head.ch&&(i.composing.sel=Pe(fe(r.head.line,n),fe(r.head.line,n+t.length)))}}),Ki(t,"compositionupdate",function(e){i.composing.data=e.data}),Ki(t,"compositionend",function(e){var t=i.composing;t&&(e.data==t.startData||/\u200b/.test(e.data)||(t.data=e.data),setTimeout(function(){t.handled||i.applyComposition(t),i.composing==t&&(i.composing=null)},50))}),Ki(t,"touchstart",function(){i.forceCompositionEnd()}),Ki(t,"input",function(){i.composing||!o.isReadOnly()&&i.pollContent()||Xt(i.cm,function(){Qt(o)})}),Ki(t,"copy",r),Ki(t,"cut",r)},prepareSelection:function(){var e=et(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e){e&&this.cm.display.view.length&&(e.focus&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var e=window.getSelection(),t=this.cm.doc.sel.primary(),r=We(this.cm,e.anchorNode,e.anchorOffset),n=We(this.cm,e.focusNode,e.focusOffset);if(!r||r.bad||!n||n.bad||0!=de(ve(r,n),t.from())||0!=de(ge(r,n),t.to())){var i=Me(this.cm,t.from()),o=Me(this.cm,t.to());if(i||o){var l=this.cm.display.view,s=e.rangeCount&&e.getRangeAt(0);if(i){if(!o){var a=l[l.length-1].measure,u=a.maps?a.maps[a.maps.length-1]:a.map;o={node:u[u.length-1],offset:u[u.length-2]-u[u.length-3]}}}else i={node:l[0].measure.map[2],offset:0};try{var c=To(i.node,i.offset,o.offset,o.node)}catch(e){}c&&(!g&&this.cm.state.focused?(e.collapse(i.node,i.offset),c.collapsed||e.addRange(c)):(e.removeAllRanges(),e.addRange(c)),s&&null==e.anchorNode?e.addRange(s):g&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){Ao(this.cm.display.cursorDiv,e.cursors),Ao(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Oo(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){var t=this;this.selectionInEditor()?this.pollSelection():Xt(this.cm,function(){t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var r=We(t,e.anchorNode,e.anchorOffset),n=We(t,e.focusNode,e.focusOffset);r&&n&&Xt(t,function(){je(t.doc,Pe(r,n),io),(r.bad||n.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){var e,t=this.cm,r=t.display,n=t.doc.sel.primary(),i=n.from(),o=n.to();if(i.line<r.viewFrom||o.line>r.viewTo-1)return!1;if(i.line==r.viewFrom||0==(e=tr(t,i.line)))var l=Si(r.view[0].line),s=r.view[0].node;else l=Si(r.view[e].line),s=r.view[e-1].node.nextSibling;var a=tr(t,o.line);if(a==r.view.length-1)var u=r.viewTo-1,c=r.lineDiv.lastChild;else u=Si(r.view[a+1].line)-1,c=r.view[a+1].node.previousSibling;for(var h=t.doc.splitLines(function(a,e,t,u,c){var h="",f=!1,d=a.doc.lineSeparator();function p(e){if(1==e.nodeType){var t=e.getAttribute("cm-text");if(null!=t)return""==t&&(t=e.textContent.replace(/\u200b/g,"")),void(h+=t);var r,n=e.getAttribute("cm-marker");if(n){var i=a.findMarks(fe(u,0),fe(c+1,0),(s=+n,function(e){return e.id==s}));return void(i.length&&(r=i[0].find())&&(h+=wi(a.doc,r.from,r.to).join(d)))}if("false"==e.getAttribute("contenteditable"))return;for(var o=0;o<e.childNodes.length;o++)p(e.childNodes[o]);/^(pre|div|p)$/i.test(e.nodeName)&&(f=!0)}else if(3==e.nodeType){var l=e.nodeValue;if(!l)return;f&&(h+=d,f=!1),h+=l}var s}for(;p(e),e!=t;)e=e.nextSibling;return h}(t,s,c,l,u)),f=wi(t.doc,fe(l,0),fe(u,bi(t.doc,u).text.length));1<h.length&&1<f.length;)if(fo(h)==fo(f))h.pop(),f.pop(),u--;else{if(h[0]!=f[0])break;h.shift(),f.shift(),l++}for(var d=0,p=0,g=h[0],v=f[0],m=Math.min(g.length,v.length);d<m&&g.charCodeAt(d)==v.charCodeAt(d);)++d;for(var y=fo(h),b=fo(f),w=Math.min(y.length-(1==h.length?d:0),b.length-(1==f.length?d:0));p<w&&y.charCodeAt(y.length-p-1)==b.charCodeAt(b.length-p-1);)++p;h[h.length-1]=y.slice(0,y.length-p),h[0]=h[0].slice(d);var x=fe(l,d),C=fe(u,f.length?fo(f).length-p:0);return 1<h.length||h[0]||de(x,C)?(Br(t.doc,h,x,C,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(e){this.cm.isReadOnly()?Yt(this.cm,Qt)(this.cm):e.data&&e.data!=e.startData&&Yt(this.cm,be)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),this.cm.isReadOnly()||Yt(this.cm,be)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(e){this.div.contentEditable=String("nocursor"!=e)},onContextMenu:mo,resetPosition:mo,needsContentAttribute:!0},ke.prototype),S.inputStyles={textarea:Le,contenteditable:ke},Oe.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var r=this.ranges[t],n=e.ranges[t];if(0!=de(r.anchor,n.anchor)||0!=de(r.head,n.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new De(pe(this.ranges[t].anchor),pe(this.ranges[t].head));return new Oe(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var r=0;r<this.ranges.length;r++){var n=this.ranges[r];if(0<=de(t,n.from())&&de(e,n.to())<=0)return r}return-1}},De.prototype={from:function(){return ve(this.anchor,this.head)},to:function(){return ge(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var yt,bt={left:0,right:0,top:0,bottom:0};function wt(e,t,r){for(var n,i,o,l,s=0;s<e.length;s+=3){var a=e[s],u=e[s+1];if(t<a?(i=0,o=1,l="left"):t<u?o=(i=t-a)+1:(s==e.length-3||t==u&&e[s+3]>t)&&(i=(o=u-a)-1,u<=t&&(l="right")),null!=i){if(n=e[s+2],a==u&&r==(n.insertLeft?"left":"right")&&(l=r),"left"==r&&0==i)for(;s&&e[s-2]==e[s-3]&&e[s-1].insertLeft;)n=e[2+(s-=3)],l="left";if("right"==r&&i==u-a)for(;s<e.length-3&&e[s+3]==e[s+4]&&!e[s+5].insertLeft;)n=e[(s+=3)+2],l="right";break}}return{node:n,start:i,end:o,collapse:l,coverStart:a,coverEnd:u}}function xt(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Ct(e){e.display.externalMeasure=null,Wo(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)xt(e.display.view[t])}function St(e){Ct(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Lt(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Tt(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function kt(e,t,r,n){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var o=Kn(t.widgets[i]);r.top+=o,r.bottom+=o}if("line"==n)return r;n||(n="local");var l=Ti(t);if("local"==n?l+=st(e.display):l-=e.display.viewOffset,"page"==n||"window"==n){var s=e.display.lineSpace.getBoundingClientRect();l+=s.top+("window"==n?0:Tt());var a=s.left+("window"==n?0:Lt());r.left+=a,r.right+=a}return r.top+=l,r.bottom+=l,r}function Mt(e,t,r){if("div"==r)return t;var n=t.left,i=t.top;if("page"==r)n-=Lt(),i-=Tt();else if("local"==r||!r){var o=e.display.sizer.getBoundingClientRect();n+=o.left,i+=o.top}var l=e.display.lineSpace.getBoundingClientRect();return{left:n-l.left,top:i-l.top}}function Nt(e,t,r,n,i){return n||(n=bi(e.doc,t.line)),kt(e,n,pt(e,n,t.ch,i),r)}function Wt(n,e,i,o,l,s){function a(e,t){var r=mt(n,l,e,t?"right":"left",s);return t?r.left=r.right:r.right=r.left,kt(n,o,r,i)}function t(e,t){var r=u[t],n=r.level%2;return e==Zo(r)&&t&&r.level<u[t-1].level?(e=Qo(r=u[--t])-(r.level%2?0:1),n=!0):e==Qo(r)&&t<u.length-1&&r.level<u[t+1].level&&(e=Zo(r=u[++t])-r.level%2,n=!1),n&&e==r.to&&e>r.from?a(e-1):a(e,n)}o=o||bi(n.doc,e.line),l||(l=vt(n,o));var u=ki(o),r=e.ch;if(!u)return a(r);var c=t(r,nl(u,r));return null!=$o&&(c.other=t(r,$o)),c}function At(e,t){var r=0;t=Ie(e.doc,t);e.options.lineWrapping||(r=Et(e.display)*t.ch);var n=bi(e.doc,t.line),i=Ti(n)+st(e.display);return{left:r,right:r,top:i,bottom:i+n.height}}function Ot(e,t,r,n){var i=fe(e,t);return i.xRel=n,r&&(i.outside=!0),i}function Dt(e,t,r){var n=e.doc;if((r+=e.display.viewOffset)<0)return Ot(n.first,0,!0,-1);var i=Li(n,r),o=n.first+n.size-1;if(o<i)return Ot(n.first+n.size-1,bi(n,o).text.length,!0,1);t<0&&(t=0);for(var l=bi(n,i);;){var s=Ht(e,l,i,t,r),a=En(l),u=a&&a.find(0,!0);if(!a||!(s.ch>u.from.ch||s.ch==u.from.ch&&0<s.xRel))return s;i=Si(l=u.to.line)}}function Ht(r,n,i,e,t){var o=t-Ti(n),l=!1,s=2*r.display.wrapper.clientWidth,a=vt(r,n);function u(e){var t=Wt(r,fe(i,e),"line",n,a);return l=!0,o>t.bottom?t.left-s:o<t.top?t.left+s:(l=!1,t.left)}var c=ki(n),h=n.text.length,f=Jo(n),d=el(n),p=u(f),g=l,v=u(d),m=l;if(v<e)return Ot(i,d,m,1);for(;;){if(c?d==f||d==ol(n,f,1):d-f<=1){for(var y=e<p||e-p<=v-e?f:d,b=e-(y==f?p:v);Mo(n.text.charAt(y));)++y;return Ot(i,y,y==f?g:m,b<-1?-1:1<b?1:0)}var w=Math.ceil(h/2),x=f+w;if(c){x=f;for(var C=0;C<w;++C)x=ol(n,x,1)}var S=u(x);e<S?(d=x,v=S,(m=l)&&(v+=1e3),h=w):(f=x,p=S,g=l,h-=w)}}function Pt(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==yt){yt=No("pre");for(var t=0;t<49;++t)yt.appendChild(document.createTextNode("x")),yt.appendChild(No("br"));yt.appendChild(document.createTextNode("x"))}Ao(e.measure,yt);var r=yt.offsetHeight/50;return 3<r&&(e.cachedTextHeight=r),Wo(e.measure),r||1}function Et(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=No("span","xxxxxxxxxx"),r=No("pre",[t]);Ao(e.measure,r);var n=t.getBoundingClientRect(),i=(n.right-n.left)/10;return 2<i&&(e.cachedCharWidth=i),i||10}var It,zt,Ft=null,Rt=0;function Bt(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Rt},Ft?Ft.ops.push(e.curOp):e.curOp.ownsGroup=Ft={ops:[e.curOp],delayedCallbacks:[]}}function Gt(e){var t=e.curOp.ownsGroup;if(t)try{!function(e){var t=e.delayedCallbacks,r=0;do{for(;r<t.length;r++)t[r].call(null);for(var n=0;n<e.ops.length;n++){var i=e.ops[n];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(r<t.length)}(t)}finally{Ft=null;for(var r=0;r<t.ops.length;r++)t.ops[r].cm.curOp=null;!function(e){for(var t=e.ops,r=0;r<t.length;r++)Ut(t[r]);for(var r=0;r<t.length;r++)n=t[r],n.updatedDisplay=n.mustUpdate&&_(n.cm,n.update);var n;for(var r=0;r<t.length;r++)Vt(t[r]);for(var r=0;r<t.length;r++)Kt(t[r]);for(var r=0;r<t.length;r++)jt(t[r])}(t)}}function Ut(e){var t,r,n=e.cm,i=n.display;!(r=(t=n).display).scrollbarsClipped&&r.scroller.offsetWidth&&(r.nativeBarWidth=r.scroller.offsetWidth-r.scroller.clientWidth,r.heightForcer.style.height=ct(t)+"px",r.sizer.style.marginBottom=-r.nativeBarWidth+"px",r.sizer.style.borderRightWidth=ct(t)+"px",r.scrollbarsClipped=!0),e.updateMaxLine&&P(n),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<i.viewFrom||e.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&n.options.lineWrapping,e.update=e.mustUpdate&&new Y(n,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Vt(e){var t=e.cm,r=t.display;e.updatedDisplay&&Q(t),e.barMeasure=I(t),r.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=pt(t,r.maxLine,r.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(r.scroller.clientWidth,r.sizer.offsetLeft+e.adjustWidthTo+ct(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,r.sizer.offsetLeft+e.adjustWidthTo-ht(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=r.input.prepareSelection())}function Kt(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&pr(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.preparedSelection&&t.display.input.showSelection(e.preparedSelection),e.updatedDisplay&&Z(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&B(t,e.barMeasure),e.selectionChanged&&nt(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),!e.focus||e.focus!=Do()||document.hasFocus&&!document.hasFocus()||me(e.cm)}function jt(e){var t=e.cm,r=t.display,n=t.doc;if(e.updatedDisplay&&$(t,e.update),null==r.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(r.wheelStartX=r.wheelStartY=null),null==e.scrollTop||r.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(n.scrollTop=Math.max(0,Math.min(r.scroller.scrollHeight-r.scroller.clientHeight,e.scrollTop)),r.scrollbars.setScrollTop(n.scrollTop),r.scroller.scrollTop=n.scrollTop),null==e.scrollLeft||r.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(n.scrollLeft=Math.max(0,Math.min(r.scroller.scrollWidth-ht(t),e.scrollLeft)),r.scrollbars.setScrollLeft(n.scrollLeft),r.scroller.scrollLeft=n.scrollLeft,V(t)),e.scrollToPos){var i=function(e,t,r,n){null==n&&(n=0);for(var i=0;i<5;i++){var o=!1,l=Wt(e,t),s=r&&r!=t?Wt(e,r):l,a=Gr(e,Math.min(l.left,s.left),Math.min(l.top,s.top)-n,Math.max(l.left,s.left),Math.max(l.bottom,s.bottom)+n),u=e.doc.scrollTop,c=e.doc.scrollLeft;if(null!=a.scrollTop&&(dr(e,a.scrollTop),1<Math.abs(e.doc.scrollTop-u)&&(o=!0)),null!=a.scrollLeft&&(pr(e,a.scrollLeft),1<Math.abs(e.doc.scrollLeft-c)&&(o=!0)),!o)break}return l}(t,Ie(n,e.scrollToPos.from),Ie(n,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&function(e,t){if(Qi(e,"scrollCursorIntoView"))return;var r=e.display,n=r.sizer.getBoundingClientRect(),i=null;t.top+n.top<0?i=!0:t.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1);if(null!=i&&!u){var o=No("div","​",null,"position: absolute; top: "+(t.top-r.viewOffset-st(e.display))+"px; height: "+(t.bottom-t.top+ct(e)+r.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(i),e.display.lineSpace.removeChild(o)}}(t,i)}var o=e.maybeHiddenMarkers,l=e.maybeUnhiddenMarkers;if(o)for(var s=0;s<o.length;++s)o[s].lines.length||_i(o[s],"hide");if(l)for(s=0;s<l.length;++s)l[s].lines.length&&_i(l[s],"unhide");r.wrapper.offsetHeight&&(n.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&_i(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Xt(e,t){if(e.curOp)return t();Bt(e);try{return t()}finally{Gt(e)}}function Yt(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Bt(e);try{return t.apply(e,arguments)}finally{Gt(e)}}}function _t(e){return function(){if(this.curOp)return e.apply(this,arguments);Bt(this);try{return e.apply(this,arguments)}finally{Gt(this)}}}function $t(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Bt(e);try{return t.apply(this,arguments)}finally{Gt(e)}}}function qt(e,t,r){this.line=t,this.rest=function(e){var t,r;for(;t=En(e);)e=t.find(1,!0).line,(r||(r=[])).push(e);return r}(t),this.size=this.rest?Si(fo(this.rest))-r+1:1,this.node=this.text=null,this.hidden=Bn(e,t)}function Zt(e,t,r){for(var n,i=[],o=t;o<r;o=n){var l=new qt(e.doc,bi(e.doc,o),o);n=o+l.size,i.push(l)}return i}function Qt(e,t,r,n){null==t&&(t=e.doc.first),null==r&&(r=e.doc.first+e.doc.size),n||(n=0);var i=e.display;if(n&&r<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=i.viewTo)C&&Fn(e.doc,t)<i.viewTo&&er(e);else if(r<=i.viewFrom)C&&Rn(e.doc,r+n)>i.viewFrom?er(e):(i.viewFrom+=n,i.viewTo+=n);else if(t<=i.viewFrom&&r>=i.viewTo)er(e);else if(t<=i.viewFrom){(o=rr(e,r,r+n,1))?(i.view=i.view.slice(o.index),i.viewFrom=o.lineN,i.viewTo+=n):er(e)}else if(r>=i.viewTo){var o;(o=rr(e,t,t,-1))?(i.view=i.view.slice(0,o.index),i.viewTo=o.lineN):er(e)}else{var l=rr(e,t,t,-1),s=rr(e,r,r+n,1);l&&s?(i.view=i.view.slice(0,l.index).concat(Zt(e,l.lineN,s.lineN)).concat(i.view.slice(s.index)),i.viewTo+=n):er(e)}var a=i.externalMeasured;a&&(r<a.lineN?a.lineN+=n:t<a.lineN+a.size&&(i.externalMeasured=null))}function Jt(e,t,r){e.curOp.viewChanged=!0;var n=e.display,i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size&&(n.externalMeasured=null),!(t<n.viewFrom||t>=n.viewTo)){var o=n.view[tr(e,t)];if(null!=o.node){var l=o.changes||(o.changes=[]);-1==go(l,r)&&l.push(r)}}}function er(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function tr(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var r=e.display.view,n=0;n<r.length;n++)if((t-=r[n].size)<0)return n}function rr(e,t,r,n){var i,o=tr(e,t),l=e.display.view;if(!C||r==e.doc.first+e.doc.size)return{index:o,lineN:r};for(var s=0,a=e.display.viewFrom;s<o;s++)a+=l[s].size;if(a!=t){if(0<n){if(o==l.length-1)return null;i=a+l[o].size-t,o++}else i=a-t;t+=i,r+=i}for(;Fn(e.doc,r)!=r;){if(o==(n<0?0:l.length-1))return null;r+=n*l[o-(n<0?1:0)].size,o+=n}return{index:o,lineN:r}}function nr(e){for(var t=e.display.view,r=0,n=0;n<t.length;n++){var i=t[n];i.hidden||i.node&&!i.changes||++r}return r}function ir(e){var t=e.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function or(e,t){for(var r=Ui(t);r!=e.wrapper;r=r.parentNode)if(!r||1==r.nodeType&&"true"==r.getAttribute("cm-ignore-events")||r.parentNode==e.sizer&&r!=e.mover)return!0}function lr(e,t,r,n){var i=e.display;if(!r&&"true"==Ui(t).getAttribute("cm-not-content"))return null;var o,l,s=i.lineSpace.getBoundingClientRect();try{o=t.clientX-s.left,l=t.clientY-s.top}catch(t){return null}var a,u=Dt(e,o,l);if(n&&1==u.xRel&&(a=bi(e.doc,u.line).text).length==u.ch){var c=ao(a,a.length,e.options.tabSize)-a.length;u=fe(u.line,Math.max(0,Math.round((o-ut(e.display).left)/Et(e.display))-c))}return u}function sr(e){var t=this,r=t.display;if(!(Qi(t,e)||r.activeTouch&&r.input.supportsTouch()))if(r.shift=e.shiftKey,or(r,e))v||(r.scroller.draggable=!1,setTimeout(function(){r.scroller.draggable=!0},100));else if(!ur(t,e)){var n,i=lr(t,e);switch(window.focus(),Vi(e)){case 1:t.state.selectingText?t.state.selectingText(e):i?function(e,t,r){w?setTimeout(wo(me,e),0):e.curOp.focus=Do();var n,i=+new Date;zt&&zt.time>i-400&&0==de(zt.pos,r)?n="triple":It&&It.time>i-400&&0==de(It.pos,r)?(n="double",zt={time:i,pos:r}):(n="single",It={time:i,pos:r});var o,l=e.doc.sel,s=y?t.metaKey:t.ctrlKey;e.options.dragDrop&&Go&&!e.isReadOnly()&&"single"==n&&-1<(o=l.contains(r))&&(de((o=l.ranges[o]).from(),r)<0||0<r.xRel)&&(0<de(o.to(),r)||r.xRel<0)?function(t,r,n,i){var o=t.display,l=+new Date,s=Yt(t,function(e){v&&(o.scroller.draggable=!1),t.state.draggingText=!1,Yi(document,"mouseup",s),Yi(o.scroller,"drop",s),Math.abs(r.clientX-e.clientX)+Math.abs(r.clientY-e.clientY)<10&&(Fi(e),!i&&+new Date-200<l&&Be(t.doc,n),v||w&&9==x?setTimeout(function(){document.body.focus(),o.input.focus()},20):o.input.focus())});v&&(o.scroller.draggable=!0);t.state.draggingText=s,o.scroller.dragDrop&&o.scroller.dragDrop();Ki(document,"mouseup",s),Ki(o.scroller,"drop",s)}(e,t,r,s):function(g,e,v,m,t){var o=g.display,y=g.doc;Fi(e);var b,w,x=y.sel,r=x.ranges;t&&!e.shiftKey?(w=y.sel.contains(v),b=-1<w?r[w]:new De(v,v)):(b=y.sel.primary(),w=y.sel.primIndex);if(e.altKey)m="rect",t||(b=new De(v,v)),v=lr(g,e,!0,!0),w=-1;else if("double"==m){var n=g.findWordAt(v);b=g.display.shift||y.extend?Re(y,b,n.anchor,n.head):n}else if("triple"==m){var i=new De(fe(v.line,0),Ie(y,fe(v.line+1,0)));b=g.display.shift||y.extend?Re(y,b,i.anchor,i.head):i}else b=Re(y,b,v);t?-1==w?(w=r.length,je(y,He(r.concat([b]),w),{scroll:!1,origin:"*mouse"})):1<r.length&&r[w].empty()&&"single"==m&&!e.shiftKey?(je(y,He(r.slice(0,w).concat(r.slice(w+1)),0),{scroll:!1,origin:"*mouse"}),x=y.sel):Ue(y,w,b,oo):(je(y,new Oe([b],w=0),oo),x=y.sel);var C=v;var l=o.wrapper.getBoundingClientRect(),s=0;function a(e){var t=++s,r=lr(g,e,!0,"rect"==m);if(r)if(0!=de(r,C)){g.curOp.focus=Do(),function(e){if(0==de(C,e))return;if(C=e,"rect"==m){for(var t=[],r=g.options.tabSize,n=ao(bi(y,v.line).text,v.ch,r),i=ao(bi(y,e.line).text,e.ch,r),o=Math.min(n,i),l=Math.max(n,i),s=Math.min(v.line,e.line),a=Math.min(g.lastLine(),Math.max(v.line,e.line));s<=a;s++){var u=bi(y,s).text,c=uo(u,o,r);o==l?t.push(new De(fe(s,c),fe(s,c))):u.length>c&&t.push(new De(fe(s,c),fe(s,uo(u,l,r))))}t.length||t.push(new De(v,v)),je(y,He(x.ranges.slice(0,w).concat(t),w),{origin:"*mouse",scroll:!1}),g.scrollIntoView(e)}else{var h=b,f=h.anchor,d=e;if("single"!=m){if("double"==m)var p=g.findWordAt(e);else var p=new De(fe(e.line,0),Ie(y,fe(e.line+1,0)));f=0<de(p.anchor,f)?(d=p.head,ve(h.from(),p.anchor)):(d=p.anchor,ge(h.to(),p.head))}var t=x.ranges.slice(0);t[w]=new De(Ie(y,f),d),je(y,He(t,w),oo)}}(r);var n=U(o,y);(r.line>=n.to||r.line<n.from)&&setTimeout(Yt(g,function(){s==t&&a(e)}),150)}else{var i=e.clientY<l.top?-20:e.clientY>l.bottom?20:0;i&&setTimeout(Yt(g,function(){s==t&&(o.scroller.scrollTop+=i,a(e))}),50)}}function u(e){g.state.selectingText=!1,s=1/0,Fi(e),o.input.focus(),Yi(document,"mousemove",c),Yi(document,"mouseup",h),y.history.lastSelOrigin=null}var c=Yt(g,function(e){Vi(e)?a(e):u(e)}),h=Yt(g,u);g.state.selectingText=h,Ki(document,"mousemove",c),Ki(document,"mouseup",h)}(e,t,r,n,s)}(t,e,i):Ui(e)==r.scroller&&Fi(e);break;case 2:v&&(t.state.lastMiddleDown=+new Date),i&&Be(t.doc,i),setTimeout(function(){r.input.focus()},20),Fi(e);break;case 3:p?Wr(t,e):((n=t).state.delayingBlurEvent=!0,setTimeout(function(){n.state.delayingBlurEvent&&(n.state.delayingBlurEvent=!1,Nr(n))},100))}}}function ar(e,t,r,n){try{var i=t.clientX,o=t.clientY}catch(t){return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&Fi(t);var l=e.display,s=l.lineDiv.getBoundingClientRect();if(o>s.bottom||!eo(e,r))return Bi(t);o-=s.top-l.viewOffset;for(var a=0;a<e.options.gutters.length;++a){var u=l.gutters.childNodes[a];if(u&&u.getBoundingClientRect().right>=i){var c=Li(e.doc,o),h=e.options.gutters[a];return _i(e,r,e,c,h,t),Bi(t)}}}function ur(e,t){return ar(e,t,"gutterClick",!0)}var cr=0;function hr(e){var i=this;if(fr(i),!Qi(i,e)&&!or(i.display,e)){Fi(e),w&&(cr=+new Date);var o=lr(i,e,!0),t=e.dataTransfer.files;if(o&&!i.isReadOnly())if(t&&t.length&&window.FileReader&&window.File)for(var l=t.length,s=Array(l),a=0,r=function(e,r){if(!i.options.allowDropFileTypes||-1!=go(i.options.allowDropFileTypes,e.type)){var n=new FileReader;n.onload=Yt(i,function(){var e=n.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),s[r]=e,++a==l){var t={from:o=Ie(i.doc,o),to:o,text:i.doc.splitLines(s.join(i.doc.lineSeparator())),origin:"paste"};Er(i.doc,t),Ke(i.doc,Pe(o,Ar(t)))}}),n.readAsText(e)}},n=0;n<l;++n)r(t[n],n);else{if(i.state.draggingText&&-1<i.doc.sel.contains(o))return i.state.draggingText(e),void setTimeout(function(){i.display.input.focus()},20);try{if(s=e.dataTransfer.getData("Text")){if(i.state.draggingText&&!(y?e.altKey:e.ctrlKey))var u=i.listSelections();if(Xe(i.doc,Pe(o,o)),u)for(n=0;n<u.length;++n)Br(i.doc,"",u[n].anchor,u[n].head,"drag");i.replaceSelection(s,"around","paste"),i.display.input.focus()}}catch(e){}}}}function fr(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function dr(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,g||q(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),g&&q(e),it(e,100))}function pr(e,t,r){(r?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,V(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}var gr=0,vr=null;w?vr=-.53:g?vr=15:o?vr=-.7:a&&(vr=-1/3);var mr=function(e){var t=e.wheelDeltaX,r=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==r&&e.detail&&e.axis==e.VERTICAL_AXIS?r=e.detail:null==r&&(r=e.wheelDelta),{x:t,y:r}};function yr(e,t){var r=mr(t),n=r.x,i=r.y,o=e.display,l=o.scroller,s=l.scrollWidth>l.clientWidth,a=l.scrollHeight>l.clientHeight;if(n&&s||i&&a){if(i&&y&&v)e:for(var u=t.target,c=o.view;u!=l;u=u.parentNode)for(var h=0;h<c.length;h++)if(c[h].node==u){e.display.currentWheelTarget=u;break e}if(n&&!g&&!m&&null!=vr)return i&&a&&dr(e,Math.max(0,Math.min(l.scrollTop+i*vr,l.scrollHeight-l.clientHeight))),pr(e,Math.max(0,Math.min(l.scrollLeft+n*vr,l.scrollWidth-l.clientWidth))),(!i||i&&a)&&Fi(t),void(o.wheelStartX=null);if(i&&null!=vr){var f=i*vr,d=e.doc.scrollTop,p=d+o.wrapper.clientHeight;f<0?d=Math.max(0,d+f-50):p=Math.min(e.doc.height,p+f+50),q(e,{top:d,bottom:p})}gr<20&&(null==o.wheelStartX?(o.wheelStartX=l.scrollLeft,o.wheelStartY=l.scrollTop,o.wheelDX=n,o.wheelDY=i,setTimeout(function(){if(null!=o.wheelStartX){var e=l.scrollLeft-o.wheelStartX,t=l.scrollTop-o.wheelStartY,r=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null,r&&(vr=(vr*gr+r)/(gr+1),++gr)}},200)):(o.wheelDX+=n,o.wheelDY+=i))}}function br(e,t,r){if("string"==typeof t&&!(t=an[t]))return!1;e.display.input.ensurePolled();var n=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),r&&(e.display.shift=!1),i=t(e)!=no}finally{e.display.shift=n,e.state.suppressEdits=!1}return i}S.wheelEventPixels=function(e){var t=mr(e);return t.x*=vr,t.y*=vr,t};var wr=new so;function xr(e,t,r,n){var i=e.state.keySeq;if(i){if(fn(t))return"handled";wr.set(50,function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())}),t=i+" "+t}var o=function(e,t,r){for(var n=0;n<e.state.keyMaps.length;n++){var i=hn(t,e.state.keyMaps[n],r,e);if(i)return i}return e.options.extraKeys&&hn(t,e.options.extraKeys,r,e)||hn(t,e.options.keyMap,r,e)}(e,t,n);return"multi"==o&&(e.state.keySeq=t),"handled"==o&&qi(e,"keyHandled",e,t,r),"handled"!=o&&"multi"!=o||(Fi(r),nt(e)),i&&!o&&/\'$/.test(t)?(Fi(r),!0):!!o}function Cr(t,e){var r=dn(e,!0);return!!r&&(e.shiftKey&&!t.state.keySeq?xr(t,"Shift-"+r,e,function(e){return br(t,e,!0)})||xr(t,r,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return br(t,e)}):xr(t,r,e,function(e){return br(t,e)}))}var Sr=null;function Lr(e){var t=this;if(t.curOp.focus=Do(),!Qi(t,e)){w&&x<11&&27==e.keyCode&&(e.returnValue=!1);var r=e.keyCode;t.display.shift=16==r||e.shiftKey;var n=Cr(t,e);m&&(Sr=n?r:null,!n&&88==r&&!Yo&&(y?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=r||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||function(e){var t=e.display.lineDiv;function r(e){18!=e.keyCode&&e.altKey||(Po(t,"CodeMirror-crosshair"),Yi(document,"keyup",r),Yi(document,"mouseover",r))}Eo(t,"CodeMirror-crosshair"),Ki(document,"keyup",r),Ki(document,"mouseover",r)}(t)}}function Tr(e){16==e.keyCode&&(this.doc.sel.shift=!1),Qi(this,e)}function kr(e){var t=this;if(!(or(t.display,e)||Qi(t,e)||e.ctrlKey&&!e.altKey||y&&e.metaKey)){var r=e.keyCode,n=e.charCode;if(m&&r==Sr)return Sr=null,void Fi(e);if(!m||e.which&&!(e.which<10)||!Cr(t,e)){var i,o=String.fromCharCode(null==n?r:n);if(!xr(i=t,"'"+o+"'",e,function(e){return br(i,e,!0)}))t.display.input.onKeyPress(e)}}}function Mr(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(_i(e,"focus",e),e.state.focused=!0,Eo(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),v&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),nt(e))}function Nr(e){e.state.delayingBlurEvent||(e.state.focused&&(_i(e,"blur",e),e.state.focused=!1,Po(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Wr(e,t){var r,n;or(e.display,t)||(n=t,eo(r=e,"gutterContextMenu")&&ar(r,n,"gutterContextMenu",!1))||(Qi(e,t,"contextmenu")||e.display.input.onContextMenu(t))}var Ar=S.changeEnd=function(e){return e.text?fe(e.from.line+e.text.length-1,fo(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};function Or(e,t){if(de(e,t.from)<0)return e;if(de(e,t.to)<=0)return Ar(t);var r=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;return e.line==t.to.line&&(n+=Ar(t).ch-t.to.ch),fe(r,n)}function Dr(e,t){for(var r=[],n=0;n<e.sel.ranges.length;n++){var i=e.sel.ranges[n];r.push(new De(Or(i.anchor,t),Or(i.head,t)))}return He(r,e.sel.primIndex)}function Hr(e,t,r){return e.line==t.line?fe(r.line,e.ch-t.ch+r.ch):fe(r.line+(e.line-t.line),e.ch)}function Pr(i,e,t){var r={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){this.canceled=!0}};return t&&(r.update=function(e,t,r,n){e&&(this.from=Ie(i,e)),t&&(this.to=Ie(i,t)),r&&(this.text=r),void 0!==n&&(this.origin=n)}),_i(i,"beforeChange",i,r),i.cm&&_i(i.cm,"beforeChange",i.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Er(e,t,r){if(e.cm){if(!e.cm.curOp)return Yt(e.cm,Er)(e,t,r);if(e.cm.state.suppressEdits)return}if(!(eo(e,"beforeChange")||e.cm&&eo(e.cm,"beforeChange"))||(t=Pr(e,t,!0))){var n=b&&!r&&function(e,t,r){var n=null;if(e.iter(t.line,r.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var r=e.markedSpans[t].marker;!r.readOnly||n&&-1!=go(n,r)||(n||(n=[])).push(r)}}),!n)return null;for(var i=[{from:t,to:r}],o=0;o<n.length;++o)for(var l=n[o],s=l.find(0),a=0;a<i.length;++a){var u=i[a];if(!(de(u.to,s.from)<0||0<de(u.from,s.to))){var c=[a,1],h=de(u.from,s.from),f=de(u.to,s.to);(h<0||!l.inclusiveLeft&&!h)&&c.push({from:u.from,to:s.from}),(0<f||!l.inclusiveRight&&!f)&&c.push({from:s.to,to:u.to}),i.splice.apply(i,c),a+=c.length-1}}return i}(e,t.from,t.to);if(n)for(var i=n.length-1;0<=i;--i)Ir(e,{from:n[i].from,to:n[i].to,text:i?[""]:t.text});else Ir(e,t)}}function Ir(e,r){if(1!=r.text.length||""!=r.text[0]||0!=de(r.from,r.to)){var t=Dr(e,r);Ai(e,r,t,e.cm?e.cm.curOp.id:NaN),Rr(e,r,t,Tn(e,r));var n=[];mi(e,function(e,t){t||-1!=go(n,e.history)||(zi(e.history,r),n.push(e.history)),Rr(e,r,null,Tn(e,r))})}}function zr(e,t,r){if(!e.cm||!e.cm.state.suppressEdits){for(var n,i=e.history,o=e.sel,l="undo"==t?i.done:i.undone,s="undo"==t?i.undone:i.done,a=0;a<l.length&&(n=l[a],r?!n.ranges||n.equals(e.sel):n.ranges);a++);if(a!=l.length){for(i.lastOrigin=i.lastSelOrigin=null;(n=l.pop()).ranges;){if(Oi(n,s),r&&!n.equals(e.sel))return void je(e,n,{clearRedo:!1});o=n}var u=[];Oi(o,s),s.push({changes:u,generation:i.generation}),i.generation=n.generation||++i.maxGeneration;var c=eo(e,"beforeChange")||e.cm&&eo(e.cm,"beforeChange");for(a=n.changes.length-1;0<=a;--a){var h=n.changes[a];if(h.origin=t,c&&!Pr(e,h,!1))return void(l.length=0);u.push(Ni(e,h));var f=a?Dr(e,h):fo(l);Rr(e,h,f,Mn(e,h)),!a&&e.cm&&e.cm.scrollIntoView({from:h.from,to:Ar(h)});var d=[];mi(e,function(e,t){t||-1!=go(d,e.history)||(zi(e.history,h),d.push(e.history)),Rr(e,h,null,Mn(e,h))})}}}}function Fr(e,t){if(0!=t&&(e.first+=t,e.sel=new Oe(vo(e.sel.ranges,function(e){return new De(fe(e.anchor.line+t,e.anchor.ch),fe(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){Qt(e.cm,e.first,e.first-t,t);for(var r=e.cm.display,n=r.viewFrom;n<r.viewTo;n++)Jt(e.cm,n,"gutter")}}function Rr(e,t,r,n){if(e.cm&&!e.cm.curOp)return Yt(e.cm,Rr)(e,t,r,n);if(t.to.line<e.first)Fr(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);Fr(e,i),t={from:fe(e.first,0),to:fe(t.to.line+i,t.to.ch),text:[fo(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:fe(o,bi(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=wi(e,t.from,t.to),r||(r=Dr(e,t)),e.cm?function(e,t,r){var n=e.doc,i=e.display,o=t.from,l=t.to,s=!1,a=o.line;e.options.lineWrapping||(a=Si(zn(bi(n,o.line))),n.iter(a,l.line+1,function(e){if(e==i.maxLine)return s=!0}));-1<n.sel.contains(t.from,t.to)&&Ji(e);ci(n,t,r,M(e)),e.options.lineWrapping||(n.iter(a,o.line+t.text.length,function(e){var t=H(e);t>i.maxLineLength&&(i.maxLine=e,i.maxLineLength=t,i.maxLineChanged=!0,s=!1)}),s&&(e.curOp.updateMaxLine=!0));n.frontier=Math.min(n.frontier,o.line),it(e,400);var u=t.text.length-(l.line-o.line)-1;t.full?Qt(e):o.line!=l.line||1!=t.text.length||ui(e.doc,t)?Qt(e,o.line,l.line+1,u):Jt(e,o.line,"text");var c=eo(e,"changes"),h=eo(e,"change");if(h||c){var f={from:o,to:l,text:t.text,removed:t.removed,origin:t.origin};h&&qi(e,"change",e,f),c&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(f)}e.display.selForContextMenu=null}(e.cm,t,n):ci(e,t,n),Xe(e,r,io)}}function Br(e,t,r,n,i){if(n||(n=r),de(n,r)<0){var o=n;n=r,r=o}"string"==typeof t&&(t=e.splitLines(t)),Er(e,{from:r,to:n,text:t,origin:i})}function Gr(e,t,r,n,i){var o=e.display,l=Pt(e.display);r<0&&(r=0);var s=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,a=ft(e),u={};a<i-r&&(i=r+a);var c=e.doc.height+at(o),h=r<l,f=c-l<i;if(r<s)u.scrollTop=h?0:r;else if(s+a<i){var d=Math.min(r,(f?c:i)-a);d!=s&&(u.scrollTop=d)}var p=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,g=ht(e)-(e.options.fixedGutter?o.gutters.offsetWidth:0),v=g<n-t;return v&&(n=t+g),t<10?u.scrollLeft=0:t<p?u.scrollLeft=Math.max(0,t-(v?0:10)):g+p-3<n&&(u.scrollLeft=n+(v?0:10)-g),u}function Ur(e,t,r){null==t&&null==r||Kr(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=r&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+r)}function Vr(e){Kr(e);var t=e.getCursor(),r=t,n=t;e.options.lineWrapping||(r=t.ch?fe(t.line,t.ch-1):t,n=fe(t.line,t.ch+1)),e.curOp.scrollToPos={from:r,to:n,margin:e.options.cursorScrollMargin,isCursor:!0}}function Kr(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var r=At(e,t.from),n=At(e,t.to),i=Gr(e,Math.min(r.left,n.left),Math.min(r.top,n.top)-t.margin,Math.max(r.right,n.right),Math.max(r.bottom,n.bottom)+t.margin);e.scrollTo(i.scrollLeft,i.scrollTop)}}function jr(e,t,r,n){var i,o=e.doc;null==r&&(r="add"),"smart"==r&&(o.mode.indent?i=lt(e,t):r="prev");var l=e.options.tabSize,s=bi(o,t),a=ao(s.text,null,l);s.stateAfter&&(s.stateAfter=null);var u,c=s.text.match(/^\s*/)[0];if(n||/\S/.test(s.text)){if("smart"==r&&((u=o.mode.indent(i,s.text.slice(c.length),s.text))==no||150<u)){if(!n)return;r="prev"}}else u=0,r="not";"prev"==r?u=t>o.first?ao(bi(o,t-1).text,null,l):0:"add"==r?u=a+e.options.indentUnit:"subtract"==r?u=a-e.options.indentUnit:"number"==typeof r&&(u=a+r),u=Math.max(0,u);var h="",f=0;if(e.options.indentWithTabs)for(var d=Math.floor(u/l);d;--d)f+=l,h+="\t";if(f<u&&(h+=ho(u-f)),h!=c)return Br(o,h,fe(t,0),fe(t,c.length),"+input"),!(s.stateAfter=null);for(d=0;d<o.sel.ranges.length;d++){var p=o.sel.ranges[d];if(p.head.line==t&&p.head.ch<c.length){Ue(o,d,new De(f=fe(t,c.length),f));break}}}function Xr(e,t,r,n){var i=t,o=t;return"number"==typeof t?o=bi(e,Ee(e,t)):i=Si(t),null==i?null:(n(o,i)&&e.cm&&Jt(e.cm,i,r),o)}function Yr(t,e){for(var r=t.doc.sel.ranges,n=[],i=0;i<r.length;i++){for(var o=e(r[i]);n.length&&de(o.from,fo(n).to)<=0;){var l=n.pop();if(de(l.from,o.from)<0){o.from=l.from;break}}n.push(o)}Xt(t,function(){for(var e=n.length-1;0<=e;e--)Br(t.doc,"",n[e].from,n[e].to,"+delete");Vr(t)})}function _r(n,e,i,t,o){var l=e.line,s=e.ch,r=i,a=bi(n,l);function u(e){var t,r=(o?ol:ll)(a,s,i,!0);if(null==r){if(e||(t=l+i)<n.first||t>=n.first+n.size||!(a=bi(n,l=t)))return!1;s=o?(i<0?el:Jo)(a):i<0?a.text.length:0}else s=r;return!0}if("char"==t)u();else if("column"==t)u(!0);else if("word"==t||"group"==t)for(var c=null,h="group"==t,f=n.cm&&n.cm.getHelper(e,"wordChars"),d=!0;!(i<0)||u(!d);d=!1){var p=a.text.charAt(s)||"\n",g=So(p,f)?"w":h&&"\n"==p?"n":!h||/\s/.test(p)?null:"p";if(!h||d||g||(g="s"),c&&c!=g){i<0&&(i=1,u());break}if(g&&(c=g),0<i&&!u(!d))break}var v=Ze(n,fe(l,s),e,r,!0);return de(e,v)||(v.hitSide=!0),v}function $r(e,t,r,n){var i,o=e.doc,l=t.left;if("page"==n){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);i=t.top+r*(s-(r<0?1.5:.5)*Pt(e.display))}else"line"==n&&(i=0<r?t.bottom+3:t.top-3);for(;;){var a=Dt(e,l,i);if(!a.outside)break;if(r<0?i<=0:i>=o.height){a.hitSide=!0;break}i+=5*r}return a}S.prototype={constructor:S,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var r=this.options,n=r[e];r[e]==t&&"mode"!=e||(r[e]=t,Zr.hasOwnProperty(e)&&Yt(this,Zr[e])(this,t,n))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](pn(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,r=0;r<t.length;++r)if(t[r]==e||t[r].name==e)return t.splice(r,1),!0},addOverlay:_t(function(e,t){var r=e.token?e:S.getMode(this.options,e);if(r.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:e,opaque:t&&t.opaque}),this.state.modeGen++,Qt(this)}),removeOverlay:_t(function(e){for(var t=this.state.overlays,r=0;r<t.length;++r){var n=t[r].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(r,1),this.state.modeGen++,void Qt(this)}}),indentLine:_t(function(e,t,r){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),ze(this.doc,e)&&jr(this,e,t,r)}),indentSelection:_t(function(e){for(var t=this.doc.sel.ranges,r=-1,n=0;n<t.length;n++){var i=t[n];if(i.empty())i.head.line>r&&(jr(this,i.head.line,e,!0),r=i.head.line,n==this.doc.sel.primIndex&&Vr(this));else{var o=i.from(),l=i.to(),s=Math.max(r,o.line);r=Math.min(this.lastLine(),l.line-(l.ch?0:1))+1;for(var a=s;a<r;++a)jr(this,a,e);var u=this.doc.sel.ranges;0==o.ch&&t.length==u.length&&0<u[n].from().ch&&Ue(this.doc,n,new De(o,u[n].to()),io)}}}),getTokenAt:function(e,t){return $n(this,e,t)},getLineTokens:function(e,t){return $n(this,fe(e),t,!0)},getTokenTypeAt:function(e){e=Ie(this.doc,e);var t,r=Qn(this,bi(this.doc,e.line)),n=0,i=(r.length-1)/2,o=e.ch;if(0==o)t=r[2];else for(;;){var l=n+i>>1;if((l?r[2*l-1]:0)>=o)i=l;else{if(!(r[2*l+1]<o)){t=r[2*l+2];break}n=l+1}}var s=t?t.indexOf("cm-overlay "):-1;return s<0?t:0==s?null:t.slice(0,s-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?S.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var r=[];if(!on.hasOwnProperty(t))return r;var n=on[t],i=this.getModeAt(e);if("string"==typeof i[t])n[i[t]]&&r.push(n[i[t]]);else if(i[t])for(var o=0;o<i[t].length;o++){var l=n[i[t][o]];l&&r.push(l)}else i.helperType&&n[i.helperType]?r.push(n[i.helperType]):n[i.name]&&r.push(n[i.name]);for(o=0;o<n._global.length;o++){var s=n._global[o];s.pred(i,this)&&-1==go(r,s.val)&&r.push(s.val)}return r},getStateAfter:function(e,t){var r=this.doc;return lt(this,(e=Ee(r,null==e?r.first+r.size-1:e))+1,t)},cursorCoords:function(e,t){var r=this.doc.sel.primary();return Wt(this,null==e?r.head:"object"==typeof e?Ie(this.doc,e):e?r.from():r.to(),t||"page")},charCoords:function(e,t){return Nt(this,Ie(this.doc,e),t||"page")},coordsChar:function(e,t){return Dt(this,(e=Mt(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Mt(this,{top:e,left:0},t||"page").top,Li(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var r,n=!1;if("number"==typeof e){var i=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:i<e&&(e=i,n=!0),r=bi(this.doc,e)}else r=e;return kt(this,r,{top:0,left:0},t||"page").top+(n?this.doc.height-Ti(r):0)},defaultTextHeight:function(){return Pt(this.display)},defaultCharWidth:function(){return Et(this.display)},setGutterMarker:_t(function(e,r,n){return Xr(this.doc,e,"gutter",function(e){var t=e.gutterMarkers||(e.gutterMarkers={});return!(t[r]=n)&&Lo(t)&&(e.gutterMarkers=null),!0})}),clearGutter:_t(function(t){var r=this,e=r.doc,n=e.first;e.iter(function(e){e.gutterMarkers&&e.gutterMarkers[t]&&(e.gutterMarkers[t]=null,Jt(r,n,"gutter"),Lo(e.gutterMarkers)&&(e.gutterMarkers=null)),++n})}),lineInfo:function(e){if("number"==typeof e){if(!ze(this.doc,e))return null;var t=e;if(!(e=bi(this.doc,e)))return null}else{if(null==(t=Si(e)))return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,r,n,i){var o,l,s,a,u,c,h=this.display,f=(e=Wt(this,Ie(this.doc,e))).bottom,d=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),h.sizer.appendChild(t),"over"==n)f=e.top;else if("above"==n||"near"==n){var p=Math.max(h.wrapper.clientHeight,this.doc.height),g=Math.max(h.sizer.clientWidth,h.lineSpace.clientWidth);("above"==n||e.bottom+t.offsetHeight>p)&&e.top>t.offsetHeight?f=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=p&&(f=e.bottom),d+t.offsetWidth>g&&(d=g-t.offsetWidth)}t.style.top=f+"px",t.style.left=t.style.right="","right"==i?(d=h.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?d=0:"middle"==i&&(d=(h.sizer.clientWidth-t.offsetWidth)/2),t.style.left=d+"px"),r&&(o=this,s=f,a=(l=d)+t.offsetWidth,u=f+t.offsetHeight,null!=(c=Gr(o,l,s,a,u)).scrollTop&&dr(o,c.scrollTop),null!=c.scrollLeft&&pr(o,c.scrollLeft))},triggerOnKeyDown:_t(Lr),triggerOnKeyPress:_t(kr),triggerOnKeyUp:Tr,execCommand:function(e){if(an.hasOwnProperty(e))return an[e].call(null,this)},triggerElectric:_t(function(e){xe(this,e)}),findPosH:function(e,t,r,n){var i=1;t<0&&(i=-1,t=-t);for(var o=0,l=Ie(this.doc,e);o<t&&!(l=_r(this.doc,l,i,r,n)).hitSide;++o);return l},moveH:_t(function(t,r){var n=this;n.extendSelectionsBy(function(e){return n.display.shift||n.doc.extend||e.empty()?_r(n.doc,e.head,t,r,n.options.rtlMoveVisually):t<0?e.from():e.to()},lo)}),deleteH:_t(function(r,n){var e=this.doc.sel,i=this.doc;e.somethingSelected()?i.replaceSelection("",null,"+delete"):Yr(this,function(e){var t=_r(i,e.head,r,n,!1);return r<0?{from:t,to:e.head}:{from:e.head,to:t}})}),findPosV:function(e,t,r,n){var i=1,o=n;t<0&&(i=-1,t=-t);for(var l=0,s=Ie(this.doc,e);l<t;++l){var a=Wt(this,s,"div");if(null==o?o=a.left:a.left=o,(s=$r(this,a,i,r)).hitSide)break}return s},moveV:_t(function(n,i){var o=this,l=this.doc,s=[],a=!o.display.shift&&!l.extend&&l.sel.somethingSelected();if(l.extendSelectionsBy(function(e){if(a)return n<0?e.from():e.to();var t=Wt(o,e.head,"div");null!=e.goalColumn&&(t.left=e.goalColumn),s.push(t.left);var r=$r(o,t,n,i);return"page"==i&&e==l.sel.primary()&&Ur(o,null,Nt(o,r,"div").top-t.top),r},lo),s.length)for(var e=0;e<l.sel.ranges.length;e++)l.sel.ranges[e].goalColumn=s[e]}),findWordAt:function(e){var t=bi(this.doc,e.line).text,r=e.ch,n=e.ch;if(t){var i=this.getHelper(e,"wordChars");(e.xRel<0||n==t.length)&&r?--r:++n;for(var o=t.charAt(r),l=So(o,i)?function(e){return So(e,i)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!So(e)};0<r&&l(t.charAt(r-1));)--r;for(;n<t.length&&l(t.charAt(n));)++n}return new De(fe(e.line,r),fe(e.line,n))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Eo(this.display.cursorDiv,"CodeMirror-overwrite"):Po(this.display.cursorDiv,"CodeMirror-overwrite"),_i(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Do()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:_t(function(e,t){null==e&&null==t||Kr(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-ct(this)-this.display.barHeight,width:e.scrollWidth-ct(this)-this.display.barWidth,clientHeight:ft(this),clientWidth:ht(this)}},scrollIntoView:_t(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:fe(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)Kr(this),this.curOp.scrollToPos=e;else{var r=Gr(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(r.scrollLeft,r.scrollTop)}}),setSize:_t(function(e,t){var r=this;function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}null!=e&&(r.display.wrapper.style.width=n(e)),null!=t&&(r.display.wrapper.style.height=n(t)),r.options.lineWrapping&&Ct(this);var i=r.display.viewFrom;r.doc.iter(i,r.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Jt(r,i,"widget");break}++i}),r.curOp.forceUpdate=!0,_i(r,"refresh",this)}),operation:function(e){return Xt(this,e)},refresh:_t(function(){var e=this.display.cachedTextHeight;Qt(this),this.curOp.forceUpdate=!0,St(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),D(this),(null==e||.5<Math.abs(e-Pt(this.display)))&&N(this),_i(this,"refresh",this)}),swapDoc:_t(function(e){var t=this.doc;return t.cm=null,yi(this,e),St(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,qi(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},to(S);var qr=S.defaults={},Zr=S.optionHandlers={};function Qr(e,t,n,r){S.defaults[e]=t,n&&(Zr[e]=r?function(e,t,r){r!=Jr&&n(e,t,r)}:n)}var Jr=S.Init={toString:function(){return"CodeMirror.Init"}};Qr("value","",function(e,t){e.setValue(t)},!0),Qr("mode",null,function(e,t){e.doc.modeOption=t,T(e)},!0),Qr("indentUnit",2,T,!0),Qr("indentWithTabs",!1),Qr("smartIndent",!0),Qr("tabSize",4,function(e){k(e),St(e),Qt(e)},!0),Qr("lineSeparator",null,function(e,n){if(e.doc.lineSep=n){var i=[],o=e.doc.first;e.doc.iter(function(e){for(var t=0;;){var r=e.text.indexOf(n,t);if(-1==r)break;t=r+n.length,i.push(fe(o,r))}o++});for(var t=i.length-1;0<=t;t--)Br(e.doc,n,i[t],fe(i[t].line,i[t].ch+n.length))}}),Qr("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t,r){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),r!=S.Init&&e.refresh()}),Qr("specialCharPlaceholder",function(e){var t=No("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t},function(e){e.refresh()},!0),Qr("electricChars",!0),Qr("inputStyle",c?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),Qr("rtlMoveVisually",!h),Qr("wholeLineUpdateBefore",!0),Qr("theme","default",function(e){W(e),A(e)},!0),Qr("keyMap","default",function(e,t,r){var n=pn(t),i=r!=S.Init&&pn(r);i&&i.detach&&i.detach(e,n),n.attach&&n.attach(e,i||null)}),Qr("extraKeys",null),Qr("lineWrapping",!1,function(e){e.options.lineWrapping?(Eo(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Po(e.display.wrapper,"CodeMirror-wrap"),P(e)),N(e),Qt(e),St(e),setTimeout(function(){B(e)},100)},!0),Qr("gutters",[],function(e){E(e.options),A(e)},!0),Qr("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?X(e.display)+"px":"0",e.refresh()},!0),Qr("coverGutterNextToScrollbar",!1,function(e){B(e)},!0),Qr("scrollbarStyle","native",function(e){R(e),B(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),Qr("lineNumbers",!1,function(e){E(e.options),A(e)},!0),Qr("firstLineNumber",1,A,!0),Qr("lineNumberFormatter",function(e){return e},A,!0),Qr("showCursorWhenSelecting",!1,Je,!0),Qr("resetSelectionOnContextMenu",!0),Qr("lineWiseCopyCut",!0),Qr("readOnly",!1,function(e,t){e.display.disabled="nocursor"==t&&(Nr(e),e.display.input.blur(),!0),e.display.input.readOnlyChanged(t)}),Qr("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),Qr("dragDrop",!0,function(e,t,r){if(!t!=!(r&&r!=S.Init)){var n=e.display.dragFunctions,i=t?Ki:Yi;i(e.display.scroller,"dragstart",n.start),i(e.display.scroller,"dragenter",n.enter),i(e.display.scroller,"dragover",n.over),i(e.display.scroller,"dragleave",n.leave),i(e.display.scroller,"drop",n.drop)}}),Qr("allowDropFileTypes",null),Qr("cursorBlinkRate",530),Qr("cursorScrollMargin",0),Qr("cursorHeight",1,Je,!0),Qr("singleCursorHeightPerLine",!0,Je,!0),Qr("workTime",100),Qr("workDelay",100),Qr("flattenSpans",!0,k,!0),Qr("addModeClass",!1,k,!0),Qr("pollInterval",100),Qr("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Qr("historyEventDelay",1250),Qr("viewportMargin",10,function(e){e.refresh()},!0),Qr("maxHighlightLength",1e4,k,!0),Qr("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),Qr("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),Qr("autofocus",null);var en=S.modes={},tn=S.mimeModes={};S.defineMode=function(e,t){S.defaults.mode||"null"==e||(S.defaults.mode=e),2<arguments.length&&(t.dependencies=Array.prototype.slice.call(arguments,2)),en[e]=t},S.defineMIME=function(e,t){tn[e]=t},S.resolveMode=function(e){if("string"==typeof e&&tn.hasOwnProperty(e))e=tn[e];else if(e&&"string"==typeof e.name&&tn.hasOwnProperty(e.name)){var t=tn[e.name];"string"==typeof t&&(t={name:t}),(e=yo(t,e)).name=t.name}else if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return S.resolveMode("application/xml");return"string"==typeof e?{name:e}:e||{name:"null"}},S.getMode=function(e,t){t=S.resolveMode(t);var r=en[t.name];if(!r)return S.getMode(e,"text/plain");var n=r(e,t);if(rn.hasOwnProperty(t.name)){var i=rn[t.name];for(var o in i)i.hasOwnProperty(o)&&(n.hasOwnProperty(o)&&(n["_"+o]=n[o]),n[o]=i[o])}if(n.name=t.name,t.helperType&&(n.helperType=t.helperType),t.modeProps)for(var o in t.modeProps)n[o]=t.modeProps[o];return n},S.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),S.defineMIME("text/plain","null");var rn=S.modeExtensions={};S.extendMode=function(e,t){bo(t,rn.hasOwnProperty(e)?rn[e]:rn[e]={})},S.defineExtension=function(e,t){S.prototype[e]=t},S.defineDocExtension=function(e,t){pi.prototype[e]=t},S.defineOption=Qr;var nn=[];S.defineInitHook=function(e){nn.push(e)};var on=S.helpers={};S.registerHelper=function(e,t,r){on.hasOwnProperty(e)||(on[e]=S[e]={_global:[]}),on[e][t]=r},S.registerGlobalHelper=function(e,t,r,n){S.registerHelper(e,t,n),on[e]._global.push({pred:r,val:n})};var ln=S.copyState=function(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var r={};for(var n in t){var i=t[n];i instanceof Array&&(i=i.concat([])),r[n]=i}return r},sn=S.startState=function(e,t,r){return!e.startState||e.startState(t,r)};S.innerMode=function(e,t){for(;e.innerMode;){var r=e.innerMode(t);if(!r||r.mode==e)break;t=r.state,e=r.mode}return r||{mode:e,state:t}};var an=S.commands={selectAll:function(e){e.setSelection(fe(e.firstLine(),0),fe(e.lastLine()),io)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),io)},killLine:function(r){Yr(r,function(e){if(e.empty()){var t=bi(r.doc,e.head.line).text.length;return e.head.ch==t&&e.head.line<r.lastLine()?{from:e.head,to:fe(e.head.line+1,0)}:{from:e.head,to:fe(e.head.line,t)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){Yr(t,function(e){return{from:fe(e.from().line,0),to:Ie(t.doc,fe(e.to().line+1,0))}})},delLineLeft:function(e){Yr(e,function(e){return{from:fe(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(r){Yr(r,function(e){var t=r.charCoords(e.head,"div").top+5;return{from:r.coordsChar({left:0,top:t},"div"),to:e.from()}})},delWrappedLineRight:function(n){Yr(n,function(e){var t=n.charCoords(e.head,"div").top+5,r=n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:r}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(fe(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(fe(e.lastLine()))},goLineStart:function(t){t.extendSelectionsBy(function(e){return tl(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){t.extendSelectionsBy(function(e){return rl(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){t.extendSelectionsBy(function(e){return function(e,t){var r,n=bi(e.doc,t);for(;r=En(n);)n=r.find(1,!0).line,t=null;var i=ki(n),o=i?i[0].level%2?Jo(n):el(n):n.text.length;return fe(null==t?Si(n):t,o)}(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(r){r.extendSelectionsBy(function(e){var t=r.charCoords(e.head,"div").top+5;return r.coordsChar({left:r.display.lineDiv.offsetWidth+100,top:t},"div")},lo)},goLineLeft:function(r){r.extendSelectionsBy(function(e){var t=r.charCoords(e.head,"div").top+5;return r.coordsChar({left:0,top:t},"div")},lo)},goLineLeftSmart:function(n){n.extendSelectionsBy(function(e){var t=n.charCoords(e.head,"div").top+5,r=n.coordsChar({left:0,top:t},"div");return r.ch<n.getLine(r.line).search(/\S/)?rl(n,e.head):r},lo)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],r=e.listSelections(),n=e.options.tabSize,i=0;i<r.length;i++){var o=r[i].from(),l=ao(e.getLine(o.line),o.ch,n);t.push(new Array(n-l%n+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(l){Xt(l,function(){for(var e=l.listSelections(),t=[],r=0;r<e.length;r++){var n=e[r].head,i=bi(l.doc,n.line).text;if(i)if(n.ch==i.length&&(n=new fe(n.line,n.ch-1)),0<n.ch)n=new fe(n.line,n.ch+1),l.replaceRange(i.charAt(n.ch-1)+i.charAt(n.ch-2),fe(n.line,n.ch-2),n,"+transpose");else if(n.line>l.doc.first){var o=bi(l.doc,n.line-1).text;o&&l.replaceRange(i.charAt(0)+l.doc.lineSeparator()+o.charAt(o.length-1),fe(n.line-1,o.length-1),fe(n.line,1),"+transpose")}t.push(new De(n,n))}l.setSelections(t)})},newlineAndIndent:function(n){Xt(n,function(){for(var e=n.listSelections().length,t=0;t<e;t++){var r=n.listSelections()[t];n.replaceRange(n.doc.lineSeparator(),r.anchor,r.head,"+input"),n.indentLine(r.from().line+1,null,!0)}Vr(n)})},toggleOverwrite:function(e){e.toggleOverwrite()}},un=S.keyMap={};function cn(e){for(var t,r,n,i,o=e.split(/-(?!$)/),l=(e=o[o.length-1],0);l<o.length-1;l++){var s=o[l];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))r=!0;else{if(!/^s(hift)$/i.test(s))throw new Error("Unrecognized modifier name: "+s);n=!0}}return t&&(e="Alt-"+e),r&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}un.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},un.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},un.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},un.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},un.default=y?un.macDefault:un.pcDefault,S.normalizeKeyMap=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];if(/^(name|fallthrough|(de|at)tach)$/.test(r))continue;if("..."==n){delete e[r];continue}for(var i=vo(r.split(" "),cn),o=0;o<i.length;o++){var l,s;l=o==i.length-1?(s=i.join(" "),n):(s=i.slice(0,o+1).join(" "),"...");var a=t[s];if(a){if(a!=l)throw new Error("Inconsistent bindings for "+s)}else t[s]=l}delete e[r]}for(var u in t)e[u]=t[u];return e};var hn=S.lookupKey=function(e,t,r,n){var i=(t=pn(t)).call?t.call(e,n):t[e];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&r(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return hn(e,t.fallthrough,r,n);for(var o=0;o<t.fallthrough.length;o++){var l=hn(e,t.fallthrough[o],r,n);if(l)return l}}},fn=S.isModifierKey=function(e){var t="string"==typeof e?e:qo[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},dn=S.keyName=function(e,t){if(m&&34==e.keyCode&&e.char)return!1;var r=qo[e.keyCode],n=r;return null!=n&&!e.altGraphKey&&(e.altKey&&"Alt"!=r&&(n="Alt-"+n),(d?e.metaKey:e.ctrlKey)&&"Ctrl"!=r&&(n="Ctrl-"+n),(d?e.ctrlKey:e.metaKey)&&"Cmd"!=r&&(n="Cmd-"+n),!t&&e.shiftKey&&"Shift"!=r&&(n="Shift-"+n),n)};function pn(e){return"string"==typeof e?un[e]:e}S.fromTextArea=function(t,e){if((e=e?bo(e):{}).value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus){var r=Do();e.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}function n(){t.value=s.getValue()}if(t.form&&(Ki(t.form,"submit",n),!e.leaveSubmitMethodAlone)){var i=t.form,o=i.submit;try{var l=i.submit=function(){n(),i.submit=o,i.submit(),i.submit=l}}catch(e){}}e.finishInit=function(e){e.save=n,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,n(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(Yi(t.form,"submit",n),"function"==typeof t.form.submit&&(t.form.submit=o))}},t.style.display="none";var s=S(function(e){t.parentNode.insertBefore(e,t.nextSibling)},e);return s};var gn=S.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};gn.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var r=t==e;else r=t&&(e.test?e.test(t):e(t));if(r)return++this.pos,t},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);if(-1<t)return this.pos=t,!0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ao(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?ao(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return ao(this.string,null,this.tabSize)-(this.lineStart?ao(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,r){if("string"!=typeof e){var n=this.string.slice(this.pos).match(e);return n&&0<n.index?null:(n&&!1!==t&&(this.pos+=n[0].length),n)}var i=function(e){return r?e.toLowerCase():e};if(i(this.string.substr(this.pos,e.length))==i(e))return!1!==t&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var vn=0,mn=S.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++vn};to(mn),mn.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Bt(e),eo(this,"clear")){var r=this.find();r&&qi(this,"clear",r.from,r.to)}for(var n=null,i=null,o=0;o<this.lines.length;++o){var l=this.lines[o],s=Sn(l.markedSpans,this);e&&!this.collapsed?Jt(e,Si(l),"text"):e&&(null!=s.to&&(i=Si(l)),null!=s.from&&(n=Si(l))),l.markedSpans=Ln(l.markedSpans,s),null==s.from&&this.collapsed&&!Bn(this.doc,l)&&e&&Ci(l,Pt(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(o=0;o<this.lines.length;++o){var a=zn(this.lines[o]),u=H(a);u>e.display.maxLineLength&&(e.display.maxLine=a,e.display.maxLineLength=u,e.display.maxLineChanged=!0)}null!=n&&e&&this.collapsed&&Qt(e,n,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&_e(e.doc)),e&&qi(e,"markerCleared",e,this),t&&Gt(e),this.parent&&this.parent.clear()}},mn.prototype.find=function(e,t){var r,n;null==e&&"bookmark"==this.type&&(e=1);for(var i=0;i<this.lines.length;++i){var o=this.lines[i],l=Sn(o.markedSpans,this);if(null!=l.from&&(r=fe(t?o:Si(o),l.from),-1==e))return r;if(null!=l.to&&(n=fe(t?o:Si(o),l.to),1==e))return n}return r&&{from:r,to:n}},mn.prototype.changed=function(){var o=this.find(-1,!0),l=this,s=this.doc.cm;o&&s&&Xt(s,function(){var e=o.line,t=Si(o.line),r=gt(s,t);if(r&&(xt(r),s.curOp.selectionChanged=s.curOp.forceUpdate=!0),s.curOp.updateMaxLine=!0,!Bn(l.doc,e)&&null!=l.height){var n=l.height;l.height=null;var i=Kn(l)-n;i&&Ci(e,e.height+i)}})},mn.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=go(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},mn.prototype.detachLine=function(e){if(this.lines.splice(go(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};vn=0;function yn(t,n,i,e,r){if(e&&e.shared)return function(e,r,n,i,o){(i=bo(i)).shared=!1;var l=[yn(e,r,n,i,o)],s=l[0],a=i.widgetNode;return mi(e,function(e){a&&(i.widgetNode=a.cloneNode(!0)),l.push(yn(e,Ie(e,r),Ie(e,n),i,o));for(var t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;s=fo(l)}),new bn(l,s)}(t,n,i,e,r);if(t.cm&&!t.cm.curOp)return Yt(t.cm,yn)(t,n,i,e,r);var o=new mn(t,r),l=de(n,i);if(e&&bo(e,o,!1),0<l||0==l&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=No("span",[o.replacedWith],"CodeMirror-widget"),e.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),e.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(In(t,n.line,n,i,o)||n.line!=i.line&&In(t,i.line,n,i,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");C=!0}o.addToHistory&&Ai(t,{from:n,to:i,origin:"markText"},t.sel,NaN);var s,a=n.line,u=t.cm;if(t.iter(a,i.line+1,function(e){var t,r;u&&o.collapsed&&!u.options.lineWrapping&&zn(e)==u.display.maxLine&&(s=!0),o.collapsed&&a!=n.line&&Ci(e,0),t=e,r=new Cn(o,a==n.line?n.ch:null,a==i.line?i.ch:null),t.markedSpans=t.markedSpans?t.markedSpans.concat([r]):[r],r.marker.attachLine(t),++a}),o.collapsed&&t.iter(n.line,i.line+1,function(e){Bn(t,e)&&Ci(e,0)}),o.clearOnEnter&&Ki(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(b=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),o.collapsed&&(o.id=++vn,o.atomic=!0),u){if(s&&(u.curOp.updateMaxLine=!0),o.collapsed)Qt(u,n.line,i.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(var c=n.line;c<=i.line;c++)Jt(u,c,"text");o.atomic&&_e(u.doc),qi(u,"markerAdded",u,o)}return o}var bn=S.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var r=0;r<e.length;++r)e[r].parent=this};function wn(e){return e.findMarks(fe(e.first,0),e.clipPos(fe(e.lastLine())),function(e){return e.parent})}function xn(e){for(var t=0;t<e.length;t++){var r=e[t],n=[r.primary.doc];mi(r.primary.doc,function(e){n.push(e)});for(var i=0;i<r.markers.length;i++){var o=r.markers[i];-1==go(n,o.doc)&&(o.parent=null,r.markers.splice(i--,1))}}}function Cn(e,t,r){this.marker=e,this.from=t,this.to=r}function Sn(e,t){if(e)for(var r=0;r<e.length;++r){var n=e[r];if(n.marker==t)return n}}function Ln(e,t){for(var r,n=0;n<e.length;++n)e[n]!=t&&(r||(r=[])).push(e[n]);return r}function Tn(e,t){if(t.full)return null;var r=ze(e,t.from.line)&&bi(e,t.from.line).markedSpans,n=ze(e,t.to.line)&&bi(e,t.to.line).markedSpans;if(!r&&!n)return null;var i=t.from.ch,o=t.to.ch,l=0==de(t.from,t.to),s=function(e,t,r){if(e)for(var n,i=0;i<e.length;++i){var o=e[i],l=o.marker;if(null==o.from||(l.inclusiveLeft?o.from<=t:o.from<t)||o.from==t&&"bookmark"==l.type&&(!r||!o.marker.insertLeft)){var s=null==o.to||(l.inclusiveRight?o.to>=t:o.to>t);(n||(n=[])).push(new Cn(l,o.from,s?null:o.to))}}return n}(r,i,l),a=function(e,t,r){if(e)for(var n,i=0;i<e.length;++i){var o=e[i],l=o.marker;if(null==o.to||(l.inclusiveRight?o.to>=t:o.to>t)||o.from==t&&"bookmark"==l.type&&(!r||o.marker.insertLeft)){var s=null==o.from||(l.inclusiveLeft?o.from<=t:o.from<t);(n||(n=[])).push(new Cn(l,s?null:o.from-t,null==o.to?null:o.to-t))}}return n}(n,o,l),u=1==t.text.length,c=fo(t.text).length+(u?i:0);if(s)for(var h=0;h<s.length;++h){if(null==(f=s[h]).to)(d=Sn(a,f.marker))?u&&(f.to=null==d.to?null:d.to+c):f.to=i}if(a)for(h=0;h<a.length;++h){var f,d;if(null!=(f=a[h]).to&&(f.to+=c),null==f.from)(d=Sn(s,f.marker))||(f.from=c,u&&(s||(s=[])).push(f));else f.from+=c,u&&(s||(s=[])).push(f)}s&&(s=kn(s)),a&&a!=s&&(a=kn(a));var p=[s];if(!u){var g,v=t.text.length-2;if(0<v&&s)for(h=0;h<s.length;++h)null==s[h].to&&(g||(g=[])).push(new Cn(s[h].marker,null,null));for(h=0;h<v;++h)p.push(g);p.push(a)}return p}function kn(e){for(var t=0;t<e.length;++t){var r=e[t];null!=r.from&&r.from==r.to&&!1!==r.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function Mn(e,t){var r=function(e,t){var r=t["spans_"+e.id];if(!r)return null;for(var n=0,i=[];n<t.text.length;++n)i.push(Hi(r[n]));return i}(e,t),n=Tn(e,t);if(!r)return n;if(!n)return r;for(var i=0;i<r.length;++i){var o=r[i],l=n[i];if(o&&l)e:for(var s=0;s<l.length;++s){for(var a=l[s],u=0;u<o.length;++u)if(o[u].marker==a.marker)continue e;o.push(a)}else l&&(r[i]=l)}return r}function Nn(e){var t=e.markedSpans;if(t){for(var r=0;r<t.length;++r)t[r].marker.detachLine(e);e.markedSpans=null}}function Wn(e,t){if(t){for(var r=0;r<t.length;++r)t[r].marker.attachLine(e);e.markedSpans=t}}function An(e){return e.inclusiveLeft?-1:0}function On(e){return e.inclusiveRight?1:0}function Dn(e,t){var r=e.lines.length-t.lines.length;if(0!=r)return r;var n=e.find(),i=t.find(),o=de(n.from,i.from)||An(e)-An(t);if(o)return-o;var l=de(n.to,i.to)||On(e)-On(t);return l||t.id-e.id}function Hn(e,t){var r,n=C&&e.markedSpans;if(n)for(var i,o=0;o<n.length;++o)(i=n[o]).marker.collapsed&&null==(t?i.from:i.to)&&(!r||Dn(r,i.marker)<0)&&(r=i.marker);return r}function Pn(e){return Hn(e,!0)}function En(e){return Hn(e,!1)}function In(e,t,r,n,i){var o=bi(e,t),l=C&&o.markedSpans;if(l)for(var s=0;s<l.length;++s){var a=l[s];if(a.marker.collapsed){var u=a.marker.find(0),c=de(u.from,r)||An(a.marker)-An(i),h=de(u.to,n)||On(a.marker)-On(i);if(!(0<=c&&h<=0||c<=0&&0<=h)&&(c<=0&&(0<de(u.to,r)||a.marker.inclusiveRight&&i.inclusiveLeft)||0<=c&&(de(u.from,n)<0||a.marker.inclusiveLeft&&i.inclusiveRight)))return!0}}}function zn(e){for(var t;t=Pn(e);)e=t.find(-1,!0).line;return e}function Fn(e,t){var r=bi(e,t),n=zn(r);return r==n?t:Si(n)}function Rn(e,t){if(t>e.lastLine())return t;var r,n=bi(e,t);if(!Bn(e,n))return t;for(;r=En(n);)n=r.find(1,!0).line;return Si(n)+1}function Bn(e,t){var r=C&&t.markedSpans;if(r)for(var n,i=0;i<r.length;++i)if((n=r[i]).marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&Gn(e,t,n))return!0}}function Gn(e,t,r){if(null==r.to){var n=r.marker.find(1,!0);return Gn(e,n.line,Sn(n.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==t.text.length)return!0;for(var i,o=0;o<t.markedSpans.length;++o)if((i=t.markedSpans[o]).marker.collapsed&&!i.marker.widgetNode&&i.from==r.to&&(null==i.to||i.to!=r.from)&&(i.marker.inclusiveLeft||r.marker.inclusiveRight)&&Gn(e,t,i))return!0}to(bn),bn.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();qi(this,"clear")}},bn.prototype.find=function(e,t){return this.primary.find(e,t)};var Un=S.LineWidget=function(e,t,r){if(r)for(var n in r)r.hasOwnProperty(n)&&(this[n]=r[n]);this.doc=e,this.node=t};function Vn(e,t,r){Ti(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Ur(e,null,r)}function Kn(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Oo(document.body,e.node)){var r="position: relative;";e.coverGutter&&(r+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(r+="width: "+t.display.wrapper.clientWidth+"px;"),Ao(t.display.measure,No("div",[e.node],null,r))}return e.height=e.node.parentNode.offsetHeight}to(Un),Un.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,r=this.line,n=Si(r);if(null!=n&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(r.widgets=null);var o=Kn(this);Ci(r,Math.max(0,r.height-o)),e&&Xt(e,function(){Vn(e,r,-o),Jt(e,n,"widget")})}},Un.prototype.changed=function(){var e=this.height,t=this.doc.cm,r=this.line;this.height=null;var n=Kn(this)-e;n&&(Ci(r,r.height+n),t&&Xt(t,function(){t.curOp.forceUpdate=!0,Vn(t,r,n)}))};var jn=S.Line=function(e,t,r){this.text=e,Wn(this,t),this.height=r?r(this):1};function Xn(e,t){if(e)for(;;){var r=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!r)break;e=e.slice(0,r.index)+e.slice(r.index+r[0].length);var n=r[1]?"bgClass":"textClass";null==t[n]?t[n]=r[2]:new RegExp("(?:^|s)"+r[2]+"(?:$|s)").test(t[n])||(t[n]+=" "+r[2])}return e}function Yn(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var r=S.innerMode(e,t);return r.mode.blankLine?r.mode.blankLine(r.state):void 0}}function _n(e,t,r,n){for(var i=0;i<10;i++){n&&(n[0]=S.innerMode(e,r).mode);var o=e.token(t,r);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}function $n(e,t,r,n){function i(e){return{start:h.start,end:h.pos,string:h.current(),type:o||null,state:e?ln(l.mode,c):c}}var o,l=e.doc,s=l.mode;t=Ie(l,t);var a,u=bi(l,t.line),c=lt(e,t.line,r),h=new gn(u.text,e.options.tabSize);for(n&&(a=[]);(n||h.pos<t.ch)&&!h.eol();)h.start=h.pos,o=_n(s,h,c),n&&a.push(i(!0));return n?a:i()}function qn(e,t,r,n,i,o,l){var s=r.flattenSpans;null==s&&(s=e.options.flattenSpans);var a,u=0,c=null,h=new gn(t,e.options.tabSize),f=e.options.addModeClass&&[null];for(""==t&&Xn(Yn(r,n),o);!h.eol();){if(a=h.pos>e.options.maxHighlightLength?(s=!1,l&&Jn(e,t,n,h.pos),h.pos=t.length,null):Xn(_n(r,h,n,f),o),f){var d=f[0].name;d&&(a="m-"+(a?d+" "+a:d))}if(!s||c!=a){for(;u<h.start;)i(u=Math.min(h.start,u+5e4),c);c=a}h.start=h.pos}for(;u<h.pos;){var p=Math.min(h.pos,u+5e4);i(p,c),u=p}}function Zn(e,t,r,n){var o=[e.state.modeGen],i={};qn(e,t.text,e.doc.mode,r,function(e,t){o.push(e,t)},i,n);for(var l=0;l<e.state.overlays.length;++l){var s=e.state.overlays[l],a=1,u=0;qn(e,t.text,s.mode,!0,function(e,t){for(var r=a;u<e;){var n=o[a];e<n&&o.splice(a,1,e,o[a+1],n),a+=2,u=Math.min(e,n)}if(t)if(s.opaque)o.splice(r,a-r,e,"cm-overlay "+t),a=r+2;else for(;r<a;r+=2){var i=o[r+1];o[r+1]=(i?i+" ":"")+"cm-overlay "+t}},i)}return{styles:o,classes:i.bgClass||i.textClass?i:null}}function Qn(e,t,r){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=lt(e,Si(t)),i=Zn(e,t,t.text.length>e.options.maxHighlightLength?ln(e.doc.mode,n):n);t.stateAfter=n,t.styles=i.styles,i.classes?t.styleClasses=i.classes:t.styleClasses&&(t.styleClasses=null),r===e.doc.frontier&&e.doc.frontier++}return t.styles}function Jn(e,t,r,n){var i=e.doc.mode,o=new gn(t,e.options.tabSize);for(o.start=o.pos=n||0,""==t&&Yn(i,r);!o.eol();)_n(i,o,r),o.start=o.pos}to(jn),jn.prototype.lineNo=function(){return Si(this)};var ei={},ti={};function ri(e,t){if(!e||/^\s*$/.test(e))return null;var r=t.addModeClass?ti:ei;return r[e]||(r[e]=e.replace(/\S+/g,"cm-$&"))}function ni(e,t){var r=No("span",null,null,v?"padding-right: .1px":null),n={pre:No("pre",[r],"CodeMirror-line"),content:r,col:0,pos:0,cm:e,splitSpaces:(w||v)&&e.getOption("lineWrapping")};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var o,l=i?t.rest[i-1]:t.line;n.pos=0,n.addToken=ii,Vo(e.display.measure)&&(o=ki(l))&&(n.addToken=li(n.addToken,o)),n.map=[],ai(l,n,Qn(e,l,t!=e.display.externalMeasured&&Si(l))),l.styleClasses&&(l.styleClasses.bgClass&&(n.bgClass=Io(l.styleClasses.bgClass,n.bgClass||"")),l.styleClasses.textClass&&(n.textClass=Io(l.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(Uo(e.display.measure))),0==i?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return v&&/\bcm-tab\b/.test(n.content.lastChild.className)&&(n.content.className="cm-tab-wrap-hack"),_i(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=Io(n.pre.className,n.textClass||"")),n}function ii(e,t,r,n,i,o,l){if(t){var s=e.splitSpaces?t.replace(/ {3,}/g,oi):t,a=e.cm.state.specialChars,u=!1;if(a.test(t)){v=document.createDocumentFragment();for(var c=0;;){a.lastIndex=c;var h=a.exec(t),f=h?h.index-c:t.length-c;if(f){var d=document.createTextNode(s.slice(c,c+f));w&&x<9?v.appendChild(No("span",[d])):v.appendChild(d),e.map.push(e.pos,e.pos+f,d),e.col+=f,e.pos+=f}if(!h)break;if(c+=f+1,"\t"==h[0]){var p=e.cm.options.tabSize,g=p-e.col%p;(d=v.appendChild(No("span",ho(g),"cm-tab"))).setAttribute("role","presentation"),d.setAttribute("cm-text","\t"),e.col+=g}else if("\r"==h[0]||"\n"==h[0]){(d=v.appendChild(No("span","\r"==h[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",h[0]),e.col+=1}else{(d=e.cm.options.specialCharPlaceholder(h[0])).setAttribute("cm-text",h[0]),w&&x<9?v.appendChild(No("span",[d])):v.appendChild(d),e.col+=1}e.map.push(e.pos,e.pos+1,d),e.pos++}}else{e.col+=t.length;var v=document.createTextNode(s);e.map.push(e.pos,e.pos+t.length,v),w&&x<9&&(u=!0),e.pos+=t.length}if(r||n||i||u||l){var m=r||"";n&&(m+=n),i&&(m+=i);var y=No("span",[v],m,l);return o&&(y.title=o),e.content.appendChild(y)}e.content.appendChild(v)}}function oi(e){for(var t=" ",r=0;r<e.length-2;++r)t+=r%2?" ":" ";return t+=" "}function li(h,f){return function(e,t,r,n,i,o,l){r=r?r+" cm-force-border":"cm-force-border";for(var s=e.pos,a=s+t.length;;){for(var u=0;u<f.length;u++){var c=f[u];if(c.to>s&&c.from<=s)break}if(c.to>=a)return h(e,t,r,n,i,o,l);h(e,t.slice(0,c.to-s),r,n,null,o,l),n=null,t=t.slice(c.to-s),s=c.to}}}function si(e,t,r,n){var i=!n&&r.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!n&&e.cm.display.input.needsContentAttribute&&(i||(i=e.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",r.id)),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t}function ai(e,t,r){var n=e.markedSpans,i=e.text,o=0;if(n)for(var l,s,a,u,c,h,f,d=i.length,p=0,g=(T=1,""),v=0;;){if(v==p){a=u=c=h=s="",f=null,v=1/0;for(var m,y=[],b=0;b<n.length;++b){var w=n[b],x=w.marker;"bookmark"==x.type&&w.from==p&&x.widgetNode?y.push(x):w.from<=p&&(null==w.to||w.to>p||x.collapsed&&w.to==p&&w.from==p)?(null!=w.to&&w.to!=p&&v>w.to&&(v=w.to,u=""),x.className&&(a+=" "+x.className),x.css&&(s=(s?s+";":"")+x.css),x.startStyle&&w.from==p&&(c+=" "+x.startStyle),x.endStyle&&w.to==v&&(m||(m=[])).push(x.endStyle,w.to),x.title&&!h&&(h=x.title),x.collapsed&&(!f||Dn(f.marker,x)<0)&&(f=w)):w.from>p&&v>w.from&&(v=w.from)}if(m)for(b=0;b<m.length;b+=2)m[b+1]==v&&(u+=" "+m[b]);if(!f||f.from==p)for(b=0;b<y.length;++b)si(t,0,y[b]);if(f&&(f.from||0)==p){if(si(t,(null==f.to?d+1:f.to)-p,f.marker,null==f.from),null==f.to)return;f.to==p&&(f=!1)}}if(d<=p)break;for(var C=Math.min(d,v);;){if(g){var S=p+g.length;if(!f){var L=C<S?g.slice(0,C-p):g;t.addToken(t,L,l?l+a:a,c,p+L.length==v?u:"",h,s)}if(C<=S){g=g.slice(C-p),p=C;break}p=S,c=""}g=i.slice(o,o=r[T++]),l=ri(r[T++],t.cm.options)}}else for(var T=1;T<r.length;T+=2)t.addToken(t,i.slice(o,o=r[T]),ri(r[T+1],t.cm.options))}function ui(e,t){return 0==t.from.ch&&0==t.to.ch&&""==fo(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function ci(e,n,t,i){function o(e){return t?t[e]:null}function r(e,t,r){!function(e,t,r,n){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Nn(e),Wn(e,r);var i=n?n(e):1;i!=e.height&&Ci(e,i)}(e,t,r,i),qi(e,"change",e,n)}function l(e,t){for(var r=e,n=[];r<t;++r)n.push(new jn(u[r],o(r),i));return n}var s=n.from,a=n.to,u=n.text,c=bi(e,s.line),h=bi(e,a.line),f=fo(u),d=o(u.length-1),p=a.line-s.line;if(n.full)e.insert(0,l(0,u.length)),e.remove(u.length,e.size-u.length);else if(ui(e,n)){var g=l(0,u.length-1);r(h,h.text,d),p&&e.remove(s.line,p),g.length&&e.insert(s.line,g)}else if(c==h){if(1==u.length)r(c,c.text.slice(0,s.ch)+f+c.text.slice(a.ch),d);else(g=l(1,u.length-1)).push(new jn(f+c.text.slice(a.ch),d,i)),r(c,c.text.slice(0,s.ch)+u[0],o(0)),e.insert(s.line+1,g)}else if(1==u.length)r(c,c.text.slice(0,s.ch)+u[0]+h.text.slice(a.ch),o(0)),e.remove(s.line+1,p);else{r(c,c.text.slice(0,s.ch)+u[0],o(0)),r(h,f+h.text.slice(a.ch),d);g=l(1,u.length-1);1<p&&e.remove(s.line+1,p-1),e.insert(s.line+1,g)}qi(e,"change",e,n)}function hi(e){this.lines=e,this.parent=null;for(var t=0,r=0;t<e.length;++t)e[t].parent=this,r+=e[t].height;this.height=r}function fi(e){this.children=e;for(var t=0,r=0,n=0;n<e.length;++n){var i=e[n];t+=i.chunkSize(),r+=i.height,i.parent=this}this.size=t,this.height=r,this.parent=null}hi.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var r=e,n=e+t;r<n;++r){var i=this.lines[r];this.height-=i.height,(o=i).parent=null,Nn(o),qi(i,"delete")}var o;this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,r){this.height+=r,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,r){for(var n=e+t;e<n;++e)if(r(this.lines[e]))return!0}},fi.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var r=0;r<this.children.length;++r){var n=this.children[r],i=n.chunkSize();if(e<i){var o=Math.min(t,i-e),l=n.height;if(n.removeInner(e,o),this.height-=l-n.height,i==o&&(this.children.splice(r--,1),n.parent=null),0==(t-=o))break;e=0}else e-=i}if(this.size-t<25&&(1<this.children.length||!(this.children[0]instanceof hi))){var s=[];this.collapse(s),this.children=[new hi(s)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,r){this.size+=t.length,this.height+=r;for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<=o){if(i.insertInner(e,t,r),i.lines&&50<i.lines.length){for(;50<i.lines.length;){var l=new hi(i.lines.splice(i.lines.length-25,25));i.height-=l.height,this.children.splice(n+1,0,l),l.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=new fi(e.children.splice(e.children.length-5,5));if(e.parent){e.size-=t.size,e.height-=t.height;var r=go(e.parent.children,e);e.parent.children.splice(r+1,0,t)}else{var n=new fi(e.children);(n.parent=e).children=[n,t],e=n}t.parent=e.parent}while(10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,r){for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<o){var l=Math.min(t,o-e);if(i.iterN(e,l,r))return!0;if(0==(t-=l))break;e=0}else e-=o}}};var di=0,pi=S.Doc=function(e,t,r,n){if(!(this instanceof pi))return new pi(e,t,r,n);null==r&&(r=0),fi.call(this,[new hi([new jn("",null)])]),this.first=r,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=r;var i=fe(r,0);this.sel=Pe(i),this.history=new Mi(null),this.id=++di,this.modeOption=t,this.lineSep=n,this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),ci(this,{from:i,to:i,text:e}),je(this,Pe(i),io)};pi.prototype=yo(fi.prototype,{constructor:pi,iter:function(e,t,r){r?this.iterN(e-this.first,t-e,r):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var r=0,n=0;n<t.length;++n)r+=t[n].height;this.insertInner(e-this.first,t,r)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=xi(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:$t(function(e){var t=fe(this.first,0),r=this.first+this.size-1;Er(this,{from:t,to:fe(r,bi(this,r).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),je(this,Pe(t))}),replaceRange:function(e,t,r,n){Br(this,e,t=Ie(this,t),r=r?Ie(this,r):t,n)},getRange:function(e,t,r){var n=wi(this,Ie(this,e),Ie(this,t));return!1===r?n:n.join(r||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(ze(this,e))return bi(this,e)},getLineNumber:function(e){return Si(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=bi(this,e)),zn(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return Ie(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:$t(function(e,t,r){Ve(this,Ie(this,"number"==typeof e?fe(e,t||0):e),null,r)}),setSelection:$t(function(e,t,r){Ve(this,Ie(this,e),Ie(this,t||e),r)}),extendSelection:$t(function(e,t,r){Be(this,Ie(this,e),t&&Ie(this,t),r)}),extendSelections:$t(function(e,t){Ge(this,Fe(this,e),t)}),extendSelectionsBy:$t(function(e,t){Ge(this,Fe(this,vo(this.sel.ranges,e)),t)}),setSelections:$t(function(e,t,r){if(e.length){for(var n=0,i=[];n<e.length;n++)i[n]=new De(Ie(this,e[n].anchor),Ie(this,e[n].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),je(this,He(i,t),r)}}),addSelection:$t(function(e,t,r){var n=this.sel.ranges.slice(0);n.push(new De(Ie(this,e),Ie(this,t||e))),je(this,He(n,n.length-1),r)}),getSelection:function(e){for(var t,r=this.sel.ranges,n=0;n<r.length;n++){var i=wi(this,r[n].from(),r[n].to());t=t?t.concat(i):i}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],r=this.sel.ranges,n=0;n<r.length;n++){var i=wi(this,r[n].from(),r[n].to());!1!==e&&(i=i.join(e||this.lineSeparator())),t[n]=i}return t},replaceSelection:function(e,t,r){for(var n=[],i=0;i<this.sel.ranges.length;i++)n[i]=e;this.replaceSelections(n,t,r||"+input")},replaceSelections:$t(function(e,t,r){for(var n=[],i=this.sel,o=0;o<i.ranges.length;o++){var l=i.ranges[o];n[o]={from:l.from(),to:l.to(),text:this.splitLines(e[o]),origin:r}}var s=t&&"end"!=t&&function(e,t,r){for(var n=[],i=fe(e.first,0),o=i,l=0;l<t.length;l++){var s=t[l],a=Hr(s.from,i,o),u=Hr(Ar(s),i,o);if(i=s.to,o=u,"around"==r){var c=e.sel.ranges[l],h=de(c.head,c.anchor)<0;n[l]=new De(h?u:a,h?a:u)}else n[l]=new De(a,a)}return new Oe(n,e.sel.primIndex)}(this,n,t);for(o=n.length-1;0<=o;o--)Er(this,n[o]);s?Ke(this,s):this.cm&&Vr(this.cm)}),undo:$t(function(){zr(this,"undo")}),redo:$t(function(){zr(this,"redo")}),undoSelection:$t(function(){zr(this,"undo",!0)}),redoSelection:$t(function(){zr(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,r=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(n=0;n<e.undone.length;n++)e.undone[n].ranges||++r;return{undo:t,redo:r}},clearHistory:function(){this.history=new Mi(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Pi(this.history.done),undone:Pi(this.history.undone)}},setHistory:function(e){var t=this.history=new Mi(this.history.maxGeneration);t.done=Pi(e.done.slice(0),null,!0),t.undone=Pi(e.undone.slice(0),null,!0)},addLineClass:$t(function(e,r,n){return Xr(this,e,"gutter"==r?"gutter":"class",function(e){var t="text"==r?"textClass":"background"==r?"bgClass":"gutter"==r?"gutterClass":"wrapClass";if(e[t]){if(Ho(n).test(e[t]))return!1;e[t]+=" "+n}else e[t]=n;return!0})}),removeLineClass:$t(function(e,o,l){return Xr(this,e,"gutter"==o?"gutter":"class",function(e){var t="text"==o?"textClass":"background"==o?"bgClass":"gutter"==o?"gutterClass":"wrapClass",r=e[t];if(!r)return!1;if(null==l)e[t]=null;else{var n=r.match(Ho(l));if(!n)return!1;var i=n.index+n[0].length;e[t]=r.slice(0,n.index)+(n.index&&i!=r.length?" ":"")+r.slice(i)||null}return!0})}),addLineWidget:$t(function(e,t,r){return i=e,o=new Un(n=this,t,r),(l=n.cm)&&o.noHScroll&&(l.display.alignWidgets=!0),Xr(n,i,"widget",function(e){var t=e.widgets||(e.widgets=[]);if(null==o.insertAt?t.push(o):t.splice(Math.min(t.length-1,Math.max(0,o.insertAt)),0,o),o.line=e,l&&!Bn(n,e)){var r=Ti(e)<n.scrollTop;Ci(e,e.height+Kn(o)),r&&Ur(l,null,o.height),l.curOp.forceUpdate=!0}return!0}),o;var n,i,o,l}),removeLineWidget:function(e){e.clear()},markText:function(e,t,r){return yn(this,Ie(this,e),Ie(this,t),r,r&&r.type||"range")},setBookmark:function(e,t){var r={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return yn(this,e=Ie(this,e),e,r,"bookmark")},findMarksAt:function(e){var t=[],r=bi(this,(e=Ie(this,e)).line).markedSpans;if(r)for(var n=0;n<r.length;++n){var i=r[n];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(i,o,l){i=Ie(this,i),o=Ie(this,o);var s=[],a=i.line;return this.iter(i.line,o.line+1,function(e){var t=e.markedSpans;if(t)for(var r=0;r<t.length;r++){var n=t[r];a==i.line&&i.ch>n.to||null==n.from&&a!=i.line||a==o.line&&n.from>o.ch||l&&!l(n.marker)||s.push(n.marker.parent||n.marker)}++a}),s},getAllMarks:function(){var n=[];return this.iter(function(e){var t=e.markedSpans;if(t)for(var r=0;r<t.length;++r)null!=t[r].from&&n.push(t[r].marker)}),n},posFromIndex:function(r){var n,i=this.first;return this.iter(function(e){var t=e.text.length+1;if(r<t)return n=r,!0;r-=t,++i}),Ie(this,fe(i,n))},indexFromPos:function(e){var t=(e=Ie(this,e)).ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new pi(xi(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,r=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<r&&(r=e.to);var n=new pi(xi(this,t,r),e.mode||this.modeOption,t,this.lineSep);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=n.find(),o=e.clipPos(i.from),l=e.clipPos(i.to);if(de(o,l)){var s=yn(e,o,l,n.primary,n.primary.type);n.markers.push(s),s.parent=n}}}(n,wn(this)),n},unlinkDoc:function(e){if(e instanceof S&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){if(this.linked[t].doc==e){this.linked.splice(t,1),e.unlinkDoc(this),xn(wn(this));break}}if(e.history==this.history){var r=[e.id];mi(e,function(e){r.push(e.id)},!0),e.history=new Mi(null),e.history.done=Pi(this.history.done,r),e.history.undone=Pi(this.history.undone,r)}},iterLinkedDocs:function(e){mi(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):jo(e)},lineSeparator:function(){return this.lineSep||"\n"}}),pi.prototype.eachLine=pi.prototype.iter;var gi="iter insert remove copy getEditor constructor".split(" ");for(var vi in pi.prototype)pi.prototype.hasOwnProperty(vi)&&go(gi,vi)<0&&(S.prototype[vi]=function(e){return function(){return e.apply(this.doc,arguments)}}(pi.prototype[vi]));function mi(e,s,a){!function e(t,r,n){if(t.linked)for(var i=0;i<t.linked.length;++i){var o=t.linked[i];if(o.doc!=r){var l=n&&o.sharedHist;a&&!l||(s(o.doc,l),e(o.doc,t,l))}}}(e,null,!0)}function yi(e,t){if(t.cm)throw new Error("This document is already in use.");N((e.doc=t).cm=e),T(e),e.options.lineWrapping||P(e),e.options.mode=t.modeOption,Qt(e)}function bi(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var r=e;!r.lines;)for(var n=0;;++n){var i=r.children[n],o=i.chunkSize();if(t<o){r=i;break}t-=o}return r.lines[t]}function wi(e,r,n){var i=[],o=r.line;return e.iter(r.line,n.line+1,function(e){var t=e.text;o==n.line&&(t=t.slice(0,n.ch)),o==r.line&&(t=t.slice(r.ch)),i.push(t),++o}),i}function xi(e,t,r){var n=[];return e.iter(t,r,function(e){n.push(e.text)}),n}function Ci(e,t){var r=t-e.height;if(r)for(var n=e;n;n=n.parent)n.height+=r}function Si(e){if(null==e.parent)return null;for(var t=e.parent,r=go(t.lines,e),n=t.parent;n;n=(t=n).parent)for(var i=0;n.children[i]!=t;++i)r+=n.children[i].chunkSize();return r+t.first}function Li(e,t){var r=e.first;e:do{for(var n=0;n<e.children.length;++n){var i=e.children[n],o=i.height;if(t<o){e=i;continue e}t-=o,r+=i.chunkSize()}return r}while(!e.lines);for(n=0;n<e.lines.length;++n){var l=e.lines[n].height;if(t<l)break;t-=l}return r+n}function Ti(e){for(var t=0,r=(e=zn(e)).parent,n=0;n<r.lines.length;++n){var i=r.lines[n];if(i==e)break;t+=i.height}for(var o=r.parent;o;o=(r=o).parent)for(n=0;n<o.children.length;++n){var l=o.children[n];if(l==r)break;t+=l.height}return t}function ki(e){var t=e.order;return null==t&&(t=e.order=sl(e.text)),t}function Mi(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function Ni(e,t){var r={from:pe(t.from),to:Ar(t),text:wi(e,t.from,t.to)};return Di(e,r,t.from.line,t.to.line+1),mi(e,function(e){Di(e,r,t.from.line,t.to.line+1)},!0),r}function Wi(e){for(;e.length;){if(!fo(e).ranges)break;e.pop()}}function Ai(e,t,r,n){var i=e.history;i.undone.length=0;var o,l,s=+new Date;if((i.lastOp==n||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&i.lastModTime>s-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=(l=i).lastOp==n?(Wi(l.done),fo(l.done)):l.done.length&&!fo(l.done).ranges?fo(l.done):1<l.done.length&&!l.done[l.done.length-2].ranges?(l.done.pop(),fo(l.done)):void 0)){var a=fo(o.changes);0==de(t.from,t.to)&&0==de(t.from,a.to)?a.to=Ar(t):o.changes.push(Ni(e,t))}else{var u=fo(i.done);for(u&&u.ranges||Oi(e.sel,i.done),o={changes:[Ni(e,t)],generation:i.generation},i.done.push(o);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(r),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=s,i.lastOp=i.lastSelOp=n,i.lastOrigin=i.lastSelOrigin=t.origin,a||_i(e,"historyAdded")}function Oi(e,t){var r=fo(t);r&&r.ranges&&r.equals(e)||t.push(e)}function Di(t,r,e,n){var i=r["spans_"+t.id],o=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,n),function(e){e.markedSpans&&((i||(i=r["spans_"+t.id]={}))[o]=e.markedSpans),++o})}function Hi(e){if(!e)return null;for(var t,r=0;r<e.length;++r)e[r].marker.explicitlyCleared?t||(t=e.slice(0,r)):t&&t.push(e[r]);return t?t.length?t:null:e}function Pi(e,t,r){for(var n=0,i=[];n<e.length;++n){var o=e[n];if(o.ranges)i.push(r?Oe.prototype.deepCopy.call(o):o);else{var l=o.changes,s=[];i.push({changes:s});for(var a=0;a<l.length;++a){var u,c=l[a];if(s.push({from:c.from,to:c.to,text:c.text}),t)for(var h in c)(u=h.match(/^spans_(\d+)$/))&&-1<go(t,Number(u[1]))&&(fo(s)[h]=c[h],delete c[h])}}}return i}function Ei(e,t,r,n){r<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function Ii(e,t,r,n){for(var i=0;i<e.length;++i){var o=e[i],l=!0;if(o.ranges){o.copied||((o=e[i]=o.deepCopy()).copied=!0);for(var s=0;s<o.ranges.length;s++)Ei(o.ranges[s].anchor,t,r,n),Ei(o.ranges[s].head,t,r,n)}else{for(s=0;s<o.changes.length;++s){var a=o.changes[s];if(r<a.from.line)a.from=fe(a.from.line+n,a.from.ch),a.to=fe(a.to.line+n,a.to.ch);else if(t<=a.to.line){l=!1;break}}l||(e.splice(0,i+1),i=0)}}}function zi(e,t){var r=t.from.line,n=t.to.line,i=t.text.length-(n-r)-1;Ii(e.done,r,n,i),Ii(e.undone,r,n,i)}to(pi);var Fi=S.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},Ri=S.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0};function Bi(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}var Gi=S.e_stop=function(e){Fi(e),Ri(e)};function Ui(e){return e.target||e.srcElement}function Vi(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),y&&e.ctrlKey&&1==t&&(t=3),t}var Ki=S.on=function(e,t,r){if(e.addEventListener)e.addEventListener(t,r,!1);else if(e.attachEvent)e.attachEvent("on"+t,r);else{var n=e._handlers||(e._handlers={});(n[t]||(n[t]=[])).push(r)}},ji=[];function Xi(e,t,r){var n=e._handlers&&e._handlers[t];return r?n&&0<n.length?n.slice():ji:n||ji}var Yi=S.off=function(e,t,r){if(e.removeEventListener)e.removeEventListener(t,r,!1);else if(e.detachEvent)e.detachEvent("on"+t,r);else for(var n=Xi(e,t,!1),i=0;i<n.length;++i)if(n[i]==r){n.splice(i,1);break}},_i=S.signal=function(e,t){var r=Xi(e,t,!0);if(r.length)for(var n=Array.prototype.slice.call(arguments,2),i=0;i<r.length;++i)r[i].apply(null,n)},$i=null;function qi(e,t){var r=Xi(e,t,!1);if(r.length){var n,i=Array.prototype.slice.call(arguments,2);Ft?n=Ft.delayedCallbacks:$i?n=$i:(n=$i=[],setTimeout(Zi,0));for(var o=0;o<r.length;++o)n.push(l(r[o]))}function l(e){return function(){e.apply(null,i)}}}function Zi(){var e=$i;$i=null;for(var t=0;t<e.length;++t)e[t]()}function Qi(e,t,r){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),_i(e,r||t.type,e,t),Bi(t)||t.codemirrorIgnore}function Ji(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var r=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)-1==go(r,t[n])&&r.push(t[n])}function eo(e,t){return 0<Xi(e,t).length}function to(e){e.prototype.on=function(e,t){Ki(this,e,t)},e.prototype.off=function(e,t){Yi(this,e,t)}}var ro=30,no=S.Pass={toString:function(){return"CodeMirror.Pass"}},io={scroll:!1},oo={origin:"*mouse"},lo={origin:"+move"};function so(){this.id=null}so.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var ao=S.countColumn=function(e,t,r,n,i){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=n||0,l=i||0;;){var s=e.indexOf("\t",o);if(s<0||t<=s)return l+(t-o);l+=s-o,l+=r-l%r,o=s+1}},uo=S.findColumn=function(e,t,r){for(var n=0,i=0;;){var o=e.indexOf("\t",n);-1==o&&(o=e.length);var l=o-n;if(o==e.length||t<=i+l)return n+Math.min(l,t-i);if(i+=o-n,n=o+1,t<=(i+=r-i%r))return n}},co=[""];function ho(e){for(;co.length<=e;)co.push(fo(co)+" ");return co[e]}function fo(e){return e[e.length-1]}var po=function(e){e.select()};function go(e,t){for(var r=0;r<e.length;++r)if(e[r]==t)return r;return-1}function vo(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=t(e[n],n);return r}function mo(){}function yo(e,t){var r;return r=Object.create?Object.create(e):(mo.prototype=e,new mo),t&&bo(t,r),r}function bo(e,t,r){for(var n in t||(t={}),e)!e.hasOwnProperty(n)||!1===r&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}function wo(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}s?po=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:w&&(po=function(e){try{e.select()}catch(e){}});var xo=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Co=S.isWordChar=function(e){return/\w/.test(e)||""<e&&(e.toUpperCase()!=e.toLowerCase()||xo.test(e))};function So(e,t){return t?!!(-1<t.source.indexOf("\\w")&&Co(e))||t.test(e):Co(e)}function Lo(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var To,ko=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Mo(e){return 768<=e.charCodeAt(0)&&ko.test(e)}function No(e,t,r,n){var i=document.createElement(e);if(r&&(i.className=r),n&&(i.style.cssText=n),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function Wo(e){for(var t=e.childNodes.length;0<t;--t)e.removeChild(e.firstChild);return e}function Ao(e,t){return Wo(e).appendChild(t)}To=document.createRange?function(e,t,r,n){var i=document.createRange();return i.setEnd(n||e,r),i.setStart(e,t),i}:function(e,t,r){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(e){return n}return n.collapse(!0),n.moveEnd("character",r),n.moveStart("character",t),n};var Oo=S.contains=function(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)};function Do(){for(var e=document.activeElement;e&&e.root&&e.root.activeElement;)e=e.root.activeElement;return e}function Ho(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}w&&x<11&&(Do=function(){try{return document.activeElement}catch(e){return document.body}});var Po=S.rmClass=function(e,t){var r=e.className,n=Ho(t).exec(r);if(n){var i=r.slice(n.index+n[0].length);e.className=r.slice(0,n.index)+(i?n[1]+i:"")}},Eo=S.addClass=function(e,t){var r=e.className;Ho(t).test(r)||(e.className+=(r?" ":"")+t)};function Io(e,t){for(var r=e.split(" "),n=0;n<r.length;n++)r[n]&&!Ho(r[n]).test(t)&&(t+=" "+r[n]);return t}function zo(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),r=0;r<t.length;r++){var n=t[r].CodeMirror;n&&e(n)}}var Fo=!1;var Ro,Bo,Go=function(){if(w&&x<9)return!1;var e=No("div");return"draggable"in e||"dragDrop"in e}();function Uo(e){if(null==Ro){var t=No("span","​");Ao(e,No("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Ro=t.offsetWidth<=1&&2<t.offsetHeight&&!(w&&x<8))}var r=Ro?No("span","​"):No("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return r.setAttribute("cm-text",""),r}function Vo(e){if(null!=Bo)return Bo;var t=Ao(e,document.createTextNode("AخA")),r=To(t,0,1).getBoundingClientRect();if(!r||r.left==r.right)return!1;var n=To(t,1,2).getBoundingClientRect();return Bo=n.right-r.right<3}var Ko,jo=S.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,r=[],n=e.length;t<=n;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var o=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),l=o.indexOf("\r");-1!=l?(r.push(o.slice(0,l)),t+=l+1):(r.push(o),t=i+1)}return r}:function(e){return e.split(/\r\n?|\n/)},Xo=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Yo="oncopy"in(Ko=No("div"))||(Ko.setAttribute("oncopy","return;"),"function"==typeof Ko.oncopy),_o=null;var $o,qo=S.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};function Zo(e){return e.level%2?e.to:e.from}function Qo(e){return e.level%2?e.from:e.to}function Jo(e){var t=ki(e);return t?Zo(t[0]):0}function el(e){var t=ki(e);return t?Qo(fo(t)):e.text.length}function tl(e,t){var r=bi(e.doc,t),n=zn(r);n!=r&&(t=Si(n));var i=ki(n),o=i?i[0].level%2?el(n):Jo(n):0;return fe(t,o)}function rl(e,t){var r=tl(e,t.line),n=bi(e.doc,r.line),i=ki(n);if(i&&0!=i[0].level)return r;var o=Math.max(0,n.text.search(/\S/)),l=t.line==r.line&&t.ch<=o&&t.ch;return fe(r.line,l?0:o)}function nl(e,t){$o=null;for(var r,n=0;n<e.length;++n){var i=e[n];if(i.from<t&&i.to>t)return n;if(i.from==t||i.to==t){if(null!=r)return o=e,l=i.level,s=e[r].level,void 0,a=o[0].level,l==a||s!=a&&l<s?(i.from!=i.to&&($o=r),n):(i.from!=i.to&&($o=n),r);r=n}}var o,l,s,a;return r}function il(e,t,r,n){if(!n)return t+r;for(;0<(t+=r)&&Mo(e.text.charAt(t)););return t}function ol(e,t,r,n){var i=ki(e);if(!i)return ll(e,t,r,n);for(var o=nl(i,t),l=i[o],s=il(e,t,l.level%2?-r:r,n);;){if(s>l.from&&s<l.to)return s;if(s==l.from||s==l.to)return nl(i,s)==o?s:0<r==(l=i[o+=r]).level%2?l.to:l.from;if(!(l=i[o+=r]))return null;s=0<r==l.level%2?il(e,l.to,-1,n):il(e,l.from,1,n)}}function ll(e,t,r,n){var i=t+r;if(n)for(;0<i&&Mo(e.text.charAt(i));)i+=r;return i<0||i>e.text.length?null:i}!function(){for(var e=0;e<10;e++)qo[e+48]=qo[e+96]=String(e);for(e=65;e<=90;e++)qo[e]=String.fromCharCode(e);for(e=1;e<=12;e++)qo[e+111]=qo[e+63235]="F"+e}();var sl=function(){var b="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",w="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";var x=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,C=/[stwN]/,S=/[LRr]/,L=/[Lb1n]/,T=/[1n]/;function k(e,t,r){this.level=e,this.from=t,this.to=r}return function(e){if(!x.test(e))return!1;for(var t,r=e.length,n=[],i=0;i<r;++i)n.push(c=(t=e.charCodeAt(i))<=247?b.charAt(t):1424<=t&&t<=1524?"R":1536<=t&&t<=1773?w.charAt(t-1536):1774<=t&&t<=2220?"r":8192<=t&&t<=8203?"w":8204==t?"b":"L");i=0;for(var o="L";i<r;++i){"m"==(c=n[i])?n[i]=o:o=c}i=0;for(var l="L";i<r;++i){"1"==(c=n[i])&&"r"==l?n[i]="n":S.test(c)&&"r"==(l=c)&&(n[i]="R")}for(i=1,o=n[0];i<r-1;++i){"+"==(c=n[i])&&"1"==o&&"1"==n[i+1]?n[i]="1":","!=c||o!=n[i+1]||"1"!=o&&"n"!=o||(n[i]=o),o=c}for(i=0;i<r;++i){if(","==(c=n[i]))n[i]="N";else if("%"==c){for(var s=i+1;s<r&&"%"==n[s];++s);for(var a=i&&"!"==n[i-1]||s<r&&"1"==n[s]?"1":"N",u=i;u<s;++u)n[u]=a;i=s-1}}for(i=0,l="L";i<r;++i){var c=n[i];"L"==l&&"1"==c?n[i]="L":S.test(c)&&(l=c)}for(i=0;i<r;++i)if(C.test(n[i])){for(s=i+1;s<r&&C.test(n[s]);++s);var h="L"==(i?n[i-1]:"L"),f="L"==(s<r?n[s]:"L");for(a=h||f?"L":"R",u=i;u<s;++u)n[u]=a;i=s-1}var d,p=[];for(i=0;i<r;)if(L.test(n[i])){var g=i;for(++i;i<r&&L.test(n[i]);++i);p.push(new k(0,g,i))}else{var v=i,m=p.length;for(++i;i<r&&"L"!=n[i];++i);for(u=v;u<i;)if(T.test(n[u])){v<u&&p.splice(m,0,new k(1,v,u));var y=u;for(++u;u<i&&T.test(n[u]);++u);p.splice(m,0,new k(2,y,u)),v=u}else++u;v<i&&p.splice(m,0,new k(1,v,i))}return 1==p[0].level&&(d=e.match(/^\s+/))&&(p[0].from=d[0].length,p.unshift(new k(0,0,d[0].length))),1==fo(p).level&&(d=e.match(/\s+$/))&&(fo(p).to-=d[0].length,p.push(new k(0,r-d[0].length,r))),2==p[0].level&&p.unshift(new k(1,p[0].to,p[0].to)),p[0].level!=fo(p).level&&p.push(new k(p[0].level,r,r)),p}}();return S.version="5.10.1",S});
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(ze){"use strict";function Ae(e,t,r){return/^(?:operator|sof|keyword c|case|new|[\[{}\(,;:]|=>)$/.test(t.lastType)||"quasi"==t.lastType&&/\{\s*$/.test(e.string.slice(0,e.pos-(r||0)))}ze.defineMode("javascript",function(e,f){var n,a,s=e.indentUnit,d=f.statementIndent,o=f.jsonld,c=f.json||o,p=f.typescript,u=f.wordCharacters||/[\w$\xa1-\uffff]/,l=function(){function e(e){return{type:e,style:"keyword"}}var t=e("keyword a"),r=e("keyword b"),n=e("keyword c"),a=e("operator"),i={type:"atom",style:"atom"},o={if:e("if"),while:t,with:t,else:r,do:r,try:r,finally:r,return:n,break:n,continue:n,new:e("new"),delete:n,throw:n,debugger:n,var:e("var"),const:e("var"),let:e("var"),function:e("function"),catch:e("catch"),for:e("for"),switch:e("switch"),case:e("case"),default:e("default"),in:a,typeof:a,instanceof:a,true:i,false:i,null:i,undefined:i,NaN:i,Infinity:i,this:e("this"),class:e("class"),super:e("atom"),yield:n,export:e("export"),import:e("import"),extends:n};if(p){var c={type:"variable",style:"variable-3"},u={interface:e("class"),implements:n,namespace:n,module:e("module"),enum:e("module"),public:e("modifier"),private:e("modifier"),protected:e("modifier"),abstract:e("modifier"),as:a,string:c,number:c,boolean:c,any:c};for(var l in u)o[l]=u[l]}return o}(),m=/[+\-*&%=<>!?|~^]/,v=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function y(e,t,r){return n=e,a=r,t}function k(e,t){var a,r=e.next();if('"'==r||"'"==r)return t.tokenize=(a=r,function(e,t){var r,n=!1;if(o&&"@"==e.peek()&&e.match(v))return t.tokenize=k,y("jsonld-keyword","meta");for(;null!=(r=e.next())&&(r!=a||n);)n=!n&&"\\"==r;return n||(t.tokenize=k),y("string","string")}),t.tokenize(e,t);if("."==r&&e.match(/^\d+(?:[eE][+\-]?\d+)?/))return y("number","number");if("."==r&&e.match(".."))return y("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(r))return y(r);if("="==r&&e.eat(">"))return y("=>","operator");if("0"==r&&e.eat(/x/i))return e.eatWhile(/[\da-f]/i),y("number","number");if("0"==r&&e.eat(/o/i))return e.eatWhile(/[0-7]/i),y("number","number");if("0"==r&&e.eat(/b/i))return e.eatWhile(/[01]/i),y("number","number");if(/\d/.test(r))return e.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),y("number","number");if("/"==r)return e.eat("*")?(t.tokenize=b)(e,t):e.eat("/")?(e.skipToEnd(),y("comment","comment")):Ae(e,t,1)?(function(e){for(var t,r=!1,n=!1;null!=(t=e.next());){if(!r){if("/"==t&&!n)return;"["==t?n=!0:n&&"]"==t&&(n=!1)}r=!r&&"\\"==t}}(e),e.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/),y("regexp","string-2")):(e.eatWhile(m),y("operator","operator",e.current()));if("`"==r)return(t.tokenize=x)(e,t);if("#"==r)return e.skipToEnd(),y("error","error");if(m.test(r))return e.eatWhile(m),y("operator","operator",e.current());if(u.test(r)){e.eatWhile(u);var n=e.current(),i=l.propertyIsEnumerable(n)&&l[n];return i&&"."!=t.lastType?y(i.type,i.style,n):y("variable","variable",n)}}function b(e,t){for(var r,n=!1;r=e.next();){if("/"==r&&n){t.tokenize=k;break}n="*"==r}return y("comment","comment")}function x(e,t){for(var r,n=!1;null!=(r=e.next());){if(!n&&("`"==r||"$"==r&&e.eat("{"))){t.tokenize=k;break}n=!n&&"\\"==r}return y("quasi","string-2",e.current())}var h="([{}])";function i(e,t){t.fatArrowAt&&(t.fatArrowAt=null);var r=e.string.indexOf("=>",e.start);if(!(r<0)){for(var n=0,a=!1,i=r-1;0<=i;--i){var o=e.string.charAt(i),c=h.indexOf(o);if(0<=c&&c<3){if(!n){++i;break}if(0==--n)break}else if(3<=c&&c<6)++n;else if(u.test(o))a=!0;else{if(/["'\/]/.test(o))return;if(a&&!n){++i;break}}}a&&!n&&(t.fatArrowAt=i)}}var w={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0};function g(e,t,r,n,a,i){this.indented=e,this.column=t,this.type=r,this.prev=a,this.info=i,null!=n&&(this.align=n)}function j(e,t){for(var r=e.localVars;r;r=r.next)if(r.name==t)return!0;for(var n=e.context;n;n=n.prev)for(r=n.vars;r;r=r.next)if(r.name==t)return!0}var M={state:null,column:null,marked:null,cc:null};function V(){for(var e=arguments.length-1;0<=e;e--)M.cc.push(arguments[e])}function E(){return V.apply(null,arguments),!0}function r(r){function e(e){for(var t=e;t;t=t.next)if(t.name==r)return!0;return!1}var t=M.state;if(M.marked="def",t.context){if(e(t.localVars))return;t.localVars={name:r,next:t.localVars}}else{if(e(t.globalVars))return;f.globalVars&&(t.globalVars={name:r,next:t.globalVars})}}var t={name:"this",next:{name:"arguments"}};function I(){M.state.context={prev:M.state.context,vars:M.state.localVars},M.state.localVars=t}function z(){M.state.localVars=M.state.context.vars,M.state.context=M.state.context.prev}function A(n,a){var e=function(){var e=M.state,t=e.indented;if("stat"==e.lexical.type)t=e.lexical.indented;else for(var r=e.lexical;r&&")"==r.type&&r.align;r=r.prev)t=r.indented;e.lexical=new g(t,M.stream.column(),n,null,e.lexical,a)};return e.lex=!0,e}function T(){var e=M.state;e.lexical.prev&&(")"==e.lexical.type&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function $(r){return function e(t){return t==r?E():";"==r?V():E(e)}}function q(e,t){return"var"==e?E(A("vardef",t.length),ne,$(";"),T):"keyword a"==e?E(A("form"),C,q,T):"keyword b"==e?E(A("form"),q,T):"{"==e?E(A("}"),_,T):";"==e?E():"if"==e?("else"==M.state.lexical.info&&M.state.cc[M.state.cc.length-1]==T&&M.state.cc.pop()(),E(A("form"),C,q,T,ue)):"function"==e?E(me):"for"==e?E(A("form"),le,q,T):"variable"==e?E(A("stat"),K):"switch"==e?E(A("form"),C,A("}","switch"),$("{"),_,T,T):"case"==e?E(C,$(":")):"default"==e?E($(":")):"catch"==e?E(A("form"),I,$("("),ve,$(")"),q,T,z):"class"==e?E(A("form"),ye,T):"export"==e?E(A("stat"),he,T):"import"==e?E(A("stat"),we,T):"module"==e?E(A("form"),ae,A("}"),$("{"),_,T,T):V(A("stat"),C,$(";"),T)}function C(e){return O(e,!1)}function W(e){return O(e,!0)}function O(e,t){if(M.state.fatArrowAt==M.stream.start){var r=t?F:D;if("("==e)return E(I,A(")"),Y(ae,")"),T,$("=>"),r,z);if("variable"==e)return V(I,ae,$("=>"),r,z)}var n,a=t?B:N;return w.hasOwnProperty(e)?E(a):"function"==e?E(me,a):"keyword c"==e?E(t?S:P):"("==e?E(A(")"),P,Ie,$(")"),T,a):"operator"==e||"spread"==e?E(t?W:C):"["==e?E(A("]"),Ve,T,a):"{"==e?Z(Q,"}",null,a):"quasi"==e?V(H,a):"new"==e?E((n=t,function(e){return"."==e?E(n?J:G):V(n?W:C)})):E()}function P(e){return e.match(/[;\}\)\],]/)?V():V(C)}function S(e){return e.match(/[;\}\)\],]/)?V():V(W)}function N(e,t){return","==e?E(C):B(e,t,!1)}function B(e,t,r){var n=0==r?N:B,a=0==r?C:W;return"=>"==e?E(I,r?F:D,z):"operator"==e?/\+\+|--/.test(t)?E(n):"?"==t?E(C,$(":"),a):E(a):"quasi"==e?V(H,n):";"!=e?"("==e?Z(W,")","call",n):"."==e?E(L,n):"["==e?E(A("]"),P,$("]"),T,n):void 0:void 0}function H(e,t){return"quasi"!=e?V():"${"!=t.slice(t.length-2)?E(H):E(C,U)}function U(e){if("}"==e)return M.marked="string-2",M.state.tokenize=x,E(H)}function D(e){return i(M.stream,M.state),V("{"==e?q:C)}function F(e){return i(M.stream,M.state),V("{"==e?q:W)}function G(e,t){if("target"==t)return M.marked="keyword",E(N)}function J(e,t){if("target"==t)return M.marked="keyword",E(B)}function K(e){return":"==e?E(T,q):V(N,$(";"),T)}function L(e){if("variable"==e)return M.marked="property",E()}function Q(e,t){return"variable"==e||"keyword"==M.style?(M.marked="property",E("get"==t||"set"==t?R:X)):"number"==e||"string"==e?(M.marked=o?"property":M.style+" property",E(X)):"jsonld-keyword"==e?E(X):"modifier"==e?E(Q):"["==e?E(C,$("]"),X):"spread"==e?E(C):void 0}function R(e){return"variable"!=e?V(X):(M.marked="property",E(me))}function X(e){return":"==e?E(W):"("==e?V(me):void 0}function Y(r,n){function a(e){if(","!=e)return e==n?E():E($(n));var t=M.state.lexical;return"call"==t.info&&(t.pos=(t.pos||0)+1),E(r,a)}return function(e){return e==n?E():V(r,a)}}function Z(e,t,r){for(var n=3;n<arguments.length;n++)M.cc.push(arguments[n]);return E(A(t,r),Y(e,t),T)}function _(e){return"}"==e?E():V(q,_)}function ee(e){if(p&&":"==e)return E(re)}function te(e,t){if("="==t)return E(W)}function re(e){if("variable"==e)return M.marked="variable-3",E()}function ne(){return V(ae,ee,oe,ce)}function ae(e,t){return"modifier"==e?E(ae):"variable"==e?(r(t),E()):"spread"==e?E(ae):"["==e?Z(ae,"]"):"{"==e?Z(ie,"}"):void 0}function ie(e,t){return"variable"!=e||M.stream.match(/^\s*:/,!1)?("variable"==e&&(M.marked="property"),"spread"==e?E(ae):"}"==e?V():E($(":"),ae,oe)):(r(t),E(oe))}function oe(e,t){if("="==t)return E(W)}function ce(e){if(","==e)return E(ne)}function ue(e,t){if("keyword b"==e&&"else"==t)return E(A("form","else"),q,T)}function le(e){if("("==e)return E(A(")"),fe,$(")"),T)}function fe(e){return"var"==e?E(ne,$(";"),de):";"==e?E(de):"variable"==e?E(se):V(C,$(";"),de)}function se(e,t){return"in"==t||"of"==t?(M.marked="keyword",E(C)):E(N,de)}function de(e,t){return";"==e?E(pe):"in"==t||"of"==t?(M.marked="keyword",E(C)):V(C,$(";"),pe)}function pe(e){")"!=e&&E(C)}function me(e,t){return"*"==t?(M.marked="keyword",E(me)):"variable"==e?(r(t),E(me)):"("==e?E(I,A(")"),Y(ve,")"),T,q,z):void 0}function ve(e){return"spread"==e?E(ve):V(ae,ee,te)}function ye(e,t){if("variable"==e)return r(t),E(ke)}function ke(e,t){return"extends"==t?E(C,ke):"{"==e?E(A("}"),be,T):void 0}function be(e,t){return"variable"==e||"keyword"==M.style?"static"==t?(M.marked="keyword",E(be)):(M.marked="property","get"==t||"set"==t?E(xe,me,be):E(me,be)):"*"==t?(M.marked="keyword",E(be)):";"==e?E(be):"}"==e?E():void 0}function xe(e){return"variable"!=e?V():(M.marked="property",E())}function he(e,t){return"*"==t?(M.marked="keyword",E(Me,$(";"))):"default"==t?(M.marked="keyword",E(C,$(";"))):V(q)}function we(e){return"string"==e?E():V(ge,Me)}function ge(e,t){return"{"==e?Z(ge,"}"):("variable"==e&&r(t),"*"==t&&(M.marked="keyword"),E(je))}function je(e,t){if("as"==t)return M.marked="keyword",E(ge)}function Me(e,t){if("from"==t)return M.marked="keyword",E(C)}function Ve(e){return"]"==e?E():V(W,Ee)}function Ee(e){return"for"==e?V(Ie,$("]")):","==e?E(Y(S,"]")):V(Y(W,"]"))}function Ie(e){return"for"==e?E(le,Ie):"if"==e?E(C,Ie):void 0}return T.lex=!0,{startState:function(e){var t={tokenize:k,lastType:"sof",cc:[],lexical:new g((e||0)-s,0,"block",!1),localVars:f.localVars,context:f.localVars&&{vars:f.localVars},indented:e||0};return f.globalVars&&"object"==typeof f.globalVars&&(t.globalVars=f.globalVars),t},token:function(e,t){if(e.sol()&&(t.lexical.hasOwnProperty("align")||(t.lexical.align=!1),t.indented=e.indentation(),i(e,t)),t.tokenize!=b&&e.eatSpace())return null;var r=t.tokenize(e,t);return"comment"==n?r:(t.lastType="operator"!=n||"++"!=a&&"--"!=a?n:"incdec",function(e,t,r,n,a){var i=e.cc;for(M.state=e,M.stream=a,M.marked=null,M.cc=i,M.style=t,e.lexical.hasOwnProperty("align")||(e.lexical.align=!0);;)if((i.length?i.pop():c?C:q)(r,n)){for(;i.length&&i[i.length-1].lex;)i.pop()();return M.marked?M.marked:"variable"==r&&j(e,n)?"variable-2":t}}(t,r,n,a,e))},indent:function(e,t){if(e.tokenize==b)return ze.Pass;if(e.tokenize!=k)return 0;var r=t&&t.charAt(0),n=e.lexical;if(!/^\s*else\b/.test(t))for(var a=e.cc.length-1;0<=a;--a){var i=e.cc[a];if(i==T)n=n.prev;else if(i!=ue)break}"stat"==n.type&&"}"==r&&(n=n.prev),d&&")"==n.type&&"stat"==n.prev.type&&(n=n.prev);var o,c,u=n.type,l=r==u;return"vardef"==u?n.indented+("operator"==e.lastType||","==e.lastType?n.info+1:0):"form"==u&&"{"==r?n.indented:"form"==u?n.indented+s:"stat"==u?n.indented+(c=t,"operator"==(o=e).lastType||","==o.lastType||m.test(c.charAt(0))||/[,.]/.test(c.charAt(0))?d||s:0):"switch"!=n.info||l||0==f.doubleIndentSwitch?n.align?n.column+(l?0:1):n.indented+(l?0:s):n.indented+(/^(?:case|default)\b/.test(t)?s:2*s)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:c?null:"/*",blockCommentEnd:c?null:"*/",lineComment:c?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:c?"json":"javascript",jsonldMode:o,jsonMode:c,expressionAllowed:Ae,skipExpression:function(e){var t=e.cc[e.cc.length-1];t!=C&&t!=W||e.cc.pop()}}}),ze.registerHelper("wordChars","javascript",/[\w$]/),ze.defineMIME("text/javascript","javascript"),ze.defineMIME("text/ecmascript","javascript"),ze.defineMIME("application/javascript","javascript"),ze.defineMIME("application/x-javascript","javascript"),ze.defineMIME("application/ecmascript","javascript"),ze.defineMIME("application/json",{name:"javascript",json:!0}),ze.defineMIME("application/x-json",{name:"javascript",json:!0}),ze.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),ze.defineMIME("text/typescript",{name:"javascript",typescript:!0}),ze.defineMIME("application/typescript",{name:"javascript",typescript:!0})});
!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(z){"use strict";var N={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},T={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1};z.defineMode("xml",function(t,e){var i,a,l=t.indentUnit,u={},n=e.htmlMode?N:T;for(var r in n)u[r]=n[r];for(var r in e)u[r]=e[r];function d(e,n){function t(t){return(n.tokenize=t)(e,n)}var r=e.next();return"<"==r?e.eat("!")?e.eat("[")?e.match("CDATA[")?t(o("atom","]]>")):null:e.match("--")?t(o("comment","--\x3e")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),t(function r(o){return function(t,e){for(var n;null!=(n=t.next());){if("<"==n)return e.tokenize=r(o+1),e.tokenize(t,e);if(">"==n){if(1!=o)return e.tokenize=r(o-1),e.tokenize(t,e);e.tokenize=d;break}}return"meta"}}(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),n.tokenize=o("meta","?>"),"meta"):(i=e.eat("/")?"closeTag":"openTag",n.tokenize=c,"tag bracket"):"&"!=r?(e.eatWhile(/[^&<]/),null):(e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"))?"atom":"error"}function c(t,e){var n=t.next();if(">"==n||"/"==n&&t.eat(">"))return e.tokenize=d,i=">"==n?"endTag":"selfcloseTag","tag bracket";if("="==n)return i="equals",null;if("<"!=n)return/[\'\"]/.test(n)?(e.tokenize=(r=n,(o=function(t,e){for(;!t.eol();)if(t.next()==r){e.tokenize=c;break}return"string"}).isInAttribute=!0,o),e.stringStartCol=t.column(),e.tokenize(t,e)):(t.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word");e.tokenize=d,e.state=g,e.tagName=e.tagStart=null;var r,o,a=e.tokenize(t,e);return a?a+" tag error":"tag error"}function o(n,r){return function(t,e){for(;!t.eol();){if(t.match(r)){e.tokenize=d;break}t.next()}return n}}function f(t,e,n){this.prev=t.context,this.tagName=e,this.indent=t.indented,this.startOfLine=n,(u.doNotIndent.hasOwnProperty(e)||t.context&&t.context.noIndent)&&(this.noIndent=!0)}function s(t){t.context&&(t.context=t.context.prev)}function m(t,e){for(var n;;){if(!t.context)return;if(n=t.context.tagName,!u.contextGrabbers.hasOwnProperty(n)||!u.contextGrabbers[n].hasOwnProperty(e))return;s(t)}}function g(t,e,n){return"openTag"==t?(n.tagStart=e.column(),p):"closeTag"==t?h:g}function p(t,e,n){return"word"==t?(n.tagName=e.current(),a="tag",k):(a="error",p)}function h(t,e,n){if("word"!=t)return a="error",b;var r=e.current();return n.context&&n.context.tagName!=r&&u.implicitlyClosed.hasOwnProperty(n.context.tagName)&&s(n),n.context&&n.context.tagName==r?(a="tag",x):(a="tag error",b)}function x(t,e,n){return"endTag"!=t?(a="error",x):(s(n),g)}function b(t,e,n){return a="error",x(t,0,n)}function k(t,e,n){if("word"==t)return a="attribute",w;if("endTag"!=t&&"selfcloseTag"!=t)return a="error",k;var r=n.tagName,o=n.tagStart;return n.tagName=n.tagStart=null,"selfcloseTag"==t||u.autoSelfClosers.hasOwnProperty(r)?m(n,r):(m(n,r),n.context=new f(n,r,o==n.indented)),g}function w(t,e,n){return"equals"==t?v:(u.allowMissing||(a="error"),k(t,0,n))}function v(t,e,n){return"string"==t?y:"word"==t&&u.allowUnquoted?(a="string",k):(a="error",k(t,0,n))}function y(t,e,n){return"string"==t?y:k(t,0,n)}return d.isInText=!0,{startState:function(t){var e={tokenize:d,state:g,indented:t||0,tagName:null,tagStart:null,context:null};return null!=t&&(e.baseIndent=t),e},token:function(t,e){if(!e.tagName&&t.sol()&&(e.indented=t.indentation()),t.eatSpace())return null;i=null;var n=e.tokenize(t,e);return(n||i)&&"comment"!=n&&(a=null,e.state=e.state(i||n,t,e),a&&(n="error"==a?n+" error":a)),n},indent:function(t,e,n){var r=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+l;if(r&&r.noIndent)return z.Pass;if(t.tokenize!=c&&t.tokenize!=d)return n?n.match(/^(\s*)/)[0].length:0;if(t.tagName)return!1!==u.multilineTagIndentPastTag?t.tagStart+t.tagName.length+2:t.tagStart+l*(u.multilineTagIndentFactor||1);if(u.alignCDATA&&/<!\[CDATA\[/.test(e))return 0;var o=e&&/^<(\/)?([\w_:\.-]*)/.exec(e);if(o&&o[1])for(;r;){if(r.tagName==o[2]){r=r.prev;break}if(!u.implicitlyClosed.hasOwnProperty(r.tagName))break;r=r.prev}else if(o)for(;r;){var a=u.contextGrabbers[r.tagName];if(!a||!a.hasOwnProperty(o[2]))break;r=r.prev}for(;r&&r.prev&&!r.startOfLine;)r=r.prev;return r?r.indent+l:t.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:u.htmlMode?"html":"xml",helperType:u.htmlMode?"html":"xml",skipAttribute:function(t){t.state==v&&(t.state=k)}}}),z.defineMIME("text/xml","xml"),z.defineMIME("application/xml","xml"),z.mimeModes.hasOwnProperty("text/html")||z.defineMIME("text/html",{name:"xml",htmlMode:!0})});
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(T){"use strict";function e(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=!0;return t}T.defineMode("css",function(e,t){var r=t.inline;t.propertyKeywords||(t=T.resolveMode("text/css"));var o,a,i=e.indentUnit,n=t.tokenHooks,l=t.documentTypes||{},s=t.mediaTypes||{},c=t.mediaFeatures||{},d=t.mediaValueKeywords||{},p=t.propertyKeywords||{},u=t.nonStandardPropertyKeywords||{},m=t.fontProperties||{},h=t.counterDescriptors||{},g=t.colorKeywords||{},b=t.valueKeywords||{},f=t.allowNested,y=!0===t.supportsAtComponent;function w(e,t){return o=t,e}function k(a){return function(e,t){for(var r,o=!1;null!=(r=e.next());){if(r==a&&!o){")"==a&&e.backUp(1);break}o=!o&&"\\"==r}return(r==a||!o&&")"!=a)&&(t.tokenize=null),w("string","string")}}function v(e,t){return e.next(),e.match(/\s*[\"\')]/,!1)?t.tokenize=null:t.tokenize=k(")"),w(null,"(")}function x(e,t,r){this.type=e,this.indent=t,this.prev=r}function z(e,t,r,o){return e.context=new x(r,t.indentation()+(!1===o?0:i),e.context),r}function q(e){return e.context.prev&&(e.context=e.context.prev),e.context.type}function P(e,t,r){return B[r.context.type](e,t,r)}function j(e,t,r,o){for(var a=o||1;0<a;a--)r.context=r.context.prev;return P(e,t,r)}function K(e){var t=e.current().toLowerCase();a=b.hasOwnProperty(t)?"atom":g.hasOwnProperty(t)?"keyword":"variable"}var B={top:function(e,t,r){if("{"==e)return z(r,t,"block");if("}"==e&&r.context.prev)return q(r);if(y&&/@component/.test(e))return z(r,t,"atComponentBlock");if(/^@(-moz-)?document$/.test(e))return z(r,t,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/.test(e))return z(r,t,"atBlock");if(/^@(font-face|counter-style)/.test(e))return r.stateArg=e,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/.test(e))return"keyframes";if(e&&"@"==e.charAt(0))return z(r,t,"at");if("hash"==e)a="builtin";else if("word"==e)a="tag";else{if("variable-definition"==e)return"maybeprop";if("interpolation"==e)return z(r,t,"interpolation");if(":"==e)return"pseudo";if(f&&"("==e)return z(r,t,"parens")}return r.context.type},block:function(e,t,r){if("word"!=e)return"meta"==e?"block":f||"hash"!=e&&"qualifier"!=e?B.top(e,t,r):(a="error","block");var o=t.current().toLowerCase();return p.hasOwnProperty(o)?(a="property","maybeprop"):u.hasOwnProperty(o)?(a="string-2","maybeprop"):f?(a=t.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(a+=" error","maybeprop")},maybeprop:function(e,t,r){return":"==e?z(r,t,"prop"):P(e,t,r)},prop:function(e,t,r){if(";"==e)return q(r);if("{"==e&&f)return z(r,t,"propBlock");if("}"==e||"{"==e)return j(e,t,r);if("("==e)return z(r,t,"parens");if("hash"!=e||/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(t.current())){if("word"==e)K(t);else if("interpolation"==e)return z(r,t,"interpolation")}else a+=" error";return"prop"},propBlock:function(e,t,r){return"}"==e?q(r):"word"==e?(a="property","maybeprop"):r.context.type},parens:function(e,t,r){return"{"==e||"}"==e?j(e,t,r):")"==e?q(r):"("==e?z(r,t,"parens"):"interpolation"==e?z(r,t,"interpolation"):("word"==e&&K(t),"parens")},pseudo:function(e,t,r){return"word"==e?(a="variable-3",r.context.type):P(e,t,r)},documentTypes:function(e,t,r){return"word"==e&&l.hasOwnProperty(t.current())?(a="tag",r.context.type):B.atBlock(e,t,r)},atBlock:function(e,t,r){if("("==e)return z(r,t,"atBlock_parens");if("}"==e||";"==e)return j(e,t,r);if("{"==e)return q(r)&&z(r,t,f?"block":"top");if("interpolation"==e)return z(r,t,"interpolation");if("word"==e){var o=t.current().toLowerCase();a="only"==o||"not"==o||"and"==o||"or"==o?"keyword":s.hasOwnProperty(o)?"attribute":c.hasOwnProperty(o)?"property":d.hasOwnProperty(o)?"keyword":p.hasOwnProperty(o)?"property":u.hasOwnProperty(o)?"string-2":b.hasOwnProperty(o)?"atom":g.hasOwnProperty(o)?"keyword":"error"}return r.context.type},atComponentBlock:function(e,t,r){return"}"==e?j(e,t,r):"{"==e?q(r)&&z(r,t,f?"block":"top",!1):("word"==e&&(a="error"),r.context.type)},atBlock_parens:function(e,t,r){return")"==e?q(r):"{"==e||"}"==e?j(e,t,r,2):B.atBlock(e,t,r)},restricted_atBlock_before:function(e,t,r){return"{"==e?z(r,t,"restricted_atBlock"):"word"==e&&"@counter-style"==r.stateArg?(a="variable","restricted_atBlock_before"):P(e,t,r)},restricted_atBlock:function(e,t,r){return"}"==e?(r.stateArg=null,q(r)):"word"==e?(a="@font-face"==r.stateArg&&!m.hasOwnProperty(t.current().toLowerCase())||"@counter-style"==r.stateArg&&!h.hasOwnProperty(t.current().toLowerCase())?"error":"property","maybeprop"):"restricted_atBlock"},keyframes:function(e,t,r){return"word"==e?(a="variable","keyframes"):"{"==e?z(r,t,"top"):P(e,t,r)},at:function(e,t,r){return";"==e?q(r):"{"==e||"}"==e?j(e,t,r):("word"==e?a="tag":"hash"==e&&(a="builtin"),"at")},interpolation:function(e,t,r){return"}"==e?q(r):"{"==e||";"==e?j(e,t,r):("word"==e?a="variable":"variable"!=e&&"("!=e&&")"!=e&&(a="error"),"interpolation")}};return{startState:function(e){return{tokenize:null,state:r?"block":"top",stateArg:null,context:new x(r?"block":"top",e||0,null)}},token:function(e,t){if(!t.tokenize&&e.eatSpace())return null;var r=(t.tokenize||function(e,t){var r=e.next();if(n[r]){var o=n[r](e,t);if(!1!==o)return o}return"@"==r?(e.eatWhile(/[\w\\\-]/),w("def",e.current())):"="==r||("~"==r||"|"==r)&&e.eat("=")?w(null,"compare"):'"'==r||"'"==r?(t.tokenize=k(r),t.tokenize(e,t)):"#"==r?(e.eatWhile(/[\w\\\-]/),w("atom","hash")):"!"==r?(e.match(/^\s*\w*/),w("keyword","important")):/\d/.test(r)||"."==r&&e.eat(/\d/)?(e.eatWhile(/[\w.%]/),w("number","unit")):"-"!==r?/[,+>*\/]/.test(r)?w(null,"select-op"):"."==r&&e.match(/^-?[_a-z][_a-z0-9-]*/i)?w("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(r)?w(null,r):"u"==r&&e.match(/rl(-prefix)?\(/)||"d"==r&&e.match("omain(")||"r"==r&&e.match("egexp(")?(e.backUp(1),t.tokenize=v,w("property","word")):/[\w\\\-]/.test(r)?(e.eatWhile(/[\w\\\-]/),w("property","word")):w(null,null):/[\d.]/.test(e.peek())?(e.eatWhile(/[\w.%]/),w("number","unit")):e.match(/^-[\w\\\-]+/)?(e.eatWhile(/[\w\\\-]/),e.match(/^\s*:/,!1)?w("variable-2","variable-definition"):w("variable-2","variable")):e.match(/^\w+-/)?w("meta","meta"):void 0})(e,t);return r&&"object"==typeof r&&(o=r[1],r=r[0]),a=r,t.state=B[t.state](o,e,t),a},indent:function(e,t){var r=e.context,o=t&&t.charAt(0),a=r.indent;return"prop"!=r.type||"}"!=o&&")"!=o||(r=r.prev),r.prev&&("}"!=o||"block"!=r.type&&"top"!=r.type&&"interpolation"!=r.type&&"restricted_atBlock"!=r.type?(")"!=o||"parens"!=r.type&&"atBlock_parens"!=r.type)&&("{"!=o||"at"!=r.type&&"atBlock"!=r.type)||(a=Math.max(0,r.indent-i),r=r.prev):a=(r=r.prev).indent),a},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",fold:"brace"}});var t=["domain","regexp","url","url-prefix"],r=e(t),o=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],a=e(o),i=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover"],n=e(i),l=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive"],s=e(l),c=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-position","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],d=e(c),p=["scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-3d-light-color","scrollbar-track-color","shape-inside","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","zoom"],u=e(p),m=e(["font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"]),h=e(["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"]),g=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],b=e(g),f=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","spell-out","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","symbolic","symbols","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],y=e(f),w=t.concat(o).concat(i).concat(l).concat(c).concat(p).concat(g).concat(f);function k(e,t){for(var r,o=!1;null!=(r=e.next());){if(o&&"/"==r){t.tokenize=null;break}o="*"==r}return["comment","comment"]}T.registerHelper("hintWords","css",w),T.defineMIME("text/css",{documentTypes:r,mediaTypes:a,mediaFeatures:n,mediaValueKeywords:s,propertyKeywords:d,nonStandardPropertyKeywords:u,fontProperties:m,counterDescriptors:h,colorKeywords:b,valueKeywords:y,tokenHooks:{"/":function(e,t){return!!e.eat("*")&&(t.tokenize=k)(e,t)}},name:"css"}),T.defineMIME("text/x-scss",{mediaTypes:a,mediaFeatures:n,mediaValueKeywords:s,propertyKeywords:d,nonStandardPropertyKeywords:u,colorKeywords:b,valueKeywords:y,fontProperties:m,allowNested:!0,tokenHooks:{"/":function(e,t){return e.eat("/")?(e.skipToEnd(),["comment","comment"]):e.eat("*")?(t.tokenize=k)(e,t):["operator","operator"]},":":function(e){return!!e.match(/\s*\{/)&&[null,"{"]},$:function(e){return e.match(/^[\w-]+/),e.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(e){return!!e.eat("{")&&[null,"interpolation"]}},name:"css",helperType:"scss"}),T.defineMIME("text/x-less",{mediaTypes:a,mediaFeatures:n,mediaValueKeywords:s,propertyKeywords:d,nonStandardPropertyKeywords:u,colorKeywords:b,valueKeywords:y,fontProperties:m,allowNested:!0,tokenHooks:{"/":function(e,t){return e.eat("/")?(e.skipToEnd(),["comment","comment"]):e.eat("*")?(t.tokenize=k)(e,t):["operator","operator"]},"@":function(e){return e.eat("{")?[null,"interpolation"]:!e.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/,!1)&&(e.eatWhile(/[\w\\\-]/),e.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),T.defineMIME("text/x-gss",{documentTypes:r,mediaTypes:a,mediaFeatures:n,propertyKeywords:d,nonStandardPropertyKeywords:u,fontProperties:m,counterDescriptors:h,colorKeywords:b,valueKeywords:y,supportsAtComponent:!0,tokenHooks:{"/":function(e,t){return!!e.eat("*")&&(t.tokenize=k)(e,t)}},name:"css",helperType:"gss"})});
!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],t):t(CodeMirror)}(function(p){"use strict";var l={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]};var o={};function f(t,e){for(var a,n,l=t.pos;0<=l&&"<"!==t.string.charAt(l);)l--;return l<0?l:(a=t.string.slice(l,t.pos).match(o[n=e]||(o[n]=new RegExp("\\s+"+n+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*"))))?a[2]:""}function h(t,e){return new RegExp((e?"^":"")+"</s*"+t+"s*>","i")}function r(t,e){for(var a in t)for(var n=e[a]||(e[a]=[]),l=t[a],o=l.length-1;0<=o;o--)n.unshift(l[o])}p.defineMode("htmlmixed",function(s,t){var u=p.getMode(s,{name:"xml",htmlMode:!0,multilineTagIndentFactor:t.multilineTagIndentFactor,multilineTagIndentPastTag:t.multilineTagIndentPastTag}),m={},e=t&&t.tags,a=t&&t.scriptTypes;if(r(l,m),e&&r(e,m),a)for(var n=a.length-1;0<=n;n--)m.script.unshift(["type",a[n].matches,a[n].mode]);function d(t,e){var a,n=e.htmlState.tagName&&e.htmlState.tagName.toLowerCase(),l=n&&m.hasOwnProperty(n)&&m[n],o=u.token(t,e.htmlState);if(l&&/\btag\b/.test(o)&&">"===t.current()&&(a=function(t,e){for(var a=0;a<t.length;a++){var n=t[a];if(!n[0]||n[1].test(f(e,n[0])))return n[2]}}(l,t))){var r=p.getMode(s,a),c=h(n,!0),i=h(n,!1);e.token=function(t,e){return t.match(c,!1)?(e.token=d,e.localState=e.localMode=null,null):(a=t,n=i,l=e.localMode.token(t,e.localState),o=a.current(),-1<(r=o.search(n))?a.backUp(o.length-r):o.match(/<\/?$/)&&(a.backUp(o.length),a.match(n,!1)||a.match(o)),l);var a,n,l,o,r},e.localMode=r,e.localState=p.startState(r,u.indent(e.htmlState,""))}return o}return{startState:function(){return{token:d,localMode:null,localState:null,htmlState:u.startState()}},copyState:function(t){var e;return t.localState&&(e=p.copyState(t.localMode,t.localState)),{token:t.token,localMode:t.localMode,localState:e,htmlState:p.copyState(u,t.htmlState)}},token:function(t,e){return e.token(t,e)},indent:function(t,e){return!t.localMode||/^\s*<\//.test(e)?u.indent(t.htmlState,e):t.localMode.indent?t.localMode.indent(t.localState,e):p.Pass},innerMode:function(t){return{state:t.localState||t.htmlState,mode:t.localMode||u}}}},"xml","javascript","css"),p.defineMIME("text/html","htmlmixed")});
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(S){"use strict";function m(e,t){if(!e.hasOwnProperty(t))throw new Error("Undefined state "+t+" in simple mode")}function s(e,t){if(!e)return/(?:)/;var n="";return e=e instanceof RegExp?(e.ignoreCase&&(n="i"),e.source):String(e),new RegExp((!1===t?"":"^")+"(?:"+e+")",n)}function v(e,t){(e.next||e.push)&&m(t,e.next||e.push),this.regex=s(e.regex),this.token=function(e){if(!e)return null;if("string"==typeof e)return e.replace(/\./g," ");for(var t=[],n=0;n<e.length;n++)t.push(e[n]&&e[n].replace(/\./g," "));return t}(e.token),this.data=e}function d(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var n=0;for(var a in e)if(e.hasOwnProperty(a)){if(!t.hasOwnProperty(a)||!d(e[a],t[a]))return!1;n++}for(var a in t)t.hasOwnProperty(a)&&n--;return 0==n}function k(e,t,n,a){var o;if(n.persistent)for(var r=t.persistentStates;r&&!o;r=r.next)(n.spec?d(n.spec,r.spec):n.mode==r.mode)&&(o=r);var i=o?o.mode:n.mode||S.getMode(e,n.spec),l=o?o.state:S.startState(i);n.persistent&&!o&&(t.persistentStates={mode:i,spec:n.spec,state:l,next:t.persistentStates}),t.localState=l,t.local={mode:i,end:n.end&&s(n.end),endScan:n.end&&!1!==n.forceEnd&&s(n.end,!1),endToken:a&&a.join?a[a.length-1]:a}}S.defineSimpleMode=function(e,t){S.defineMode(e,function(e){return S.simpleMode(e,t)})},S.simpleMode=function(e,t){m(t,"start");var n={},a=t.meta||{},o=!1;for(var r in t)if(r!=a&&t.hasOwnProperty(r))for(var i=n[r]=[],l=t[r],s=0;s<l.length;s++){var d=l[s];i.push(new v(d,t)),(d.indent||d.dedent)&&(o=!0)}var c,u,p,f,h={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:o?[]:null}},copyState:function(e){var t={state:e.state,pending:e.pending,local:e.local,localState:null,indent:e.indent&&e.indent.slice(0)};e.localState&&(t.localState=S.copyState(e.local.mode,e.localState)),e.stack&&(t.stack=e.stack.slice(0));for(var n=e.persistentStates;n;n=n.next)t.persistentStates={mode:n.mode,spec:n.spec,state:n.state==e.localState?t.localState:S.copyState(n.mode,n.state),next:t.persistentStates};return t},token:(p=n,f=e,function(e,t){if(t.pending){var n=t.pending.shift();return 0==t.pending.length&&(t.pending=null),e.pos+=n.text.length,n.token}if(t.local){if(t.local.end&&e.match(t.local.end)){var a=t.local.endToken||null;return t.local=t.localState=null,a}var o,a=t.local.mode.token(e,t.localState);return t.local.endScan&&(o=t.local.endScan.exec(e.current()))&&(e.pos=e.start+o.index),a}for(var r=p[t.state],i=0;i<r.length;i++){var l=r[i],s=(!l.data.sol||e.sol())&&e.match(l.regex);if(s){if(l.data.next?t.state=l.data.next:l.data.push?((t.stack||(t.stack=[])).push(t.state),t.state=l.data.push):l.data.pop&&t.stack&&t.stack.length&&(t.state=t.stack.pop()),l.data.mode&&k(f,t,l.data.mode,l.token),l.data.indent&&t.indent.push(e.indentation()+f.indentUnit),l.data.dedent&&t.indent.pop(),2<s.length){t.pending=[];for(var d=2;d<s.length;d++)s[d]&&t.pending.push({text:s[d],token:l.token[d-1]});return e.backUp(s[0].length-(s[1]?s[1].length:0)),l.token[0]}return l.token&&l.token.join?l.token[0]:l.token}}return e.next(),null}),innerMode:function(e){return e.local&&{mode:e.local.mode,state:e.localState}},indent:(c=n,u=a,function(e,t,n){if(e.local&&e.local.mode.indent)return e.local.mode.indent(e.localState,t,n);if(null==e.indent||e.local||u.dontIndentStates&&-1<function(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return!0}(e.state,u.dontIndentStates))return S.Pass;var a=e.indent.length-1,o=c[e.state];e:for(;;){for(var r=0;r<o.length;r++){var i=o[r];if(i.data.dedent&&!1!==i.data.dedentIfLineStart){var l=i.regex.exec(t);if(l&&l[0]){a--,(i.next||i.push)&&(o=c[i.next||i.push]),t=t.slice(l[0].length);continue e}}}break}return a<0?0:e.indent[a]})};if(a)for(var g in a)a.hasOwnProperty(g)&&(h[g]=a[g]);return h}});
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(f){"use strict";f.multiplexingMode=function(a){var d=Array.prototype.slice.call(arguments,1);function v(e,n,t,i){if("string"==typeof n){var r=e.indexOf(n,t);return i&&-1<r?r+n.length:r}var o=n.exec(t?e.slice(t):e);return o?o.index+t+(i?o[0].length:0):-1}return{startState:function(){return{outer:f.startState(a),innerActive:null,inner:null}},copyState:function(e){return{outer:f.copyState(a,e.outer),innerActive:e.innerActive,inner:e.innerActive&&f.copyState(e.innerActive.mode,e.inner)}},token:function(e,n){if(n.innerActive){var t=n.innerActive;o=e.string;if(!t.close&&e.sol())return n.innerActive=n.inner=null,this.token(e,n);if((l=t.close?v(o,t.close,e.pos,t.parseDelimiters):-1)==e.pos&&!t.parseDelimiters)return e.match(t.close),n.innerActive=n.inner=null,t.delimStyle&&t.delimStyle+" "+t.delimStyle+"-close";-1<l&&(e.string=o.slice(0,l));var i=t.mode.token(e,n.inner);return-1<l&&(e.string=o),l==e.pos&&t.parseDelimiters&&(n.innerActive=n.inner=null),t.innerStyle&&(i=i?i+" "+t.innerStyle:t.innerStyle),i}for(var r=1/0,o=e.string,c=0;c<d.length;++c){var l,s=d[c];if((l=v(o,s.open,e.pos))==e.pos)return s.parseDelimiters||e.match(s.open),n.innerActive=s,n.inner=f.startState(s.mode,a.indent?a.indent(n.outer,""):0),s.delimStyle&&s.delimStyle+" "+s.delimStyle+"-open";-1!=l&&l<r&&(r=l)}r!=1/0&&(e.string=o.slice(0,r));var u=a.token(e,n.outer);return r!=1/0&&(e.string=o),u},indent:function(e,n){var t=e.innerActive?e.innerActive.mode:a;return t.indent?t.indent(e.innerActive?e.inner:e.outer,n):f.Pass},blankLine:function(e){var n=e.innerActive?e.innerActive.mode:a;if(n.blankLine&&n.blankLine(e.innerActive?e.inner:e.outer),e.innerActive)"\n"===e.innerActive.close&&(e.innerActive=e.inner=null);else for(var t=0;t<d.length;++t){var i=d[t];"\n"===i.open&&(e.innerActive=i,e.inner=f.startState(i.mode,n.indent?n.indent(e.outer,""):0))}},electricChars:a.electricChars,innerMode:function(e){return e.inner?{state:e.inner,mode:e.innerActive.mode}:{state:e.outer,mode:a}}}}});
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../../addon/mode/simple"),require("../../addon/mode/multiplex")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../../addon/mode/simple","../../addon/mode/multiplex"],e):e(CodeMirror)}(function(n){"use strict";n.defineSimpleMode("handlebars-tags",{start:[{regex:/\{\{!--/,push:"dash_comment",token:"comment"},{regex:/\{\{!/,push:"comment",token:"comment"},{regex:/\{\{/,push:"handlebars",token:"tag"}],handlebars:[{regex:/\}\}/,pop:!0,token:"tag"},{regex:/"(?:[^\\"]|\\.)*"?/,token:"string"},{regex:/'(?:[^\\']|\\.)*'?/,token:"string"},{regex:/>|[#\/]([A-Za-z_]\w*)/,token:"keyword"},{regex:/(?:else|this)\b/,token:"keyword"},{regex:/\d+/i,token:"number"},{regex:/=|~|@|true|false/,token:"atom"},{regex:/(?:\.\.\/)*(?:[A-Za-z_][\w\.]*)+/,token:"variable-2"}],dash_comment:[{regex:/--\}\}/,pop:!0,token:"comment"},{regex:/./,token:"comment"}],comment:[{regex:/\}\}/,pop:!0,token:"comment"},{regex:/./,token:"comment"}]}),n.defineMode("handlebars",function(e,o){var t=n.getMode(e,"handlebars-tags");return o&&o.base?n.multiplexingMode(n.getMode(e,o.base),{open:"{{",close:"}}",mode:t,parseDelimiters:!0}):t}),n.defineMIME("text/x-handlebars-template","handlebars")});
!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(A){"use strict";var S="CodeMirror-hint-active";function o(t,i){this.cm=t,this.options=i,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var e=this;t.on("cursorActivity",this.activityFunc=function(){e.cursorActivity()})}A.showHint=function(t,i,e){if(!i)return t.showHint(e);e&&e.async&&(i.async=!0);var n={hint:i};if(e)for(var o in e)n[o]=e[o];return t.showHint(n)},A.defineExtension("showHint",function(t){t=function(t,i,e){var n=t.options.hintOptions,o={};for(var s in h)o[s]=h[s];if(n)for(var s in n)void 0!==n[s]&&(o[s]=n[s]);if(e)for(var s in e)void 0!==e[s]&&(o[s]=e[s]);o.hint.resolve&&(o.hint=o.hint.resolve(t,i));return o}(this,this.getCursor("start"),t);var i=this.listSelections();if(!(1<i.length)){if(this.somethingSelected()){if(!t.hint.supportsSelection)return;for(var e=0;e<i.length;e++)if(i[e].head.line!=i[e].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var n=this.state.completionActive=new o(this,t);n.options.hint&&(A.signal(this,"startCompletion",this),n.update(!0))}});var n=window.requestAnimationFrame||function(t){return setTimeout(t,1e3/60)},s=window.cancelAnimationFrame||clearTimeout;function T(t){return"string"==typeof t?t:t.text}function M(t,i){for(;i&&i!=t;){if("LI"===i.nodeName.toUpperCase()&&i.parentNode==t)return i;i=i.parentNode}}function c(o,t){this.completion=o,this.data=t,this.picked=!1;var e=this,s=o.cm,c=this.hints=document.createElement("ul");c.className="CodeMirror-hints",this.selectedHint=t.selectedHint||0;for(var i=t.list,n=0;n<i.length;++n){var r=c.appendChild(document.createElement("li")),h=i[n],l="CodeMirror-hint"+(n!=this.selectedHint?"":" "+S);null!=h.className&&(l=h.className+" "+l),r.className=l,h.render?h.render(r,t,h):r.appendChild(document.createTextNode(h.displayText||T(h))),r.hintId=n}var a=s.cursorCoords(o.options.alignWithWord?t.from:null),u=a.left,f=a.bottom,d=!0;c.style.left=u+"px",c.style.top=f+"px";var p=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),m=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(o.options.container||document.body).appendChild(c);var g=c.getBoundingClientRect(),v=g.bottom-m,y=c.scrollHeight>c.clientHeight+1,w=s.getScrollInfo();if(0<v){var H=g.bottom-g.top;if(0<a.top-(a.bottom-g.top)-H)c.style.top=(f=a.top-H)+"px",d=!1;else if(m<H){c.style.height=m-5+"px",c.style.top=(f=a.bottom-g.top)+"px";var k=s.getCursor();t.from.ch!=k.ch&&(a=s.cursorCoords(k),c.style.left=(u=a.left)+"px",g=c.getBoundingClientRect())}}var C,b=g.right-p;if(0<b&&(g.right-g.left>p&&(c.style.width=p-5+"px",b-=g.right-g.left-p),c.style.left=(u=a.left-b)+"px"),y)for(var x=c.firstChild;x;x=x.nextSibling)x.style.paddingRight=s.display.nativeBarWidth+"px";(s.addKeyMap(this.keyMap=function(t,n){var o={Up:function(){n.moveFocus(-1)},Down:function(){n.moveFocus(1)},PageUp:function(){n.moveFocus(1-n.menuSize(),!0)},PageDown:function(){n.moveFocus(n.menuSize()-1,!0)},Home:function(){n.setFocus(0)},End:function(){n.setFocus(n.length-1)},Enter:n.pick,Tab:n.pick,Esc:n.close},i=t.options.customKeys,s=i?{}:o;function e(t,i){var e;e="string"!=typeof i?function(t){return i(t,n)}:o.hasOwnProperty(i)?o[i]:i,s[t]=e}if(i)for(var c in i)i.hasOwnProperty(c)&&e(c,i[c]);var r=t.options.extraKeys;if(r)for(var c in r)r.hasOwnProperty(c)&&e(c,r[c]);return s}(o,{moveFocus:function(t,i){e.changeActive(e.selectedHint+t,i)},setFocus:function(t){e.changeActive(t)},menuSize:function(){return e.screenAmount()},length:i.length,close:function(){o.close()},pick:function(){e.pick()},data:t})),o.options.closeOnUnfocus)&&(s.on("blur",this.onBlur=function(){C=setTimeout(function(){o.close()},100)}),s.on("focus",this.onFocus=function(){clearTimeout(C)}));return s.on("scroll",this.onScroll=function(){var t=s.getScrollInfo(),i=s.getWrapperElement().getBoundingClientRect(),e=f+w.top-t.top,n=e-(window.pageYOffset||(document.documentElement||document.body).scrollTop);if(d||(n+=c.offsetHeight),n<=i.top||n>=i.bottom)return o.close();c.style.top=e+"px",c.style.left=u+w.left-t.left+"px"}),A.on(c,"dblclick",function(t){var i=M(c,t.target||t.srcElement);i&&null!=i.hintId&&(e.changeActive(i.hintId),e.pick())}),A.on(c,"click",function(t){var i=M(c,t.target||t.srcElement);i&&null!=i.hintId&&(e.changeActive(i.hintId),o.options.completeOnSingleClick&&e.pick())}),A.on(c,"mousedown",function(){setTimeout(function(){s.focus()},20)}),A.signal(t,"select",i[0],c.firstChild),!0}function r(t,i,e,n){if(t.async)t(i,n,e);else{var o=t(i,e);o&&o.then?o.then(n):n(o)}}o.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&A.signal(this.data,"close"),this.widget&&this.widget.close(),A.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,i){var e=t.list[i];e.hint?e.hint(this.cm,t,e):this.cm.replaceRange(T(e),e.from||t.from,e.to||t.to,"complete"),A.signal(t,"pick",e),this.close()},cursorActivity:function(){this.debounce&&(s(this.debounce),this.debounce=0);var t=this.cm.getCursor(),i=this.cm.getLine(t.line);if(t.line!=this.startPos.line||i.length-t.ch!=this.startLen-this.startPos.ch||t.ch<this.startPos.ch||this.cm.somethingSelected()||t.ch&&this.options.closeCharacters.test(i.charAt(t.ch-1)))this.close();else{var e=this;this.debounce=n(function(){e.update()}),this.widget&&this.widget.disable()}},update:function(i){if(null!=this.tick){var e=this,n=++this.tick;r(this.options.hint,this.cm,this.options,function(t){e.tick==n&&e.finishUpdate(t,i)})}},finishUpdate:function(t,i){this.data&&A.signal(this.data,"update");var e,n,o=this.widget&&this.widget.picked||i&&this.options.completeSingle;(this.widget&&this.widget.close(),t&&this.data&&(e=this.data,n=t,0<A.cmpPos(n.from,e.from)&&e.to.ch-e.from.ch!=n.to.ch-n.from.ch))||(this.data=t)&&t.list.length&&(o&&1==t.list.length?this.pick(t,0):(this.widget=new c(this,t),A.signal(t,"shown")))}},c.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var t=this.completion.cm;this.completion.options.closeOnUnfocus&&(t.off("blur",this.onBlur),t.off("focus",this.onFocus)),t.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var t=this;this.keyMap={Enter:function(){t.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,i){if(t>=this.data.list.length?t=i?this.data.list.length-1:0:t<0&&(t=i?0:this.data.list.length-1),this.selectedHint!=t){var e=this.hints.childNodes[this.selectedHint];e.className=e.className.replace(" "+S,""),(e=this.hints.childNodes[this.selectedHint=t]).className+=" "+S,e.offsetTop<this.hints.scrollTop?this.hints.scrollTop=e.offsetTop-3:e.offsetTop+e.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=e.offsetTop+e.offsetHeight-this.hints.clientHeight+3),A.signal(this.data,"select",this.data.list[this.selectedHint],e)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},A.registerHelper("hint","auto",{resolve:function(t,i){var e,c=t.getHelpers(i,"hint");if(c.length){var n=function(t,n,o){var s=function(t,i){if(!t.somethingSelected())return i;for(var e=[],n=0;n<i.length;n++)i[n].supportsSelection&&e.push(i[n]);return e}(t,c);!function i(e){if(e==s.length)return n(null);r(s[e],t,o,function(t){t&&0<t.list.length?n(t):i(e+1)})}(0)};return n.async=!0,n.supportsSelection=!0,n}return(e=t.getHelper(t.getCursor(),"hintWords"))?function(t){return A.hint.fromList(t,{words:e})}:A.hint.anyword?function(t,i){return A.hint.anyword(t,i)}:function(){}}}),A.registerHelper("hint","fromList",function(t,i){var e=t.getCursor(),n=t.getTokenAt(e),o=A.Pos(e.line,n.end);if(n.string&&/\w/.test(n.string[n.string.length-1]))var s=n.string,c=A.Pos(e.line,n.start);else s="",c=o;for(var r=[],h=0;h<i.words.length;h++){var l=i.words[h];l.slice(0,s.length)==s&&r.push(l)}if(r.length)return{list:r,from:c,to:o}}),A.commands.autocomplete=A.showHint;var h={hint:A.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null};A.defineOption("hintOptions",null)});
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(y){"use strict";var b=/[\w$]+/;y.registerHelper("hint","anyword",function(e,r){for(var t=r&&r.word||b,o=r&&r.range||500,i=e.getCursor(),n=e.getLine(i.line),f=i.ch,s=f;s&&t.test(n.charAt(s-1));)--s;for(var a=s!=f&&n.slice(s,f),c=r&&r.list||[],l={},d=new RegExp(t.source,"g"),u=-1;u<=1;u+=2)for(var p=i.line,g=Math.min(Math.max(p+u*o,e.firstLine()),e.lastLine())+u;p!=g;p+=u)for(var h,m=e.getLine(p);h=d.exec(m);)p==i.line&&h[0]===a||a&&0!=h[0].lastIndexOf(a,0)||Object.prototype.hasOwnProperty.call(l,h[0])||(l[h[0]]=!0,c.push(h[0]));return{list:c,from:y.Pos(i.line,s),to:y.Pos(i.line,f)}})});
!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&void 0!==module.exports?module.exports=t():"undefined"!=typeof Package?Sortable=t():window.Sortable=t()}(function(){"use strict";if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var C,E,x,N,k,B,p,v,m,Y,X,O,c,i,A,I,d,l,R,t,b={},o=/\s+/g,P="Sortable"+(new Date).getTime(),_=window,h=_.document,a=_.parseInt,e=_.jQuery||_.Zepto,n=_.Polymer,r=!!("draggable"in h.createElement("div")),s=!navigator.userAgent.match(/Trident.*rv[ :]?11\./)&&((t=h.createElement("x")).style.cssText="pointer-events:auto","auto"===t.style.pointerEvents),M=!1,D=Math.abs,u=Math.min,f=[],L=J(function(t,e,n){if(n&&e.scroll){var i,o,a,r,s,l,c=e.scrollSensitivity,d=e.scrollSpeed,h=t.clientX,u=t.clientY,f=window.innerWidth,g=window.innerHeight;if(v!==n&&(p=e.scroll,v=n,m=e.scrollFn,!0===p)){p=n;do{if(p.offsetWidth<p.scrollWidth||p.offsetHeight<p.scrollHeight)break}while(p=p.parentNode)}p&&(o=(i=p).getBoundingClientRect(),a=(D(o.right-h)<=c)-(D(o.left-h)<=c),r=(D(o.bottom-u)<=c)-(D(o.top-u)<=c)),a||r||(r=(g-u<=c)-(u<=c),((a=(f-h<=c)-(h<=c))||r)&&(i=_)),b.vx===a&&b.vy===r&&b.el===i||(b.el=i,b.vx=a,b.vy=r,clearInterval(b.pid),i&&(b.pid=setInterval(function(){if(l=r?r*d:0,s=a?a*d:0,"function"==typeof m)return m.call(_this,s,l,t);i===_?_.scrollTo(_.pageXOffset+s,_.pageYOffset+l):(i.scrollTop+=l,i.scrollLeft+=s)},24)))}},30),g=function(t){function e(i,o){return void 0!==i&&!0!==i||(i=n.name),"function"==typeof i?i:function(t,e){var n=e.options.group.name;return o?i:i&&(i.join?-1<i.indexOf(n):n==i)}}var n={},i=t.group;i&&"object"==typeof i||(i={name:i}),n.name=i.name,n.checkPull=e(i.pull,!0),n.checkPut=e(i.put),t.group=n};function U(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=K({},e),t[P]=this;var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0}};for(var i in n)!(i in e)&&(e[i]=n[i]);for(var o in g(e),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!e.forceFallback&&r,y(t,"mousedown",this._onTapStart),y(t,"touchstart",this._onTapStart),this.nativeDraggable&&(y(t,"dragover",this),y(t,"dragenter",this)),f.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function H(t){N&&N.state!==t&&(j(N,"display",t?"none":""),!t&&N.state&&k.insertBefore(N,C),N.state=t)}function W(t,e,n){if(t){n=n||h;do{if(">*"===e&&t.parentNode===n||Z(t,e))return t}while(void 0,t=(o=(i=t).host)&&o.nodeType?o:i.parentNode)}var i,o;return null}function y(t,e,n){t.addEventListener(e,n,!1)}function w(t,e,n){t.removeEventListener(e,n,!1)}function T(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(o," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(o," ")}}function j(t,e,n){var i=t&&t.style;if(i){if(void 0===n)return h.defaultView&&h.defaultView.getComputedStyle?n=h.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in i||(e="-webkit-"+e),i[e]=n+("string"==typeof n?"":"px")}}function S(t,e,n){if(t){var i=t.getElementsByTagName(e),o=0,a=i.length;if(n)for(;o<a;o++)n(i[o],o);return i}return[]}function F(t,e,n,i,o,a,r){t=t||e[P];var s=h.createEvent("Event"),l=t.options,c="on"+n.charAt(0).toUpperCase()+n.substr(1);s.initEvent(n,!0,!0),s.to=e,s.from=o||e,s.item=i||e,s.clone=N,s.oldIndex=a,s.newIndex=r,e.dispatchEvent(s),l[c]&&l[c].call(t,s)}function V(t,e,n,i,o,a,r){var s,l,c=t[P],d=c.options.onMove;return(s=h.createEvent("Event")).initEvent("move",!0,!0),s.to=e,s.from=t,s.dragged=n,s.draggedRect=i,s.related=o||e,s.relatedRect=a||e.getBoundingClientRect(),t.dispatchEvent(s),d&&(l=d.call(c,s,r)),l}function q(t){t.draggable=!1}function z(){M=!1}function G(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function Q(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"===t.nodeName.toUpperCase()||">*"!==e&&!Z(t,e)||n++;return n}function Z(t,e){if(t){var n=(e=e.split(".")).shift().toUpperCase(),i=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");return!(""!==n&&t.nodeName.toUpperCase()!=n||e.length&&((" "+t.className+" ").match(i)||[]).length!=e.length)}return!1}function J(t,e){var n,i;return function(){void 0===n&&(n=arguments,i=this,setTimeout(function(){1===n.length?t.call(i,n[0]):t.apply(i,n),n=void 0},e))}}function K(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function $(t){return e?e(t).clone(!0)[0]:n&&n.dom?n.dom(t).cloneNode(!0):t.cloneNode(!0)}return U.prototype={constructor:U,_onTapStart:function(t){if("i"!=t.target.tagName&&"I"!=t.target.tagName){var e,n=this,i=this.el,o=this.options,a=t.type,r=t.touches&&t.touches[0],s=(r||t).target,l=t.target.shadowRoot&&t.path[0]||s,c=o.filter;if(!C&&!("mousedown"===a&&0!==t.button||o.disabled)&&(!o.handle||W(l,o.handle,i))&&(s=W(s,o.draggable,i))){if(e=Q(s,o.draggable),"function"==typeof c){if(c.call(this,t,s,this))return F(n,l,"filter",s,i,e),void t.preventDefault()}else if(c&&(c=c.split(",").some(function(t){if(t=W(l,t.trim(),i))return F(n,t,"filter",s,i,e),!0})))return void t.preventDefault();this._prepareDragStart(t,r,s,e)}}else t.target.click()},_prepareDragStart:function(t,e,n,i){var o,a=this,r=a.el,s=a.options,l=r.ownerDocument;n&&!C&&n.parentNode===r&&(d=t,k=r,E=(C=n).parentNode,B=C.nextSibling,A=s.group,c=i,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,C.style["will-change"]="transform",o=function(){a._disableDelayedDrag(),C.draggable=a.nativeDraggable,T(C,s.chosenClass,!0),a._triggerDragStart(e),F(a,k,"choose",C,k,c)},s.ignore.split(",").forEach(function(t){S(C,t.trim(),q)}),y(l,"mouseup",a._onDrop),y(l,"touchend",a._onDrop),y(l,"touchcancel",a._onDrop),s.delay?(y(l,"mouseup",a._disableDelayedDrag),y(l,"touchend",a._disableDelayedDrag),y(l,"touchcancel",a._disableDelayedDrag),y(l,"mousemove",a._disableDelayedDrag),y(l,"touchmove",a._disableDelayedDrag),a._dragStartTimer=setTimeout(o,s.delay)):o())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),w(t,"mouseup",this._disableDelayedDrag),w(t,"touchend",this._disableDelayedDrag),w(t,"touchcancel",this._disableDelayedDrag),w(t,"mousemove",this._disableDelayedDrag),w(t,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(t){t?(d={target:C,clientX:t.clientX,clientY:t.clientY},this._onDragStart(d,"touch")):this.nativeDraggable?(y(C,"dragend",this),y(k,"dragstart",this._onDragStart)):this._onDragStart(d,!0);try{h.selection?setTimeout(function(){h.selection.empty()}):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(){if(k&&C){var t=this.options;T(C,t.ghostClass,!0),T(C,t.dragClass,!1),F(U.active=this,k,"start",C,k,c)}},_emulateDragOver:function(){if(l){if(this._lastX===l.clientX&&this._lastY===l.clientY)return;this._lastX=l.clientX,this._lastY=l.clientY,s||j(x,"display","none");var t=h.elementFromPoint(l.clientX,l.clientY),e=t,n=f.length;if(e)do{if(e[P]){for(;n--;)f[n]({clientX:l.clientX,clientY:l.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);s||j(x,"display","")}},_onTouchMove:function(t){if(d){var e=this.options,n=e.fallbackTolerance,i=e.fallbackOffset,o=t.touches?t.touches[0]:t,a=o.clientX-d.clientX+i.x,r=o.clientY-d.clientY+i.y,s=t.touches?"translate3d("+a+"px,"+r+"px,0)":"translate("+a+"px,"+r+"px)";if(!U.active){if(n&&u(D(o.clientX-this._lastX),D(o.clientY-this._lastY))<n)return;this._dragStarted()}this._appendGhost(),R=!0,l=o,j(x,"webkitTransform",s),j(x,"mozTransform",s),j(x,"msTransform",s),j(x,"transform",s),t.preventDefault()}},_appendGhost:function(){if(!x){var t,e=C.getBoundingClientRect(),n=j(C),i=this.options;T(x=C.cloneNode(!0),i.ghostClass,!1),T(x,i.fallbackClass,!0),T(x,i.dragClass,!0),j(x,"top",e.top-a(n.marginTop,10)),j(x,"left",e.left-a(n.marginLeft,10)),j(x,"width",e.width),j(x,"height",e.height),j(x,"opacity","0.8"),j(x,"position","fixed"),j(x,"zIndex","100000"),j(x,"pointerEvents","none"),i.fallbackOnBody&&h.body.appendChild(x)||k.appendChild(x),t=x.getBoundingClientRect(),j(x,"width",2*e.width-t.width),j(x,"height",2*e.height-t.height)}},_onDragStart:function(t,e){var n=t.dataTransfer,i=this.options;this._offUpEvents(),"clone"==A.checkPull(this,this,C,t)&&(j(N=$(C),"display","none"),k.insertBefore(N,C),F(this,k,"clone",C)),T(C,i.dragClass,!0),e?("touch"===e?(y(h,"touchmove",this._onTouchMove),y(h,"touchend",this._onDrop),y(h,"touchcancel",this._onDrop)):(y(h,"mousemove",this._onTouchMove),y(h,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(n&&(n.effectAllowed="move",i.setData&&i.setData.call(this,n,C)),y(h,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(t){var e,n,i,o,a,r,s,l=this.el,c=this.options,d=c.group,h=U.active,u=A===d,f=c.sort;if(void 0!==t.preventDefault&&(t.preventDefault(),!c.dragoverBubble&&t.stopPropagation()),R=!0,A&&!c.disabled&&(u?f||(o=!k.contains(C)):I===this||A.checkPull(this,h,C,t)&&d.checkPut(this,h,C,t))&&(void 0===t.rootEl||t.rootEl===this.el)){if(L(t,c,this.el),M)return;if(e=W(t.target,c.draggable,l),n=C.getBoundingClientRect(),I=this,o)return H(!0),E=k,void(N||B?k.insertBefore(C,N||B):f||k.appendChild(C));if(0===l.children.length||l.children[0]===x||l===t.target&&(a=t,r=l.lastElementChild,s=r.getBoundingClientRect(),e=(5<a.clientY-(s.top+s.height)||5<a.clientX-(s.right+s.width))&&r)){if(e){if(e.animated)return;i=e.getBoundingClientRect()}H(u),!1!==V(k,l,C,n,e,i,t)&&(C.contains(l)||(l.appendChild(C),E=l),this._animate(n,C),e&&this._animate(i,e))}else if(e&&!e.animated&&e!==C&&void 0!==e.parentNode[P]){Y!==e&&(X=j(Y=e),O=j(e.parentNode));var g,p=(i=e.getBoundingClientRect()).right-i.left,v=i.bottom-i.top,m=/left|right|inline/.test(X.cssFloat+X.display)||"flex"==O.display&&0===O["flex-direction"].indexOf("row"),b=e.offsetWidth>C.offsetWidth,_=e.offsetHeight>C.offsetHeight,D=.5<(m?(t.clientX-i.left)/p:(t.clientY-i.top)/v),y=e.nextElementSibling,w=V(k,l,C,n,e,i,t);if(!1!==w){if(M=!0,setTimeout(z,30),H(u),1===w||-1===w)g=1===w;else if(m){var T=C.offsetTop,S=e.offsetTop;g=T===S?e.previousElementSibling===C&&!b||D&&b:e.previousElementSibling===C||C.previousElementSibling===e?.5<(t.clientY-i.top)/v:T<S}else g=y!==C&&!_||D&&_;C.contains(l)||(g&&!y?l.appendChild(C):e.parentNode.insertBefore(C,g?y:e)),E=C.parentNode,this._animate(n,C),this._animate(i,e)}}}},_animate:function(t,e){var n=this.options.animation;if(n){var i=e.getBoundingClientRect();j(e,"transition","none"),j(e,"transform","translate3d("+(t.left-i.left)+"px,"+(t.top-i.top)+"px,0)"),e.offsetWidth,j(e,"transition","all "+n+"ms"),j(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=setTimeout(function(){j(e,"transition",""),j(e,"transform",""),e.animated=!1},n)}},_offUpEvents:function(){var t=this.el.ownerDocument;w(h,"touchmove",this._onTouchMove),w(t,"mouseup",this._onDrop),w(t,"touchend",this._onDrop),w(t,"touchcancel",this._onDrop)},_onDrop:function(t){var e=this.el,n=this.options;clearInterval(this._loopId),clearInterval(b.pid),clearTimeout(this._dragStartTimer),w(h,"mousemove",this._onTouchMove),this.nativeDraggable&&(w(h,"drop",this),w(e,"dragstart",this._onDragStart)),this._offUpEvents(),t&&(R&&(t.preventDefault(),!n.dropBubble&&t.stopPropagation()),x&&x.parentNode.removeChild(x),C&&(this.nativeDraggable&&w(C,"dragend",this),q(C),C.style["will-change"]="",T(C,this.options.ghostClass,!1),T(C,this.options.chosenClass,!1),k!==E?0<=(i=Q(C,n.draggable))&&(F(null,E,"add",C,k,c,i),F(this,k,"remove",C,k,c,i),F(null,E,"sort",C,k,c,i),F(this,k,"sort",C,k,c,i)):(N&&N.parentNode.removeChild(N),C.nextSibling!==B&&0<=(i=Q(C,n.draggable))&&(F(this,k,"update",C,k,c,i),F(this,k,"sort",C,k,c,i))),U.active&&(null!=i&&-1!==i||(i=c),F(this,k,"end",C,k,c,i),this.save()))),this._nulling()},_nulling:function(){k=C=E=x=B=N=p=v=d=l=R=i=Y=X=I=A=U.active=null},handleEvent:function(t){var e=t.type;"dragover"===e||"dragenter"===e?C&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move");t.preventDefault()}(t)):"drop"!==e&&"dragend"!==e||this._onDrop(t)},toArray:function(){for(var t,e=[],n=this.el.children,i=0,o=n.length,a=this.options;i<o;i++)W(t=n[i],a.draggable,this.el)&&e.push(t.getAttribute(a.dataIdAttr)||G(t));return e},sort:function(t){var i={},o=this.el;this.toArray().forEach(function(t,e){var n=o.children[e];W(n,this.options.draggable,o)&&(i[t]=n)},this),t.forEach(function(t){i[t]&&(o.removeChild(i[t]),o.appendChild(i[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return W(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];n[t]=e,"group"===t&&g(n)},destroy:function(){var t=this.el;t[P]=null,w(t,"mousedown",this._onTapStart),w(t,"touchstart",this._onTapStart),this.nativeDraggable&&(w(t,"dragover",this),w(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),f.splice(f.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},U.utils={on:y,off:w,css:j,find:S,is:function(t,e){return!!W(t,e,t)},extend:K,throttle:J,closest:W,toggleClass:T,clone:$,index:Q},U.create=function(t,e){return new U(t,e)},U.version="1.4.2",U});
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(ge){ge.fn.jScrollPane=function(o){function i(v,e){function m(e){var t,o,i,n,s,r,a,l,c,p,d,u,f,h,j=!1,g=!1;if(M=e,void 0===X)s=v.scrollTop(),r=v.scrollLeft(),v.css({overflow:"hidden",padding:0}),R=v.innerWidth()+ue,I=v.innerHeight(),v.width(R),X=ge('<div class="jspPane" />').css("padding",de).append(v.children()),F=ge('<div class="jspContainer" />').css({width:R+"px",height:I+"px"}).append(X).appendTo(v);else{if(v.css("width",""),j=M.stickToBottom&&(20<(l=q-I)&&l-Y()<10),g=M.stickToRight&&(20<(a=L-R)&&a-W()<10),(n=v.innerWidth()+ue!=R||v.outerHeight()!=I)&&(R=v.innerWidth()+ue,I=v.innerHeight(),F.css({width:R+"px",height:I+"px"})),!n&&fe==L&&X.outerHeight()==q)return void v.width(R);fe=L,X.css("width",""),v.width(R),F.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}X.css("overflow","auto"),L=e.contentWidth?e.contentWidth:X[0].scrollWidth,q=X[0].scrollHeight,X.css("overflow",""),V=1<(E=q/I),(G=1<(O=L/R))||V?(v.addClass("jspScrollable"),(t=M.maintainPosition&&(Q||J))&&(o=W(),i=Y()),V&&(F.append(ge('<div class="jspVerticalBar" />').append(ge('<div class="jspCap jspCapTop" />'),ge('<div class="jspTrack" />').append(ge('<div class="jspDrag" />').append(ge('<div class="jspDragTop" />'),ge('<div class="jspDragBottom" />'))),ge('<div class="jspCap jspCapBottom" />'))),Z=F.find(">.jspVerticalBar"),_=Z.find(">.jspTrack"),N=_.find(">.jspDrag"),M.showArrows&&(oe=ge('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",k(0,-1)).bind("click.jsp",z),ie=ge('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",k(0,1)).bind("click.jsp",z),M.arrowScrollOnHover&&(oe.bind("mouseover.jsp",k(0,-1,oe)),ie.bind("mouseover.jsp",k(0,1,ie))),y(_,M.verticalArrowPositions,oe,ie)),ee=I,F.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){ee-=ge(this).outerHeight()}),N.hover(function(){N.addClass("jspHover")},function(){N.removeClass("jspHover")}).bind("mousedown.jsp",function(e){ge("html").bind("dragstart.jsp selectstart.jsp",z),N.addClass("jspActive");var t=e.pageY-N.position().top;return ge("html").bind("mousemove.jsp",function(e){B(e.pageY-t,!1)}).bind("mouseup.jsp mouseleave.jsp",T),!1}),b()),G&&(F.append(ge('<div class="jspHorizontalBar" />').append(ge('<div class="jspCap jspCapLeft" />'),ge('<div class="jspTrack" />').append(ge('<div class="jspDrag" />').append(ge('<div class="jspDragLeft" />'),ge('<div class="jspDragRight" />'))),ge('<div class="jspCap jspCapRight" />'))),ne=F.find(">.jspHorizontalBar"),se=ne.find(">.jspTrack"),U=se.find(">.jspDrag"),M.showArrows&&(le=ge('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",k(-1,0)).bind("click.jsp",z),ce=ge('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",k(1,0)).bind("click.jsp",z),M.arrowScrollOnHover&&(le.bind("mouseover.jsp",k(-1,0,le)),ce.bind("mouseover.jsp",k(1,0,ce))),y(se,M.horizontalArrowPositions,le,ce)),U.hover(function(){U.addClass("jspHover")},function(){U.removeClass("jspHover")}).bind("mousedown.jsp",function(e){ge("html").bind("dragstart.jsp selectstart.jsp",z),U.addClass("jspActive");var t=e.pageX-U.position().left;return ge("html").bind("mousemove.jsp",function(e){x(e.pageX-t,!1)}).bind("mouseup.jsp mouseleave.jsp",T),!1}),re=F.innerWidth(),w()),function(){if(G&&V){var e=se.outerHeight(),t=_.outerWidth();ee-=e,ge(ne).find(">.jspCap:visible,>.jspArrow").each(function(){re+=ge(this).outerWidth()}),re-=t,I-=t,R-=e,se.parent().append(ge('<div class="jspCorner" />').css("width",e+"px")),b(),w()}G&&X.width(F.outerWidth()-ue+"px"),q=X.outerHeight(),E=q/I,G&&((ae=Math.ceil(1/O*re))>M.horizontalDragMaxWidth?ae=M.horizontalDragMaxWidth:ae<M.horizontalDragMinWidth&&(ae=M.horizontalDragMinWidth),U.width(ae+"px"),$=re-ae,H(J)),V&&((te=Math.ceil(1/E*ee))>M.verticalDragMaxHeight?te=M.verticalDragMaxHeight:te<M.verticalDragMinHeight&&(te=M.verticalDragMinHeight),N.height(te+"px"),K=ee-te,D(Q))}(),t&&(S(g?L-R:o,!1),P(j?q-I:i,!1)),X.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){A(e.target,!1)}),F.unbind(je).bind(je,function(e,t,o,i){J||(J=0),Q||(Q=0);var n=J,s=Q,r=e.deltaFactor||M.mouseWheelSpeed;return he.scrollBy(o*r,-i*r,!1),n==J&&s==Q}),h=!1,F.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(e){var t=e.originalEvent.touches[0];c=W(),p=Y(),d=t.pageX,u=t.pageY,h=!(f=!1)}).bind("touchmove.jsp",function(e){if(h){var t=e.originalEvent.touches[0],o=J,i=Q;return he.scrollTo(c+d-t.pageX,p+u-t.pageY),f=f||5<Math.abs(d-t.pageX)||5<Math.abs(u-t.pageY),o==J&&i==Q}}).bind("touchend.jsp",function(){h=!1}).bind("click.jsp-touchclick",function(){return f?f=!1:void 0}),M.enableKeyboardNavigation&&function(){function i(){var e=J,t=Q;switch(n){case 40:he.scrollByY(M.keyboardSpeed,!1);break;case 38:he.scrollByY(-M.keyboardSpeed,!1);break;case 34:case 32:he.scrollByY(I*M.scrollPagePercent,!1);break;case 33:he.scrollByY(-I*M.scrollPagePercent,!1);break;case 39:he.scrollByX(M.keyboardSpeed,!1);break;case 37:he.scrollByX(-M.keyboardSpeed,!1)}return s=e!=J||t!=Q}var n,s,r=[];G&&r.push(ne[0]),V&&r.push(Z[0]),X.bind("focus.jsp",function(){v.focus()}),v.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(e){if(e.target===this||r.length&&ge(e.target).closest(r).length){var t=J,o=Q;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:n=e.keyCode,i();break;case 35:P(q-I),n=null;break;case 36:P(0),n=null}return!(s=e.keyCode==n&&t!=J||o!=Q)}}).bind("keypress.jsp",function(e){return e.keyCode==n&&i(),e.target===this||r.length&&ge(e.target).closest(r).length?!s:void 0}),M.hideFocus?(v.css("outline","none"),"hideFocus"in F[0]&&v.attr("hideFocus",!0)):(v.css("outline",""),"hideFocus"in F[0]&&v.attr("hideFocus",!1))}(),M.clickOnTrack&&(C(),V&&_.bind("mousedown.jsp",function(n){if(void 0===n.originalTarget||n.originalTarget==n.currentTarget){var s,r=ge(this),e=r.offset(),a=n.pageY-e.top-Q,l=!0,c=function(){var e=r.offset(),t=n.pageY-e.top-te/2,o=I*M.scrollPagePercent,i=K*o/(q-I);if(a<0)t<Q-i?he.scrollByY(-o):B(t);else{if(!(0<a))return void p();Q+i<t?he.scrollByY(o):B(t)}s=setTimeout(c,l?M.initialDelay:M.trackClickRepeatFreq),l=!1},p=function(){s&&clearTimeout(s),s=null,ge(document).unbind("mouseup.jsp",p)};return c(),ge(document).bind("mouseup.jsp",p),!1}}),G&&se.bind("mousedown.jsp",function(n){if(void 0===n.originalTarget||n.originalTarget==n.currentTarget){var s,r=ge(this),e=r.offset(),a=n.pageX-e.left-J,l=!0,c=function(){var e=r.offset(),t=n.pageX-e.left-ae/2,o=R*M.scrollPagePercent,i=$*o/(L-R);if(a<0)t<J-i?he.scrollByX(-o):x(t);else{if(!(0<a))return void p();J+i<t?he.scrollByX(o):x(t)}s=setTimeout(c,l?M.initialDelay:M.trackClickRepeatFreq),l=!1},p=function(){s&&clearTimeout(s),s=null,ge(document).unbind("mouseup.jsp",p)};return c(),ge(document).bind("mouseup.jsp",p),!1}})),function(){if(location.hash&&1<location.hash.length){var e,t,o=escape(location.hash.substr(1));try{e=ge("#"+o+', a[name="'+o+'"]')}catch(e){return}e.length&&X.find(o)&&(0===F.scrollTop()?t=setInterval(function(){0<F.scrollTop()&&(A(e,!0),ge(document).scrollTop(F.position().top),clearInterval(t))},50):(A(e,!0),ge(document).scrollTop(F.position().top)))}}(),M.hijackInternalLinks&&(ge(document.body).data("jspHijack")||(ge(document.body).data("jspHijack",!0),ge(document.body).delegate('a[href*="#"]',"click",function(e){var t,o,i,n,s,r=this.href.substr(0,this.href.indexOf("#")),a=location.href;if(-1!==location.href.indexOf("#")&&(a=location.href.substr(0,location.href.indexOf("#"))),r===a){t=escape(this.href.substr(this.href.indexOf("#")+1));try{o=ge("#"+t+', a[name="'+t+'"]')}catch(e){return}o.length&&((i=o.closest(".jspScrollable")).data("jsp").scrollToElement(o,!0),i[0].scrollIntoView&&(n=ge(window).scrollTop(),((s=o.offset().top)<n||s>n+ge(window).height())&&i[0].scrollIntoView()),e.preventDefault())}})))):(v.removeClass("jspScrollable"),X.css({top:0,left:0,width:F.width()-ue}),F.unbind(je),X.find(":input,a").unbind("focus.jsp"),v.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),X.unbind(".jsp"),C()),M.autoReinitialise&&!pe?pe=setInterval(function(){m(M)},M.autoReinitialiseDelay):!M.autoReinitialise&&pe&&clearInterval(pe),s&&v.scrollTop(0)&&P(s,!1),r&&v.scrollLeft(0)&&S(r,!1),v.trigger("jsp-initialised",[G||V])}function b(){_.height(ee+"px"),Q=0,t=M.verticalGutter+_.outerWidth(),X.width(R-t-ue);try{0===Z.position().left&&X.css("margin-left",t+"px")}catch(e){}}function w(){F.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){re-=ge(this).outerWidth()}),se.width(re+"px"),J=0}function y(e,t,o,i){var n,s="before",r="after";"os"==t&&(t=/Mac/.test(navigator.platform)?"after":"split"),t==s?r=t:t==r&&(s=t,n=o,o=i,i=n),e[s](o)[r](i)}function k(e,t,o){return function(){return function(e,t,o,i){o=ge(o).addClass("jspActive");var n,s,r=!0,a=function(){0!==e&&he.scrollByX(e*M.arrowButtonSpeed),0!==t&&he.scrollByY(t*M.arrowButtonSpeed),s=setTimeout(a,r?M.initialDelay:M.arrowRepeatFreq),r=!1};a(),n=i?"mouseout.jsp":"mouseup.jsp",(i=i||ge("html")).bind(n,function(){o.removeClass("jspActive"),s&&clearTimeout(s),s=null,i.unbind(n)})}(e,t,this,o),this.blur(),!1}}function C(){se&&se.unbind("mousedown.jsp"),_&&_.unbind("mousedown.jsp")}function T(){ge("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),N&&N.removeClass("jspActive"),U&&U.removeClass("jspActive")}function B(e,t){if(V){e<0?e=0:K<e&&(e=K);var o=new ge.Event("jsp-will-scroll-y");if(v.trigger(o,[e]),!o.isDefaultPrevented()){var i=e||0,n=0===i,s=i==K,r=-(e/K)*(q-I);void 0===t&&(t=M.animateScroll),t?he.animate(N,"top",e,D,function(){v.trigger("jsp-user-scroll-y",[-r,n,s])}):(N.css("top",e),D(e),v.trigger("jsp-user-scroll-y",[-r,n,s]))}}}function D(e){void 0===e&&(e=N.position().top),F.scrollTop(0);var t,o,i=0===(Q=e||0),n=Q==K,s=-(e/K)*(q-I);(r!=i||l!=n)&&(r=i,l=n,v.trigger("jsp-arrow-change",[r,l,a,c])),t=i,o=n,M.showArrows&&(oe[t?"addClass":"removeClass"]("jspDisabled"),ie[o?"addClass":"removeClass"]("jspDisabled")),X.css("top",s),v.trigger("jsp-scroll-y",[-s,i,n]).trigger("scroll")}function x(e,t){if(G){e<0?e=0:$<e&&(e=$);var o=new ge.Event("jsp-will-scroll-x");if(v.trigger(o,[e]),!o.isDefaultPrevented()){var i=e||0,n=0===i,s=i==$,r=-(e/$)*(L-R);void 0===t&&(t=M.animateScroll),t?he.animate(U,"left",e,H,function(){v.trigger("jsp-user-scroll-x",[-r,n,s])}):(U.css("left",e),H(e),v.trigger("jsp-user-scroll-x",[-r,n,s]))}}}function H(e){void 0===e&&(e=U.position().left),F.scrollTop(0);var t,o,i=0===(J=e||0),n=J==$,s=-(e/$)*(L-R);(a!=i||c!=n)&&(a=i,c=n,v.trigger("jsp-arrow-change",[r,l,a,c])),t=i,o=n,M.showArrows&&(le[t?"addClass":"removeClass"]("jspDisabled"),ce[o?"addClass":"removeClass"]("jspDisabled")),X.css("left",s),v.trigger("jsp-scroll-x",[-s,i,n]).trigger("scroll")}function P(e,t){B(e/(q-I)*K,t)}function S(e,t){x(e/(L-R)*$,t)}function A(e,t,o){var i,n,s,r,a,l,c,p,d,u=0,f=0;try{i=ge(e)}catch(e){return}for(n=i.outerHeight(),s=i.outerWidth(),F.scrollTop(0),F.scrollLeft(0);!i.is(".jspPane");)if(u+=i.position().top,f+=i.position().left,i=i.offsetParent(),/^body|html$/i.test(i[0].nodeName))return;l=(r=Y())+I,u<r||t?p=u-M.horizontalGutter:l<u+n&&(p=u-I+n+M.horizontalGutter),isNaN(p)||P(p,o),c=(a=W())+R,f<a||t?d=f-M.horizontalGutter:c<f+s&&(d=f-R+s+M.horizontalGutter),isNaN(d)||S(d,o)}function W(){return-X.position().left}function Y(){return-X.position().top}function z(){return!1}var M,X,R,I,F,L,q,O,E,V,G,N,K,Q,U,$,J,Z,_,t,ee,te,oe,ie,ne,se,re,ae,le,ce,pe,de,ue,fe,he=this,r=!0,a=!0,l=!1,c=!1,o=v.clone(!1,!1).empty(),je=ge.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";ue="border-box"===v.css("box-sizing")?de=0:(de=v.css("paddingTop")+" "+v.css("paddingRight")+" "+v.css("paddingBottom")+" "+v.css("paddingLeft"),(parseInt(v.css("paddingLeft"),10)||0)+(parseInt(v.css("paddingRight"),10)||0)),ge.extend(he,{reinitialise:function(e){m(e=ge.extend({},M,e))},scrollToElement:function(e,t,o){A(e,t,o)},scrollTo:function(e,t,o){S(e,o),P(t,o)},scrollToX:function(e,t){S(e,t)},scrollToY:function(e,t){P(e,t)},scrollToPercentX:function(e,t){S(e*(L-R),t)},scrollToPercentY:function(e,t){P(e*(q-I),t)},scrollBy:function(e,t,o){he.scrollByX(e,o),he.scrollByY(t,o)},scrollByX:function(e,t){x((W()+Math[e<0?"floor":"ceil"](e))/(L-R)*$,t)},scrollByY:function(e,t){B((Y()+Math[e<0?"floor":"ceil"](e))/(q-I)*K,t)},positionDragX:function(e,t){x(e,t)},positionDragY:function(e,t){B(e,t)},animate:function(e,t,o,i,n){var s={};s[t]=o,e.animate(s,{duration:M.animateDuration,easing:M.animateEase,queue:!1,step:i,complete:n})},getContentPositionX:function(){return W()},getContentPositionY:function(){return Y()},getContentWidth:function(){return L},getContentHeight:function(){return q},getPercentScrolledX:function(){return W()/(L-R)},getPercentScrolledY:function(){return Y()/(q-I)},getIsScrollableH:function(){return G},getIsScrollableV:function(){return V},getContentPane:function(){return X},scrollToBottom:function(e){B(K,e)},hijackInternalLinks:ge.noop,destroy:function(){var e,t;e=Y(),t=W(),v.removeClass("jspScrollable").unbind(".jsp"),X.unbind(".jsp"),v.replaceWith(o.append(X.children())),o.scrollTop(e),o.scrollLeft(t),pe&&clearInterval(pe)}}),m(e)}return o=ge.extend({},ge.fn.jScrollPane.defaults,o),ge.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){o[this]=o[this]||o.speed}),this.each(function(){var e=ge(this),t=e.data("jsp");t?t.reinitialise(o):(ge("script",e).filter('[type="text/javascript"],:not([type])').remove(),t=new i(e,o),e.data("jsp",t))})},ge.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}});
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.html2canvas=t()}}(function(){return function i(a,s,c){function h(n,t){if(!s[n]){if(!a[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(l)return l(n,!0);var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var r=s[n]={exports:{}};a[n][0].call(r.exports,function(t){var e=a[n][1][t];return h(e||t)},r,r.exports,i,a,s,c)}return s[n].exports}for(var l="function"==typeof require&&require,t=0;t<c.length;t++)h(c[t]);return h}({1:[function(t,L,M){(function(P){!function(t){function y(t){throw RangeError(g[t])}function n(t,e){for(var n=t.length;n--;)t[n]=e(t[n]);return t}function e(t,e){return n(t.split(f),e).join(".")}function w(t){for(var e,n,o=[],r=0,i=t.length;r<i;)55296<=(e=t.charCodeAt(r++))&&e<=56319&&r<i?56320==(64512&(n=t.charCodeAt(r++)))?o.push(((1023&e)<<10)+(1023&n)+65536):(o.push(e),r--):o.push(e);return o}function v(t){return n(t,function(t){var e="";return 65535<t&&(e+=A((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+A(t)}).join("")}function b(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function x(t,e,n){var o=0;for(t=n?O(t/d):t>>1,t+=O(t/e);m*C>>1<t;o+=T)t=O(t/m);return O(o+(m+1)*t/(t+l))}function o(t){var e,n,o,r,i,a,s,c,h,l,d,u=[],p=t.length,f=0,g=I,m=S;for((n=t.lastIndexOf(R))<0&&(n=0),o=0;o<n;++o)128<=t.charCodeAt(o)&&y("not-basic"),u.push(t.charCodeAt(o));for(r=0<n?n+1:0;r<p;){for(i=f,a=1,s=T;p<=r&&y("invalid-input"),d=t.charCodeAt(r++),(T<=(c=d-48<10?d-22:d-65<26?d-65:d-97<26?d-97:T)||c>O((E-f)/a))&&y("overflow"),f+=c*a,!(c<(h=s<=m?k:m+C<=s?C:s-m));s+=T)a>O(E/(l=T-h))&&y("overflow"),a*=l;m=x(f-i,e=u.length+1,0==i),O(f/e)>E-g&&y("overflow"),g+=O(f/e),f%=e,u.splice(f++,0,g)}return v(u)}function r(t){var e,n,o,r,i,a,s,c,h,l,d,u,p,f,g,m=[];for(u=(t=w(t)).length,e=I,i=S,a=n=0;a<u;++a)(d=t[a])<128&&m.push(A(d));for(o=r=m.length,r&&m.push(R);o<u;){for(s=E,a=0;a<u;++a)e<=(d=t[a])&&d<s&&(s=d);for(s-e>O((E-n)/(p=o+1))&&y("overflow"),n+=(s-e)*p,e=s,a=0;a<u;++a)if((d=t[a])<e&&++n>E&&y("overflow"),d==e){for(c=n,h=T;!(c<(l=h<=i?k:i+C<=h?C:h-i));h+=T)g=c-l,f=T-l,m.push(A(b(l+g%f,0))),c=O(g/f);m.push(A(b(c,0))),i=x(n,p,o==r),n=0,++o}++n,++e}return m.join("")}var i="object"==typeof M&&M,a="object"==typeof L&&L&&L.exports==i&&L,s="object"==typeof P&&P;(s.global===s||s.window===s)&&(t=s);var c,h,E=2147483647,T=36,k=1,C=26,l=38,d=700,S=72,I=128,R="-",u=/^xn--/,p=/[^ -~]/,f=/\x2E|\u3002|\uFF0E|\uFF61/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=T-k,O=Math.floor,A=String.fromCharCode;if(c={version:"1.2.4",ucs2:{decode:w,encode:v},decode:o,encode:r,toASCII:function(t){return e(t,function(t){return p.test(t)?"xn--"+r(t):t})},toUnicode:function(t){return e(t,function(t){return u.test(t)?o(t.slice(4).toLowerCase()):t})}},i&&!i.nodeType)if(a)a.exports=c;else for(h in c)c.hasOwnProperty(h)&&(i[h]=c[h]);else t.punycode=c}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e){function r(t,e){for(var n=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),o=t.firstChild;o;)(!0===e||1!==o.nodeType||"SCRIPT"!==o.nodeName)&&n.appendChild(r(o,e)),o=o.nextSibling;return 1===t.nodeType&&(n._scrollTop=t.scrollTop,n._scrollLeft=t.scrollLeft,"CANVAS"===t.nodeName?function(e,t){try{t&&(t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e.getContext("2d").getImageData(0,0,e.width,e.height),0,0))}catch(t){i("Unable to copy canvas content from",e,t)}}(t,n):("TEXTAREA"===t.nodeName||"SELECT"===t.nodeName)&&(n.value=t.value)),n}var i=t("./log");e.exports=function(i,t,e,n,a,s,c){var h=r(i.documentElement,a.javascriptEnabled),l=t.createElement("iframe");return l.className="html2canvas-container",l.style.visibility="hidden",l.style.position="fixed",l.style.left="-10000px",l.style.top="0px",l.style.border="0",l.width=e,l.height=n,l.scrolling="no",t.body.appendChild(l),new Promise(function(e){var t,n,o,r=l.contentWindow.document;l.contentWindow.onload=l.onload=function(){var t=setInterval(function(){0<r.body.childNodes.length&&(function t(e){if(1===e.nodeType){e.scrollTop=e._scrollTop,e.scrollLeft=e._scrollLeft;for(var n=e.firstChild;n;)t(n),n=n.nextSibling}}(r.documentElement),clearInterval(t),"view"===a.type&&(l.contentWindow.scrollTo(s,c),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||l.contentWindow.scrollY===c&&l.contentWindow.scrollX===s||(r.documentElement.style.top=-c+"px",r.documentElement.style.left=-s+"px",r.documentElement.style.position="absolute")),e(l))},50)},r.open(),r.write("<!DOCTYPE html><html></html>"),n=s,o=c,!(t=i).defaultView||n===t.defaultView.pageXOffset&&o===t.defaultView.pageYOffset||t.defaultView.scrollTo(n,o),r.replaceChild(r.adoptNode(h),r.documentElement),r.close()})}},{"./log":13}],3:[function(t,e){function n(t){this.r=0,this.g=0,this.b=0,this.a=null,this.fromArray(t)||this.namedColor(t)||this.rgb(t)||this.rgba(t)||this.hex6(t)||this.hex3(t)}n.prototype.darken=function(t){var e=1-t;return new n([Math.round(this.r*e),Math.round(this.g*e),Math.round(this.b*e),this.a])},n.prototype.isTransparent=function(){return 0===this.a},n.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},n.prototype.fromArray=function(t){return Array.isArray(t)&&(this.r=Math.min(t[0],255),this.g=Math.min(t[1],255),this.b=Math.min(t[2],255),3<t.length&&(this.a=t[3])),Array.isArray(t)};var o=/^#([a-f0-9]{3})$/i;n.prototype.hex3=function(t){var e;return null!==(e=t.match(o))&&(this.r=parseInt(e[1][0]+e[1][0],16),this.g=parseInt(e[1][1]+e[1][1],16),this.b=parseInt(e[1][2]+e[1][2],16)),null!==e};var r=/^#([a-f0-9]{6})$/i;n.prototype.hex6=function(t){var e=null;return null!==(e=t.match(r))&&(this.r=parseInt(e[1].substring(0,2),16),this.g=parseInt(e[1].substring(2,4),16),this.b=parseInt(e[1].substring(4,6),16)),null!==e};var i=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;n.prototype.rgb=function(t){var e;return null!==(e=t.match(i))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3])),null!==e};var a=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;n.prototype.rgba=function(t){var e;return null!==(e=t.match(a))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3]),this.a=Number(e[4])),null!==e},n.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},n.prototype.namedColor=function(t){t=t.toLowerCase();var e=s[t];if(e)this.r=e[0],this.g=e[1],this.b=e[2];else if("transparent"===t)return this.r=this.g=this.b=this.a=0,!0;return!!e},n.prototype.isColor=!0;var s={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};e.exports=n},{}],4:[function(t,e){function n(t,e){var n,o,r=k++;if((e=e||{}).logging&&(v.options.logging=!0,v.options.start=Date.now()),e.async=void 0===e.async||e.async,e.allowTaint=void 0!==e.allowTaint&&e.allowTaint,e.removeContainer=void 0===e.removeContainer||e.removeContainer,e.javascriptEnabled=void 0!==e.javascriptEnabled&&e.javascriptEnabled,e.imageTimeout=void 0===e.imageTimeout?1e4:e.imageTimeout,e.renderer="function"==typeof e.renderer?e.renderer:m,e.strict=!!e.strict,"string"==typeof t){if("string"!=typeof e.proxy)return Promise.reject("Proxy must be used when rendering url");var i=null!=e.width?e.width:window.innerWidth,a=null!=e.height?e.height:window.innerHeight;return x((n=t,o=document.createElement("a"),o.href=n,o.href=o.href,o),e.proxy,document,i,a,e).then(function(t){return p(t.contentWindow.document.documentElement,t,e,i,a)})}var s,c,h,l,d,u=(void 0===t?[document.documentElement]:t.length?t:[t])[0];return u.setAttribute(T+r,r),(s=u.ownerDocument,c=e,h=u.ownerDocument.defaultView.innerWidth,l=u.ownerDocument.defaultView.innerHeight,d=r,b(s,s,h,l,c,s.defaultView.pageXOffset,s.defaultView.pageYOffset).then(function(t){v("Document cloned");var e=T+d,n="["+e+"='"+d+"']";s.querySelector(n).removeAttribute(e);var o=t.contentWindow,r=o.document.querySelector(n),i=Promise.resolve("function"!=typeof c.onclone||c.onclone(o.document));return i.then(function(){return p(r,t,c,h,l)})})).then(function(t){return"function"==typeof e.onrendered&&(v("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),e.onrendered(t)),t})}function p(n,o,r,t,e){var i,a,s=o.contentWindow,c=new g(s.document),h=new y(r,c),l=E(n),d="view"===r.type?t:(a=s.document,Math.max(Math.max(a.body.scrollWidth,a.documentElement.scrollWidth),Math.max(a.body.offsetWidth,a.documentElement.offsetWidth),Math.max(a.body.clientWidth,a.documentElement.clientWidth))),u="view"===r.type?e:(i=s.document,Math.max(Math.max(i.body.scrollHeight,i.documentElement.scrollHeight),Math.max(i.body.offsetHeight,i.documentElement.offsetHeight),Math.max(i.body.clientHeight,i.documentElement.clientHeight))),p=new r.renderer(d,u,h,r,document);return new w(n,p,c,h,r).ready.then(function(){var t,e;return v("Finished rendering"),t="view"===r.type?f(p.canvas,{width:p.canvas.width,height:p.canvas.height,top:0,left:0,x:0,y:0}):n===s.document.body||n===s.document.documentElement||null!=r.canvas?p.canvas:f(p.canvas,{width:null!=r.width?r.width:l.width,height:null!=r.height?r.height:l.height,top:l.top,left:l.left,x:0,y:0}),e=o,r.removeContainer&&(e.parentNode.removeChild(e),v("Cleaned up container")),t})}function f(t,e){var n=document.createElement("canvas"),o=Math.min(t.width-1,Math.max(0,e.left)),r=Math.min(t.width,Math.max(1,e.left+e.width)),i=Math.min(t.height-1,Math.max(0,e.top)),a=Math.min(t.height,Math.max(1,e.top+e.height));n.width=e.width,n.height=e.height;var s=r-o,c=a-i;return v("Cropping canvas at:","left:",e.left,"top:",e.top,"width:",s,"height:",c),v("Resulting crop with width",e.width,"and height",e.height,"with x",o,"and y",i),n.getContext("2d").drawImage(t,o,i,s,c,e.x,e.y,s,c),n}var g=t("./support"),m=t("./renderers/canvas"),y=t("./imageloader"),w=t("./nodeparser"),o=t("./nodecontainer"),v=t("./log"),r=t("./utils"),b=t("./clone"),x=t("./proxy").loadUrlDocument,E=r.getBounds,T="data-html2canvas-node",k=0;n.CanvasRenderer=m,n.NodeContainer=o,n.log=v,n.utils=r;var i="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return Promise.reject("No canvas support")}:n;e.exports=i},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(t,e){var o=t("./log"),r=t("./utils").smallImage;e.exports=function t(e){if(this.src=e,o("DummyImageContainer for",e),!this.promise||!this.image){o("Initiating DummyImageContainer"),t.prototype.image=new Image;var n=this.image;t.prototype.promise=new Promise(function(t,e){n.onload=t,n.onerror=e,n.src=r(),!0===n.complete&&t(n)})}}},{"./log":13,"./utils":26}],6:[function(t,e){var c=t("./utils").smallImage;e.exports=function(t,e){var n,o,r=document.createElement("div"),i=document.createElement("img"),a=document.createElement("span"),s="Hidden Text";r.style.visibility="hidden",r.style.fontFamily=t,r.style.fontSize=e,r.style.margin=0,r.style.padding=0,document.body.appendChild(r),i.src=c(),i.width=1,i.height=1,i.style.margin=0,i.style.padding=0,i.style.verticalAlign="baseline",a.style.fontFamily=t,a.style.fontSize=e,a.style.margin=0,a.style.padding=0,a.appendChild(document.createTextNode(s)),r.appendChild(a),r.appendChild(i),n=i.offsetTop-a.offsetTop+1,r.removeChild(a),r.appendChild(document.createTextNode(s)),r.style.lineHeight="normal",i.style.verticalAlign="super",o=i.offsetTop-r.offsetTop+1,document.body.removeChild(r),this.baseline=n,this.lineWidth=1,this.middle=o}},{"./utils":26}],7:[function(t,e){function n(){this.data={}}var o=t("./font");n.prototype.getMetrics=function(t,e){return void 0===this.data[t+"-"+e]&&(this.data[t+"-"+e]=new o(t,e)),this.data[t+"-"+e]},e.exports=n},{"./font":6}],8:[function(i,t){function e(e,t,n){this.image=null,this.src=e;var o=this,r=a(e);this.promise=(t?new Promise(function(t){"about:blank"===e.contentWindow.document.URL||null==e.contentWindow.document.documentElement?e.contentWindow.onload=e.onload=function(){t(e)}:t(e)}):this.proxyLoad(n.proxy,r,n)).then(function(t){return i("./core")(t.contentWindow.document.documentElement,{type:"view",width:t.width,height:t.height,proxy:n.proxy,javascriptEnabled:n.javascriptEnabled,removeContainer:n.removeContainer,allowTaint:n.allowTaint,imageTimeout:n.imageTimeout/2})}).then(function(t){return o.image=t})}var a=i("./utils").getBounds,r=i("./proxy").loadUrlDocument;e.prototype.proxyLoad=function(t,e,n){var o=this.src;return r(o.src,t,o.ownerDocument,e.width,e.height,n)},t.exports=e},{"./core":4,"./proxy":16,"./utils":26}],9:[function(t,e){function n(t){this.src=t.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=Promise.resolve(!0)}n.TYPES={LINEAR:1,RADIAL:2},n.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,e.exports=n},{}],10:[function(t,e){e.exports=function(n,o){this.src=n,this.image=new Image;var r=this;this.tainted=null,this.promise=new Promise(function(t,e){r.image.onload=t,r.image.onerror=e,o&&(r.image.crossOrigin="anonymous"),r.image.src=n,!0===r.image.complete&&t(r.image)})}},{}],11:[function(t,e){function n(t,e){this.link=null,this.options=t,this.support=e,this.origin=this.getOrigin(window.location.href)}var i=t("./log"),o=t("./imagecontainer"),r=t("./dummyimagecontainer"),a=t("./proxyimagecontainer"),s=t("./framecontainer"),c=t("./svgcontainer"),h=t("./svgnodecontainer"),l=t("./lineargradientcontainer"),d=t("./webkitgradientcontainer"),u=t("./utils").bind;n.prototype.findImages=function(t){var e=[];return t.reduce(function(t,e){switch(e.node.nodeName){case"IMG":return t.concat([{args:[e.node.src],method:"url"}]);case"svg":case"IFRAME":return t.concat([{args:[e.node],method:e.node.nodeName}])}return t},[]).forEach(this.addImage(e,this.loadImage),this),e},n.prototype.findBackgroundImage=function(t,e){return e.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(t,this.loadImage),this),t},n.prototype.addImage=function(n,o){return function(e){e.args.forEach(function(t){this.imageExists(n,t)||(n.splice(0,0,o.call(this,e)),i("Added image #"+n.length,"string"==typeof t?t.substring(0,100):t))},this)}},n.prototype.hasImageBackground=function(t){return"none"!==t.method},n.prototype.loadImage=function(t){if("url"!==t.method)return"linear-gradient"===t.method?new l(t):"gradient"===t.method?new d(t):"svg"===t.method?new h(t.args[0],this.support.svg):"IFRAME"===t.method?new s(t.args[0],this.isSameOrigin(t.args[0].src),this.options):new r(t);var e=t.args[0];return!this.isSVG(e)||this.support.svg||this.options.allowTaint?e.match(/data:image\/.*;base64,/i)?new o(e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(e)||!0===this.options.allowTaint||this.isSVG(e)?new o(e,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new o(e,!0):this.options.proxy?new a(e,this.options.proxy):new r(e):new c(e)},n.prototype.isSVG=function(t){return"svg"===t.substring(t.length-3).toLowerCase()||c.prototype.isInline(t)},n.prototype.imageExists=function(t,e){return t.some(function(t){return t.src===e})},n.prototype.isSameOrigin=function(t){return this.getOrigin(t)===this.origin},n.prototype.getOrigin=function(t){var e=this.link||(this.link=document.createElement("a"));return e.href=t,e.href=e.href,e.protocol+e.hostname+e.port},n.prototype.getPromise=function(e){return this.timeout(e,this.options.imageTimeout).catch(function(){return new r(e.src).promise.then(function(t){e.image=t})})},n.prototype.get=function(e){var n=null;return this.images.some(function(t){return(n=t).src===e})?n:null},n.prototype.fetch=function(t){return this.images=t.reduce(u(this.findBackgroundImage,this),this.findImages(t)),this.images.forEach(function(e,n){e.promise.then(function(){i("Succesfully loaded image #"+(n+1),e)},function(t){i("Failed loading image #"+(n+1),e,t)})}),this.ready=Promise.all(this.images.map(this.getPromise,this)),i("Finished searching images"),this},n.prototype.timeout=function(n,o){var r,t=Promise.race([n.promise,new Promise(function(t,e){r=setTimeout(function(){i("Timed out loading image",n),e(n)},o)})]).then(function(t){return clearTimeout(r),t});return t.catch(function(){clearTimeout(r)}),t},e.exports=n},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(t,e){function n(t){r.apply(this,arguments),this.type=r.TYPES.LINEAR;var e=n.REGEXP_DIRECTION.test(t.args[0])||!r.REGEXP_COLORSTOP.test(t.args[0]);e?t.args[0].split(/\s+/).reverse().forEach(function(t,e){switch(t){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var n=this.y0,o=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=o,this.y1=n;break;case"center":break;default:var r=.01*parseFloat(t,10);if(isNaN(r))break;0===e?(this.y0=r,this.y1=1-this.y0):(this.x0=r,this.x1=1-this.x0)}},this):(this.y0=0,this.y1=1),this.colorStops=t.args.slice(e?1:0).map(function(t){var e=t.match(r.REGEXP_COLORSTOP),n=+e[2],o=0===n?"%":e[3];return{color:new i(e[1]),stop:"%"===o?n/100:null}}),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(n,o){null===n.stop&&this.colorStops.slice(o).some(function(t,e){return null!==t.stop&&(n.stop=(t.stop-this.colorStops[o-1].stop)/(e+1)+this.colorStops[o-1].stop,!0)},this)},this)}var r=t("./gradientcontainer"),i=t("./color");n.prototype=Object.create(r.prototype),n.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,e.exports=n},{"./color":3,"./gradientcontainer":9}],13:[function(t,e){var n=function(){n.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-n.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};n.options={logging:!1},e.exports=n},{}],14:[function(t,e){function n(t,e){this.node=t,this.parent=e,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function c(t){return-1!==t.toString().indexOf("%")}function o(t){return t.replace("px","")}function r(t){return parseFloat(t)}var i=t("./color"),a=t("./utils"),s=a.getBounds,h=a.parseBackgrounds,l=a.offsetBounds;n.prototype.cloneTo=function(t){t.visible=this.visible,t.borders=this.borders,t.bounds=this.bounds,t.clip=this.clip,t.backgroundClip=this.backgroundClip,t.computedStyles=this.computedStyles,t.styles=this.styles,t.backgroundImages=this.backgroundImages,t.opacity=this.opacity},n.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},n.prototype.assignStack=function(t){(this.stack=t).children.push(this)},n.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},n.prototype.css=function(t){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[t]||(this.styles[t]=this.computedStyles[t])},n.prototype.prefixedCss=function(e){var n=this.css(e);return void 0===n&&["webkit","moz","ms","o"].some(function(t){return void 0!==(n=this.css(t+e.substr(0,1).toUpperCase()+e.substr(1)))},this),void 0===n?null:n},n.prototype.computedStyle=function(t){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,t)},n.prototype.cssInt=function(t){var e=parseInt(this.css(t),10);return isNaN(e)?0:e},n.prototype.color=function(t){return this.colors[t]||(this.colors[t]=new i(this.css(t)))},n.prototype.cssFloat=function(t){var e=parseFloat(this.css(t));return isNaN(e)?0:e},n.prototype.fontWeight=function(){var t=this.css("fontWeight");switch(parseInt(t,10)){case 401:t="bold";break;case 400:t="normal"}return t},n.prototype.parseClip=function(){var t=this.css("clip").match(this.CLIP);return t?{top:parseInt(t[1],10),right:parseInt(t[2],10),bottom:parseInt(t[3],10),left:parseInt(t[4],10)}:null},n.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=h(this.css("backgroundImage")))},n.prototype.cssList=function(t,e){var n=(this.css(t)||"").split(",");return 1===(n=(n=n[e||0]||n[0]||"auto").trim().split(" ")).length&&(n=[n[0],c(n[0])?"auto":n[0]]),n},n.prototype.parseBackgroundSize=function(t,e,n){var o,r,i=this.cssList("backgroundSize",n);if(c(i[0]))o=t.width*parseFloat(i[0])/100;else{if(/contain|cover/.test(i[0])){var a=t.width/t.height,s=e.width/e.height;return a<s^"contain"===i[0]?{width:t.height*s,height:t.height}:{width:t.width,height:t.width/s}}o=parseInt(i[0],10)}return r="auto"===i[0]&&"auto"===i[1]?e.height:"auto"===i[1]?o/e.width*e.height:c(i[1])?t.height*parseFloat(i[1])/100:parseInt(i[1],10),"auto"===i[0]&&(o=r/e.height*e.width),{width:o,height:r}},n.prototype.parseBackgroundPosition=function(t,e,n,o){var r,i,a=this.cssList("backgroundPosition",n);return r=c(a[0])?(t.width-(o||e).width)*(parseFloat(a[0])/100):parseInt(a[0],10),i="auto"===a[1]?r/e.width*e.height:c(a[1])?(t.height-(o||e).height)*parseFloat(a[1])/100:parseInt(a[1],10),"auto"===a[0]&&(r=i/e.height*e.width),{left:r,top:i}},n.prototype.parseBackgroundRepeat=function(t){return this.cssList("backgroundRepeat",t)[0]},n.prototype.parseTextShadows=function(){var t=this.css("textShadow"),e=[];if(t&&"none"!==t)for(var n=t.match(this.TEXT_SHADOW_PROPERTY),o=0;n&&o<n.length;o++){var r=n[o].match(this.TEXT_SHADOW_VALUES);e.push({color:new i(r[0]),offsetX:r[1]?parseFloat(r[1].replace("px","")):0,offsetY:r[2]?parseFloat(r[2].replace("px","")):0,blur:r[3]?r[3].replace("px",""):0})}return e},n.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var t=this.parseBounds(),e=this.prefixedCss("transformOrigin").split(" ").map(o).map(r);e[0]+=t.left,e[1]+=t.top,this.transformData={origin:e,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},n.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var t=this.prefixedCss("transform"),e=t?function(t){if(t&&"matrix"===t[1])return t[2].split(",").map(function(t){return parseFloat(t.trim())});if(t&&"matrix3d"===t[1]){var e=t[2].split(",").map(function(t){return parseFloat(t.trim())});return[e[0],e[1],e[4],e[5],e[12],e[13]]}}(t.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=e||[1,0,0,1,0,0]}return this.transformMatrix},n.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?l(this.node):s(this.node))},n.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},n.prototype.getValue=function(){var t,e,n=this.node.value||"";return"SELECT"===this.node.tagName?(t=this.node,n=(e=t.options[t.selectedIndex||0])&&e.text||""):"password"===this.node.type&&(n=Array(n.length+1).join("•")),0===n.length?this.node.placeholder||"":n},n.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,n.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,n.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,n.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,e.exports=n},{"./color":3,"./utils":26}],15:[function(t,e){function n(t,e,n,o,r){R("Starting NodeParser"),this.renderer=e,this.options=r,this.range=null,this.support=n,this.renderQueue=[],this.stack=new B(!0,1,t.ownerDocument,null);var i=new A(t,null);if(r.background&&e.rectangle(0,0,e.width,e.height,new N(r.background)),t===t.ownerDocument.documentElement){var a=new A(i.color("backgroundColor").isTransparent()?t.ownerDocument.body:t.ownerDocument.documentElement,null);e.rectangle(0,0,e.width,e.height,a.color("backgroundColor"))}i.visibile=i.isElementVisible(),this.createPseudoHideStyles(t.ownerDocument),this.disableAnimations(t.ownerDocument),this.nodes=I([i].concat(this.getChildren(i)).filter(function(t){return t.visible=t.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new M,R("Fetched nodes, total:",this.nodes.length),R("Calculate overflow clips"),this.calculateOverflowClips(),R("Start fetching images"),this.images=o.fetch(this.nodes.filter(T)),this.ready=this.images.ready.then(_(function(){return R("Images loaded, starting parsing"),R("Creating stacking contexts"),this.createStackingContexts(),R("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),R("Render queue created with "+this.renderQueue.length+" items"),new Promise(_(function(t){r.async?"function"==typeof r.async?r.async.call(this,this.renderQueue,t):0<this.renderQueue.length?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,t)):t():(this.renderQueue.forEach(this.paint,this),t())},this))},this))}function o(t){return t.parent&&t.parent.clip.length}function l(){}function c(a,s,c,h){return a.map(function(t,e){if(0<t.width){var n=s.left,o=s.top,r=s.width,i=s.height-a[2].width;switch(e){case 0:i=a[0].width,t.args=d({c1:[n,o],c2:[n+r,o],c3:[n+r-a[1].width,o+i],c4:[n+a[3].width,o+i]},h[0],h[1],c.topLeftOuter,c.topLeftInner,c.topRightOuter,c.topRightInner);break;case 1:n=s.left+s.width-a[1].width,r=a[1].width,t.args=d({c1:[n+r,o],c2:[n+r,o+i+a[2].width],c3:[n,o+i],c4:[n,o+a[0].width]},h[1],h[2],c.topRightOuter,c.topRightInner,c.bottomRightOuter,c.bottomRightInner);break;case 2:o=o+s.height-a[2].width,i=a[2].width,t.args=d({c1:[n+r,o+i],c2:[n,o+i],c3:[n+a[3].width,o],c4:[n+r-a[3].width,o]},h[2],h[3],c.bottomRightOuter,c.bottomRightInner,c.bottomLeftOuter,c.bottomLeftInner);break;case 3:r=a[3].width,t.args=d({c1:[n,o+i+a[2].width],c2:[n,o],c3:[n+r,o+a[0].width],c4:[n+r,o+i]},h[3],h[0],c.bottomLeftOuter,c.bottomLeftInner,c.topLeftOuter,c.topLeftInner)}}return t})}function v(t,e,n,o){var r=(Math.sqrt(2)-1)/3*4,i=n*r,a=o*r,s=t+n,c=e+o;return{topLeft:u({x:t,y:c},{x:t,y:c-a},{x:s-i,y:e},{x:s,y:e}),topRight:u({x:t,y:e},{x:t+i,y:e},{x:s,y:c-a},{x:s,y:c}),bottomRight:u({x:s,y:e},{x:s,y:e+a},{x:t+i,y:c},{x:t,y:c}),bottomLeft:u({x:s,y:c},{x:s-i,y:c},{x:t,y:e+a},{x:t,y:e})}}function h(t,e,n){var o=t.left,r=t.top,i=t.width,a=t.height,s=e[0][0]<i/2?e[0][0]:i/2,c=e[0][1]<a/2?e[0][1]:a/2,h=e[1][0]<i/2?e[1][0]:i/2,l=e[1][1]<a/2?e[1][1]:a/2,d=e[2][0]<i/2?e[2][0]:i/2,u=e[2][1]<a/2?e[2][1]:a/2,p=e[3][0]<i/2?e[3][0]:i/2,f=e[3][1]<a/2?e[3][1]:a/2,g=i-h,m=a-u,y=i-d,w=a-f;return{topLeftOuter:v(o,r,s,c).topLeft.subdivide(.5),topLeftInner:v(o+n[3].width,r+n[0].width,Math.max(0,s-n[3].width),Math.max(0,c-n[0].width)).topLeft.subdivide(.5),topRightOuter:v(o+g,r,h,l).topRight.subdivide(.5),topRightInner:v(o+Math.min(g,i+n[3].width),r+n[0].width,g>i+n[3].width?0:h-n[3].width,l-n[0].width).topRight.subdivide(.5),bottomRightOuter:v(o+y,r+m,d,u).bottomRight.subdivide(.5),bottomRightInner:v(o+Math.min(y,i-n[3].width),r+Math.min(m,a+n[0].width),Math.max(0,d-n[1].width),u-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:v(o,r+w,p,f).bottomLeft.subdivide(.5),bottomLeftInner:v(o+n[3].width,r+w,Math.max(0,p-n[3].width),f-n[2].width).bottomLeft.subdivide(.5)}}function u(s,c,h,l){var d=function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}};return{start:s,startControl:c,endControl:h,end:l,subdivide:function(t){var e=d(s,c,t),n=d(c,h,t),o=d(h,l,t),r=d(e,n,t),i=d(n,o,t),a=d(r,i,t);return[u(s,e,r,a),u(a,i,o,l)]},curveTo:function(t){t.push(["bezierCurve",c.x,c.y,h.x,h.y,l.x,l.y])},curveToReversed:function(t){t.push(["bezierCurve",h.x,h.y,c.x,c.y,s.x,s.y])}}}function d(t,e,n,o,r,i,a){var s=[];return 0<e[0]||0<e[1]?(s.push(["line",o[1].start.x,o[1].start.y]),o[1].curveTo(s)):s.push(["line",t.c1[0],t.c1[1]]),0<n[0]||0<n[1]?(s.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(s),s.push(["line",a[0].end.x,a[0].end.y]),a[0].curveToReversed(s)):(s.push(["line",t.c2[0],t.c2[1]]),s.push(["line",t.c3[0],t.c3[1]])),0<e[0]||0<e[1]?(s.push(["line",r[1].end.x,r[1].end.y]),r[1].curveToReversed(s)):s.push(["line",t.c4[0],t.c4[1]]),s}function a(t,e,n,o,r,i,a){0<e[0]||0<e[1]?(t.push(["line",o[0].start.x,o[0].start.y]),o[0].curveTo(t),o[1].curveTo(t)):t.push(["line",i,a]),(0<n[0]||0<n[1])&&t.push(["line",r[0].start.x,r[0].start.y])}function p(t){return t.cssInt("zIndex")<0}function f(t){return 0<t.cssInt("zIndex")}function g(t){return 0===t.cssInt("zIndex")}function m(t){return-1!==["inline","inline-block","inline-table"].indexOf(t.css("display"))}function y(t){return t instanceof B}function w(t){return 0<t.node.data.trim().length}function r(t){return t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE}function b(t){return"static"!==t.css("position")}function x(t){return"none"!==t.css("float")}function E(t){var e=this;return function(){return!t.apply(e,arguments)}}function T(t){return t.node.nodeType===Node.ELEMENT_NODE}function i(t){return!0===t.isPseudoElement}function k(t){return t.node.nodeType===Node.TEXT_NODE}function s(t){return parseInt(t,10)}function C(t){return t.width}function S(t){return t.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(t.node.nodeName)}function I(t){return[].concat.apply([],t)}var R=t("./log"),O=t("punycode"),A=t("./nodecontainer"),P=t("./textcontainer"),L=t("./pseudoelementcontainer"),M=t("./fontmetrics"),N=t("./color"),B=t("./stackingcontext"),D=t("./utils"),_=D.bind,F=D.getBounds,W=D.parseBackgrounds,H=D.offsetBounds;n.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(t){if(T(t)){i(t)&&t.appendToDOM(),t.borders=this.parseBorders(t);var e="hidden"===t.css("overflow")?[t.borders.clip]:[],n=t.parseClip();n&&-1!==["absolute","fixed"].indexOf(t.css("position"))&&e.push([["rect",t.bounds.left+n.left,t.bounds.top+n.top,n.right-n.left,n.bottom-n.top]]),t.clip=o(t)?t.parent.clip.concat(e):e,t.backgroundClip="hidden"!==t.css("overflow")?t.clip.concat([t.borders.clip]):t.clip,i(t)&&t.cleanDOM()}else k(t)&&(t.clip=o(t)?t.parent.clip:[]);i(t)||(t.bounds=null)},this)},n.prototype.asyncRenderer=function(t,e,n){n=n||Date.now(),this.paint(t[this.renderIndex++]),t.length===this.renderIndex?e():n+20>Date.now()?this.asyncRenderer(t,e,n):setTimeout(_(function(){this.asyncRenderer(t,e)},this),0)},n.prototype.createPseudoHideStyles=function(t){this.createStyles(t,"."+L.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+L.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},n.prototype.disableAnimations=function(t){this.createStyles(t,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},n.prototype.createStyles=function(t,e){var n=t.createElement("style");n.innerHTML=e,t.body.appendChild(n)},n.prototype.getPseudoElements=function(t){var e=[[t]];if(t.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(t,":before"),o=this.getPseudoElement(t,":after");n&&e.push(n),o&&e.push(o)}return I(e)},n.prototype.getPseudoElement=function(t,e){var n,o,r=t.computedStyle(e);if(!r||!r.content||"none"===r.content||"-moz-alt-content"===r.content||"none"===r.display)return null;for(var i=(n=r.content,o=void 0,(o=n.substr(0,1))===n.substr(n.length-1)&&o.match(/'|"/)?n.substr(1,n.length-2):n),a="url"===i.substr(0,3),s=document.createElement(a?"img":"html2canvaspseudoelement"),c=new L(s,t,e),h=r.length-1;0<=h;h--){var l=r.item(h).replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")});s.style[l]=r[l]}if(s.className=L.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+L.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,a)return s.src=W(i)[0].args[0],[c];var d=document.createTextNode(i);return s.appendChild(d),[c,new P(d,c)]},n.prototype.getChildren=function(n){return I([].filter.call(n.node.childNodes,r).map(function(t){var e=[t.nodeType===Node.TEXT_NODE?new P(t,n):new A(t,n)].filter(S);return t.nodeType===Node.ELEMENT_NODE&&e.length&&"TEXTAREA"!==t.tagName?e[0].isElementVisible()?e.concat(this.getChildren(e[0])):[]:e},this))},n.prototype.newStackingContext=function(t,e){var n=new B(e,t.getOpacity(),t.node,t.parent);t.cloneTo(n),(e?n.getParentStack(this):n.parent.stack).contexts.push(n),t.stack=n},n.prototype.createStackingContexts=function(){this.nodes.forEach(function(t){var e,n;T(t)&&(this.isRootElement(t)||t.getOpacity()<1||(n=(e=t).css("position"),"auto"!==(-1!==["absolute","relative","fixed"].indexOf(n)?e.css("zIndex"):"auto"))||this.isBodyWithTransparentRoot(t)||t.hasTransform())?this.newStackingContext(t,!0):T(t)&&(b(t)&&g(t)||-1!==["inline-block","inline-table"].indexOf(t.css("display"))||x(t))?this.newStackingContext(t,!1):t.assignStack(t.parent.stack)},this)},n.prototype.isBodyWithTransparentRoot=function(t){return"BODY"===t.node.nodeName&&t.parent.color("backgroundColor").isTransparent()},n.prototype.isRootElement=function(t){return null===t.parent},n.prototype.sortStackingContexts=function(t){var n;t.contexts.sort((n=t.contexts.slice(0),function(t,e){return t.cssInt("zIndex")+n.indexOf(t)/n.length-(e.cssInt("zIndex")+n.indexOf(e)/n.length)})),t.contexts.forEach(this.sortStackingContexts,this)},n.prototype.parseTextBounds=function(a){return function(t,e,n){if("none"!==a.parent.css("textDecoration").substr(0,4)||0!==t.trim().length){if(this.support.rangeBounds&&!a.parent.hasTransform()){var o=n.slice(0,e).join("").length;return this.getRangeBounds(a.node,o,t.length)}if(a.node&&"string"==typeof a.node.data){var r=a.node.splitText(t.length),i=this.getWrapperBounds(a.node,a.parent.hasTransform());return a.node=r,i}}else(!this.support.rangeBounds||a.parent.hasTransform())&&(a.node=a.node.splitText(t.length));return{}}},n.prototype.getWrapperBounds=function(t,e){var n=t.ownerDocument.createElement("html2canvaswrapper"),o=t.parentNode,r=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),o.replaceChild(n,t);var i=e?H(n):F(n);return o.replaceChild(r,n),i},n.prototype.getRangeBounds=function(t,e,n){var o=this.range||(this.range=t.ownerDocument.createRange());return o.setStart(t,e),o.setEnd(t,e+n),o.getBoundingClientRect()},n.prototype.parse=function(t){var e=t.contexts.filter(p),n=t.children.filter(T),o=n.filter(E(x)),r=o.filter(E(b)).filter(E(m)),i=n.filter(E(b)).filter(x),a=o.filter(E(b)).filter(m),s=t.contexts.concat(o.filter(b)).filter(g),c=t.children.filter(k).filter(w),h=t.contexts.filter(f);e.concat(r).concat(i).concat(a).concat(s).concat(c).concat(h).forEach(function(t){this.renderQueue.push(t),y(t)&&(this.parse(t),this.renderQueue.push(new l))},this)},n.prototype.paint=function(t){try{t instanceof l?this.renderer.ctx.restore():k(t)?(i(t.parent)&&t.parent.appendToDOM(),this.paintText(t),i(t.parent)&&t.parent.cleanDOM()):this.paintNode(t)}catch(t){if(R(t),this.options.strict)throw t}},n.prototype.paintNode=function(t){y(t)&&(this.renderer.setOpacity(t.opacity),this.renderer.ctx.save(),t.hasTransform()&&this.renderer.setTransform(t.parseTransform())),"INPUT"===t.node.nodeName&&"checkbox"===t.node.type?this.paintCheckbox(t):"INPUT"===t.node.nodeName&&"radio"===t.node.type?this.paintRadio(t):this.paintElement(t)},n.prototype.paintElement=function(n){var o=n.parseBounds();this.renderer.clip(n.backgroundClip,function(){this.renderer.renderBackground(n,o,n.borders.borders.map(C))},this),this.renderer.clip(n.clip,function(){this.renderer.renderBorders(n.borders.borders)},this),this.renderer.clip(n.backgroundClip,function(){switch(n.node.nodeName){case"svg":case"IFRAME":var t=this.images.get(n.node);t?this.renderer.renderImage(n,o,n.borders,t):R("Error loading <"+n.node.nodeName+">",n.node);break;case"IMG":var e=this.images.get(n.node.src);e?this.renderer.renderImage(n,o,n.borders,e):R("Error loading <img>",n.node.src);break;case"CANVAS":this.renderer.renderImage(n,o,n.borders,{image:n.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(n)}},this)},n.prototype.paintCheckbox=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height),o={width:n-1,height:n-1,top:e.top,left:e.left},r=[3,3],i=[r,r,r,r],a=[1,1,1,1].map(function(t){return{color:new N("#A5A5A5"),width:t}}),s=h(o,i,a);this.renderer.clip(t.backgroundClip,function(){this.renderer.rectangle(o.left+1,o.top+1,o.width-2,o.height-2,new N("#DEDEDE")),this.renderer.renderBorders(c(a,o,s,i)),t.node.checked&&(this.renderer.font(new N("#424242"),"normal","normal","bold",n-3+"px","arial"),this.renderer.text("✔",o.left+n/6,o.top+n-1))},this)},n.prototype.paintRadio=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height)-2;this.renderer.clip(t.backgroundClip,function(){this.renderer.circleStroke(e.left+1,e.top+1,n,new N("#DEDEDE"),1,new N("#A5A5A5")),t.node.checked&&this.renderer.circle(Math.ceil(e.left+n/4)+1,Math.ceil(e.top+n/4)+1,Math.floor(n/2),new N("#424242"))},this)},n.prototype.paintFormValue=function(e){var t=e.getValue();if(0<t.length){var n=e.node.ownerDocument,o=n.createElement("html2canvaswrapper");["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach(function(t){try{o.style[t]=e.css(t)}catch(t){R("html2canvas: Parse: Exception caught in renderFormValue: "+t.message)}});var r=e.parseBounds();o.style.position="fixed",o.style.left=r.left+"px",o.style.top=r.top+"px",o.textContent=t,n.body.appendChild(o),this.paintText(new P(o.firstChild,e)),n.body.removeChild(o)}},n.prototype.paintText=function(n){n.applyTextTransform();var t,e=O.ucs2.decode(n.node.data),o=this.options.letterRendering&&!/^(normal|none|0px)$/.test(n.parent.css("letterSpacing"))||(t=n.node.data,/[^\u0000-\u00ff]/.test(t))?e.map(function(t){return O.ucs2.encode([t])}):function(t){for(var e,n=[],o=0,r=!1;t.length;)i=t[o],-1!==[32,13,10,9,45].indexOf(i)===r?((e=t.splice(0,o)).length&&n.push(O.ucs2.encode(e)),r=!r,o=0):o++,o>=t.length&&(e=t.splice(0,o)).length&&n.push(O.ucs2.encode(e));var i;return n}(e),r=n.parent.fontWeight(),i=n.parent.css("fontSize"),a=n.parent.css("fontFamily"),s=n.parent.parseTextShadows();this.renderer.font(n.parent.color("color"),n.parent.css("fontStyle"),n.parent.css("fontVariant"),r,i,a),s.length?this.renderer.fontShadow(s[0].color,s[0].offsetX,s[0].offsetY,s[0].blur):this.renderer.clearShadow(),this.renderer.clip(n.parent.clip,function(){o.map(this.parseTextBounds(n),this).forEach(function(t,e){t&&(this.renderer.text(o[e],t.left,t.bottom),this.renderTextDecoration(n.parent,t,this.fontMetrics.getMetrics(a,i)))},this)},this)},n.prototype.renderTextDecoration=function(t,e,n){switch(t.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(e.left,Math.round(e.top+n.baseline+n.lineWidth),e.width,1,t.color("color"));break;case"overline":this.renderer.rectangle(e.left,Math.round(e.top),e.width,1,t.color("color"));break;case"line-through":this.renderer.rectangle(e.left,Math.ceil(e.top+n.middle+n.lineWidth),e.width,1,t.color("color"))}};var V={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};n.prototype.parseBorders=function(i){var n,t=i.parseBounds(),e=(n=i,["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){var e=n.css("border"+t+"Radius").split(" ");return e.length<=1&&(e[1]=e[0]),e.map(s)})),o=["Top","Right","Bottom","Left"].map(function(t,e){var n=i.css("border"+t+"Style"),o=i.color("border"+t+"Color");"inset"===n&&o.isBlack()&&(o=new N([255,255,255,o.a]));var r=V[n]?V[n][e]:null;return{width:i.cssInt("border"+t+"Width"),color:r?o[r[0]](r[1]):o,args:null}}),r=h(t,e,o);return{clip:this.parseBackgroundClip(i,r,o,e,t),borders:c(o,t,r,e)}},n.prototype.parseBackgroundClip=function(t,e,n,o,r){var i=[];switch(t.css("backgroundClip")){case"content-box":case"padding-box":a(i,o[0],o[1],e.topLeftInner,e.topRightInner,r.left+n[3].width,r.top+n[0].width),a(i,o[1],o[2],e.topRightInner,e.bottomRightInner,r.left+r.width-n[1].width,r.top+n[0].width),a(i,o[2],o[3],e.bottomRightInner,e.bottomLeftInner,r.left+r.width-n[1].width,r.top+r.height-n[2].width),a(i,o[3],o[0],e.bottomLeftInner,e.topLeftInner,r.left+n[3].width,r.top+r.height-n[2].width);break;default:a(i,o[0],o[1],e.topLeftOuter,e.topRightOuter,r.left,r.top),a(i,o[1],o[2],e.topRightOuter,e.bottomRightOuter,r.left+r.width,r.top),a(i,o[2],o[3],e.bottomRightOuter,e.bottomLeftOuter,r.left+r.width,r.top+r.height),a(i,o[3],o[0],e.bottomLeftOuter,e.topLeftOuter,r.left,r.top+r.height)}return i},e.exports=n},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(t,e,n){function s(t,e,n){var o="withCredentials"in new XMLHttpRequest;if(!e)return Promise.reject("No proxy configured");var r=c(o),i=h(e,t,r);return o?l(i):a(n,i,r).then(function(t){return p(t.content)})}function a(r,i,a){return new Promise(function(e,n){var t=r.createElement("script"),o=function(){delete window.html2canvas.proxy[a],r.body.removeChild(t)};window.html2canvas.proxy[a]=function(t){o(),e(t)},t.src=i,t.onerror=function(t){o(),n(t)},r.body.appendChild(t)})}function c(t){return t?"":"html2canvas_"+Date.now()+"_"+ ++r+"_"+Math.round(1e5*Math.random())}function h(t,e,n){return t+"?url="+encodeURIComponent(e)+(n.length?"&callback=html2canvas.proxy."+n:"")}var l=t("./xhr"),o=t("./utils"),d=t("./log"),u=t("./clone"),p=o.decode64,r=0;n.Proxy=s,n.ProxyURL=function(t,e,n){var o="crossOrigin"in new Image,r=c(o),i=h(e,t,r);return o?Promise.resolve(i):a(n,i,r).then(function(t){return"data:"+t.type+";base64,"+t.content})},n.loadUrlDocument=function(t,e,n,o,r,i){return new s(t,e,window.document).then((a=t,function(e){var n,t=new DOMParser;try{n=t.parseFromString(e,"text/html")}catch(t){d("DOMParser not supported, falling back to createHTMLDocument"),n=document.implementation.createHTMLDocument("");try{n.open(),n.write(e),n.close()}catch(t){d("createHTMLDocument write not supported, falling back to document.body.innerHTML"),n.body.innerHTML=e}}var o=n.querySelector("base");if(!o||!o.href.host){var r=n.createElement("base");r.href=a,n.head.insertBefore(r,n.head.firstChild)}return n})).then(function(t){return u(t,n,o,r,i,0,0)});var a}},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(t,e){var i=t("./proxy").ProxyURL;e.exports=function(n,o){var t=document.createElement("a");t.href=n,n=t.href,this.src=n,this.image=new Image;var r=this;this.promise=new Promise(function(t,e){r.image.crossOrigin="Anonymous",r.image.onload=t,r.image.onerror=e,new i(n,o,document).then(function(t){r.image.src=t}).catch(e)})}},{"./proxy":16}],18:[function(t,e){function n(t,e,n){o.call(this,t,e),this.isPseudoElement=!0,this.before=":before"===n}var o=t("./nodecontainer");n.prototype.cloneTo=function(t){n.prototype.cloneTo.call(this,t),t.isPseudoElement=!0,t.before=this.before},(n.prototype=Object.create(o.prototype)).appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},n.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},n.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},n.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",n.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",e.exports=n},{"./nodecontainer":14}],19:[function(t,e){function n(t,e,n,o,r){this.width=t,this.height=e,this.images=n,this.options=o,this.document=r}var c=t("./log");n.prototype.renderImage=function(t,e,n,o){var r=t.cssInt("paddingLeft"),i=t.cssInt("paddingTop"),a=t.cssInt("paddingRight"),s=t.cssInt("paddingBottom"),c=n.borders,h=e.width-(c[1].width+c[3].width+r+a),l=e.height-(c[0].width+c[2].width+i+s);this.drawImage(o,0,0,o.image.width||h,o.image.height||l,e.left+r+c[3].width,e.top+i+c[0].width,h,l)},n.prototype.renderBackground=function(t,e,n){0<e.height&&0<e.width&&(this.renderBackgroundColor(t,e),this.renderBackgroundImage(t,e,n))},n.prototype.renderBackgroundColor=function(t,e){var n=t.color("backgroundColor");n.isTransparent()||this.rectangle(e.left,e.top,e.width,e.height,n)},n.prototype.renderBorders=function(t){t.forEach(this.renderBorder,this)},n.prototype.renderBorder=function(t){t.color.isTransparent()||null===t.args||this.drawShape(t.args,t.color)},n.prototype.renderBackgroundImage=function(i,a,s){i.parseBackgroundImages().reverse().forEach(function(t,e,n){switch(t.method){case"url":var o=this.images.get(t.args[0]);o?this.renderBackgroundRepeating(i,a,o,n.length-(e+1),s):c("Error loading background-image",t.args[0]);break;case"linear-gradient":case"gradient":var r=this.images.get(t.value);r?this.renderBackgroundGradient(r,a,s):c("Error loading background-image",t.args[0]);break;case"none":break;default:c("Unknown background-image type",t.args[0])}},this)},n.prototype.renderBackgroundRepeating=function(t,e,n,o,r){var i=t.parseBackgroundSize(e,n.image,o),a=t.parseBackgroundPosition(e,n.image,o,i);switch(t.parseBackgroundRepeat(o)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,a,i,e,e.left+r[3],e.top+a.top+r[0],99999,i.height,r);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,a,i,e,e.left+a.left+r[3],e.top+r[0],i.width,99999,r);break;case"no-repeat":this.backgroundRepeatShape(n,a,i,e,e.left+a.left+r[3],e.top+a.top+r[0],i.width,i.height,r);break;default:this.renderBackgroundRepeat(n,a,i,{top:e.top,left:e.left},r[3],r[0])}},e.exports=n},{"./log":13}],20:[function(t,e){function n(t,e){r.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=t,this.canvas.height=e),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},a("Initialized CanvasRenderer with size",t,"x",e)}function o(t){return 0<t.length}var r=t("../renderer"),i=t("../lineargradientcontainer"),a=t("../log");(n.prototype=Object.create(r.prototype)).setFillStyle=function(t){return this.ctx.fillStyle="object"==typeof t&&t.isColor?t.toString():t,this.ctx},n.prototype.rectangle=function(t,e,n,o,r){this.setFillStyle(r).fillRect(t,e,n,o)},n.prototype.circle=function(t,e,n,o){this.setFillStyle(o),this.ctx.beginPath(),this.ctx.arc(t+n/2,e+n/2,n/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},n.prototype.circleStroke=function(t,e,n,o,r,i){this.circle(t,e,n,o),this.ctx.strokeStyle=i.toString(),this.ctx.stroke()},n.prototype.drawShape=function(t,e){this.shape(t),this.setFillStyle(e).fill()},n.prototype.taints=function(e){if(null===e.tainted){this.taintCtx.drawImage(e.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),e.tainted=!1}catch(t){this.taintCtx=document.createElement("canvas").getContext("2d"),e.tainted=!0}}return e.tainted},n.prototype.drawImage=function(t,e,n,o,r,i,a,s,c){(!this.taints(t)||this.options.allowTaint)&&this.ctx.drawImage(t.image,e,n,o,r,i,a,s,c)},n.prototype.clip=function(t,e,n){this.ctx.save(),t.filter(o).forEach(function(t){this.shape(t).clip()},this),e.call(n),this.ctx.restore()},n.prototype.shape=function(t){return this.ctx.beginPath(),t.forEach(function(t,e){"rect"===t[0]?this.ctx.rect.apply(this.ctx,t.slice(1)):this.ctx[0===e?"moveTo":t[0]+"To"].apply(this.ctx,t.slice(1))},this),this.ctx.closePath(),this.ctx},n.prototype.font=function(t,e,n,o,r,i){this.setFillStyle(t).font=[e,n,o,r,i].join(" ").split(",")[0]},n.prototype.fontShadow=function(t,e,n,o){this.setVariable("shadowColor",t.toString()).setVariable("shadowOffsetY",e).setVariable("shadowOffsetX",n).setVariable("shadowBlur",o)},n.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},n.prototype.setOpacity=function(t){this.ctx.globalAlpha=t},n.prototype.setTransform=function(t){this.ctx.translate(t.origin[0],t.origin[1]),this.ctx.transform.apply(this.ctx,t.matrix),this.ctx.translate(-t.origin[0],-t.origin[1])},n.prototype.setVariable=function(t,e){return this.variables[t]!==e&&(this.variables[t]=this.ctx[t]=e),this},n.prototype.text=function(t,e,n){this.ctx.fillText(t,e,n)},n.prototype.backgroundRepeatShape=function(t,e,n,o,r,i,a,s,c){var h=[["line",Math.round(r),Math.round(i)],["line",Math.round(r+a),Math.round(i)],["line",Math.round(r+a),Math.round(s+i)],["line",Math.round(r),Math.round(s+i)]];this.clip([h],function(){this.renderBackgroundRepeat(t,e,n,o,c[3],c[0])},this)},n.prototype.renderBackgroundRepeat=function(t,e,n,o,r,i){var a=Math.round(o.left+e.left+r),s=Math.round(o.top+e.top+i);this.setFillStyle(this.ctx.createPattern(this.resizeImage(t,n),"repeat")),this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},n.prototype.renderBackgroundGradient=function(t,e){if(t instanceof i){var n=this.ctx.createLinearGradient(e.left+e.width*t.x0,e.top+e.height*t.y0,e.left+e.width*t.x1,e.top+e.height*t.y1);t.colorStops.forEach(function(t){n.addColorStop(t.stop,t.color.toString())}),this.rectangle(e.left,e.top,e.width,e.height,n)}},n.prototype.resizeImage=function(t,e){var n=t.image;if(n.width===e.width&&n.height===e.height)return n;var o=document.createElement("canvas");return o.width=e.width,o.height=e.height,o.getContext("2d").drawImage(n,0,0,n.width,n.height,0,0,e.width,e.height),o},e.exports=n},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(t,e){function n(t,e,n,o){r.call(this,n,o),this.ownStacking=t,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*e}var r=t("./nodecontainer");(n.prototype=Object.create(r.prototype)).getParentStack=function(t){var e=this.parent?this.parent.stack:null;return e?e.ownStacking?e:e.getParentStack(t):t.stack},e.exports=n},{"./nodecontainer":14}],22:[function(t,e){function n(t){this.rangeBounds=this.testRangeBounds(t),this.cors=this.testCORS(),this.svg=this.testSVG()}n.prototype.testRangeBounds=function(t){var e,n,o=!1;return t.createRange&&((e=t.createRange()).getBoundingClientRect&&((n=t.createElement("boundtest")).style.height="123px",n.style.display="block",t.body.appendChild(n),e.selectNode(n),123===e.getBoundingClientRect().height&&(o=!0),t.body.removeChild(n))),o},n.prototype.testCORS=function(){return void 0!==(new Image).crossOrigin},n.prototype.testSVG=function(){var t=new Image,e=document.createElement("canvas"),n=e.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),e.toDataURL()}catch(t){return!1}return!0},e.exports=n},{}],23:[function(t,e){function n(t){this.src=t,this.image=null;var n=this;this.promise=this.hasFabric().then(function(){return n.isInline(t)?Promise.resolve(n.inlineFormatting(t)):o(t)}).then(function(e){return new Promise(function(t){window.html2canvas.svg.fabric.loadSVGFromString(e,n.createCanvas.call(n,t))})})}var o=t("./xhr"),r=t("./utils").decode64;n.prototype.hasFabric=function(){return window.html2canvas.svg&&window.html2canvas.svg.fabric?Promise.resolve():Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},n.prototype.inlineFormatting=function(t){return/^data:image\/svg\+xml;base64,/.test(t)?this.decode64(this.removeContentType(t)):this.removeContentType(t)},n.prototype.removeContentType=function(t){return t.replace(/^data:image\/svg\+xml(;base64)?,/,"")},n.prototype.isInline=function(t){return/^data:image\/svg\+xml/i.test(t)},n.prototype.createCanvas=function(o){var r=this;return function(t,e){var n=new window.html2canvas.svg.fabric.StaticCanvas("c");r.image=n.lowerCanvasEl,n.setWidth(e.width).setHeight(e.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(t,e)).renderAll(),o(n.lowerCanvasEl)}},n.prototype.decode64=function(t){return"function"==typeof window.atob?window.atob(t):r(t)},e.exports=n},{"./utils":26,"./xhr":28}],24:[function(t,e){function n(n,t){this.src=n,this.image=null;var o=this;this.promise=t?new Promise(function(t,e){o.image=new Image,o.image.onload=t,o.image.onerror=e,o.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(n),!0===o.image.complete&&t(o.image)}):this.hasFabric().then(function(){return new Promise(function(t){window.html2canvas.svg.fabric.parseSVGDocument(n,o.createCanvas.call(o,t))})})}var o=t("./svgcontainer");n.prototype=Object.create(o.prototype),e.exports=n},{"./svgcontainer":23}],25:[function(t,e){function n(t,e){r.call(this,t,e)}function o(t,e,n){return 0<t.length?e+n.toUpperCase():void 0}var r=t("./nodecontainer");(n.prototype=Object.create(r.prototype)).applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},n.prototype.transform=function(t){var e=this.node.data;switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,o);case"uppercase":return e.toUpperCase();default:return e}},e.exports=n},{"./nodecontainer":14}],26:[function(t,e,n){n.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},n.bind=function(t,e){return function(){return t.apply(e,arguments)}},n.decode64=function(t){var e,n,o,r,i,a,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=t.length,l="";for(e=0;e<h;e+=4)i=c.indexOf(t[e])<<2|(n=c.indexOf(t[e+1]))>>4,a=(15&n)<<4|(o=c.indexOf(t[e+2]))>>2,s=(3&o)<<6|(r=c.indexOf(t[e+3])),l+=64===o?String.fromCharCode(i):64===r||-1===r?String.fromCharCode(i,a):String.fromCharCode(i,a,s);return l},n.getBounds=function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect(),n=null==t.offsetWidth?e.width:t.offsetWidth;return{top:e.top,bottom:e.bottom||e.top+e.height,right:e.left+n,left:e.left,width:n,height:null==t.offsetHeight?e.height:t.offsetHeight}}return{}},n.offsetBounds=function(t){var e=t.offsetParent?n.offsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,right:t.offsetLeft+e.left+t.offsetWidth,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},n.parseBackgrounds=function(t){var e,n,o,r,i,a,s,c=[],h=0,l=0,d=function(){e&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&s.push(n),"-"===e.substr(0,1)&&0<(r=e.indexOf("-",1)+1)&&(o=e.substr(0,r),e=e.substr(r)),c.push({prefix:o,method:e.toLowerCase(),value:i,args:s,image:null})),s=[],e=o=n=i=""};return s=[],e=o=n=i="",t.split("").forEach(function(t){if(!(0===h&&-1<" \r\n\t".indexOf(t))){switch(t){case'"':a?a===t&&(a=null):a=t;break;case"(":if(a)break;if(0===h)return h=1,void(i+=t);l++;break;case")":if(a)break;if(1===h){if(0===l)return h=0,i+=t,void d();l--}break;case",":if(a)break;if(0===h)return void d();if(1===h&&0===l&&!e.match(/^url$/i))return s.push(n),n="",void(i+=t)}i+=t,0===h?e+=t:n+=t}}),d(),c}},{}],27:[function(t,e){function n(t){o.apply(this,arguments),this.type="linear"===t.args[0]?o.TYPES.LINEAR:o.TYPES.RADIAL}var o=t("./gradientcontainer");n.prototype=Object.create(o.prototype),e.exports=n},{"./gradientcontainer":9}],28:[function(t,e){e.exports=function(o){return new Promise(function(t,e){var n=new XMLHttpRequest;n.open("GET",o),n.onload=function(){200===n.status?t(n.responseText):e(new Error(n.statusText))},n.onerror=function(){e(new Error("Network Error"))},n.send()})}},{}]},{},[4])(4)});
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(_,T){function M(){return new Date(Date.UTC.apply(Date,arguments))}function b(){var t=new Date;return M(t.getFullYear(),t.getMonth(),t.getDate())}function t(t){return function(){return this[t].apply(this,arguments)}}var e,i=(e={get:function(t){return this.slice(t)[0]},contains:function(t){for(var e=t&&t.valueOf(),i=0,a=this.length;i<a;i++)if(this[i].valueOf()===e)return i;return-1},remove:function(t){this.splice(t,1)},replace:function(t){t&&(_.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t))},clear:function(){this.length=0},copy:function(){var t=new i;return t.replace(this),t}},function(){var t=[];return t.push.apply(t,arguments),_.extend(t,e),t}),U=function(t,e){_(t).data("datepicker",this),this._process_options(e),this.dates=new i,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=_(t),this.isInput=this.element.is("input"),this.inputField=this.isInput?this.element:this.element.find("input"),this.component=!!this.element.hasClass("date")&&this.element.find(".add-on, .input-group-addon, .btn"),this.hasInput=this.component&&this.inputField.length,this.component&&0===this.component.length&&(this.component=!1),this.isInline=!this.component&&this.element.is("div"),this.picker=_(x.template),this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow),this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(t,e){return parseInt(e)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.setDaysOfWeekHighlighted(this.o.daysOfWeekHighlighted),this.setDatesDisabled(this.o.datesDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};U.prototype={constructor:U,_resolveViewName:function(t,e){return 0===t||"days"===t||"month"===t?0:1===t||"months"===t||"year"===t?1:2===t||"years"===t||"decade"===t?2:3===t||"decades"===t||"century"===t?3:4===t||"centuries"===t||"millennium"===t?4:e!==T&&e},_check_template:function(t){try{return t!==T&&""!==t&&((t.match(/[<>]/g)||[]).length<=0||0<_(t).length)}catch(t){return!1}},_process_options:function(t){this._o=_.extend({},this._o,t);var e=this.o=_.extend({},this._o),i=e.language;F[i]||(i=i.split("-")[0],F[i]||(i=d.language)),e.language=i,e.startView=this._resolveViewName(e.startView,0),e.minViewMode=this._resolveViewName(e.minViewMode,0),e.maxViewMode=this._resolveViewName(e.maxViewMode,4),e.startView=Math.min(e.startView,e.maxViewMode),e.startView=Math.max(e.startView,e.minViewMode),!0!==e.multidate&&(e.multidate=Number(e.multidate)||!1,!1!==e.multidate&&(e.multidate=Math.max(0,e.multidate))),e.multidateSeparator=String(e.multidateSeparator),e.weekStart%=7,e.weekEnd=(e.weekStart+6)%7;var a=x.parseFormat(e.format);e.startDate!==-1/0&&(e.startDate?e.startDate instanceof Date?e.startDate=this._local_to_utc(this._zero_time(e.startDate)):e.startDate=x.parseDate(e.startDate,a,e.language,e.assumeNearbyYear):e.startDate=-1/0),e.endDate!==1/0&&(e.endDate?e.endDate instanceof Date?e.endDate=this._local_to_utc(this._zero_time(e.endDate)):e.endDate=x.parseDate(e.endDate,a,e.language,e.assumeNearbyYear):e.endDate=1/0),e.daysOfWeekDisabled=e.daysOfWeekDisabled||[],_.isArray(e.daysOfWeekDisabled)||(e.daysOfWeekDisabled=e.daysOfWeekDisabled.split(/[,\s]*/)),e.daysOfWeekDisabled=_.map(e.daysOfWeekDisabled,function(t){return parseInt(t,10)}),e.daysOfWeekHighlighted=e.daysOfWeekHighlighted||[],_.isArray(e.daysOfWeekHighlighted)||(e.daysOfWeekHighlighted=e.daysOfWeekHighlighted.split(/[,\s]*/)),e.daysOfWeekHighlighted=_.map(e.daysOfWeekHighlighted,function(t){return parseInt(t,10)}),e.datesDisabled=e.datesDisabled||[],_.isArray(e.datesDisabled)||(e.datesDisabled=[e.datesDisabled]),e.datesDisabled=_.map(e.datesDisabled,function(t){return x.parseDate(t,a,e.language,e.assumeNearbyYear)});var s=String(e.orientation).toLowerCase().split(/\s+/g),n=e.orientation.toLowerCase();if(s=_.grep(s,function(t){return/^auto|left|right|top|bottom$/.test(t)}),e.orientation={x:"auto",y:"auto"},n&&"auto"!==n)if(1===s.length)switch(s[0]){case"top":case"bottom":e.orientation.y=s[0];break;case"left":case"right":e.orientation.x=s[0]}else n=_.grep(s,function(t){return/^left|right$/.test(t)}),e.orientation.x=n[0]||"auto",n=_.grep(s,function(t){return/^top|bottom$/.test(t)}),e.orientation.y=n[0]||"auto";if(e.defaultViewDate){var o=e.defaultViewDate.year||(new Date).getFullYear(),r=e.defaultViewDate.month||0,h=e.defaultViewDate.day||1;e.defaultViewDate=M(o,r,h)}else e.defaultViewDate=b()},_events:[],_secondaryEvents:[],_applyEvents:function(t){for(var e,i,a,s=0;s<t.length;s++)e=t[s][0],2===t[s].length?(i=T,a=t[s][1]):3===t[s].length&&(i=t[s][1],a=t[s][2]),e.on(a,i)},_unapplyEvents:function(t){for(var e,i,a,s=0;s<t.length;s++)e=t[s][0],2===t[s].length?(a=T,i=t[s][1]):3===t[s].length&&(a=t[s][1],i=t[s][2]),e.off(i,a)},_buildEvents:function(){var t={keyup:_.proxy(function(t){-1===_.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:_.proxy(this.keydown,this),paste:_.proxy(this.paste,this)};!0===this.o.showOnFocus&&(t.focus=_.proxy(this.show,this)),this.isInput?this._events=[[this.element,t]]:this.component&&this.hasInput?this._events=[[this.inputField,t],[this.component,{click:_.proxy(this.show,this)}]]:this._events=[[this.element,{click:_.proxy(this.show,this),keydown:_.proxy(this.keydown,this)}]],this._events.push([this.element,"*",{blur:_.proxy(function(t){this._focused_from=t.target},this)}],[this.element,{blur:_.proxy(function(t){this._focused_from=t.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":_.proxy(function(t){this.update(t.date)},this)}]),this._secondaryEvents=[[this.picker,{click:_.proxy(this.click,this)}],[_(window),{resize:_.proxy(this.place,this)}],[_(document),{mousedown:_.proxy(function(t){this.element.is(t.target)||this.element.find(t.target).length||this.picker.is(t.target)||this.picker.find(t.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,e){var i=e||this.dates.get(-1),a=this._utc_to_local(i);this.element.trigger({type:t,date:a,dates:_.map(this.dates,this._utc_to_local),format:_.proxy(function(t,e){0===arguments.length?(t=this.dates.length-1,e=this.o.format):"string"==typeof t&&(e=t,t=this.dates.length-1),e=e||this.o.format;var i=this.dates.get(t);return x.formatDate(i,e,this.o.language)},this)})},show:function(){return this.inputField.prop("disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly?void 0:(this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&_(this.element).blur(),this)},hide:function(){return this.isInline||!this.picker.is(":visible")||(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&this.inputField.val()&&this.setValue(),this._trigger("hide")),this},destroy:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(t){var e;if(t.originalEvent.clipboardData&&t.originalEvent.clipboardData.types&&-1!==_.inArray("text/plain",t.originalEvent.clipboardData.types))e=t.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;e=window.clipboardData.getData("Text")}this.setDate(e),this.update(),t.preventDefault()},_utc_to_local:function(t){return t&&new Date(t.getTime()+6e4*t.getTimezoneOffset())},_local_to_utc:function(t){return t&&new Date(t.getTime()-6e4*t.getTimezoneOffset())},_zero_time:function(t){return t&&new Date(t.getFullYear(),t.getMonth(),t.getDate())},_zero_utc_time:function(t){return t&&new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()))},getDates:function(){return _.map(this.dates,this._utc_to_local)},getUTCDates:function(){return _.map(this.dates,function(t){return new Date(t)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var t=this.dates.get(-1);return void 0!==t?new Date(t):null},clearDates:function(){this.inputField&&this.inputField.val(""),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(){var t=_.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,t),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var t=_.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,_.map(t,this._utc_to_local)),this._trigger("changeDate"),this.setValue(),this},setDate:t("setDates"),setUTCDate:t("setUTCDates"),remove:t("destroy"),setValue:function(){var t=this.getFormattedDate();return this.inputField.val(t),this},getFormattedDate:function(e){e===T&&(e=this.o.format);var i=this.o.language;return _.map(this.dates,function(t){return x.formatDate(t,e,i)}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(t){return this._process_options({startDate:t}),this.update(),this.updateNavArrows(),this},getEndDate:function(){return this.o.endDate},setEndDate:function(t){return this._process_options({endDate:t}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(t){return this._process_options({daysOfWeekDisabled:t}),this.update(),this.updateNavArrows(),this},setDaysOfWeekHighlighted:function(t){return this._process_options({daysOfWeekHighlighted:t}),this.update(),this},setDatesDisabled:function(t){this._process_options({datesDisabled:t}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return this;var t=this.picker.outerWidth(),e=this.picker.outerHeight(),i=_(this.o.container),a=i.width(),s="body"===this.o.container?_(document).scrollTop():i.scrollTop(),n=i.offset(),o=[];this.element.parents().each(function(){var t=_(this).css("z-index");"auto"!==t&&0!==t&&o.push(parseInt(t))});var r=Math.max.apply(Math,o)+this.o.zIndexOffset,h=this.component?this.component.parent().offset():this.element.offset(),l=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),d=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),c=h.left-n.left,u=h.top-n.top;"body"!==this.o.container&&(u+=s),this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(c-=t-d)):h.left<0?(this.picker.addClass("datepicker-orient-left"),c-=h.left-10):a<c+t?(this.picker.addClass("datepicker-orient-right"),c+=d-t):this.picker.addClass("datepicker-orient-left");var p=this.o.orientation.y;if("auto"===p&&(p=-s+u-e<0?"bottom":"top"),this.picker.addClass("datepicker-orient-"+p),"top"===p?u-=e+parseInt(this.picker.css("padding-top")):u+=l,this.o.rtl){var f=a-(c+d);this.picker.css({top:u,right:f,zIndex:r})}else this.picker.css({top:u,left:c,zIndex:r});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var t=this.dates.copy(),i=[],e=!1;return arguments.length?(_.each(arguments,_.proxy(function(t,e){e instanceof Date&&(e=this._local_to_utc(e)),i.push(e)},this)),e=!0):(i=(i=this.isInput?this.element.val():this.element.data("date")||this.inputField.val())&&this.o.multidate?i.split(this.o.multidateSeparator):[i],delete this.element.data().date),i=_.map(i,_.proxy(function(t){return x.parseDate(t,this.o.format,this.o.language,this.o.assumeNearbyYear)},this)),i=_.grep(i,_.proxy(function(t){return!this.dateWithinRange(t)||!t},this),!0),this.dates.replace(i),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=this.o.defaultViewDate,e?this.setValue():i.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill(),this.element.change(),this},fillDow:function(){var t=this.o.weekStart,e="<tr>";for(this.o.calendarWeeks&&(this.picker.find(".datepicker-days .datepicker-switch").attr("colspan",function(t,e){return parseInt(e)+1}),e+='<th class="cw">&#160;</th>');t<this.o.weekStart+7;)e+='<th class="dow',-1<_.inArray(t,this.o.daysOfWeekDisabled)&&(e+=" disabled"),e+='">'+F[this.o.language].daysMin[t++%7]+"</th>";e+="</tr>",this.picker.find(".datepicker-days thead").append(e)},fillMonths:function(){for(var t=this._utc_to_local(this.viewDate),e="",i=0;i<12;){e+='<span class="month'+(t&&t.getMonth()===i?" focused":"")+'">'+F[this.o.language].monthsShort[i++]+"</span>"}this.picker.find(".datepicker-months td").html(e)},setRange:function(t){t&&t.length?this.range=_.map(t,function(t){return t.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var e=[],i=this.viewDate.getUTCFullYear(),a=this.viewDate.getUTCMonth(),s=new Date;return t.getUTCFullYear()<i||t.getUTCFullYear()===i&&t.getUTCMonth()<a?e.push("old"):(t.getUTCFullYear()>i||t.getUTCFullYear()===i&&t.getUTCMonth()>a)&&e.push("new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&e.push("focused"),this.o.todayHighlight&&t.getUTCFullYear()===s.getFullYear()&&t.getUTCMonth()===s.getMonth()&&t.getUTCDate()===s.getDate()&&e.push("today"),-1!==this.dates.contains(t)&&e.push("active"),this.dateWithinRange(t)||e.push("disabled"),this.dateIsDisabled(t)&&e.push("disabled","disabled-date"),-1!==_.inArray(t.getUTCDay(),this.o.daysOfWeekHighlighted)&&e.push("highlighted"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&e.push("range"),-1!==_.inArray(t.valueOf(),this.range)&&e.push("selected"),t.valueOf()===this.range[0]&&e.push("range-start"),t.valueOf()===this.range[this.range.length-1]&&e.push("range-end")),e},_fill_yearsView:function(t,e,i,a,s,n,o,r){var h,l,d,c,u,p,f,g,D,v,y;for(h="",l=this.picker.find(t),d=parseInt(s/i,10)*i,u=parseInt(n/a,10)*a,p=parseInt(o/a,10)*a,c=_.map(this.dates,function(t){return parseInt(t.getUTCFullYear()/a,10)*a}),l.find(".datepicker-switch").text(d+"-"+(d+9*a)),f=d-a,g=-1;g<11;g+=1)D=[e],v=null,-1===g?D.push("old"):10===g&&D.push("new"),-1!==_.inArray(f,c)&&D.push("active"),(f<u||p<f)&&D.push("disabled"),f===this.viewDate.getFullYear()&&D.push("focused"),r!==_.noop&&((y=r(new Date(f,0,1)))===T?y={}:"boolean"==typeof y?y={enabled:y}:"string"==typeof y&&(y={classes:y}),!1===y.enabled&&D.push("disabled"),y.classes&&(D=D.concat(y.classes.split(/\s+/))),y.tooltip&&(v=y.tooltip)),h+='<span class="'+D.join(" ")+'"'+(v?' title="'+v+'"':"")+">"+f+"</span>",f+=a;l.find("td").html(h)},fill:function(){var t,e,i=new Date(this.viewDate),s=i.getUTCFullYear(),a=i.getUTCMonth(),n=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,o=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,r=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,h=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,l=F[this.o.language].today||F.en.today||"",d=F[this.o.language].clear||F.en.clear||"",c=F[this.o.language].titleFormat||F.en.titleFormat;if(!isNaN(s)&&!isNaN(a)){this.picker.find(".datepicker-days .datepicker-switch").text(x.formatDate(i,c,this.o.language)),this.picker.find("tfoot .today").text(l).toggle(!1!==this.o.todayBtn),this.picker.find("tfoot .clear").text(d).toggle(!1!==this.o.clearBtn),this.picker.find("thead .datepicker-title").text(this.o.title).toggle(""!==this.o.title),this.updateNavArrows(),this.fillMonths();var u=M(s,a-1,28),p=x.getDaysInMonth(u.getUTCFullYear(),u.getUTCMonth());u.setUTCDate(p),u.setUTCDate(p-(u.getUTCDay()-this.o.weekStart+7)%7);var f=new Date(u);u.getUTCFullYear()<100&&f.setUTCFullYear(u.getUTCFullYear()),f.setUTCDate(f.getUTCDate()+42),f=f.valueOf();for(var g,D=[];u.valueOf()<f;){if(u.getUTCDay()===this.o.weekStart&&(D.push("<tr>"),this.o.calendarWeeks)){var v=new Date(+u+(this.o.weekStart-u.getUTCDay()-7)%7*864e5),y=new Date(Number(v)+(11-v.getUTCDay())%7*864e5),m=new Date(Number(m=M(y.getUTCFullYear(),0,1))+(11-m.getUTCDay())%7*864e5),w=(y-m)/864e5/7+1;D.push('<td class="cw">'+w+"</td>")}(g=this.getClassNames(u)).push("day"),this.o.beforeShowDay!==_.noop&&((e=this.o.beforeShowDay(this._utc_to_local(u)))===T?e={}:"boolean"==typeof e?e={enabled:e}:"string"==typeof e&&(e={classes:e}),!1===e.enabled&&g.push("disabled"),e.classes&&(g=g.concat(e.classes.split(/\s+/))),e.tooltip&&(t=e.tooltip)),g=_.isFunction(_.uniqueSort)?_.uniqueSort(g):_.unique(g),D.push('<td class="'+g.join(" ")+'"'+(t?' title="'+t+'"':"")+">"+u.getUTCDate()+"</td>"),t=null,u.getUTCDay()===this.o.weekEnd&&D.push("</tr>"),u.setUTCDate(u.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(D.join(""));var k=F[this.o.language].monthsTitle||F.en.monthsTitle||"Months",C=this.picker.find(".datepicker-months").find(".datepicker-switch").text(this.o.maxViewMode<2?k:s).end().find("span").removeClass("active");if(_.each(this.dates,function(t,e){e.getUTCFullYear()===s&&C.eq(e.getUTCMonth()).addClass("active")}),(s<n||r<s)&&C.addClass("disabled"),s===n&&C.slice(0,o).addClass("disabled"),s===r&&C.slice(h+1).addClass("disabled"),this.o.beforeShowMonth!==_.noop){var b=this;_.each(C,function(t,e){var i=new Date(s,t,1),a=b.o.beforeShowMonth(i);a===T?a={}:"boolean"==typeof a?a={enabled:a}:"string"==typeof a&&(a={classes:a}),!1!==a.enabled||_(e).hasClass("disabled")||_(e).addClass("disabled"),a.classes&&_(e).addClass(a.classes),a.tooltip&&_(e).prop("title",a.tooltip)})}this._fill_yearsView(".datepicker-years","year",10,1,s,n,r,this.o.beforeShowYear),this._fill_yearsView(".datepicker-decades","decade",100,10,s,n,r,this.o.beforeShowDecade),this._fill_yearsView(".datepicker-centuries","century",1e3,100,s,n,r,this.o.beforeShowCentury)}},updateNavArrows:function(){if(this._allow_update){var t=new Date(this.viewDate),e=t.getUTCFullYear(),i=t.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-1/0&&e<=this.o.startDate.getUTCFullYear()&&i<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&e>=this.o.endDate.getUTCFullYear()&&i>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:case 3:case 4:this.o.startDate!==-1/0&&e<=this.o.startDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&e>=this.o.endDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(t){var e,i,a,s,n,o,r;t.preventDefault(),t.stopPropagation(),(e=_(t.target)).hasClass("datepicker-switch")&&this.showMode(1);var h=e.closest(".prev, .next");0<h.length&&(i=x.modes[this.viewMode].navStep*(h.hasClass("prev")?-1:1),0===this.viewMode?(this.viewDate=this.moveMonth(this.viewDate,i),this._trigger("changeMonth",this.viewDate)):(this.viewDate=this.moveYear(this.viewDate,i),1===this.viewMode&&this._trigger("changeYear",this.viewDate)),this.fill()),e.hasClass("today")&&!e.hasClass("day")&&(this.showMode(-2),this._setDate(b(),"linked"===this.o.todayBtn?null:"view")),e.hasClass("clear")&&this.clearDates(),e.hasClass("disabled")||(e.hasClass("day")&&(a=parseInt(e.text(),10)||1,s=this.viewDate.getUTCFullYear(),n=this.viewDate.getUTCMonth(),e.hasClass("old")&&(0===n?(n=11,s-=1,r=o=!0):(n-=1,o=!0)),e.hasClass("new")&&(11===n?(s+=1,r=o=!(n=0)):(n+=1,o=!0)),this._setDate(M(s,n,a)),r&&this._trigger("changeYear",this.viewDate),o&&this._trigger("changeMonth",this.viewDate)),e.hasClass("month")&&(this.viewDate.setUTCDate(1),a=1,n=e.parent().find("span").index(e),s=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(n),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode?(this._setDate(M(s,n,a)),this.showMode()):this.showMode(-1),this.fill()),(e.hasClass("year")||e.hasClass("decade")||e.hasClass("century"))&&(this.viewDate.setUTCDate(1),a=1,n=0,s=parseInt(e.text(),10)||0,this.viewDate.setUTCFullYear(s),e.hasClass("year")&&(this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(M(s,n,a))),e.hasClass("decade")&&(this._trigger("changeDecade",this.viewDate),3===this.o.minViewMode&&this._setDate(M(s,n,a))),e.hasClass("century")&&(this._trigger("changeCentury",this.viewDate),4===this.o.minViewMode&&this._setDate(M(s,n,a))),this.showMode(-1),this.fill())),this.picker.is(":visible")&&this._focused_from&&_(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(t){var e=this.dates.contains(t);if(t||this.dates.clear(),-1!==e?(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive)&&this.dates.remove(e):(!1===this.o.multidate&&this.dates.clear(),this.dates.push(t)),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(t,e){e&&"date"!==e||this._toggle_multidate(t&&new Date(t)),e&&"view"!==e||(this.viewDate=t&&new Date(t)),this.fill(),this.setValue(),e&&"view"===e||this._trigger("changeDate"),this.inputField&&this.inputField.change(),!this.o.autoclose||e&&"date"!==e||this.hide()},moveDay:function(t,e){var i=new Date(t);return i.setUTCDate(t.getUTCDate()+e),i},moveWeek:function(t,e){return this.moveDay(t,7*e)},moveMonth:function(t,e){if(!(i=t)||isNaN(i.getTime()))return this.o.defaultViewDate;var i;if(!e)return t;var a,s,n=new Date(t.valueOf()),o=n.getUTCDate(),r=n.getUTCMonth(),h=Math.abs(e);if(e=0<e?1:-1,1===h)s=-1===e?function(){return n.getUTCMonth()===r}:function(){return n.getUTCMonth()!==a},a=r+e,n.setUTCMonth(a),(a<0||11<a)&&(a=(a+12)%12);else{for(var l=0;l<h;l++)n=this.moveMonth(n,e);a=n.getUTCMonth(),n.setUTCDate(o),s=function(){return a!==n.getUTCMonth()}}for(;s();)n.setUTCDate(--o),n.setUTCMonth(a);return n},moveYear:function(t,e){return this.moveMonth(t,12*e)},moveAvailableDate:function(t,e,i){do{if(t=this[i](t,e),!this.dateWithinRange(t))return!1;i="moveDay"}while(this.dateIsDisabled(t));return t},weekOfDateIsDisabled:function(t){return-1!==_.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(a){return this.weekOfDateIsDisabled(a)||0<_.grep(this.o.datesDisabled,function(t){return i=t,(e=a).getUTCFullYear()===i.getUTCFullYear()&&e.getUTCMonth()===i.getUTCMonth()&&e.getUTCDate()===i.getUTCDate();var e,i}).length},dateWithinRange:function(t){return t>=this.o.startDate&&t<=this.o.endDate},keydown:function(t){if(this.picker.is(":visible")){var e,i,a=!1,s=this.focusDate||this.viewDate;switch(t.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),t.preventDefault();break;case 37:case 38:case 39:case 40:if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;e=37===t.keyCode||38===t.keyCode?-1:1,0===this.viewMode?t.ctrlKey?(i=this.moveAvailableDate(s,e,"moveYear"))&&this._trigger("changeYear",this.viewDate):t.shiftKey?(i=this.moveAvailableDate(s,e,"moveMonth"))&&this._trigger("changeMonth",this.viewDate):37===t.keyCode||39===t.keyCode?i=this.moveAvailableDate(s,e,"moveDay"):this.weekOfDateIsDisabled(s)||(i=this.moveAvailableDate(s,e,"moveWeek")):1===this.viewMode?((38===t.keyCode||40===t.keyCode)&&(e*=4),i=this.moveAvailableDate(s,e,"moveMonth")):2===this.viewMode&&((38===t.keyCode||40===t.keyCode)&&(e*=4),i=this.moveAvailableDate(s,e,"moveYear")),i&&(this.focusDate=this.viewDate=i,this.setValue(),this.fill(),t.preventDefault());break;case 13:if(!this.o.forceParse)break;s=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(s),a=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(t.preventDefault(),t.stopPropagation(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}a&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField&&this.inputField.change())}else 40===t.keyCode&&(this.show(),t.stopPropagation())},showMode:function(t){t&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,this.viewMode+t))),this.picker.children("div").hide().filter(".datepicker-"+x.modes[this.viewMode].clsName).show(),this.updateNavArrows()}};var l=function(t,e){_(t).data("datepicker",this),this.element=_(t),this.inputs=_.map(e.inputs,function(t){return t.jquery?t[0]:t}),delete e.inputs,s.call(_(this.inputs),e).on("changeDate",_.proxy(this.dateUpdated,this)),this.pickers=_.map(this.inputs,function(t){return _(t).data("datepicker")}),this.updateDates()};l.prototype={updateDates:function(){this.dates=_.map(this.pickers,function(t){return t.getUTCDate()}),this.updateRanges()},updateRanges:function(){var i=_.map(this.dates,function(t){return t.valueOf()});_.each(this.pickers,function(t,e){e.setRange(i)})},dateUpdated:function(t){if(!this.updating){this.updating=!0;var e=_(t.target).data("datepicker");if(void 0!==e){var i=e.getUTCDate(),a=_.inArray(t.target,this.inputs),s=a-1,n=a+1,o=this.inputs.length;if(-1!==a){if(_.each(this.pickers,function(t,e){e.getUTCDate()||e.setUTCDate(i)}),i<this.dates[s])for(;0<=s&&i<this.dates[s];)this.pickers[s--].setUTCDate(i);else if(i>this.dates[n])for(;n<o&&i>this.dates[n];)this.pickers[n++].setUTCDate(i);this.updateDates(),delete this.updating}}}},remove:function(){_.map(this.pickers,function(t){t.remove()}),delete this.element.data().datepicker}};var a=_.fn.datepicker,s=function(o){var r,h=Array.apply(null,arguments);if(h.shift(),this.each(function(){var t=_(this),e=t.data("datepicker"),i="object"==typeof o&&o;if(!e){var a=function(t,e){function i(t,e){return e.toLowerCase()}var a=_(t).data(),s={},n=new RegExp("^"+e.toLowerCase()+"([A-Z])");for(var o in e=new RegExp("^"+e.toLowerCase()),a)e.test(o)&&(s[o.replace(n,i)]=a[o]);return s}(this,"date"),s=function(t){var i={};if(F[t]||(t=t.split("-")[0],F[t])){var a=F[t];return _.each(c,function(t,e){e in a&&(i[e]=a[e])}),i}}(_.extend({},d,a,i).language),n=_.extend({},d,s,a,i);e=t.hasClass("input-daterange")||n.inputs?(_.extend(n,{inputs:n.inputs||t.find("input").toArray()}),new l(this,n)):new U(this,n),t.data("datepicker",e)}"string"==typeof o&&"function"==typeof e[o]&&(r=e[o].apply(e,h))}),r===T||r instanceof U||r instanceof l)return this;if(1<this.length)throw new Error("Using only allowed for the collection of a single element ("+o+" function)");return r};_.fn.datepicker=s;var d=_.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:_.noop,beforeShowMonth:_.noop,beforeShowYear:_.noop,beforeShowDecade:_.noop,beforeShowCentury:_.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&laquo;",rightArrow:"&raquo;"}},c=_.fn.datepicker.locale_opts=["format","rtl","weekStart"];_.fn.datepicker.Constructor=U;var F=_.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},x={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10},{clsName:"decades",navFnc:"FullDecade",navStep:100},{clsName:"centuries",navFnc:"FullCentury",navStep:1e3}],isLeapYear:function(t){return t%4==0&&t%100!=0||t%400==0},getDaysInMonth:function(t,e){return[31,x.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function(t){if("function"==typeof t.toValue&&"function"==typeof t.toDisplay)return t;var e=t.replace(this.validParts,"\0").split("\0"),i=t.match(this.validParts);if(!e||!e.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:e,parts:i}},parseDate:function(t,e,i,a){function s(t,e){return!0===e&&(e=10),t<100&&((t+=2e3)>(new Date).getFullYear()+e&&(t-=100)),t}function n(){var t=this.slice(0,c[h].length),e=c[h].slice(0,t.length);return t.toLowerCase()===e.toLowerCase()}if(!t)return T;if(t instanceof Date)return t;if("string"==typeof e&&(e=x.parseFormat(e)),e.toValue)return e.toValue(t,e,i);var o,r,h,l,d=/([\-+]\d+)([dmwy])/,c=t.match(/([\-+]\d+)([dmwy])/g),u={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},p={yesterday:"-1d",today:"+0d",tomorrow:"+1d"};if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(t)){for(t=new Date,h=0;h<c.length;h++)o=d.exec(c[h]),r=parseInt(o[1]),l=u[o[2]],t=U.prototype[l](t,r);return M(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())}if(void 0!==p[t]&&(c=(t=p[t]).match(/([\-+]\d+)([dmwy])/g),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(t))){for(t=new Date,h=0;h<c.length;h++)o=d.exec(c[h]),r=parseInt(o[1]),l=u[o[2]],t=U.prototype[l](t,r);return M(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())}c=t&&t.match(this.nonpunctuation)||[],t=new Date;var f,g,D={},v=["yyyy","yy","M","MM","m","mm","d","dd"],y={yyyy:function(t,e){return t.setUTCFullYear(a?s(e,a):e)},yy:function(t,e){return t.setUTCFullYear(a?s(e,a):e)},m:function(t,e){if(isNaN(t))return t;for(e-=1;e<0;)e+=12;for(e%=12,t.setUTCMonth(e);t.getUTCMonth()!==e;)t.setUTCDate(t.getUTCDate()-1);return t},d:function(t,e){return t.setUTCDate(e)}};y.M=y.MM=y.mm=y.m,y.dd=y.d,t=b();var m=e.parts.slice();if(c.length!==m.length&&(m=_(m).filter(function(t,e){return-1!==_.inArray(e,v)}).toArray()),c.length===m.length){var w,k,C;for(h=0,w=m.length;h<w;h++){if(f=parseInt(c[h],10),o=m[h],isNaN(f))switch(o){case"MM":g=_(F[i].months).filter(n),f=_.inArray(g[0],F[i].months)+1;break;case"M":g=_(F[i].monthsShort).filter(n),f=_.inArray(g[0],F[i].monthsShort)+1}D[o]=f}for(h=0;h<v.length;h++)(C=v[h])in D&&!isNaN(D[C])&&(k=new Date(t),y[C](k,D[C]),isNaN(k)||(t=k))}return t},formatDate:function(t,e,i){if(!t)return"";if("string"==typeof e&&(e=x.parseFormat(e)),e.toDisplay)return e.toDisplay(t,e,i);var a={d:t.getUTCDate(),D:F[i].daysShort[t.getUTCDay()],DD:F[i].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:F[i].monthsShort[t.getUTCMonth()],MM:F[i].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};a.dd=(a.d<10?"0":"")+a.d,a.mm=(a.m<10?"0":"")+a.m,t=[];for(var s=_.extend([],e.separators),n=0,o=e.parts.length;n<=o;n++)s.length&&t.push(s.shift()),t.push(a[e.parts[n]]);return t.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};x.template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+x.headTemplate+"<tbody></tbody>"+x.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+x.headTemplate+x.contTemplate+x.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+x.headTemplate+x.contTemplate+x.footTemplate+'</table></div><div class="datepicker-decades"><table class="table-condensed">'+x.headTemplate+x.contTemplate+x.footTemplate+'</table></div><div class="datepicker-centuries"><table class="table-condensed">'+x.headTemplate+x.contTemplate+x.footTemplate+"</table></div></div>",_.fn.datepicker.DPGlobal=x,_.fn.datepicker.noConflict=function(){return _.fn.datepicker=a,this},_.fn.datepicker.version="1.6.4",_(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var e=_(this);e.data("datepicker")||(t.preventDefault(),s.call(e,"show"))}),_(function(){s.call(_('[data-provide="datepicker-inline"]'))})});
jQuery.fn.datepicker.dates.ar={days:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت","الأحد"],daysShort:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت","أحد"],daysMin:["ح","ن","ث","ع","خ","ج","س","ح"],months:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],monthsShort:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],today:"هذا اليوم",rtl:!0},jQuery.fn.datepicker.dates.az={days:["Bazar","Bazar ertəsi","Çərşənbə axşamı","Çərşənbə","Cümə axşamı","Cümə","Şənbə"],daysShort:["B.","B.e","Ç.a","Ç.","C.a","C.","Ş."],daysMin:["B.","B.e","Ç.a","Ç.","C.a","C.","Ş."],months:["Yanvar","Fevral","Mart","Aprel","May","İyun","İyul","Avqust","Sentyabr","Oktyabr","Noyabr","Dekabr"],monthsShort:["Yan","Fev","Mar","Apr","May","İyun","İyul","Avq","Sen","Okt","Noy","Dek"],today:"Bu gün",weekStart:1},jQuery.fn.datepicker.dates.bg={days:["Неделя","Понеделник","Вторник","Сряда","Четвъртък","Петък","Събота"],daysShort:["Нед","Пон","Вто","Сря","Чет","Пет","Съб"],daysMin:["Н","П","В","С","Ч","П","С"],months:["Януари","Февруари","Март","Април","Май","Юни","Юли","Август","Септември","Октомври","Ноември","Декември"],monthsShort:["Ян","Фев","Мар","Апр","Май","Юни","Юли","Авг","Сеп","Окт","Ное","Дек"],today:"днес"},jQuery.fn.datepicker.dates.bs={days:["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"],daysShort:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"],daysMin:["N","Po","U","Sr","Č","Pe","Su"],months:["Januar","Februar","Mart","April","Maj","Juni","Juli","August","Septembar","Oktobar","Novembar","Decembar"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Danas",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.ca={days:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"],daysShort:["Diu","Dil","Dmt","Dmc","Dij","Div","Dis"],daysMin:["dg","dl","dt","dc","dj","dv","ds"],months:["Gener","Febrer","Març","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],monthsShort:["Gen","Feb","Mar","Abr","Mai","Jun","Jul","Ago","Set","Oct","Nov","Des"],today:"Avui",monthsTitle:"Mesos",clear:"Esborrar",weekStart:1,format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates.cs={days:["Neděle","Pondělí","Úterý","Středa","Čtvrtek","Pátek","Sobota"],daysShort:["Ned","Pon","Úte","Stř","Čtv","Pát","Sob"],daysMin:["Ne","Po","Út","St","Čt","Pá","So"],months:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],monthsShort:["Led","Úno","Bře","Dub","Kvě","Čer","Čnc","Srp","Zář","Říj","Lis","Pro"],today:"Dnes",clear:"Vymazat",weekStart:1,format:"dd.m.yyyy"},jQuery.fn.datepicker.dates.cy={days:["Sul","Llun","Mawrth","Mercher","Iau","Gwener","Sadwrn"],daysShort:["Sul","Llu","Maw","Mer","Iau","Gwe","Sad"],daysMin:["Su","Ll","Ma","Me","Ia","Gwe","Sa"],months:["Ionawr","Chewfror","Mawrth","Ebrill","Mai","Mehefin","Gorfennaf","Awst","Medi","Hydref","Tachwedd","Rhagfyr"],monthsShort:["Ion","Chw","Maw","Ebr","Mai","Meh","Gor","Aws","Med","Hyd","Tach","Rha"],today:"Heddiw"},jQuery.fn.datepicker.dates.da={days:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],daysShort:["søn","man","tir","ons","tor","fre","lør"],daysMin:["sø","ma","ti","on","to","fr","lø"],months:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],monthsShort:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],today:"I Dag",clear:"Nulstil"},jQuery.fn.datepicker.dates.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",monthsTitle:"Monate",clear:"Löschen",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.el={days:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],daysShort:["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"],daysMin:["Κυ","Δε","Τρ","Τε","Πε","Πα","Σα"],months:["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],monthsShort:["Ιαν","Φεβ","Μαρ","Απρ","Μάι","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],today:"Σήμερα",clear:"Καθαρισμός",weekStart:1,format:"d/m/yyyy"},jQuery.fn.datepicker.dates["en-AU"]={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",monthsTitle:"Months",clear:"Clear",weekStart:1,format:"d/mm/yyyy"},jQuery.fn.datepicker.dates["en-GB"]={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",monthsTitle:"Months",clear:"Clear",weekStart:1,format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates.eo={days:["dimanĉo","lundo","mardo","merkredo","ĵaŭdo","vendredo","sabato"],daysShort:["dim.","lun.","mar.","mer.","ĵaŭ.","ven.","sam."],daysMin:["d","l","ma","me","ĵ","v","s"],months:["januaro","februaro","marto","aprilo","majo","junio","julio","aŭgusto","septembro","oktobro","novembro","decembro"],monthsShort:["jan.","feb.","mar.","apr.","majo","jun.","jul.","aŭg.","sep.","okt.","nov.","dec."],today:"Hodiaŭ",clear:"Nuligi",weekStart:1,format:"yyyy-mm-dd"},jQuery.fn.datepicker.dates.es={days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],daysShort:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy",monthsTitle:"Meses",clear:"Borrar",weekStart:1,format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates.et={days:["Pühapäev","Esmaspäev","Teisipäev","Kolmapäev","Neljapäev","Reede","Laupäev"],daysShort:["Pühap","Esmasp","Teisip","Kolmap","Neljap","Reede","Laup"],daysMin:["P","E","T","K","N","R","L"],months:["Jaanuar","Veebruar","Märts","Aprill","Mai","Juuni","Juuli","August","September","Oktoober","November","Detsember"],monthsShort:["Jaan","Veebr","Märts","Apr","Mai","Juuni","Juuli","Aug","Sept","Okt","Nov","Dets"],today:"Täna",clear:"Tühjenda",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.eu={days:["Igandea","Astelehena","Asteartea","Asteazkena","Osteguna","Ostirala","Larunbata"],daysShort:["Ig","Al","Ar","Az","Og","Ol","Lr"],daysMin:["Ig","Al","Ar","Az","Og","Ol","Lr"],months:["Urtarrila","Otsaila","Martxoa","Apirila","Maiatza","Ekaina","Uztaila","Abuztua","Iraila","Urria","Azaroa","Abendua"],monthsShort:["Urt","Ots","Mar","Api","Mai","Eka","Uzt","Abu","Ira","Urr","Aza","Abe"],today:"Gaur"},jQuery.fn.datepicker.dates.fa={days:["یک‌شنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه","شنبه","یک‌شنبه"],daysShort:["یک","دو","سه","چهار","پنج","جمعه","شنبه","یک"],daysMin:["ی","د","س","چ","پ","ج","ش","ی"],months:["ژانویه","فوریه","مارس","آوریل","مه","ژوئن","ژوئیه","اوت","سپتامبر","اکتبر","نوامبر","دسامبر"],monthsShort:["ژان","فور","مار","آور","مه","ژون","ژوی","اوت","سپت","اکت","نوا","دسا"],today:"امروز",clear:"پاک کن",weekStart:1,format:"yyyy/mm/dd"},jQuery.fn.datepicker.dates.fi={days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],daysShort:["sun","maa","tii","kes","tor","per","lau"],daysMin:["su","ma","ti","ke","to","pe","la"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tam","hel","maa","huh","tou","kes","hei","elo","syy","lok","mar","jou"],today:"tänään",clear:"Tyhjennä",weekStart:1,format:"d.m.yyyy"},jQuery.fn.datepicker.dates.fo={days:["Sunnudagur","Mánadagur","Týsdagur","Mikudagur","Hósdagur","Fríggjadagur","Leygardagur"],daysShort:["Sun","Mán","Týs","Mik","Hós","Frí","Ley"],daysMin:["Su","Má","Tý","Mi","Hó","Fr","Le"],months:["Januar","Februar","Marts","Apríl","Mei","Juni","Juli","August","Septembur","Oktobur","Novembur","Desembur"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"Í Dag",clear:"Reinsa"},jQuery.fn.datepicker.dates.fr={days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],daysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],daysMin:["D","L","Ma","Me","J","V","S"],months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthsShort:["Jan","Fév","Mar","Avr","Mai","Jui","Jul","Aou","Sep","Oct","Nov","Déc"],today:"Aujourd'hui",monthsTitle:"Mois",clear:"Effacer",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.fr={days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],daysShort:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],daysMin:["d","l","ma","me","j","v","s"],months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],monthsShort:["janv.","févr.","mars","avril","mai","juin","juil.","août","sept.","oct.","nov.","déc."],today:"Aujourd'hui",monthsTitle:"Mois",clear:"Effacer",weekStart:1,format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates.gl={days:["Domingo","Luns","Martes","Mércores","Xoves","Venres","Sábado"],daysShort:["Dom","Lun","Mar","Mér","Xov","Ven","Sáb"],daysMin:["Do","Lu","Ma","Me","Xo","Ve","Sa"],months:["Xaneiro","Febreiro","Marzo","Abril","Maio","Xuño","Xullo","Agosto","Setembro","Outubro","Novembro","Decembro"],monthsShort:["Xan","Feb","Mar","Abr","Mai","Xun","Xul","Ago","Sep","Out","Nov","Dec"],today:"Hoxe",clear:"Limpar",weekStart:1,format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates.he={days:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת","ראשון"],daysShort:["א","ב","ג","ד","ה","ו","ש","א"],daysMin:["א","ב","ג","ד","ה","ו","ש","א"],months:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],monthsShort:["ינו","פבר","מרץ","אפר","מאי","יונ","יול","אוג","ספט","אוק","נוב","דצמ"],today:"היום",rtl:!0},jQuery.fn.datepicker.dates.hr={days:["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"],daysShort:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"],daysMin:["Ne","Po","Ut","Sr","Če","Pe","Su"],months:["Siječanj","Veljača","Ožujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],monthsShort:["Sij","Velj","Ožu","Tra","Svi","Lip","Srp","Kol","Ruj","Lis","Stu","Pro"],today:"Danas"},jQuery.fn.datepicker.dates.hu={days:["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],daysShort:["vas","hét","ked","sze","csü","pén","szo"],daysMin:["V","H","K","Sze","Cs","P","Szo"],months:["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],monthsShort:["jan","feb","már","ápr","máj","jún","júl","aug","sze","okt","nov","dec"],today:"ma",weekStart:1,clear:"töröl",titleFormat:"yyyy. MM",format:"yyyy.mm.dd"},jQuery.fn.datepicker.dates.hy={days:["Կիրակի","Երկուշաբթի","Երեքշաբթի","Չորեքշաբթի","Հինգշաբթի","Ուրբաթ","Շաբաթ"],daysShort:["Կրկ","Երկ","Երք","Չրք","Հնգ","Ուր","Շբթ"],daysMin:["Կրկ","Երկ","Երք","Չրք","Հնգ","Ուր","Շբթ"],months:["Հունվար","Փետրվար","Մարտ","Ապրիլ","Մայիս","Հունիս","Հուլիս","Օգոստոս","Սեպտեմբեր","Հոկտեմբեր","Նոյեմբեր","Դեկտեմբեր"],monthsShort:["Հուն","Փետ","Մար","Ապր","Մայ","Հնս","Հլս","Օգս","Սեպ","Հոկ","Նմբ","Դեկ"],today:"Այսօր",clear:"Ջնջել",format:"dd.mm.yyyy",weekStart:1},jQuery.fn.datepicker.dates.id={days:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],daysShort:["Mgu","Sen","Sel","Rab","Kam","Jum","Sab"],daysMin:["Mg","Sn","Sl","Ra","Ka","Ju","Sa"],months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],today:"Hari Ini",clear:"Kosongkan"},jQuery.fn.datepicker.dates.is={days:["Sunnudagur","Mánudagur","Þriðjudagur","Miðvikudagur","Fimmtudagur","Föstudagur","Laugardagur"],daysShort:["Sun","Mán","Þri","Mið","Fim","Fös","Lau"],daysMin:["Su","Má","Þr","Mi","Fi","Fö","La"],months:["Janúar","Febrúar","Mars","Apríl","Maí","Júní","Júlí","Ágúst","September","Október","Nóvember","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Maí","Jún","Júl","Ágú","Sep","Okt","Nóv","Des"],today:"Í Dag"},jQuery.fn.datepicker.dates.it={days:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"],daysShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],daysMin:["Do","Lu","Ma","Me","Gi","Ve","Sa"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",clear:"Cancella",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.it={days:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"],daysShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],daysMin:["Do","Lu","Ma","Me","Gi","Ve","Sa"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",monthsTitle:"Mesi",clear:"Cancella",weekStart:1,format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates.ja={days:["日曜","月曜","火曜","水曜","木曜","金曜","土曜"],daysShort:["日","月","火","水","木","金","土"],daysMin:["日","月","火","水","木","金","土"],months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],today:"今日",format:"yyyy/mm/dd",titleFormat:"yyyy年mm月",clear:"クリア"},jQuery.fn.datepicker.dates.ka={days:["კვირა","ორშაბათი","სამშაბათი","ოთხშაბათი","ხუთშაბათი","პარასკევი","შაბათი"],daysShort:["კვი","ორშ","სამ","ოთხ","ხუთ","პარ","შაბ"],daysMin:["კვ","ორ","სა","ოთ","ხუ","პა","შა"],months:["იანვარი","თებერვალი","მარტი","აპრილი","მაისი","ივნისი","ივლისი","აგვისტო","სექტემბერი","ოქტომები","ნოემბერი","დეკემბერი"],monthsShort:["იან","თებ","მარ","აპრ","მაი","ივნ","ივლ","აგვ","სექ","ოქტ","ნოე","დეკ"],today:"დღეს",clear:"გასუფთავება",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.kh={days:["អាទិត្យ","ចន្ទ","អង្គារ","ពុធ","ព្រហស្បតិ៍","សុក្រ","សៅរ៍","អាទិត្យ"],daysShort:["អា.ទិ","ចន្ទ","អង្គារ","ពុធ","ព្រ.ហ","សុក្រ","សៅរ៍","អា.ទិ"],daysMin:["អា.ទិ","ចន្ទ","អង្គារ","ពុធ","ព្រ.ហ","សុក្រ","សៅរ៍","អា.ទិ"],months:["មករា","កុម្ភះ","មិនា","មេសា","ឧសភា","មិថុនា","កក្កដា","សីហា","កញ្ញា","តុលា","វិច្ឆិកា","ធ្នូ"],monthsShort:["មករា","កុម្ភះ","មិនា","មេសា","ឧសភា","មិថុនា","កក្កដា","សីហា","កញ្ញា","តុលា","វិច្ឆិកា","ធ្នូ"],today:"ថ្ងៃនេះ",clear:"សំអាត"},jQuery.fn.datepicker.dates.kk={days:["Жексенбі","Дүйсенбі","Сейсенбі","Сәрсенбі","Бейсенбі","Жұма","Сенбі"],daysShort:["Жек","Дүй","Сей","Сәр","Бей","Жұм","Сен"],daysMin:["Жк","Дс","Сс","Ср","Бс","Жм","Сн"],months:["Қаңтар","Ақпан","Наурыз","Сәуір","Мамыр","Маусым","Шілде","Тамыз","Қыркүйек","Қазан","Қараша","Желтоқсан"],monthsShort:["Қаң","Ақп","Нау","Сәу","Мам","Мау","Шіл","Там","Қыр","Қаз","Қар","Жел"],today:"Бүгін",weekStart:1},jQuery.fn.datepicker.dates.ko={days:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],daysShort:["일","월","화","수","목","금","토"],daysMin:["일","월","화","수","목","금","토"],months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],monthsShort:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],today:"오늘",clear:"삭제",format:"yyyy-mm-dd",titleFormat:"yyyy년mm월",weekStart:0},jQuery.fn.datepicker.dates.kr={days:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],daysShort:["일","월","화","수","목","금","토"],daysMin:["일","월","화","수","목","금","토"],months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],monthsShort:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},jQuery.fn.datepicker.dates.lt={days:["Sekmadienis","Pirmadienis","Antradienis","Trečiadienis","Ketvirtadienis","Penktadienis","Šeštadienis"],daysShort:["S","Pr","A","T","K","Pn","Š"],daysMin:["Sk","Pr","An","Tr","Ke","Pn","Št"],months:["Sausis","Vasaris","Kovas","Balandis","Gegužė","Birželis","Liepa","Rugpjūtis","Rugsėjis","Spalis","Lapkritis","Gruodis"],monthsShort:["Sau","Vas","Kov","Bal","Geg","Bir","Lie","Rugp","Rugs","Spa","Lap","Gru"],today:"Šiandien",monthsTitle:"Mėnesiai",clear:"Išvalyti",weekStart:1,format:"yyyy-mm-dd"},jQuery.fn.datepicker.dates.lv={days:["Svētdiena","Pirmdiena","Otrdiena","Trešdiena","Ceturtdiena","Piektdiena","Sestdiena"],daysShort:["Sv","P","O","T","C","Pk","S"],daysMin:["Sv","Pr","Ot","Tr","Ce","Pk","Se"],months:["Janvāris","Februāris","Marts","Aprīlis","Maijs","Jūnijs","Jūlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jūn","Jūl","Aug","Sep","Okt","Nov","Dec"],today:"Šodien",weekStart:1},jQuery.fn.datepicker.dates.me={days:["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"],daysShort:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"],daysMin:["Ne","Po","Ut","Sr","Če","Pe","Su"],months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danas",weekStart:1,clear:"Izbriši",format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.mk={days:["Недела","Понеделник","Вторник","Среда","Четврток","Петок","Сабота"],daysShort:["Нед","Пон","Вто","Сре","Чет","Пет","Саб"],daysMin:["Не","По","Вт","Ср","Че","Пе","Са"],months:["Јануари","Февруари","Март","Април","Мај","Јуни","Јули","Август","Септември","Октомври","Ноември","Декември"],monthsShort:["Јан","Фев","Мар","Апр","Мај","Јун","Јул","Авг","Сеп","Окт","Ное","Дек"],today:"Денес",format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.mn={days:["Ням","Даваа","Мягмар","Лхагва","Пүрэв","Баасан","Бямба"],daysShort:["Ням","Дав","Мяг","Лха","Пүр","Баа","Бям"],daysMin:["Ня","Да","Мя","Лх","Пү","Ба","Бя"],months:["Хулгана","Үхэр","Бар","Туулай","Луу","Могой","Морь","Хонь","Бич","Тахиа","Нохой","Гахай"],monthsShort:["Хул","Үхэ","Бар","Туу","Луу","Мог","Мор","Хон","Бич","Тах","Нох","Гах"],today:"Өнөөдөр",clear:"Тодорхой",format:"yyyy.mm.dd",weekStart:1},jQuery.fn.datepicker.dates.ms={days:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],daysShort:["Aha","Isn","Sel","Rab","Kha","Jum","Sab"],daysMin:["Ah","Is","Se","Ra","Kh","Ju","Sa"],months:["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],today:"Hari Ini",clear:"Bersihkan"},jQuery.fn.datepicker.dates.nb={days:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"],daysShort:["Søn","Man","Tir","Ons","Tor","Fre","Lør"],daysMin:["Sø","Ma","Ti","On","To","Fr","Lø"],months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"I Dag",format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates["nl-BE"]={days:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],daysShort:["zo","ma","di","wo","do","vr","za"],daysMin:["zo","ma","di","wo","do","vr","za"],months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],monthsShort:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],today:"Vandaag",monthsTitle:"Maanden",clear:"Leegmaken",weekStart:1,format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates.nl={days:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],daysShort:["zo","ma","di","wo","do","vr","za"],daysMin:["zo","ma","di","wo","do","vr","za"],months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],monthsShort:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],today:"Vandaag",monthsTitle:"Maanden",clear:"Wissen",weekStart:1,format:"dd-mm-yyyy"},jQuery.fn.datepicker.dates.no={days:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"],daysShort:["Søn","Man","Tir","Ons","Tor","Fre","Lør"],daysMin:["Sø","Ma","Ti","On","To","Fr","Lø"],months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"I dag",clear:"Nullstill",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.pl={days:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],daysShort:["niedz.","pon.","wt.","śr.","czw.","piąt.","sob."],daysMin:["ndz.","pn.","wt.","śr.","czw.","pt.","sob."],months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],monthsShort:["sty.","lut.","mar.","kwi.","maj","cze.","lip.","sie.","wrz.","paź.","lis.","gru."],today:"dzisiaj",weekStart:1,clear:"wyczyść",format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates["pt-BR"]={days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",monthsTitle:"Meses",clear:"Limpar",format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates.pt={days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",monthsTitle:"Meses",clear:"Limpar",format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates.ro={days:["Duminică","Luni","Marţi","Miercuri","Joi","Vineri","Sâmbătă"],daysShort:["Dum","Lun","Mar","Mie","Joi","Vin","Sâm"],daysMin:["Du","Lu","Ma","Mi","Jo","Vi","Sâ"],months:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],monthsShort:["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Nov","Dec"],today:"Astăzi",clear:"Șterge",weekStart:1},jQuery.fn.datepicker.dates["rs-latin"]={days:["Nedelja","Ponedeljak","Utorak","Sreda","Četvrtak","Petak","Subota"],daysShort:["Ned","Pon","Uto","Sre","Čet","Pet","Sub"],daysMin:["N","Po","U","Sr","Č","Pe","Su"],months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danas",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.rs={days:["Недеља","Понедељак","Уторак","Среда","Четвртак","Петак","Субота"],daysShort:["Нед","Пон","Уто","Сре","Чет","Пет","Суб"],daysMin:["Н","По","У","Ср","Ч","Пе","Су"],months:["Јануар","Фебруар","Март","Април","Мај","Јун","Јул","Август","Септембар","Октобар","Новембар","Децембар"],monthsShort:["Јан","Феб","Мар","Апр","Мај","Јун","Јул","Авг","Сеп","Окт","Нов","Дец"],today:"Данас",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.ru={days:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],daysShort:["Вск","Пнд","Втр","Срд","Чтв","Птн","Суб"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],today:"Сегодня",clear:"Очистить",format:"dd.mm.yyyy",weekStart:1},jQuery.fn.datepicker.dates.sk={days:["Nedeľa","Pondelok","Utorok","Streda","Štvrtok","Piatok","Sobota"],daysShort:["Ned","Pon","Uto","Str","Štv","Pia","Sob"],daysMin:["Ne","Po","Ut","St","Št","Pia","So"],months:["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Máj","Jún","Júl","Aug","Sep","Okt","Nov","Dec"],today:"Dnes",clear:"Vymazať",weekStart:1,format:"d.m.yyyy"},jQuery.fn.datepicker.dates.sl={days:["Nedelja","Ponedeljek","Torek","Sreda","Četrtek","Petek","Sobota"],daysShort:["Ned","Pon","Tor","Sre","Čet","Pet","Sob"],daysMin:["Ne","Po","To","Sr","Če","Pe","So"],months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danes"},jQuery.fn.datepicker.dates.sq={days:["E Diel","E Hënë","E Martē","E Mërkurë","E Enjte","E Premte","E Shtunë"],daysShort:["Die","Hën","Mar","Mër","Enj","Pre","Shtu"],daysMin:["Di","Hë","Ma","Më","En","Pr","Sht"],months:["Janar","Shkurt","Mars","Prill","Maj","Qershor","Korrik","Gusht","Shtator","Tetor","Nëntor","Dhjetor"],monthsShort:["Jan","Shk","Mar","Pri","Maj","Qer","Korr","Gu","Sht","Tet","Nën","Dhjet"],today:"Sot"},jQuery.fn.datepicker.dates["sr-latin"]={days:["Nedelja","Ponedeljak","Utorak","Sreda","Četvrtak","Petak","Subota"],daysShort:["Ned","Pon","Uto","Sre","Čet","Pet","Sub"],daysMin:["N","Po","U","Sr","Č","Pe","Su"],months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danas",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.sr={days:["Недеља","Понедељак","Уторак","Среда","Четвртак","Петак","Субота"],daysShort:["Нед","Пон","Уто","Сре","Чет","Пет","Суб"],daysMin:["Н","По","У","Ср","Ч","Пе","Су"],months:["Јануар","Фебруар","Март","Април","Мај","Јун","Јул","Август","Септембар","Октобар","Новембар","Децембар"],monthsShort:["Јан","Феб","Мар","Апр","Мај","Јун","Јул","Авг","Сеп","Окт","Нов","Дец"],today:"Данас",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.sv={days:["Söndag","Måndag","Tisdag","Onsdag","Torsdag","Fredag","Lördag"],daysShort:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"],daysMin:["Sö","Må","Ti","On","To","Fr","Lö"],months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Idag",format:"yyyy-mm-dd",weekStart:1,clear:"Rensa"},jQuery.fn.datepicker.dates.sw={days:["Jumapili","Jumatatu","Jumanne","Jumatano","Alhamisi","Ijumaa","Jumamosi"],daysShort:["J2","J3","J4","J5","Alh","Ij","J1"],daysMin:["2","3","4","5","A","I","1"],months:["Januari","Februari","Machi","Aprili","Mei","Juni","Julai","Agosti","Septemba","Oktoba","Novemba","Desemba"],monthsShort:["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ago","Sep","Okt","Nov","Des"],today:"Leo"},jQuery.fn.datepicker.dates.th={days:["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัส","ศุกร์","เสาร์","อาทิตย์"],daysShort:["อา","จ","อ","พ","พฤ","ศ","ส","อา"],daysMin:["อา","จ","อ","พ","พฤ","ศ","ส","อา"],months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],monthsShort:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],today:"วันนี้"},jQuery.fn.datepicker.dates.tr={days:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],daysShort:["Pz","Pzt","Sal","Çrş","Prş","Cu","Cts"],daysMin:["Pz","Pzt","Sa","Çr","Pr","Cu","Ct"],months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],monthsShort:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],today:"Bugün",clear:"Temizle",weekStart:1,format:"dd.mm.yyyy"},jQuery.fn.datepicker.dates.uk={days:["Неділя","Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"],daysShort:["Нед","Пнд","Втр","Срд","Чтв","Птн","Суб"],daysMin:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],months:["Cічень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],monthsShort:["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],today:"Сьогодні",clear:"Очистити",format:"dd.mm.yyyy",weekStart:1},jQuery.fn.datepicker.dates.vi={days:["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"],daysShort:["CN","Thứ 2","Thứ 3","Thứ 4","Thứ 5","Thứ 6","Thứ 7"],daysMin:["CN","T2","T3","T4","T5","T6","T7"],months:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],monthsShort:["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],today:"Hôm nay",clear:"Xóa",format:"dd/mm/yyyy"},jQuery.fn.datepicker.dates["zh-CN"]={days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],daysShort:["周日","周一","周二","周三","周四","周五","周六"],daysMin:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],today:"今日",clear:"清除",format:"yyyy年mm月dd日",titleFormat:"yyyy年mm月",weekStart:1},jQuery.fn.datepicker.dates["zh-TW"]={days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],daysShort:["週日","週一","週二","週三","週四","週五","週六"],daysMin:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],today:"今天",format:"yyyy年mm月dd日",weekStart:1,clear:"清除"};
SVGPathElement.prototype.getPathData&&SVGPathElement.prototype.setPathData||function(){var r={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},n=function(e){this._string=e,this._currentIndex=0,this._endIndex=this._string.length,this._prevCommand=null,this._skipOptionalSpaces()},u=-1!==window.navigator.userAgent.indexOf("MSIE ");n.prototype={parseSegment:function(){var e=this._string[this._currentIndex],t=r[e]?r[e]:null;if(null===t){if(null===this._prevCommand)return null;if(null===(t=("+"===e||"-"===e||"."===e||"0"<=e&&e<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null))return null}else this._currentIndex+=1;var s=null,a=(this._prevCommand=t).toUpperCase();return"H"===a||"V"===a?s=[this._parseNumber()]:"M"===a||"L"===a||"T"===a?s=[this._parseNumber(),this._parseNumber()]:"S"===a||"Q"===a?s=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"C"===a?s=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"A"===a?s=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()]:"Z"===a&&(this._skipOptionalSpaces(),s=[]),null===s||0<=s.indexOf(null)?null:{type:t,values:s}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var e=this._string[this._currentIndex];return r[e]?r[e]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return"M"===e||"m"===e},_isCurrentSpace:function(){var e=this._string[this._currentIndex];return e<=" "&&(" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]&&(this._currentIndex+=1,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},_parseNumber:function(){var e=0,t=0,s=1,a=0,r=1,n=1,u=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex]?this._currentIndex+=1:this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,r=-1),this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])&&"."!==this._string[this._currentIndex])return null;for(var i=this._currentIndex;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==i)for(var l=this._currentIndex-1,h=1;i<=l;)t+=h*(this._string[l]-"0"),l-=1,h*=10;if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){if(this._currentIndex+=1,this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])return null;for(;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)s*=10,a+=(this._string.charAt(this._currentIndex)-"0")/s,this._currentIndex+=1}if(this._currentIndex!==u&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){if(this._currentIndex+=1,"+"===this._string[this._currentIndex]?this._currentIndex+=1:"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,n=-1),this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])return null;for(;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)e*=10,e+=this._string[this._currentIndex]-"0",this._currentIndex+=1}var v=t+a;return v*=r,e&&(v*=Math.pow(10,n*e)),u===this._currentIndex?null:(this._skipOptionalSpacesOrDelimiter(),v)},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var e=null,t=this._string[this._currentIndex];if(this._currentIndex+=1,"0"===t)e=0;else{if("1"!==t)return null;e=1}return this._skipOptionalSpacesOrDelimiter(),e}};var a=function(e){if(!e||0===e.length)return[];var t=new n(e),s=[];if(t.initialCommandIsMoveTo())for(;t.hasMoreData();){var a=t.parseSegment();if(null===a)break;s.push(a)}return s},s=SVGPathElement.prototype.setAttribute,i=SVGPathElement.prototype.removeAttribute,c=window.Symbol?Symbol():"__cachedPathData",o=window.Symbol?Symbol():"__cachedNormalizedPathData",U=function(e,t,s,a,r,n,u,i,l,h){var v,p,_,c,o,d=function(e,t,s){return{x:e*Math.cos(s)-t*Math.sin(s),y:e*Math.sin(s)+t*Math.cos(s)}},y=(v=u,Math.PI*v/180),x=[];if(h)p=h[0],_=h[1],c=h[2],o=h[3];else{var I=d(e,t,-y);e=I.x,t=I.y;var f=d(s,a,-y),m=(e-(s=f.x))/2,g=(t-(a=f.y))/2,b=m*m/(r*r)+g*g/(n*n);1<b&&(r*=b=Math.sqrt(b),n*=b);var M=r*r,S=n*n,V=M*S-M*g*g-S*m*m,A=M*g*g+S*m*m,P=(i===l?-1:1)*Math.sqrt(Math.abs(V/A));c=P*r*g/n+(e+s)/2,o=P*-n*m/r+(t+a)/2,p=Math.asin(parseFloat(((t-o)/n).toFixed(9))),_=Math.asin(parseFloat(((a-o)/n).toFixed(9))),e<c&&(p=Math.PI-p),s<c&&(_=Math.PI-_),p<0&&(p=2*Math.PI+p),_<0&&(_=2*Math.PI+_),l&&_<p&&(p-=2*Math.PI),!l&&p<_&&(_-=2*Math.PI)}var C=_-p;if(Math.abs(C)>120*Math.PI/180){var E=_,N=s,D=a;_=l&&p<_?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,s=c+r*Math.cos(_),a=o+n*Math.sin(_),x=U(s,a,N,D,r,n,u,0,l,[_,E,c,o])}C=_-p;var O=Math.cos(p),L=Math.sin(p),G=Math.cos(_),k=Math.sin(_),T=Math.tan(C/4),Z=4/3*r*T,w=4/3*n*T,H=[e,t],Q=[e+Z*L,t-w*O],z=[s+Z*k,a-w*G],F=[s,a];if(Q[0]=2*H[0]-Q[0],Q[1]=2*H[1]-Q[1],h)return[Q,z,F].concat(x);x=[Q,z,F].concat(x);for(var q=[],j=0;j<x.length;j+=3){r=d(x[j][0],x[j][1],y),n=d(x[j+1][0],x[j+1][1],y);var R=d(x[j+2][0],x[j+2][1],y);q.push([r.x,r.y,n.x,n.y,R.x,R.y])}return q},d=function(e){return e.map(function(e){return{type:e.type,values:Array.prototype.slice.call(e.values)}})},y=function(e){var y=[],x=null,I=null,f=null,m=null,g=null,b=null,M=null;return e.forEach(function(e){if("M"===e.type){var t=e.values[0],s=e.values[1];y.push({type:"M",values:[t,s]}),m=b=t,g=M=s}else if("C"===e.type){var a=e.values[0],r=e.values[1],n=e.values[2],u=e.values[3];t=e.values[4],s=e.values[5],y.push({type:"C",values:[a,r,n,u,t,s]}),I=n,f=u,m=t,g=s}else if("L"===e.type)t=e.values[0],s=e.values[1],y.push({type:"L",values:[t,s]}),m=t,g=s;else if("H"===e.type)t=e.values[0],y.push({type:"L",values:[t,g]}),m=t;else if("V"===e.type)s=e.values[0],y.push({type:"L",values:[m,s]}),g=s;else if("S"===e.type)n=e.values[0],u=e.values[1],t=e.values[2],s=e.values[3],l="C"===x||"S"===x?(i=m+(m-I),g+(g-f)):(i=m,g),y.push({type:"C",values:[i,l,n,u,t,s]}),I=n,f=u,m=t,g=s;else if("T"===e.type){t=e.values[0],s=e.values[1],r="Q"===x||"T"===x?(a=m+(m-I),g+(g-f)):(a=m,g);var i=m+2*(a-m)/3,l=g+2*(r-g)/3,h=t+2*(a-t)/3,v=s+2*(r-s)/3;y.push({type:"C",values:[i,l,h,v,t,s]}),I=a,f=r,m=t,g=s}else if("Q"===e.type)a=e.values[0],r=e.values[1],t=e.values[2],s=e.values[3],i=m+2*(a-m)/3,l=g+2*(r-g)/3,h=t+2*(a-t)/3,v=s+2*(r-s)/3,y.push({type:"C",values:[i,l,h,v,t,s]}),I=a,f=r,m=t,g=s;else if("A"===e.type){var p=Math.abs(e.values[0]),_=Math.abs(e.values[1]),c=e.values[2],o=e.values[3],d=e.values[4];t=e.values[5],s=e.values[6],0===p||0===_?(y.push({type:"C",values:[m,g,t,s,t,s]}),m=t,g=s):m===t&&g===s||(U(m,g,t,s,p,_,c,o,d).forEach(function(e){y.push({type:"C",values:e})}),m=t,g=s)}else"Z"===e.type&&(y.push(e),m=b,g=M);x=e.type}),y};SVGPathElement.prototype.setAttribute=function(e,t){"d"===e&&(this[c]=null,this[o]=null),s.call(this,e,t)},SVGPathElement.prototype.removeAttribute=function(e,t){"d"===e&&(this[c]=null,this[o]=null),i.call(this,e)},SVGPathElement.prototype.getPathData=function(e){if(e&&e.normalize){if(this[o])return d(this[o]);this[c]?s=d(this[c]):(s=a(this.getAttribute("d")||""),this[c]=d(s));var t=y((l=[],_=p=v=h=null,s.forEach(function(e){var t=e.type;if("M"===t){var s=e.values[0],a=e.values[1];l.push({type:"M",values:[s,a]}),h=p=s,v=_=a}else if("m"===t)s=h+e.values[0],a=v+e.values[1],l.push({type:"M",values:[s,a]}),h=p=s,v=_=a;else if("L"===t)s=e.values[0],a=e.values[1],l.push({type:"L",values:[s,a]}),h=s,v=a;else if("l"===t)s=h+e.values[0],a=v+e.values[1],l.push({type:"L",values:[s,a]}),h=s,v=a;else if("C"===t){var r=e.values[0],n=e.values[1],u=e.values[2],i=e.values[3];s=e.values[4],a=e.values[5],l.push({type:"C",values:[r,n,u,i,s,a]}),h=s,v=a}else"c"===t?(r=h+e.values[0],n=v+e.values[1],u=h+e.values[2],i=v+e.values[3],s=h+e.values[4],a=v+e.values[5],l.push({type:"C",values:[r,n,u,i,s,a]}),h=s,v=a):"Q"===t?(r=e.values[0],n=e.values[1],s=e.values[2],a=e.values[3],l.push({type:"Q",values:[r,n,s,a]}),h=s,v=a):"q"===t?(r=h+e.values[0],n=v+e.values[1],s=h+e.values[2],a=v+e.values[3],l.push({type:"Q",values:[r,n,s,a]}),h=s,v=a):"A"===t?(s=e.values[5],a=e.values[6],l.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,a]}),h=s,v=a):"a"===t?(s=h+e.values[5],a=v+e.values[6],l.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,a]}),h=s,v=a):"H"===t?(s=e.values[0],l.push({type:"H",values:[s]}),h=s):"h"===t?(s=h+e.values[0],l.push({type:"H",values:[s]}),h=s):"V"===t?(a=e.values[0],l.push({type:"V",values:[a]}),v=a):"v"===t?(a=v+e.values[0],l.push({type:"V",values:[a]}),v=a):"S"===t?(u=e.values[0],i=e.values[1],s=e.values[2],a=e.values[3],l.push({type:"S",values:[u,i,s,a]}),h=s,v=a):"s"===t?(u=h+e.values[0],i=v+e.values[1],s=h+e.values[2],a=v+e.values[3],l.push({type:"S",values:[u,i,s,a]}),h=s,v=a):"T"===t?(s=e.values[0],a=e.values[1],l.push({type:"T",values:[s,a]}),h=s,v=a):"t"===t?(s=h+e.values[0],a=v+e.values[1],l.push({type:"T",values:[s,a]}),h=s,v=a):"Z"!==t&&"z"!==t||(l.push({type:"Z",values:[]}),h=p,v=_)}),l));return this[o]=d(t),t}if(this[c])return d(this[c]);var l,h,v,p,_,s=a(this.getAttribute("d")||"");return this[c]=d(s),s},SVGPathElement.prototype.setPathData=function(e){if(0===e.length)u?this.setAttribute("d",""):this.removeAttribute("d");else{for(var t="",s=0,a=e.length;s<a;s+=1){var r=e[s];0<s&&(t+=" "),t+=r.type,r.values&&0<r.values.length&&(t+=" "+r.values.join(" "))}this.setAttribute("d",t)}},SVGRectElement.prototype.getPathData=function(e){var t=this.x.baseVal.value,s=this.y.baseVal.value,a=this.width.baseVal.value,r=this.height.baseVal.value,n=this.hasAttribute("rx")?this.rx.baseVal.value:this.ry.baseVal.value,u=this.hasAttribute("ry")?this.ry.baseVal.value:this.rx.baseVal.value;a/2<n&&(n=a/2),r/2<u&&(u=r/2);var i=[{type:"M",values:[t+n,s]},{type:"H",values:[t+a-n]},{type:"A",values:[n,u,0,0,1,t+a,s+u]},{type:"V",values:[s+r-u]},{type:"A",values:[n,u,0,0,1,t+a-n,s+r]},{type:"H",values:[t+n]},{type:"A",values:[n,u,0,0,1,t,s+r-u]},{type:"V",values:[s+u]},{type:"A",values:[n,u,0,0,1,t+n,s]},{type:"Z",values:[]}];return i=i.filter(function(e){return"A"!==e.type||0!==e.values[0]&&0!==e.values[1]}),e&&!0===e.normalize&&(i=y(i)),i},SVGCircleElement.prototype.getPathData=function(e){var t=this.cx.baseVal.value,s=this.cy.baseVal.value,a=this.r.baseVal.value,r=[{type:"M",values:[t+a,s]},{type:"A",values:[a,a,0,0,1,t,s+a]},{type:"A",values:[a,a,0,0,1,t-a,s]},{type:"A",values:[a,a,0,0,1,t,s-a]},{type:"A",values:[a,a,0,0,1,t+a,s]},{type:"Z",values:[]}];return e&&!0===e.normalize&&(r=y(r)),r},SVGEllipseElement.prototype.getPathData=function(e){var t=this.cx.baseVal.value,s=this.cy.baseVal.value,a=this.rx.baseVal.value,r=this.ry.baseVal.value,n=[{type:"M",values:[t+a,s]},{type:"A",values:[a,r,0,0,1,t,s+r]},{type:"A",values:[a,r,0,0,1,t-a,s]},{type:"A",values:[a,r,0,0,1,t,s-r]},{type:"A",values:[a,r,0,0,1,t+a,s]},{type:"Z",values:[]}];return e&&!0===e.normalize&&(n=y(n)),n},SVGLineElement.prototype.getPathData=function(){return[{type:"M",values:[this.x1.baseVal.value,this.y1.baseVal.value]},{type:"L",values:[this.x2.baseVal.value,this.y2.baseVal.value]}]},SVGPolylineElement.prototype.getPathData=function(){for(var e=[],t=0;t<this.points.numberOfItems;t+=1){var s=this.points.getItem(t);e.push({type:0===t?"M":"L",values:[s.x,s.y]})}return e},SVGPolygonElement.prototype.getPathData=function(){for(var e=[],t=0;t<this.points.numberOfItems;t+=1){var s=this.points.getItem(t);e.push({type:0===t?"M":"L",values:[s.x,s.y]})}return e.push({type:"Z",values:[]}),e}}();